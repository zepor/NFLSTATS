(function(a,b){if(typeof define==="function"&&define.amd){define(["angular"],function(c){return(nf.ng.Bridge=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Bridge=b(require("angular")))}else{nf.ng.Bridge=b(a.angular)}}}(this,function(a){function b(){this.rootScope;this.injector}b.prototype={constructor:b,call:function(e,d){var h=e.split(".");var i=this.rootScope;a.forEach(h,function(j){i=i[j]});var f=d.split(".");d=this.rootScope;a.forEach(f,function(j){d=d[j]});var g=Array.prototype.slice.call(arguments,2);var c=d.apply(i,g);if(c){return c}},get:function(c){var d=c.split(".");var e=this.rootScope;a.forEach(d,function(f){e=e[f]});return e},digest:function(){this.rootScope.$digest()}};return new b()}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.ServiceProvider=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.ServiceProvider=b())}else{nf.ng.ServiceProvider=b()}}}(this,function(){return function(){function a(){}a.prototype={constructor:a,register:function(c,b){this[c]=b},remove:function(b){delete this[b]}};return new a()}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.ClusterSummary=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterSummary=b(require("jquery")))}else{nf.ClusterSummary=b(a.$)}}}(this,function(e){var d=false;var c=false;var f=false;var b=false;var a={urls:{clusterSummary:"../nifi-api/flow/cluster/summary"}};return{loadClusterSummary:function(){return e.ajax({type:"GET",url:a.urls.clusterSummary,dataType:"json"}).done(function(g){var h=g;var i=h.clusterSummary;if(d===true){if(f!==i.connectedToCluster){b=true}}else{if(i.clustered&&!i.connectedToCluster){b=true}}c=i.clustered;f=i.connectedToCluster;d=true})},isClustered:function(){return c===true},isConnectedToCluster:function(){return f===true},didConnectedStateChange:function(){var g=b;b=false;return g}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.AuthorizationStorage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AuthorizationStorage=b())}else{nf.AuthorizationStorage=b()}}}(this,function(){var b="Access-Token-Expiration";var a=new RegExp("Request-Token=([^;]+)");return{getRequestToken:function(){var c=null;var d=a.exec(document.cookie);if(d){c=d[1]}return c},getToken:function(){return sessionStorage.getItem(b)},hasToken:function(){var c=this.getToken();return typeof c==="string"},removeToken:function(){sessionStorage.removeItem(b)},setToken:function(c){sessionStorage.setItem(b,c)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.Storage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Storage=b())}else{nf.Storage=b()}}}(this,function(){var h=false;var g=86400000;var f=g*2;var b=function(i){return typeof i==="undefined"};var e=function(i){return i===null};var d=function(i){return !b(i)&&!e(i)};var c=function(k){if(d(k.expires)){var i=new Date(k.expires);var j=new Date();return i.valueOf()<j.valueOf()}else{return false}};var a=function(i){try{var j=JSON.parse(localStorage.getItem(i));if(d(j)){return j}else{return null}}catch(k){return null}};return{init:function(){for(var k=0;k<localStorage.length;k++){try{var j=localStorage.key(k);this.getItem(j)}catch(l){}}},acknowledgeDisconnection:function(){h=true},resetDisconnectionAcknowledgement:function(){h=false},isDisconnectionAcknowledged:function(){return h},setItem:function(j,l,i){i=d(i)?i:new Date().valueOf()+f;var k={expires:i,item:l};localStorage.setItem(j,JSON.stringify(k))},hasItem:function(i){return a(i)!==null},getItem:function(i){var j=a(i);if(j===null){return null}if(c(j)){this.removeItem(i);return null}if(d(j.item)){return j.item}else{return null}},getItemExpiration:function(i){var j=a(i);if(j===null){return null}if(d(j.expires)){return j.expires}else{return null}},removeItem:function(i){localStorage.removeItem(i)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.AuthorizationStorage"],function(d,c){return(nf.AjaxSetup=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AjaxSetup=b(require("jquery"),require("nf.AuthorizationStorage")))}else{nf.AjaxSetup=b(a.$,a.nf.AuthorizationStorage)}}}(this,function(b,a){b(document).ready(function(c){c.ajaxSetup({beforeSend:function(e){var d=a.getRequestToken();if(d!==null){e.setRequestHeader("Request-Token",d)}}})})}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.UniversalCapture=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.UniversalCapture=b(require("jquery")))}else{nf.UniversalCapture=b(a.$)}}}(this,function(b){b(document).ready(function(c){c(window).on("keydown",function(d){var i=d.ctrlKey||d.metaKey;if(!i&&d.keyCode===27){var g=c("div.value-combo");if(g.is(":visible")&&g.parent().hasClass("combo-editor")){return}if(c("div.property-detail").is(":visible")){a.removeAllPropertyDetailDialogs();d.stopImmediatePropagation();d.preventDefault()}else{var h=c(d.target);if(h.length){var j=c(".cancellable");if(j.length){var e=null;var f=null;c.each(j,function(k,m){var l=c(m);var n=l.css("zIndex");if(l.is(":visible")&&(n!==null&&typeof n!=="undefined")){n=parseInt(n,10);if(e===null||n>e){e=n;f=l}}});if(f!==null){if(f.hasClass("modal")){f.modal("hide")}else{f.hide()}d.stopImmediatePropagation();d.preventDefault();return}}if(top!==window){if(typeof parent.nf!=="undefined"&&typeof parent.nf.Shell!=="undefined"){parent.$("#shell-close-button").click();d.stopImmediatePropagation();d.preventDefault();return}}}}}else{if(i){if(d.keyCode===82){d.preventDefault()}}else{if(!c("input, textarea").is(":focus")&&(d.keyCode==8||d.keyCode===46)){d.preventDefault()}}}})});var a={removeAllPropertyDetailDialogs:function(){var c=b("body").find("div.property-detail");c.find("div.nf-editor").nfeditor("destroy");c.find("div.value-combo").combo("destroy");c.hide().remove()}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.Dialog=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Dialog=b(require("jquery")))}else{nf.Dialog=b(a.$)}}}(this,function(b){b(document).ready(function(){b("#nf-ok-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-ok-dialog-content").empty()}}});b("#nf-yes-no-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-yes-no-dialog-content").empty();b("#nf-yes-no-dialog").modal("setButtonModel",[])}}})});var a={showOkDialog:function(c){c=b.extend({headerText:"",dialogContent:""},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-ok-dialog-content").append(d).append("</br>");b("#nf-ok-dialog").modal("setButtonModel",[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-ok-dialog").modal("hide");if(typeof c.okHandler==="function"){c.okHandler.call(this)}}}}]);b("#nf-ok-dialog").modal("setHeaderText",c.headerText).modal("show")},showYesNoDialog:function(c){c=b.extend({headerText:"",dialogContent:"",yesText:"Yes",noText:"No"},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-yes-no-dialog-content").append(d);b("#nf-yes-no-dialog").modal("setButtonModel",[{buttonText:c.yesText,color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.yesHandler==="function"){c.yesHandler.call(this)}}}},{buttonText:c.noText,color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.noHandler==="function"){c.noHandler.call(this)}}}}]);b("#nf-yes-no-dialog").modal("setHeaderText",c.headerText).modal("show")},showDisconnectedFromClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node is currently not connected to the cluster. Any modifications to the data flow made here will not replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})},showConnectedToClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node just joined the cluster. Any modifications to the data flow made here will replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.AuthorizationStorage","lodash","moment"],function(f,e,c,d,g){return(nf.Common=b(f,e,c,d,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Common=b(require("jquery"),require("d3"),require("nf.AuthorizationStorage"),require("lodash"),require("moment")))}else{nf.Common=b(a.$,a.d3,a.nf.AuthorizationStorage,a._,a.moment)}}}(this,function(f,e,b,c,h){f(document).ready(function(){var i="images/bg-error.png";f("<img/>").attr("src",i).on("load",function(){f("div.message-pane").css("background-image",i)});f(document).on("mouseenter","span.link",function(){f(this).addClass("link-over")}).on("mouseleave","span.link",function(){f(this).removeClass("link-over")});f(document).on("click","div.nf-checkbox",function(){var l=f(this);var k=l.hasClass("checkbox-unchecked");var j=l.hasClass("disabled");if(j){return}if(k){l.removeClass("checkbox-unchecked").addClass("checkbox-checked")}else{l.removeClass("checkbox-checked").addClass("checkbox-unchecked")}l.trigger("change",{isChecked:k})});f(document).on("click",".nf-checkbox-label",function(j){f(j.target).parent().find(".nf-checkbox").click()});f(document).ajaxStart(function(){f("div.loading-container").addClass("ajax-loading")}).ajaxStop(function(){f("div.loading-container").removeClass("ajax-loading")});if(b.hasToken()){f("#user-logout-container").css("display","block");g.scheduleTokenRefresh()}f("#user-logout").on("click",function(){f.ajax({type:"DELETE",url:"../nifi-api/access/logout",}).done(function(){b.removeToken();window.location="../nifi/logout"}).fail(nfErrorHandler.handleAjaxError)});f("#user-home").on("click",function(){if(top!==window){parent.window.location="../nifi/"}else{window.location="../nifi/"}})});var d=null;var a=[{text:"view the user interface",value:"flow",description:"Allows users to view the user interface"},{text:"access the controller",value:"controller",description:"Allows users to view/modify the controller including Management Controller Services, Reporting Tasks, Registry Clients, Parameter Providers and nodes in the cluster"},{text:"access parameter contexts",value:"parameter-contexts",description:"Allows users to view/modify Parameter Contexts"},{text:"query provenance",value:"provenance",description:"Allows users to submit a Provenance Search and request Event Lineage"},{text:"access restricted components",value:"restricted-components",description:"Allows users to create/modify restricted components assuming other permissions are sufficient"},{text:"access all policies",value:"policies",description:"Allows users to view/modify the policies for all components"},{text:"access users/user groups",value:"tenants",description:"Allows users to view/modify the users and user groups"},{text:"retrieve site-to-site details",value:"site-to-site",description:"Allows other NiFi instances to retrieve Site-To-Site details of this NiFi"},{text:"view system diagnostics",value:"system",description:"Allows users to view System Diagnostics"},{text:"proxy user requests",value:"proxy",description:"Allows proxy machines to send requests on the behalf of others"},{text:"access counters",value:"counters",description:"Allows users to view/modify Counters"}];var g={ANONYMOUS_USER_TEXT:"Anonymous user",config:{sensitiveText:"Sensitive value set",tooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:function(i){f(this).slideDown(100)}},hide:{effect:function(i){f(this).slideUp(100)}},position:{at:"top center",my:"bottom center"}}},SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,currentUser:undefined,sortVersion:function(j,t){if(j===t){return 0}var p=j.split(/-/);var u=t.split(/-/);if(p.length>=1&&u.length>=1){var r=p[0].split(/\./);var o=u[0].split(/\./);if(r.length>=1&&o.length>=1){var m=Math.min(r.length,o.length);for(var n=0;n<m;n++){var s=parseInt(r[n],10);var l=parseInt(o[n],10);if(isNaN(s)&&isNaN(l)){continue}else{if(isNaN(s)){return -1}else{if(isNaN(l)){return 1}}}if(s!==l){return s-l}}if(r.length===o.length){if(p.length===u.length){var q=g.substringAfterFirst(j,p[0]);var k=g.substringAfterFirst(t,u[0]);return q===k?0:q>k?1:-1}else{return u.length-p.length}}else{return r.length-o.length}}else{if(r.length>=1){return 1}else{if(o.length>=1){return -1}else{return 0}}}}else{if(p.length>=1){return 1}else{if(u.length>=1){return -1}else{return 0}}}},sortType:function(i,l){var j=function(o,m){var p=g.formatBundle(o.bundle);var n=g.formatBundle(m.bundle);return p===n?0:p>n?1:-1};var k=function(t,s){if(i.columnId==="version"){var r=g.isDefinedAndNotNull(t.bundle[i.columnId])?t.bundle[i.columnId]:"";var p=g.isDefinedAndNotNull(s.bundle[i.columnId])?s.bundle[i.columnId]:"";var n=g.sortVersion(r,p);return n===0?j(t,s):n}else{if(i.columnId==="type"){var q=g.substringAfterLast(t[i.columnId],".");var o=g.substringAfterLast(s[i.columnId],".");return q===o?0:q>o?1:-1}else{var m=g.isDefinedAndNotNull(t[i.columnId])?t[i.columnId]:"";var u=g.isDefinedAndNotNull(s[i.columnId])?s[i.columnId]:"";return m===u?j(t,s):m>u?1:-1}}};l.sort(k,i.sortAsc)},typeFormatter:function(n,j,m,l,i){var k="";if(i.restricted===true){k+='<div class="view-usage-restriction fa fa-shield"></div><span class="hidden row-id">'+g.escapeHtml(i.id)+"</span>"}else{k+='<div class="fa"></div>'}k+=g.escapeHtml(m);return k},genericValueFormatter:function(m,j,l,k,i){return g.escapeHtml(l)},typeBundleFormatter:function(m,j,l,k,i){return g.escapeHtml(g.formatBundle(i.bundle))},typeVersionFormatter:function(n,j,m,l,i){var k="";if(g.isDefinedAndNotNull(i.bundle)){k+=('<div style="float: left;">'+g.escapeHtml(i.bundle.version)+"</div>")}else{k+='<div style="float: left;">unversioned</div>'}if(!g.isEmpty(i.controllerServiceApis)){k+='<div class="controller-service-apis fa fa-list" title="Compatible Controller Service" style="margin-left: 4px;"></div><span class="hidden row-id">'+g.escapeHtml(i.id)+"</span>"}k+='<div class="clear"></div>';return k},instanceTypeFormatter:function(m,j,l,k,i){if(!i.permissions.canRead){return""}return g.escapeHtml(g.formatType(i.component))},instanceBundleFormatter:function(m,j,l,k,i){if(!i.permissions.canRead){return""}return g.typeBundleFormatter(m,j,l,k,i.component)},getVersionControlTooltip:function(i){return i.stateExplanation},formatClassName:function(i){return g.substringAfterLast(i.type,".")},formatType:function(i){var j=g.formatClassName(i);if(i.bundle.version!=="unversioned"){j+=(" "+i.bundle.version)}return j},formatBundle:function(i){var j="";if(i.group!=="default"){j=i.group+" - "}return j+i.artifact},setCurrentUser:function(i){g.currentUser=i},scheduleTokenRefresh:function(){if(d!==null){clearInterval(d)}var i=g.MILLIS_PER_MINUTE;var j=function(){var o=b.getToken();if(o!==null){var l=parseInt(o,10)*g.MILLIS_PER_SECOND;var n=new Date(l);var m=new Date();var k=n.valueOf()-m.valueOf()-(30*g.MILLIS_PER_SECOND);if(k<i){if(f("#current-user").text()!==g.ANONYMOUS_USER_TEXT&&!f("#anonymous-user-alert").is(":visible")){f("#anonymous-user-alert").show().qtip(f.extend({},g.config.tooltipConfig,{content:"Your session will expire soon. Please log in again to avoid being automatically logged out.",position:{my:"top right",at:"bottom left"}}))}}}};j();d=setInterval(j,i)},setAnonymousUserLabel:function(){var i=f("#anonymous-user-alert");if(i.data("qtip")){i.qtip("api").destroy(true)}i.show().qtip(f.extend({},g.config.tooltipConfig,{content:"You are accessing with limited authority. Log in or request an account to access with additional authority granted to you by an administrator.",position:{my:"top right",at:"bottom left"}}));f("#current-user").text(g.ANONYMOUS_USER_TEXT).show()},getSessionExpiration:function(j){var k=null;var i=g.getJwtPayload(j);if(i){k=i.exp}return k},getDefaultExpiration:function(){var j=new Date();var i=j.getTime()+43200000;var k=Math.round(i/1000);return k.toString()},getJwtPayload:function(j){if(g.isDefinedAndNotNull(j)){var i=j.split(/\./);if(i.length!==3){return""}var l=f.base64.atob(i[1]);var k=JSON.parse(l);if(g.isDefinedAndNotNull(k)){return k}else{return null}}return null},canVersionFlows:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.canVersionFlows===true}else{return false}},canAccessProvenance:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.provenancePermissions.canRead===true}else{return false}},canAccessRestrictedComponents:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.restrictedComponentsPermissions.canWrite===true}else{return false}},canAccessComponentRestrictions:function(j){if(g.isDefinedAndNotNull(g.currentUser)){if(g.currentUser.restrictedComponentsPermissions.canWrite===true){return true}var i=function(m){if(g.isEmpty(g.currentUser.componentRestrictionPermissions)){return false}var l=false;f.each(g.currentUser.componentRestrictionPermissions,function(n,o){if(o.requiredPermission.id===m.id){if(o.permissions.canWrite===true){l=true;return false}}});return l};var k=true;if(g.isEmpty(j)){k=false}else{f.each(j,function(l,m){if(!i(m.requiredPermission)){k=false;return false}})}return k}else{return false}},canAccessCounters:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.countersPermissions.canRead===true}else{return false}},canModifyCounters:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.countersPermissions.canRead===true&&g.currentUser.countersPermissions.canWrite===true}else{return false}},canAccessTenants:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.tenantsPermissions.canRead===true}else{return false}},canModifyTenants:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.tenantsPermissions.canRead===true&&g.currentUser.tenantsPermissions.canWrite===true}else{return false}},canModifyParameterContexts:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.parameterContextPermissions.canRead===true&&g.currentUser.parameterContextPermissions.canWrite===true}else{return false}},canAccessPolicies:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.policiesPermissions.canRead===true}else{return false}},canModifyPolicies:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.policiesPermissions.canRead===true&&g.currentUser.policiesPermissions.canWrite===true}else{return false}},canAccessController:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.controllerPermissions.canRead===true}else{return false}},canModifyController:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.controllerPermissions.canRead===true&&g.currentUser.controllerPermissions.canWrite===true}else{return false}},canAccessSystem:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.systemPermissions.canRead===true}else{return false}},addHoverEffect:function(i,k,j){f(document).on("mouseenter",i,function(){f(this).removeClass(k).addClass(j)}).on("mouseleave",i,function(){f(this).removeClass(j).addClass(k)});return f(i).addClass(k)},toggleScrollable:function(i){if(f(i).is(":visible")){if(i.offsetHeight<i.scrollHeight||i.offsetWidth<i.scrollWidth){f(i).addClass("scrollable")}else{f(i).removeClass("scrollable")}}},determineContrastColor:function(i){if(parseInt(i,16)>16777215/1.5){return"#000000"}return"#ffffff"},updateLogoutLink:function(){if(b.hasToken()){f("#user-logout-container").css("display","block")}else{f("#user-logout-container").css("display","none")}},isContentViewConfigured:function(){var i=f("#nifi-content-viewer-url").text();return !g.isBlank(i)},populateField:function(j,i){if(g.isUndefined(i)||g.isNull(i)){return f("#"+j).addClass("unset").text("No value set")}else{if(i===""){return f("#"+j).addClass("blank").text("Empty string set")}else{return f("#"+j).text(i)}}},clearField:function(i){return f("#"+i).removeClass("unset blank").text("")},cleanUpTooltips:function(i,j){i.find(j).each(function(){var l=f(this);if(l.data("qtip")){var k=l.qtip("api");k.destroy(true)}})},formatPropertyTooltip:function(j,l){var m=[];if(g.isDefinedAndNotNull(j)){if(!g.isBlank(j.description)){m.push(g.escapeHtml(j.description))}if(!g.isBlank(j.defaultValue)){m.push("<b>Default value:</b> "+g.escapeHtml(j.defaultValue))}if(!g.isBlank(j.supportsEl)){m.push("<b>Expression language scope:</b> "+g.escapeHtml(j.expressionLanguageScope))}if(!g.isBlank(j.sensitive)){m.push("<b>Sensitive property:</b> "+g.escapeHtml(j.sensitive))}if(!g.isBlank(j.identifiesControllerService)){var i=g.formatType({type:j.identifiesControllerService,bundle:j.identifiesControllerServiceBundle});var k=g.formatBundle(j.identifiesControllerServiceBundle);m.push("<b>Requires Controller Service:</b> "+g.escapeHtml(i+" from "+k))}}if(g.isDefinedAndNotNull(l)){if(!g.isEmpty(l.previousValues)){var n=[];f.each(l.previousValues,function(p,o){n.push("<li>"+g.escapeHtml(o.previousValue)+" - "+g.escapeHtml(o.timestamp)+" ("+g.escapeHtml(o.userIdentity)+")</li>")});m.push('<b>History:</b><ul class="property-info">'+n.join("")+"</ul>")}}if(m.length>0){return m.join("<br/><br/>")}else{return null}},formatWhitespaceTooltip:function(){return g.escapeHtml("The specified value contains leading and/or trailing whitespace character(s). This could produce unexpected results if it was not intentional.")},LEAD_TRAIL_WHITE_SPACE_REGEX:/^[ \s]+|[ \s]+$/,hasLeadTrailWhitespace:function(i){if(g.isBlank(i)){return false}return g.LEAD_TRAIL_WHITE_SPACE_REGEX.test(i)},formatProperty:function(i,j){return'<div><span class="label">'+g.formatValue(i)+": </span>"+g.formatValue(j)+"</div>"},formatValue:function(i){if(g.isDefinedAndNotNull(i)){if(i===""){return'<span class="blank" style="font-size: 13px; padding-top: 2px;">Empty string set</span>'}else{return g.escapeHtml(i)}}else{return'<span class="unset" style="font-size: 13px; padding-top: 2px;">No value set</span>'}},escapeHtml:(function(){var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2f;"};return function(j){if(g.isDefinedAndNotNull(j)){return String(j).replace(/[&<>"'\/]/g,function(k){return i[k]})}else{return""}}}()),formatNewLines:function(i){if(g.isDefinedAndNotNull(i)){return i.replaceAll(/[\n]/g,"<br>")}else{return""}},isSensitiveProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.sensitive===true}else{return false}},isRequiredProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.required===true}else{return false}},isDynamicProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.dynamic===true}else{return false}},getAllowableValues:function(i){if(g.isDefinedAndNotNull(i)){return i.allowableValues}else{return null}},supportsEl:function(i){if(g.isDefinedAndNotNull(i)){return i.supportsEl===true}else{return false}},formatUnorderedList:function(j){if(f.isArray(j)){var i=f('<ul class="result"></ul>');f.each(j,function(l,m){var k=f("<li></li>").appendTo(i);if(m instanceof jQuery){k.append(m)}else{k.text(m)}});return i}else{return null}},substringAfterLast:function(m,l){var j="";var k=m.lastIndexOf(l);if(k>=0){var i=k+l.length;if(i<m.length){j=m.substr(i)}}return j},substringAfterFirst:function(m,l){var j="";var k=m.indexOf(l);if(k>=0){var i=k+l.length;if(i<m.length){j=m.substr(i)}}return j},substringBeforeLast:function(l,k){var i="";var j=l.lastIndexOf(k);if(j>=0){i=l.substr(0,j)}return i},substringBeforeFirst:function(l,k){var i="";var j=l.indexOf(k);if(j>=0){i=l.substr(0,j)}return i},setCursor:function(j,i){if(i){f("#"+j).addClass("pointer")}else{f("#"+j).removeClass("pointer")}},MILLIS_PER_DAY:86400000,MILLIS_PER_HOUR:3600000,MILLIS_PER_MINUTE:60000,MILLIS_PER_SECOND:1000,loadBalanceStrategyOptions:[{text:"Do not load balance",value:"DO_NOT_LOAD_BALANCE",description:"Do not load balance FlowFiles between nodes in the cluster."},{text:"Partition by attribute",value:"PARTITION_BY_ATTRIBUTE",description:"Determine which node to send a given FlowFile to based on the value of a user-specified FlowFile Attribute. All FlowFiles that have the same value for said Attribute will be sent to the same node in the cluster."},{text:"Round robin",value:"ROUND_ROBIN",description:"FlowFiles will be distributed to nodes in the cluster in a Round-Robin fashion. However, if a node in the cluster is not able to receive data as fast as other nodes, that node may be skipped in one or more iterations in order to maximize throughput of data distribution across the cluster."},{text:"Single node",value:"SINGLE_NODE",description:"All FlowFiles will be sent to the same node. Which node they are sent to is not defined."}],loadBalanceCompressionOptions:[{text:"Do not compress",value:"DO_NOT_COMPRESS",description:"FlowFiles will not be compressed"},{text:"Compress attributes only",value:"COMPRESS_ATTRIBUTES_ONLY",description:"FlowFiles' attributes will be compressed, but the FlowFiles' contents will not be"},{text:"Compress attributes and content",value:"COMPRESS_ATTRIBUTES_AND_CONTENT",description:"FlowFiles' attributes and content will be compressed"}],formatDuration:function(l){l=l<1?0:l;var n=l/g.MILLIS_PER_DAY;n=n>=1?parseInt(n,10):0;l%=g.MILLIS_PER_DAY;var i=l/g.MILLIS_PER_HOUR;i=i>=1?parseInt(i,10):0;l%=g.MILLIS_PER_HOUR;var j=l/g.MILLIS_PER_MINUTE;j=j>=1?parseInt(j,10):0;l%=g.MILLIS_PER_MINUTE;var m=l/g.MILLIS_PER_SECOND;m=m>=1?parseInt(m,10):0;l=Math.floor(l%g.MILLIS_PER_SECOND);var k=g.pad(i,2,"0")+":"+g.pad(j,2,"0")+":"+g.pad(m,2,"0")+"."+g.pad(l,3,"0");if(n>0){return n+" days and "+k}else{return k}},formatPredictedDuration:function(i){if(i===0){return"now"}return h.duration(i,"ms").humanize()},BYTES_IN_KILOBYTE:1024,BYTES_IN_MEGABYTE:1048576,BYTES_IN_GIGABYTE:1073741824,BYTES_IN_TERABYTE:1099511627776,formatDataSize:function(j){var i=parseFloat(j/g.BYTES_IN_TERABYTE);if(i>1){return i.toFixed(2)+" TB"}i=parseFloat(j/g.BYTES_IN_GIGABYTE);if(i>1){return i.toFixed(2)+" GB"}i=parseFloat(j/g.BYTES_IN_MEGABYTE);if(i>1){return i.toFixed(2)+" MB"}i=parseFloat(j/g.BYTES_IN_KILOBYTE);if(i>1){return i.toFixed(2)+" KB"}return parseFloat(j).toFixed(2)+" bytes"},formatInteger:function(j){var i=j+"";var k=/(\d+)(\d{3})/;while(k.test(i)){i=i.replace(k,"$1,$2")}return g.escapeHtml(i)},formatFloat:function(i){if(g.isUndefinedOrNull(i)){return 0+""}return i.toFixed(2)+""},pad:function(l,j,k){var i=l+"";while(i.length<j){i=k+i}return i},formatDateTime:function(i){return g.pad(i.getMonth()+1,2,"0")+"/"+g.pad(i.getDate(),2,"0")+"/"+g.pad(i.getFullYear(),2,"0")+" "+g.pad(i.getHours(),2,"0")+":"+g.pad(i.getMinutes(),2,"0")+":"+g.pad(i.getSeconds(),2,"0")+"."+g.pad(i.getMilliseconds(),3,"0")},parseDateTime:function(m){if(!g.isDefinedAndNotNull(m)){return new Date()}if(m==="No value set"){return new Date()}if(m==="Empty string set"){return new Date()}var t=m.split(/ /);if(t.length!==3){return new Date()}var j=t[0].split(/\//);var i=t[1].split(/:/);if(j.length!==3||i.length!==3){return new Date()}var o=parseInt(j[2],10);var n=parseInt(j[0],10)-1;var p=parseInt(j[1],10);var q=parseInt(i[0],10);var l=parseInt(i[1],10);var s=i[2].split(/\./);var r=parseInt(s[0],10);var k=0;if(s.length===2){k=parseInt(s[1],10)}return new Date(o,n,p,q,l,r,k)},parseDuration:function(i){var j=i.split(/:/);if(j.length!==3){return 0}var k=j[2].split(/\./);if(k.length===2){return new Date(1970,0,1,parseInt(j[0],10),parseInt(j[1],10),parseInt(k[0],10),parseInt(k[1],10)).getTime()}else{return new Date(1970,0,1,parseInt(j[0],10),parseInt(j[1],10),parseInt(j[2],10),0).getTime()}},parseSize:function(k){var l=k.split(/ /);var j=parseFloat(l[0].replace(/,/g,""));var i=l[1];if(i==="KB"){return j*1024}else{if(i==="MB"){return j*1024*1024}else{if(i==="GB"){return j*1024*1024*1024}else{if(i==="TB"){return j*1024*1024*1024*1024}else{return j}}}}},parseCount:function(k){var j=k.split(/ /,1);if(j.length!==1){return 0}var i=parseInt(j[0].replace(/,/g,""),10);if(isNaN(i)){return 0}return i},isDefinedAndNotNull:function(i){return !g.isUndefined(i)&&!g.isNull(i)},isUndefinedOrNull:function(i){return g.isUndefined(i)||g.isNull(i)},isUndefined:function(i){return typeof i==="undefined"},isBlank:function(i){return g.isUndefined(i)||g.isNull(i)||f.trim(i)===""},isNull:function(i){return i===null},isEmpty:function(i){return f.isArray(i)?i.length===0:true},doBulletinsDiffer:function(k,l){if(f.isArray(k)&&f.isArray(l)){if(k.length===l.length){for(var j=0;j<k.length;j++){if(k[j].id!==l[j].id||k[j].canRead!==l[j].canRead){return true}}}else{return true}}else{if(f.isArray(k)||f.isArray(l)){return true}}return false},getFormattedBulletins:function(j){var i=[];f.each(j,function(l,m){if(m.canRead===true){var k=m.bulletin;var p="";if(g.isDefinedAndNotNull(k.nodeAddress)){p="-&nbsp;"+g.escapeHtml(k.nodeAddress)+"&nbsp;-&nbsp;"}var o=f("<pre></pre>").css({"white-space":"pre-wrap"}).text(k.message);var n=f("<div>"+g.escapeHtml(k.timestamp)+"&nbsp;"+p+"&nbsp;<b>"+g.escapeHtml(k.level)+"</b>&nbsp;</div>").append(o);i.push(n)}});return i},getFormattedServiceApis:function(j){var i=[];f.each(j,function(m,n){var k=g.formatType({type:n.type,bundle:n.bundle});var l=g.formatBundle(n.bundle);i.push(f("<div></div>").text(k+" from "+l))});return i},getFormattedGarbageCollections:function(j){j.sort(function(l,k){return k.collectionCount-l.collectionCount});var i=[];f.each(j,function(m,k){var l=f('<span style="font-weight: bold;"></span>').text(k.name);var n=f("<span></span>").text(" - "+k.collectionCount+" times ("+k.collectionTime+")");var o=f("<div></div>").append(l).append(n);i.push(o)});return i},isGlobalPolicy:function(i){return g.getPolicyTypeListing(i)!==null},getPolicyTypeListing:function(i){return a.find(function(j){return i===j.value})},getComponentName:function(i){return i.permissions.canRead===true?i.component.name:i.id},getComboOptionText:function(i,k){var j=i.find(function(l){return l.value===k});return g.isDefinedAndNotNull(j)?j.text:undefined},throttle:function(i,j){return c.throttle(i,j)},getKeyValue:function(j,i){return i.split(".").reduce(function(l,k){return(typeof l===undefined||l===null)?l:(typeof l[k]=="function")?l[k]():l[k]},j)},isMultiLine:function(i){const j=/\n/.exec(i);if(j){return true}return false},sortParameterContextsAlphabeticallyBasedOnAuthorization:function(m){var j=m.filter(function(n){return n.permissions.canRead});var k=m.filter(function(n){return !n.permissions.canRead});var i=j.sort(function(o,n){if(o.component.name<n.component.name){return -1}if(o.component.name>n.component.name){return 1}return 0});var l=k.sort(function(o,n){if(o.id<n.id){return -1}if(o.id>n.id){return 1}return 0});return i.concat(l)}};return g}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Dialog","nf.Common","nf.AuthorizationStorage"],function(e,d,f,c){return(nf.ErrorHandler=b(e,d,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("jquery"),require("nf.Dialog"),require("nf.Common"),require("nf.AuthorizationStorage")))}else{nf.ErrorHandler=b(a.$,a.nf.Dialog,a.nf.Common,a.nf.AuthorizationStorage)}}}(this,function(d,c,e,b){var a={handleAjaxError:function(k,f,g){if(f==="canceled"){b.removeToken();if(d("#splash").is(":visible")){d("#message-title").text("Session Expired");d("#message-content").text("Your session has expired. Please reload to log in again.");d("#message-pane").show()}else{c.showOkDialog({headerText:"Session Expired",dialogContent:"Your session has expired. Please press Ok to log in again.",okHandler:function(){window.location="../nifi/"}})}return}var i=k.getResponseHeader("WWW-Authenticate");var j=new RegExp("^Bearer.*$");if(j.test(i)){b.removeToken()}if(d("#splash").is(":visible")){if(k.status===401){d("#message-title").text("Unauthorized")}else{if(k.status===403){d("#message-title").text("Insufficient Permissions")}else{if(k.status===409){d("#message-title").text("Invalid State")}else{if(k.status===413){d("#message-title").text("Payload Too Large")}else{d("#message-title").text("An unexpected error has occurred")}}}}if(d.trim(k.responseText)===""){d("#message-content").text("Please check the logs.")}else{d("#message-content").text(k.responseText)}d("#message-pane").show();return}if(k.status===400||k.status===404||k.status===409||k.status==413||k.status===503){c.showOkDialog({headerText:"Error",dialogContent:e.escapeHtml(k.responseText)})}else{if(k.status===403){c.showOkDialog({headerText:"Insufficient Permissions",dialogContent:e.escapeHtml(k.responseText)})}else{if(k.status<99||k.status===12007||k.status===12029){var h="Please ensure the application is running and check the logs for any errors.";if(e.isDefinedAndNotNull(f)){if(f==="timeout"){h="Request has timed out. Please ensure the application is running and check the logs for any errors."}else{if(f==="abort"){h="Request has been aborted."}else{if(f==="No Transport"){h="Request transport mechanism failed. Please ensure the host where the application is running is accessible."}}}}d("#message-title").text("Unable to communicate with NiFi");d("#message-content").text(h)}else{if(k.status===401){d("#message-title").text("Unauthorized");if(d.trim(k.responseText)===""){d("#message-content").text("Authentication is required to use this NiFi.")}else{d("#message-content").text(k.responseText)}}else{if(k.status===500){d("#message-title").text("An unexpected error has occurred");if(d.trim(k.responseText)===""){d("#message-content").text("An error occurred communicating with the application core. Please check the logs and fix any configuration issues before restarting.")}else{d("#message-content").text(k.responseText)}}else{if(k.status===200||k.status===201){d("#message-title").text("Parse Error");if(d.trim(k.responseText)===""){d("#message-content").text("Unable to interpret response from NiFi.")}else{d("#message-content").text(k.responseText)}}else{d("#message-title").text(k.status+": Unexpected Response");d("#message-content").text("An unexpected error has occurred. Please check the logs.")}}}}d("#message-pane").show()}}},handleConfigurationUpdateAjaxError:function(i,f,g){if(i.status===400){var j=i.responseText.split("\n");var h;if(j.length===1){h=d("<span></span>").text(j[0])}else{h=e.formatUnorderedList(j)}c.showOkDialog({dialogContent:h,headerText:"Configuration Error"})}else{a.handleAjaxError(i,f,g)}}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.ClusterSummary","nf.ErrorHandler","nf.Dialog","nf.Common"],function(e,h,c,g,d,f){return(nf.ComponentState=b(e,h,c,g,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ComponentState=b(require("jquery"),require("Slick"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ComponentState=b(a.$,a.Slick,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(f,b,k,j,d,c){var l=function(){var o=[{id:"key",field:"key",name:"Key",sortable:true,resizable:true,formatter:c.genericValueFormatter},{id:"value",field:"value",name:"Value",sortable:true,resizable:true,formatter:c.genericValueFormatter}];if(k.isConnectedToCluster()){o.push({id:"scope",field:"scope",name:"Scope",sortable:true,resizable:true,formatter:c.genericValueFormatter})}return o};var g=function(){var o=f("#component-state-table").data("gridInstance");if(c.isDefinedAndNotNull(o)){var p=o.getData();p.setFilterArgs({searchString:m()});p.refresh()}};var a=function(q,p){if(p.searchString===""){return true}try{var u=new RegExp(p.searchString,"i")}catch(r){return false}var t=q.key.search(u)>=0;var o=q.value.search(u)>=0;var s=false;if(c.isDefinedAndNotNull(q.scope)){s=q.scope.search(u)>=0}return t||o||s};var e=function(o,q){var p=function(t,r){var s=c.isDefinedAndNotNull(t[o.columnId])?t[o.columnId]:"";var u=c.isDefinedAndNotNull(r[o.columnId])?r[o.columnId]:"";return s===u?0:s>u?1:-1};q.sort(p,o.sortAsc)};var m=function(){return f("#component-state-filter").val()};var i=function(){var o=f("#component-state-table").data("gridInstance");var p=o.getData();p.setItems([]);f("#component-state-partial-results-container").hide();f("#displayed-component-state-entries").text("0");f("#total-component-state-entries").text("0")};var h=function(o,p){var q=0;var s=0;var t=false;var r=f("#component-state-table").data("gridInstance");r.setColumns(l());var u=r.getData();u.beginUpdate();if(c.isDefinedAndNotNull(o)){f.each(o.state,function(v,w){u.addItem(f.extend({id:q++,scope:w.clusterNodeAddress},w))});s+=o.totalEntryCount;if(c.isDefinedAndNotNull(o.state)&&o.totalEntryCount!==o.state.length){t=true}}if(c.isDefinedAndNotNull(p)){f.each(p.state,function(v,w){u.addItem(f.extend({id:q++,scope:"Cluster"},w))});s+=p.totalEntryCount;if(c.isDefinedAndNotNull(p.state)&&p.totalEntryCount!==p.state.length){t=true}}u.endUpdate();u.reSort();if(t){f("#component-state-partial-results-container").show()}f("#total-component-state-entries").text(c.formatInteger(s))};var n=function(){f("#component-state-name").text("");f("#component-state-description").text("");f("#component-state-filter").val("");f("#clear-link").removeClass("disabled").attr("title","");i();f("#component-state-table").removeData("component")};return{init:function(){f("#component-state-filter").on("keyup",function(){g()});f("#component-state-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Component State",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f(this).modal("hide")}}}],handler:{close:function(){n()},resize:function(){f("#component-state-description").width(f("#component-state-dialog").find(".dialog-content").innerWidth()-1).text(f("#component-state-description").attr("title")).ellipsis()}}});f("#clear-link").on("click",function(){if(f(this).hasClass("disabled")===false){var s=f("#component-state-table");var u=s.data("gridInstance");var t=u.getDataLength();if(t>0){var r=s.data("component");f.ajax({type:"POST",url:r.uri+"/state/clear-requests",dataType:"json"}).done(function(v){i();h()}).fail(j.handleAjaxError)}else{d.showOkDialog({headerText:"Component State",dialogContent:"This component has no state to clear."})}}});var o={autosizeColsMode:b.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var q=new b.Data.DataView({inlineFilters:false});q.setItems([]);q.setFilterArgs({searchString:"",property:"key"});q.setFilter(a);e({columnId:"key",sortAsc:true},q);var p=new b.Grid("#component-state-table",q,l(),o);p.setSelectionModel(new b.RowSelectionModel());p.registerPlugin(new b.AutoTooltips());p.setSortColumn("key",true);p.onSort.subscribe(function(s,r){e({columnId:r.sortCol.field,sortAsc:r.sortAsc},q)});q.onRowCountChanged.subscribe(function(s,r){p.updateRowCount();p.render();f("#displayed-component-state-entries").text(r.current)});q.onRowsChanged.subscribe(function(s,r){p.invalidateRows(r.rows);p.render()});f("#component-state-table").data("gridInstance",p);f("#displayed-component-state-entries").text("0");f("#total-component-state-entries").text("0")},showState:function(o,p){return f.ajax({type:"GET",url:o.uri+"/state",dataType:"json"}).done(function(r){var s=r.componentState;var q=f("#component-state-table");h(s.localState,s.clusterState);f("#component-state-dialog").modal("show");f("#component-state-name").text(o.component.name);f("#component-state-description").width(f("#component-state-dialog").find(".dialog-content").innerWidth()-1).text(s.stateDescription).ellipsis();q.data("component",o);if(p===false){f("#clear-link").addClass("disabled").attr("title","Component state can only be cleared when the component is not actively running")}var t=q.data("gridInstance");t.resizeCanvas()}).fail(j.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Shell=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Shell=b(require("jquery"),require("nf.Common")))}else{nf.Shell=b(a.$,a.nf.Common)}}}(this,function(b,e){b(document).ready(function(){b("#shell-dialog").modal({scrollableContentStyle:"scrollable",header:false,footer:false,responsive:{x:false,y:false}});b("#shell-close-button").click(function(){b("#shell-dialog").modal("hide")});b("#shell-undock-button").click(function(){var f=b("#shell-iframe").attr("src");if(!e.isBlank(f)){window.open(f);b("#shell-dialog").modal("hide")}})});var d=null;var c=null;var a=null;return{init:function(f){a=f},resizeContent:function(f){var g=f.find(".shell-content-container");g.css({width:f.width(),height:f.height()-28-40});f.trigger("shell:content:resize")},resizeIframe:function(f){var g=f.find("#shell-iframe");g.css({width:f.width(),height:f.height()-28-40});f.trigger("shell:iframe:resize")},showPage:function(f,g){if(e.isDefinedAndNotNull(a)){a.hide()}return b.Deferred(function(h){var i=b("#shell");if(e.isNull(g)||e.isUndefined(g)){g=true}b("#shell-dialog").modal("setCloseHandler",function(){i.empty();h.resolve()});b("#shell-dialog").modal("setOpenHandler",function(){e.toggleScrollable(b("#"+this.find(".tab-container").attr("id")+"-content").get(0))});b("#shell-dialog").modal("show");if(g){b("#shell-undock-button").show()}else{b("#shell-undock-button").hide()}var j=b("<iframe/>",{id:"shell-iframe",frameBorder:"0",src:f}).css({width:i.width(),height:i.height()-28}).appendTo(i)}).promise()},showContent:function(f){if(e.isDefinedAndNotNull(a)){a.hide()}return b.Deferred(function(g){var k=b(f);if(k.length){var h=b("#shell");var j=k.parent();k.detach();b("#shell-dialog").modal("setCloseHandler",function(){var m=b(".combo");for(var n=0,l=m.length;n<l;n++){if(b(m[n]).is(":visible")){b(m[n]).combo("close")}}g.resolve();k.hide().detach().appendTo(j);h.empty()});b("#shell-undock-button").hide();b("#shell-dialog").modal("show");var i=b("<div />").addClass("shell-content-container").css({width:h.width(),height:h.height()}).append(k).appendTo(h);k.show()}}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Client=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Client=b(require("jquery"),require("nf.Common")))}else{nf.Client=b(a.$,a.nf.Common)}}}(this,function(b,c){var a=null;return{init:function(){return b.ajax({type:"GET",url:"../nifi-api/flow/client-id",}).done(function(d){a=d})},getRevision:function(e){return{clientId:a,version:e.revision.version}},isNewerRevision:function(f,d){if(c.isDefinedAndNotNull(f)){var g=f.revision;var e=d.revision;return e.version>=g.version}else{return true}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.D3Helpers=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.D3Helpers=b())}else{nf.ng.D3Helpers=b()}}}(this,function(){return{multiAttr:function(b,a){Object.keys(a).forEach(function(c){b.attr(c,a[c])});return b}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Clipboard=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Clipboard=b(require("jquery"),require("nf.Common")))}else{nf.Clipboard=b(a.$,a.nf.Common)}}}(this,function(e,f){var a="copy";var d="paste";var c=null;var b={};return{addListener:function(h,g){b[h]=g},removeListener:function(g){if(f.isDefinedAndNotNull(b[g])){delete b[g]}},copy:function(h){c=h;for(var g in b){b[g].call(g,a,c)}},isCopied:function(){return f.isDefinedAndNotNull(c)},paste:function(){return e.Deferred(function(g){if(f.isDefinedAndNotNull(c)){var i=c;g.resolve(i);c=null;for(var h in b){b[h].call(h,d,i)}}else{g.reject()}}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Shell","nf.Dialog","nf.Storage","nf.Client"],function(g,h,c,f,e,d){return(nf.CustomUi=b(g,h,c,f,e,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.CustomUi=b(require("jquery"),require("nf.Common"),require("nf.Shell"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client")))}else{nf.CustomUi=b(a.$,a.nf.Common,a.nf.Shell,a.nf.Dialog,a.nf.Storage,a.nf.Client)}}}(this,function(e,f,a,d,c,b){return{showCustomUi:function(g,i,h){return e.Deferred(function(j){e("#shell-close-button");var k=b.getRevision(g);var l={id:g.id,revision:k.version,clientId:k.clientId,editable:h,disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged()};a.showPage(".."+i+"?"+e.param(l),false).done(function(){j.resolve()})}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","jquery","nf.Common","nf.ErrorHandler","nf.Dialog","nf.Clipboard","nf.Storage"],function(e,g,h,i,f,d,c){return(nf.CanvasUtils=b(e,g,h,i,f,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.CanvasUtils=b(require("d3"),require("jquery"),require("nf.Common"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Clipboard"),require("nf.Storage")))}else{nf.CanvasUtils=b(a.d3,a.$,a.nf.Common,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Clipboard,a.nf.Storage)}}}(this,function(r,b,h,e,k,f,d){var s;var p;var n;var i;var c;var a={};var g=new Map();var t=new Map();var q={storage:{namePrefix:"nifi-view-"},urls:{controller:"../nifi-api/controller"}};var j=2000;var o=2*Math.PI;var l=function(z,x){var w=0;var A=z-1;var y;var v=0;while(w<=A){y=~~((w+A)/2);v=x(y);if(v<0){A=y-1}else{if(v>0){w=y+1}else{break}}}return y};var u=function(w,v){return b.Deferred(function(y){var x=m.getGroupId();var z=n.marshal(w,x);n.create(z).done(function(A){n.move(A.snippet.id,v).done(function(){var C=new Map();var B=function(D,E){if(!C.has(D)){C.set(D,[])}C.get(D).push(E)};w.each(function(D){B(D.type,D.id)});C.forEach(function(E,D){m.getComponentByType(D).remove(E)});i.refresh();y.resolve()}).fail(e.handleAjaxError).fail(function(){y.reject()})}).fail(e.handleAjaxError).fail(function(){y.reject()})}).promise()};var m={init:function(z,x,w,y,v){s=z;p=x;n=w;i=y;c=v},config:{systemTooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:false},hide:{effect:false},position:{at:"bottom right",my:"top left"}}},getComponentByType:function(v){return c.getComponentByType(v)},getPerimeterPoint:function(v,E){var w=Math.atan2(E.height,E.width);var B=E.width/2;var A=E.height/2;var z=E.x+B;var x=E.y+A;var F=v.x-z;var D=v.y-x;var y=Math.atan2(D,F);y=y%o;if(y<0){y+=o}var C=(Math.PI/2)-y;if((y>=0&&y<w)||(y>=(o-w)&&y<o)){return{x:E.x+E.width,y:x+Math.tan(y)*B}}else{if(y>=w&&y<(Math.PI-w)){return{x:z+Math.tan(C)*A,y:E.y+E.height}}else{if(y>=(Math.PI-w)&&y<(Math.PI+w)){return{x:E.x,y:x-Math.tan(y)*B}}else{return{x:z-Math.tan(C)*A,y:E.y}}}}},queryBulletins:function(x){var v=[];var w=function(C){var A=new URL(window.location);var y=h.substringBeforeLast(A.href,"/nifi");var E=y+"/nifi-api/flow/bulletin-board?"+b.param({sourceId:C.join("|")});if(E.length>j){var z=Math.ceil(C.length/2);var D=C.slice(0,z);if(D.length>0){w(D)}var B=C.slice(z);if(B.length>0){w(B)}}else{v.push(b.ajax({type:"GET",url:E,dataType:"json"}))}};w(x);if(v.length===1){return b.Deferred(function(y){v[0].done(function(z){y.resolve(z)}).fail(function(){y.reject()}).fail(e.handleAjaxError)}).promise()}else{return b.Deferred(function(y){b.when.apply(window,v).done(function(){var A=b.makeArray(arguments);var z=null;var B=[];b.each(A,function(E,C){var D=C[0];var F=D.bulletinBoard;if(z===null){z=F.generated}Array.prototype.push.apply(B,F.bulletins)});B.sort(function(D,C){return C.id-D.id});y.resolve({bulletinBoard:{generated:z,bulletins:B}})}).fail(function(){y.reject()}).fail(e.handleAjaxError)}).promise()}},showComponent:function(w,v){if(h.isDefinedAndNotNull(w)){var x=b.Deferred(function(y){if(w!==s.getGroupId()){s.reload({},w).done(function(){y.resolve()}).fail(function(B,z,A){k.showOkDialog({headerText:"Error",dialogContent:"Unable to load the group for the specified component."});y.reject(B,z,A)})}else{y.resolve()}}).promise();x.done(function(){var y=r.select("#id-"+v);if(!y.empty()){p.show(y)}else{k.showOkDialog({headerText:"Error",dialogContent:"Unable to find the specified component."})}});return x}else{return b.Deferred(function(y){y.reject()}).promise()}},showDeepLink:function(v){m.getSelection().classed("selected",false);if(b("#nf-ok-dialog").is(":visible")===true){b("#nf-ok-dialog").modal("hide")}if("URLSearchParams" in window){var y=new URL(window.location).searchParams;if(!nf.Common.isDefinedAndNotNull(y)){y=new URLSearchParams(new URL(window.location).search)}var w=m.getGroupId();if(nf.Common.isDefinedAndNotNull(y)){var x=[];if(y.get("processGroupId")){w=y.get("processGroupId")}if(y.get("componentIds")){x=y.get("componentIds").split(",")}if(x.length>=1){return m.showComponents(w,x,v)}else{return m.getComponentByType("ProcessGroup").enterGroup(w)}}else{return m.getComponentByType("ProcessGroup").enterGroup(w)}}},showComponents:function(w,y,v){if(h.isDefinedAndNotNull(w)){var x=b.Deferred(function(z){if(w!==s.getGroupId()||v){s.reload({},w).done(function(){z.resolve()}).fail(function(C,A,B){k.showOkDialog({headerText:"Error",dialogContent:"Unable to enter the selected group."});z.reject(C,A,B)})}else{z.resolve()}}).promise();x.done(function(){var z=r.selectAll("g.component, g.connection").filter(function(B){if(y.indexOf(B.id)>=0){y.splice(y.indexOf(B.id),1);return B}});if(y.length>0){var A=b("<p></p>").text("Specified component(s) not found: "+y.join(", ")+".").append("<br/><br/>").append(b("<p>Unable to select component(s).</p>"));k.showOkDialog({headerText:"Error",dialogContent:A})}p.show(z)});return x}},setURLParameters:function(x,y){if("URLSearchParams" in window){if(!h.isDefinedAndNotNull(x)){x=m.getGroupId()}if(!h.isDefinedAndNotNull(y)){y=m.getSelection()}var v=[];y.each(function(B){v.push(B.id)});var w=new URL(window.location);var A=new URL(window.location).searchParams;if(!nf.Common.isDefinedAndNotNull(A)){A=new URLSearchParams(w.search)}if(nf.Common.isDefinedAndNotNull(A)){var A=new URLSearchParams(w.search);A.set("processGroupId",x);A.set("componentIds",v.sort());var z=w.origin+w.pathname;if(h.isDefinedAndNotNull(m.getParentGroupId())||v.length>0){if(!h.isDefinedAndNotNull(m.getParentGroupId())){A.set("processGroupId","root")}if((w.origin+w.pathname+"?"+A.toString()).length<=j){z=w.origin+w.pathname+"?"+A.toString()}else{if(h.isDefinedAndNotNull(m.getParentGroupId())){A.set("componentIds","");z=w.origin+w.pathname+"?"+A.toString()}}}window.history.replaceState({previous_url:w.href},window.document.title,z)}}},getSelection:function(){return r.selectAll("g.component.selected, g.connection.selected")},getSelectionById:function(v){return r.select("#id-"+v)},getCenterForBoundingBox:function(w){var y=s.View.getScale();if(h.isDefinedAndNotNull(w.scale)){y=w.scale}var A=b("#canvas-container");var x=A.width()/y;var z=A.height()/y;var v=[(x/2)-(w.width/2),(z/2)-(w.height/2)];return v},isBoundingBoxInViewport:function(E,H){var B=s.View.getScale();var A=s.View.getTranslate();var D=s.CANVAS_OFFSET;var F=b("#canvas-container");var w=Math.floor(F.width()/B);var x=Math.floor(F.height()/B);var C=Math.ceil(-A[0]/B);var y=Math.ceil(-A[1]/B);var I=C+w;var K=y+x;var z=Math.ceil(E.x);var J=Math.floor(E.x+E.width);var G=Math.ceil(E.y-(D)/B);var v=Math.floor(E.y-(D/B)+E.height);if(H){return !(z<C||J>I||G<y||v>K)}else{return((z>C&&z<I)||(J<I&&J>C))&&((G>y&&G<K)||(v<K&&v>y))}},centerBoundingBox:function(w){var x=s.View.getScale();if(h.isDefinedAndNotNull(w.scale)){x=w.scale}var v=m.getCenterForBoundingBox(w);s.View.transform([(v[0]-w.x)*x,(v[1]-w.y)*x],x)},editable:function(v,w,x){if(m.canModify(v)){if(!v.classed("connectable")){v.call(w.activate)}if(!v.classed("moveable")){v.call(x.activate)}}else{if(v.classed("connectable")){v.call(w.deactivate)}if(v.classed("moveable")){v.call(x.deactivate)}}},transition:function(v,w){if(w&&!v.empty()){return v.transition().duration(400)}else{return v}},position:function(v,w){if(v.empty()){return}return m.transition(v,w).attr("transform",function(x){return"translate("+x.position.x+", "+x.position.y+")"})},clearEllipsisCache:function(){a={}},ellipsis:function(C,D,B){D=D.trim();var w=parseInt(C.attr("width"),10);var y=C.node();C.text(D);var E=D.length;if(E<5){return}var x=a[B];if(x===undefined){x={};a[B]=x}var v=x[D];var A=(v===undefined)?undefined:v[w];if(A===undefined){if(y.getSubStringLength(0,D.length-1)>w){w-=5;var z=l(D.length,function(F){var G=y.getSubStringLength(0,F);if(G>w){return -1}else{if(G<w){return 1}}return 0});A=z}else{A=-1}if(x[D]===undefined){x[D]={}}x[D][w]=A}if(A===-1){return}C.text(D.substring(0,A)+String.fromCharCode(8230))},multilineEllipsis:function(F,I,H,A){var z=1;var B=H.split(/\s+/).reverse();var E=parseInt(F.attr("x"),10);var D=parseInt(F.attr("y"),10);var w=parseInt(F.attr("width"),10);var J=[];var C=F.append("tspan").attr("x",E).attr("y",D).attr("width",w);var v=B.pop();while(h.isDefinedAndNotNull(v)){J.push(v);C.text(J.join(" "));if(C.node().getComputedTextLength()>w){J.pop();C.text(J.join(" "));C=F.append("tspan").attr("x",E).attr("dy","1.2em").attr("width",w);if(++z>=I){var G=[v].concat(B.reverse());m.ellipsis(C,G.join(" "),A);break}else{C.text(v);J=[v]}}v=B.pop()}},activeThreadCount:function(x,A,B){var z=A.status.aggregateSnapshot.activeThreadCount;var v=A.status.aggregateSnapshot.terminatedThreadCount;if(z>0||v>0){var w=function(){var C=z+" active threads";if(v>0){C+=" ("+v+" terminated)"}return C};var y=x.select("text.active-thread-count").text(function(){if(v>0){return z+" ("+v+")"}else{return z}}).style("display","block").each(function(){var D=r.select(this);var C=this.getBBox();D.attr("x",function(){return A.dimensions.width-C.width-15});D.selectAll("title").remove()});y.append("title").text(w);x.select("text.active-thread-count-icon").attr("x",function(){var C=y.node().getBBox();if(typeof B==="function"){B(C.width+6)}return A.dimensions.width-C.width-20}).style("fill",function(){if(v>0){return"#ba554a"}else{return"#728e9b"}}).style("display","block").each(function(){var C=r.select(this);C.selectAll("title").remove()}).append("title").text(w)}else{x.selectAll("text.active-thread-count, text.active-thread-count-icon").style("display","none").each(function(){r.select(this).selectAll("title").remove()})}},disableImageHref:function(v){v.on("click.disableImageHref",function(w){if(w.ctrlKey||w.shiftKey){w.preventDefault()}})},bulletins:function(v,B,C,A){A=h.isDefinedAndNotNull(A)?A:0;var y=r.select("#bulletin-tip-"+B.id);var x=false;if(!h.isEmpty(B.bulletins)){var z=h.getFormattedBulletins(B.bulletins);x=z.length>0;if(x){var w=h.formatUnorderedList(z)}}if(x){v.select("text.bulletin-icon").each(function(){if(y.empty()){y=C().append("div").attr("id",function(){return"bulletin-tip-"+B.id}).attr("class","tooltip nifi-tooltip")}y.html(function(){return b("<div></div>").append(w).html()});m.canvasTooltip(y,r.select(this))});v.select("text.bulletin-icon").style("visibility","visible");v.select("rect.bulletin-background").style("visibility","visible")}else{if(!y.empty()){y.remove()}v.select("text.bulletin-icon").style("visibility","hidden");v.select("rect.bulletin-background").style("visibility","hidden")}},canvasTooltip:function(v,w){w.on("mouseenter",function(x){v.style("top",(x.pageY+15)+"px").style("left",(x.pageX+15)+"px").style("display","block")}).on("mousemove",function(){v.style("top",(event.pageY+15)+"px").style("left",(event.pageX+15)+"px")}).on("mouseleave",function(){v.style("display","none")})},canAlign:function(x){var w=true;var v=x.filter(function(z){var y=r.select(this);return m.isConnection(y)});if(x.size()-v.size()<2){w=false}if(m.canModify(x)===false){w=false}return w},isColorable:function(x){if(x.empty()){return false}if(m.canRead(x)===false||m.canModify(x)===false){return false}var w=x.filter(function(B){var A=r.select(this);return m.isProcessor(A)&&m.canModify(A)});var z=x.filter(function(B){var A=r.select(this);return m.isLabel(A)&&m.canModify(A)});var v=w.size()===x.size();var y=z.size()===x.size();return v||y},isConnection:function(v){return v.classed("connection")},isRemoteProcessGroup:function(v){return v.classed("remote-process-group")},isProcessor:function(v){return v.classed("processor")},isLabel:function(v){return v.classed("label")},isInputPort:function(v){return v.classed("input-port")},isOutputPort:function(v){return v.classed("output-port")},isProcessGroup:function(v){return v.classed("process-group")},isFunnel:function(v){return v.classed("funnel")},areRunnable:function(v){if(v.empty()){return true}var w=true;v.each(function(){if(!m.isRunnable(r.select(this))){w=false;return false}});return w},isRunnable:function(v){if(v.size()!==1){return false}if(m.isProcessGroup(v)){return true}if(m.canOperate(v)===false){return false}var x=false;var w=v.datum();if(m.isProcessor(v)||m.isInputPort(v)||m.isOutputPort(v)){x=m.supportsModification(v)&&w.status.aggregateSnapshot.runStatus==="Stopped"}return x},areStoppable:function(v){if(v.empty()){return true}var w=true;v.each(function(){if(!m.isStoppable(r.select(this))){w=false;return false}});return w},isStoppable:function(v){if(v.size()!==1){return false}if(m.isProcessGroup(v)){return true}if(m.canOperate(v)===false){return false}var x=false;var w=v.datum();if(m.isProcessor(v)||m.isInputPort(v)||m.isOutputPort(v)){x=w.status.aggregateSnapshot.runStatus==="Running"}return x},filterEnable:function(v){return v.filter(function(y){var w=r.select(this);var x=w.datum();if(m.isProcessGroup(w)){return true}if(m.canOperate(w)===false){return false}return((m.isProcessor(w)||m.isInputPort(w)||m.isOutputPort(w))&&m.supportsModification(w)&&x.status.aggregateSnapshot.runStatus==="Disabled")})},canEnable:function(v){if(v.empty()){return true}return m.filterEnable(v).size()===v.size()},filterDisable:function(v){return v.filter(function(y){var w=r.select(this);var x=w.datum();if(m.isProcessGroup(w)){return true}if(m.canOperate(w)===false){return false}return((m.isProcessor(w)||m.isInputPort(w)||m.isOutputPort(w))&&m.supportsModification(w)&&(x.status.aggregateSnapshot.runStatus==="Stopped"||x.status.aggregateSnapshot.runStatus==="Invalid"))})},canDisable:function(v){if(v.empty()){return true}return m.filterDisable(v).size()===v.size()},canAllStartTransmitting:function(v){if(v.empty()){return false}var w=true;v.each(function(){if(!m.canStartTransmitting(r.select(this))){w=false}});return w},canStartTransmitting:function(v){if(v.size()!==1){return false}if((m.canModify(v)===false||m.canRead(v)===false)&&m.canOperate(v)===false){return false}return m.isRemoteProcessGroup(v)},canAllStopTransmitting:function(v){if(v.empty()){return false}var w=true;v.each(function(){if(!m.canStopTransmitting(r.select(this))){w=false}});return w},canStopTransmitting:function(v){if(v.size()!==1){return false}if((m.canModify(v)===false||m.canRead(v)===false)&&m.canOperate(v)===false){return false}return m.isRemoteProcessGroup(v)},areDeletable:function(v){if(v.empty()){return false}var w=true;v.each(function(){if(!m.isDeletable(r.select(this))){w=false}});return w},isDeletable:function(v){if(v.size()!==1){return false}if(s.canWrite()===false){return false}if(m.canModify(v)===false){return false}return m.supportsModification(v)},isConfigurable:function(v){if(v.size()!==1){if(v.empty()){return true}else{return false}}if(m.isProcessGroup(v)){return true}if(m.canRead(v)===false||m.canModify(v)===false){return false}if(m.isFunnel(v)){return false}return m.supportsModification(v)},hasDetails:function(v){if(v.size()!==1){return false}if(m.canRead(v)===false){return false}if(m.canModify(v)){if(m.isProcessor(v)||m.isInputPort(v)||m.isOutputPort(v)||m.isRemoteProcessGroup(v)||m.isConnection(v)){return !m.isConfigurable(v)}}else{return m.isProcessor(v)||m.isConnection(v)||m.isInputPort(v)||m.isOutputPort(v)||m.isRemoteProcessGroup(v)}return false},canManagePolicies:function(){var v=m.getSelection();if(v.size()<=1){if(!v.empty()&&m.isConnection(v)){return false}return h.canAccessTenants()}return false},canModify:function(x){var w=x.size();var v=x.filter(function(y){return y.permissions.canWrite}).size();return w===v},canRead:function(w){var v=w.size();var x=w.filter(function(y){return y.permissions.canRead}).size();return v===x},canOperate:function(x){var w=x.size();var v=x.filter(function(y){return y.permissions.canWrite||(y.operatePermissions&&y.operatePermissions.canWrite)}).size();return w===v},supportsModification:function(C){if(C.size()!==1){return false}var A=C.datum();var y=false;if(m.isProcessor(C)||m.isInputPort(C)||m.isOutputPort(C)){y=!(A.status.aggregateSnapshot.runStatus==="Running"||A.status.aggregateSnapshot.activeThreadCount>0)}else{if(m.isRemoteProcessGroup(C)){y=!(A.status.transmissionStatus==="Transmitting"||A.status.aggregateSnapshot.activeThreadCount>0)}else{if(m.isProcessGroup(C)){y=true}else{if(m.isFunnel(C)){y=true}else{if(m.isLabel(C)){y=true}else{if(m.isConnection(C)){var B=false;var w=false;var D=m.getConnectionSourceComponentId(A);var v=r.select("#id-"+D);if(!v.empty()){if(m.isRemoteProcessGroup(v)||m.isProcessGroup(v)){B=true}else{B=m.supportsModification(v)}}var x=m.getConnectionDestinationComponentId(A);var z=r.select("#id-"+x);if(!z.empty()){if(m.isRemoteProcessGroup(z)||m.isProcessGroup(z)){w=true}else{w=m.supportsModification(z)}}y=B&&w}}}}}}return y},getConnectableTypeForSource:function(w){var v;if(m.isProcessor(w)){v="PROCESSOR"}else{if(m.isRemoteProcessGroup(w)){v="REMOTE_OUTPUT_PORT"}else{if(m.isProcessGroup(w)){v="OUTPUT_PORT"}else{if(m.isInputPort(w)){v="INPUT_PORT"}else{if(m.isFunnel(w)){v="FUNNEL"}}}}}return v},getConnectableTypeForDestination:function(w){var v;if(m.isProcessor(w)){v="PROCESSOR"}else{if(m.isRemoteProcessGroup(w)){v="REMOTE_INPUT_PORT"}else{if(m.isProcessGroup(w)){v="INPUT_PORT"}else{if(m.isOutputPort(w)){v="OUTPUT_PORT"}else{if(m.isFunnel(w)){v="FUNNEL"}}}}}return v},isCopyable:function(w){if(w.empty()){return false}if(m.canRead(w)===false){return false}var v=w.filter(function(A){var y=r.select(this);if(m.isConnection(y)){var x=!w.filter(function(B){var C=m.getConnectionSourceComponentId(A);return C===B.id}).empty();var z=!w.filter(function(B){var C=m.getConnectionDestinationComponentId(A);return C===B.id}).empty();return x&&z}else{return m.isProcessor(y)||m.isFunnel(y)||m.isLabel(y)||m.isProcessGroup(y)||m.isRemoteProcessGroup(y)||m.isInputPort(y)||m.isOutputPort(y)}});return w.size()===v.size()},isPastable:function(){return s.canWrite()&&f.isCopied()},persistUserView:function(){var v=q.storage.namePrefix+s.getGroupId();var x=s.View.getTranslate();var w={scale:s.View.getScale(),translateX:x[0],translateY:x[1]};d.setItem(v,w)},formatConnectionName:function(v){if(!h.isBlank(v.name)){return v.name}else{if(h.isDefinedAndNotNull(v.selectedRelationships)){return v.selectedRelationships.join(", ")}}return""},reloadConnectionSourceAndDestination:function(y,x){if(h.isBlank(y)===false){var w=r.select("#id-"+y);if(w.empty()===false){c.reload(w)}}if(h.isBlank(x)===false){var v=r.select("#id-"+x);if(v.empty()===false){c.reload(v)}}},getConnectionSourceComponentId:function(v){var w=v.sourceId;if(v.sourceGroupId!==s.getGroupId()){w=v.sourceGroupId}return w},getConnectionDestinationComponentId:function(v){var w=v.destinationId;if(v.destinationGroupId!==s.getGroupId()){w=v.destinationGroupId}return w},restoreUserView:function(){var x=false;try{var v=q.storage.namePrefix+s.getGroupId();var w=d.getItem(v);if(h.isDefinedAndNotNull(w)){if(isFinite(w.scale)&&isFinite(w.translateX)&&isFinite(w.translateY)){s.View.transform([w.translateX,w.translateY],w.scale);x=true}}}catch(y){}return x},getOrigin:function(w){var v={};w.each(function(y){var x=r.select(this);if(!m.isConnection(x)){if(h.isUndefined(v.x)||y.position.x<v.x){v.x=y.position.x}if(h.isUndefined(v.y)||y.position.y<v.y){v.y=y.position.y}}});return v},getSelectionBoundingClientRect:function(v){var z=s.View.getScale();var y=s.View.getTranslate();var x={x:Number.MAX_VALUE,y:Number.MAX_VALUE,right:Number.MIN_VALUE,bottom:Number.MIN_VALUE,translate:s.View.getTranslate()};var w=v.nodes().reduce(function(C,B){var A=B.getBoundingClientRect();C.x=Math.min(A.x,C.x);C.y=Math.min(A.y,C.y);C.right=Math.max(A.right,C.right);C.bottom=Math.max(A.bottom,C.bottom);return C},x);w.x=(w.x-y[0])/z;w.y=(w.y-y[1])/z;w.right=(w.right-y[0])/z;w.bottom=(w.bottom-y[1])/z;w.width=w.right-w.x;w.height=w.bottom-w.y;w.top=w.y;w.left=w.x;return w},translateBoundingClientRect:function(w,v){if(h.isUndefinedOrNull(v)){if(h.isDefinedAndNotNull(w.translate)){v=w.translate}else{v=s.View.getTranslate()}}return{x:w.x-v[0],y:w.y-v[1],left:w.left-v[0],right:w.right-v[0],top:w.top-v[1],bottom:w.bottom-v[1],width:w.width,height:w.height}},moveComponentsToParent:function(w){var v=s.getParentGroupId();if(v===null){k.showOkDialog({headerText:"Process Group",dialogContent:"Components are already in the topmost group."})}else{u(w,v)}},moveComponents:function(w,x){var v=x.datum();u(w,v.id).done(function(){m.getComponentByType("ProcessGroup").reload(v.id)})},trimDanglingEdges:function(v){var w=function(x){var B=m.getConnectionSourceComponentId(x);var A=m.getConnectionDestinationComponentId(x);var z=false;var y=false;v.each(function(C){if(C.id===B){z=true}if(C.id===A){y=true}});return z&&y};return v.filter(function(x){if(x.type==="Connection"){return w(x)}else{return true}})},isValidConnectionSource:function(v){if(v.size()!==1){return false}if(m.isProcessGroup(v)){return true}if(m.canRead(v)===false||m.canModify(v)===false){return false}return m.isProcessor(v)||m.isRemoteProcessGroup(v)||m.isInputPort(v)||m.isFunnel(v)},isValidConnectionDestination:function(w){if(w.size()!==1){return false}if(m.isProcessGroup(w)){return true}if(m.canModify(w)===false){return false}if(m.isRemoteProcessGroup(w)||m.isOutputPort(w)||m.isFunnel(w)){return true}if(m.isProcessor(w)){var v=w.datum();return v.inputRequirement!=="INPUT_FORBIDDEN"}},isManagedAuthorizer:function(){return s.isManagedAuthorizer()},isConfigurableAuthorizer:function(){return s.isConfigurableAuthorizer()},isConfigurableUsersAndGroups:function(){return s.isConfigurableUsersAndGroups()},addComponentRestrictions:function(v,w){v.forEach(function(x,y){if(!g.has(y)){g.set(y,[])}x.forEach(function(z){g.get(y).push(z)})});w.forEach(function(x,y){if(!t.has(y)){t.set(y,x)}})},getComponentRestrictions:function(){return{restrictedUsage:g,requiredPermissions:t}},setGroupId:function(v){return s.setGroupId(v)},getGroupId:function(){return s.getGroupId()},setParameterContext:function(v){return s.setParameterContext(v)},getParameterContext:function(){return s.getParameterContext()},getGroupName:function(){return s.getGroupName()},getParentGroupId:function(){return s.getParentGroupId()},reload:function(v){return s.reload({transition:true},v)},canReadCurrentGroup:function(){return s.canRead()},canWriteCurrentGroup:function(){return s.canWrite()},getCanvasScale:function(){return s.View.getScale()},getCanvasTranslate:function(){return s.View.getTranslate()},translateCanvas:function(v){s.View.translate(v)},fitCanvas:function(){return s.View.fit()},zoomInCanvas:function(){return s.View.zoomIn()},zoomOutCanvas:function(){return s.View.zoomOut()},actualSizeCanvas:function(){return s.View.actualSize()},shouldRenderPerScale:function(){return s.View.shouldRenderPerScale()},getCanvasOffset:function(){return s.CANVAS_OFFSET},executeAction:function(w,v){p[w](v)}};return m}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.CanvasUtils"],function(d,e,c){return(nf.GoTo=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.GoTo=b(require("jquery"),require("nf.ErrorHandler"),require("nf.CanvasUtils")))}else{nf.GoTo=b(a.$,a.nf.ErrorHandler,a.nf.CanvasUtils)}}}(this,function(h,j,e){var b={urls:{api:"../nifi-api",processGroups:"../nifi-api/flow/process-groups/"}};var a;var f;var c=function(u,q,r,p){var o=h('<div class="source-destination-connection"></div>').appendTo("#connections-container");if(q.sourceType==="OUTPUT_PORT"){d(u,o,q,r)}else{if(q.sourceType==="REMOTE_OUTPUT_PORT"){i(u,o,q,p)}else{g(o,q)}}var t=h('<div class="connection-entry"></div>').appendTo(o);var w="unset";var s="Connection";if(q.permissions.canRead===true){var v=e.formatConnectionName(q.component);if(v!==""){w="";s=v}}h('<div class="search-result-icon icon-connect"></div>').appendTo(t);h('<div class="connection-entry-name go-to-link"></div>').attr("title",s).addClass(w).text(s).on("click",function(){e.showComponent(u,q.id);h("#connections-dialog").modal("hide")}).appendTo(t);h('<div class="clear"></div>').appendTo(t);if(q.destinationType==="INPUT_PORT"){l(u,o,q,r)}else{if(q.destinationType==="REMOTE_INPUT_PORT"){k(u,o,q,p)}else{m(o,q)}}h('<div class="clear"></div>').appendTo(o)};var m=function(o,p){var q="icon-funnel";if(p.destinationType==="PROCESSOR"){q="icon-processor"}else{if(p.destinationType==="OUTPUT_PORT"){q="icon-port-out"}}var r=p.destinationId;if(p.permissions.canRead===true){r=p.component.destination.name}else{if(a===p.destinationId){r=f}}var s=h('<div class="destination-component"></div>').appendTo(o);h('<div class="search-result-icon"></div>').addClass(q).appendTo(s);h('<div class="destination-component-name go-to-link"></div>').attr("title",r).text(r).on("click",function(){e.showComponent(p.destinationGroupId,p.destinationId);h("#connections-dialog").modal("hide")}).appendTo(s);h('<div class="clear"></div>').appendTo(s)};var l=function(w,p,s,t){var v;h.each(t,function(x,y){if(s.destinationGroupId===y.id){v=y;return false}});var o=n(v);var r=h('<div class="destination-component"></div>').appendTo(p);h('<div class="search-result-icon icon-group"></div>').appendTo(r);h('<div class="destination-component-name go-to-link"></div>').attr("title",o).text(o).on("click",function(){e.showComponent(w,v.id);h("#connections-dialog").modal("hide")}).appendTo(r);h('<div class="clear"></div>').appendTo(r);var u=s.destinationId;if(s.permissions.canRead===true){u=s.component.destination.name}else{if(a===s.destinationId){u=f}}var q=h('<div class="destination-input-port"></div>').appendTo(r);h('<div class="search-result-icon icon-port-in"></div>').appendTo(q);h('<div class="destination-input-port-name go-to-link"></div>').attr("title",u).text(u).on("click",function(){e.showComponent(s.destinationGroupId,s.destinationId);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(r)};var k=function(t,o,s,r){var v;h.each(r,function(x,y){if(s.destinationGroupId===y.id){v=y;return false}});var u=n(v);var q=h('<div class="destination-component"></div>').appendTo(o);h('<div class="search-result-icon icon-group-remote"></div>').appendTo(q);h('<div class="destination-component-name go-to-link"></div>').attr("title",u).text(u).on("click",function(){e.showComponent(t,v.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var w=s.destinationId;if(s.permissions.canRead===true){w=s.component.destination.name}else{if(a===s.destinationId){w=f}}var p=h('<div class="destination-input-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-in"></div>').appendTo(p);h('<div class="destination-input-port-name"></div>').attr("title",w).text(w).appendTo(p);h('<div class="clear"></div>').appendTo(q)};var g=function(o,q){var s="icon-funnel";if(q.sourceType==="PROCESSOR"){s="icon-processor"}else{if(q.sourceType==="INPUT_PORT"){s="icon-port-in"}}var p=q.sourceId;if(q.permissions.canRead===true){p=q.component.source.name}else{if(a===q.sourceId){p=f}}var r=h('<div class="source-component"></div>').appendTo(o);h('<div class="search-result-icon"></div>').addClass(s).appendTo(r);h('<div class="source-component-name go-to-link"></div>').attr("title",p).text(p).on("click",function(){e.showComponent(q.sourceGroupId,q.sourceId);h("#connections-dialog").modal("hide")}).appendTo(r);h('<div class="clear"></div>').appendTo(r)};var d=function(v,p,r,s){var u;h.each(s,function(x,y){if(r.sourceGroupId===y.id){u=y;return false}});var o=n(u);var q=h('<div class="source-component"></div>').appendTo(p);h('<div class="search-result-icon icon-group"></div>').appendTo(q);h('<div class="source-component-name go-to-link"></div>').attr("title",o).text(o).on("click",function(){e.showComponent(v,u.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var t=r.sourceId;if(r.permissions.canRead===true){t=r.component.source.name}else{if(a===r.sourceId){t=f}}var w=h('<div class="source-output-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-out"></div>').appendTo(w);h('<div class="source-output-port-name go-to-link"></div>').attr("title",t).text(t).on("click",function(){e.showComponent(r.sourceGroupId,r.sourceId);h("#connections-dialog").modal("hide")}).appendTo(w);h('<div class="clear"></div>').appendTo(q)};var i=function(s,o,r,p){var u;h.each(p,function(x,y){if(r.sourceGroupId===y.id){u=y;return false}});var t=n(u);var q=h('<div class="source-component"></div>').appendTo(o);h('<div class="search-result-icon icon-group-remote"></div>').appendTo(q);h('<div class="source-component-name go-to-link"></div>').attr("title",t).text(t).on("click",function(){e.showComponent(s,u.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var v=r.sourceId;if(r.permissions.canRead===true){v=r.component.source.name}else{if(r.sourceId===a){v=f}}var w=h('<div class="source-output-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-out"></div>').appendTo(w);h('<div class="source-output-port-name"></div>').attr("title",v).text(v).appendTo(w);h('<div class="clear"></div>').appendTo(q)};var n=function(o){if(o.permissions.canRead===true){return o.component.name}else{if(a===o.id){return f}else{return o.id}}};return{init:function(){h("#connections-dialog").modal({scrollableContentStyle:"scrollable",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){h("#connections-dialog").modal("hide")}}}],handler:{close:function(){h("#connections-context").empty();h("#connections-container").empty()}}})},showDownstreamFromProcessor:function(s){var t=s.datum();var q=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();var o=n(t);a=t.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-processor"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(q,function(u,v){if(v.sourceId===t.id){c(e.getGroupId(),v,p,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromProcessor:function(s){var t=s.datum();var q=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();var o=n(t);a=t.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-processor"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(q,function(u,v){if(v.destinationId===t.id){c(e.getGroupId(),v,p,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromGroup:function(r){var s=r.datum();var p=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var q=e.getComponentByType("RemoteProcessGroup").get();var u="icon-group";if(e.isRemoteProcessGroup(r)){u="icon-group-remote"}var t=n(s);a=s.id;f=t;h("#connections-context").append(h('<div class="search-result-icon"></div>').addClass(u)).append(h('<div class="connections-component-name"></div>').text(t)).append('<div class="clear"></div>');h.each(p,function(v,w){if(w.sourceGroupId===s.id){c(e.getGroupId(),w,o,q)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromGroup:function(r){var s=r.datum();var p=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var q=e.getComponentByType("RemoteProcessGroup").get();var u="icon-group";if(e.isRemoteProcessGroup(r)){u="icon-group-remote"}var t=n(s);a=s.id;f=t;h("#connections-context").append(h('<div class="search-result-icon"></div>').addClass(u)).append(h('<div class="connections-component-name"></div>').text(t)).append('<div class="clear"></div>');h.each(p,function(v,w){if(w.destinationGroupId===s.id){c(e.getGroupId(),w,o,q)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromInputPort:function(t){var q=t.datum();var r=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var s=e.getComponentByType("RemoteProcessGroup").get();var o=n(q);a=q.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-port-in"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(r,function(u,v){if(v.sourceId===q.id){c(e.getGroupId(),v,p,s)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromInputPort:function(p){var o=p.datum();h.ajax({type:"GET",url:b.urls.processGroups+encodeURIComponent(e.getParentGroupId()),dataType:"json"}).done(function(s){var r=s.processGroupFlow.flow;var u=r.connections;var t=r.processGroups;var v=r.remoteProcessGroups;var q=n(o);a=o.id;f=q;h("#connections-context").append('<div class="search-result-icon icon-group"></div>').append(h('<div class="connections-component-name"></div>').text(e.getGroupName())).append('<div class="clear"></div>').append('<div class="search-result-icon icon-port-in" style="margin-left: 20px;"></div>').append(h('<div class="connections-component-name"></div>').text(q)).append('<div class="clear"></div>');h.each(u,function(w,x){if(x.destinationId===o.id){c(e.getParentGroupId(),x,t,v)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")}).fail(j.handleAjaxError)},showDownstreamFromOutputPort:function(p){var o=p.datum();h.ajax({type:"GET",url:b.urls.processGroups+encodeURIComponent(e.getParentGroupId()),dataType:"json"}).done(function(s){var r=s.processGroupFlow.flow;var u=r.connections;var t=r.processGroups;var v=r.remoteProcessGroups;var q=n(o);a=o.id;f=q;h("#connections-context").append('<div class="search-result-icon icon-group"></div>').append(h('<div class="connections-component-name"></div>').text(e.getGroupName())).append('<div class="clear"></div>').append('<div class="search-result-icon icon-port-out" style="margin-left: 20px;"></div>').append(h('<div class="connections-component-name"></div>').text(q)).append('<div class="clear"></div>');h.each(u,function(w,x){if(x.sourceId===o.id){c(e.getParentGroupId(),x,t,v)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")}).fail(j.handleAjaxError)},showUpstreamFromOutputPort:function(t){var q=t.datum();var r=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var s=e.getComponentByType("RemoteProcessGroup").get();var o=n(q);a=q.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-port-out"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(r,function(u,v){if(v.destinationId===q.id){c(e.getGroupId(),v,p,s)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromFunnel:function(s){var p=s.datum();var q=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();a=p.id;f="Funnel";h("#connections-context").append('<div class="search-result-icon icon-funnel"></div>').append(h('<div class="connections-component-name"></div>').text("Funnel")).append('<div class="clear"></div>');h.each(q,function(t,u){if(u.sourceId===p.id){c(e.getGroupId(),u,o,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromFunnel:function(s){var p=s.datum();var q=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();a=p.id;f="Funnel";h("#connections-context").append('<div class="search-result-icon icon-funnel"></div>').append(h('<div class="upstream-destination-name"></div>').text("Funnel")).append('<div class="clear"></div>');h.each(q,function(t,u){if(u.destinationId===p.id){c(e.getGroupId(),u,o,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage","nf.CanvasUtils","nf.Client"],function(g,f,d,e,c){return(nf.Snippet=b(g,f,d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Snippet=b(require("jquery"),require("d3"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.Client")))}else{nf.Snippet=b(a.$,a.d3,a.nf.Storage,a.nf.CanvasUtils,a.nf.Client)}}}(this,function(f,e,c,d,b){var a={urls:{snippets:"../nifi-api/snippets",processGroups:"../nifi-api/process-groups"}};return{marshal:function(h,g){var i={parentGroupId:g,processors:{},funnels:{},inputPorts:{},outputPorts:{},remoteProcessGroups:{},processGroups:{},connections:{},labels:{}};h.each(function(k){var j=e.select(this);if(d.isProcessor(j)){i.processors[k.id]=b.getRevision(j.datum())}else{if(d.isFunnel(j)){i.funnels[k.id]=b.getRevision(j.datum())}else{if(d.isLabel(j)){i.labels[k.id]=b.getRevision(j.datum())}else{if(d.isInputPort(j)){i.inputPorts[k.id]=b.getRevision(j.datum())}else{if(d.isOutputPort(j)){i.outputPorts[k.id]=b.getRevision(j.datum())}else{if(d.isProcessGroup(j)){i.processGroups[k.id]=b.getRevision(j.datum())}else{if(d.isRemoteProcessGroup(j)){i.remoteProcessGroups[k.id]=b.getRevision(j.datum())}else{if(d.isConnection(j)){i.connections[k.id]=b.getRevision(j.datum())}}}}}}}}});return i},create:function(h){var g={disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged(),snippet:h};return f.ajax({type:"POST",url:a.urls.snippets,data:JSON.stringify(g),dataType:"json",contentType:"application/json"})},copy:function(i,g,j){var h={snippetId:i,originX:g.x,originY:g.y,disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged()};return f.ajax({type:"POST",url:a.urls.processGroups+"/"+encodeURIComponent(j)+"/snippet-instance",data:JSON.stringify(h),dataType:"json",contentType:"application/json"})},remove:function(g){return f.ajax({type:"DELETE",url:a.urls.snippets+"/"+encodeURIComponent(g)+"?"+f.param({disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged()})})},move:function(h,i){var g={disconnectedNodeAcknowledged:c.isDisconnectionAcknowledged(),snippet:{id:h,parentGroupId:i}};return f.ajax({type:"PUT",url:a.urls.snippets+"/"+encodeURIComponent(h),data:JSON.stringify(g),dataType:"json",contentType:"application/json"})}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Dialog","nf.ng.Bridge","nf.ErrorHandler"],function(e,f,d,c,g){return(nf.Verify=b(e,f,d,c,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Verify=b(require("jquery"),require("nf.Common"),require("nf.Dialog"),require("nf.ng.Bridge"),require("nf.ErrorHandler")))}else{nf.Verify=b(a.$,a.nf.Common,a.nf.Dialog,a.nf.ng.Bridge,a.nf.ErrorHandler)}}}(this,function(g,d,e,h,i){var p={autosizeColsMode:Slick.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,editable:true,enableAddRow:false,autoEdit:false,multiSelect:false,rowHeight:24};var f=function(u){var v=this;var r="";var s;var x;var w;var t;this.init=function(){var z=g("body");s=u.item[u.column.field];x=g("<div></div>").addClass("slickgrid-editor").css({"z-index":100000,position:"absolute","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",overflow:"hidden",padding:"10px 20px",cursor:"move",transform:"translate3d(0px, 0px, 0px)"}).appendTo(z);t=g('<textarea hidefocus rows="5"/>').css({height:"80px",width:u.position.width+"px","min-width":"212px","margin-bottom":"5px","margin-top":"10px","white-space":"pre"}).tab().on("keydown",v.handleKeyDown).appendTo(x);x.draggable({cancel:".button, textarea, .nf-checkbox",containment:"parent"});var y=g('<div class="string-check-container" />');y.appendTo(x);w=g('<div class="nf-checkbox string-check" />').on("change",function(D,C){if(C.isChecked){t.prop("disabled",true).val("")}else{t.prop("disabled",false).val(s)}}).appendTo(y);g('<span class="string-check-label nf-checkbox-label">&nbsp;Set empty string</span>').appendTo(y);var A=g('<div class="button">Ok</div>').css({color:"#fff",background:"#728E9B"}).hover(function(){g(this).css("background","#004849")},function(){g(this).css("background","#728E9B")}).on("click",v.save);var B=g('<div class="secondary-button">Cancel</div>').css({color:"#004849",background:"#E3E8EB"}).hover(function(){g(this).css("background","#C7D2D7")},function(){g(this).css("background","#E3E8EB")}).on("click",v.cancel);g("<div></div>").css({position:"relative",top:"10px",left:"20px",width:"212px",clear:"both","float":"right"}).append(A).append(B).append('<div class="clear"></div>').appendTo(x);v.position(u.position);t.focus().select()};this.handleKeyDown=function(y){if(y.which===g.ui.keyCode.ENTER&&!y.shiftKey){v.save()}else{if(y.which===g.ui.keyCode.ESCAPE){v.cancel();y.stopImmediatePropagation();y.preventDefault()}}};this.save=function(){u.commitChanges()};this.cancel=function(){t.val(r);u.cancelChanges()};this.hide=function(){x.hide()};this.show=function(){x.show()};this.position=function(y){x.css({top:y.top-27,left:y.left-20})};this.destroy=function(){x.remove()};this.focus=function(){t.focus()};this.loadValue=function(z){var A=false;if(d.isDefinedAndNotNull(z[u.column.field])){r=z[u.column.field];A=r===""}var y=A?"checkbox-checked":"checkbox-unchecked";w.addClass(y);t.val(r);t.select()};this.serializeValue=function(){if(t.val()===""){if(w.hasClass("checkbox-checked")){return""}else{return null}}else{return t.val()}};this.applyValue=function(y,z){y[u.column.field]=z};this.isValueChanged=function(){return v.serializeValue()!==s};this.validate=function(){return{valid:true,msg:null}};this.init()};var q=function(){var s=g("#referenced-attributes-table").data("gridInstance");var r=s.getData();s.setSelectedRows([]);r.setItems([])};var k=function(){g("#referenced-attributes-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Referenced Attributes",handler:{close:function(){q()},open:function(){var r=g("#referenced-attributes-table").data("gridInstance");if(d.isDefinedAndNotNull(r)){r.resizeCanvas()}}}})};var j=function(u,w,s,v,t,r){l(u,w,s,v).done(function(x){r.empty();g.each(x,function(z,y){var B=g('<div class="verification-result"></div>').appendTo(r);var C;switch(y.outcome){case"SUCCESSFUL":C="fa-check";break;case"FAILED":C="fa-times";break;case"SKIPPED":C="fa-exclamation";break}var A=g('<div class="verification-result-header"></div>').appendTo(B);g('<div class="verification-result-outcome fa '+C+'"></div>').appendTo(A);g('<div class="verification-result-step-name"></div>').text(y.verificationStepName).appendTo(A);g('<div class="clear"></div>').appendTo(A);g('<div class="verification-result-explanation"></div>').text(y.explanation).appendTo(B)});if(typeof t==="function"){t(x,v)}})};var o=function(u,v,s,t,r){g("#referenced-attributes-dialog").modal("setButtonModel",[{buttonText:"Verify",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var z=g("#referenced-attributes-table").data("gridInstance");var w=z.getData();var y=w.getItems();var x=y.reduce(function(B,A){B[A.name]=A.value;return B},{});g("#referenced-attributes-dialog").modal("hide");j(u,v,s,x,t,r)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#referenced-attributes-dialog").modal("hide")}}}])};var c=function(){g("#verification-request-status-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Verifying Properties",handler:{close:function(){g("#verification-request-status-dialog").modal("setButtonModel",[])}}})};var b=function(){g("#new-referenced-attribute-dialog").modal({headerText:"New Attribute",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){m()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#new-referenced-attribute-dialog").modal("hide")}}}],handler:{close:function(){g("#new-referenced-attribute-name").val("")},open:function(){g("#new-referenced-attribute-name").focus()}}});g("#new-referenced-attribute-name").on("keydown",function(s){var r=s.keyCode?s.keyCode:s.which;if(r===g.ui.keyCode.ENTER){m();s.stopImmediatePropagation();s.preventDefault()}});g("#add-referenced-attribute").on("click",function(){g("#new-referenced-attribute-dialog").modal("show")})};var m=function(){var r=g.trim(g("#new-referenced-attribute-name").val());if(r!==""){var t=g("#referenced-attributes-table").data("gridInstance");var u=t.getData();var w=null;g.each(u.getItems(),function(x,y){if(r===y.name){w=y}});if(w===null){u.beginUpdate();u.addItem({id:r,name:r,value:null,});u.endUpdate();u.reSort();var v=u.getRowById(r);t.setActiveCell(v,t.getColumnIndex("value"));t.editActiveCell()}else{e.showOkDialog({headerText:"Attribute Exists",dialogContent:"An attribute with this name already exists."});var s=u.getRowById(w.id);t.setSelectedRows([s]);t.scrollRowIntoView(s)}g("#new-referenced-attribute-dialog").modal("hide")}else{e.showOkDialog({headerText:"Attribute Error",dialogContent:"The name of the attribute must be specified."})}};var n=function(r,t){var s=function(w,u){var v=d.isDefinedAndNotNull(w[r.columnId])?w[r.columnId]:"";var x=d.isDefinedAndNotNull(u[r.columnId])?u[r.columnId]:"";return v===x?0:v>x?1:-1};t.sort(s,r.sortAsc)};var a=function(){var u=g("#referenced-attributes-table");var w=function(C,z,B,A,y){return d.escapeHtml(B)};var s=function(C,z,B,A,y){if(B===""){return'<span class="table-cell blank">Empty string set</span>'}else{if(B===null){return'<span class="unset">No value set</span>'}else{return d.escapeHtml(B)}}};var v=function(C,z,B,A,y){return'<div title="Delete" class="delete-attribute pointer fa fa-trash"></div>'};var t=[{id:"name",name:"Name",field:"name",formatter:w,sortable:true,resizable:true},{id:"value",name:"Value",field:"value",formatter:s,sortable:true,resizable:true,cssClass:"pointer"},{id:"actions",name:"&nbsp;",minWidth:10,width:10,formatter:v}];var r=new Slick.Data.DataView({inlineFilters:false});r.getItemMetadata=function(y){return{columns:{value:{editor:f}}}};n({columnId:"name",sortAsc:true},r);var x=new Slick.Grid(u,r,t,p);x.setSelectionModel(new Slick.RowSelectionModel());x.registerPlugin(new Slick.AutoTooltips());x.setSortColumn("name",true);x.onSort.subscribe(function(z,y){n({columnId:y.sortCol.id,sortAsc:y.sortAsc},r)});x.onClick.subscribe(function(B,y){if(x.getColumns()[y.cell].id==="value"){x.gotoCell(y.row,y.cell,true);B.stopImmediatePropagation()}else{if(x.getColumns()[y.cell].id==="actions"){var z=r.getItem(y.row);var A=g(B.target);if(A.hasClass("delete-attribute")){r.deleteItem(z.id)}}}});x.onBeforeCellEditorDestroy.subscribe(function(z,y){setTimeout(function(){x.resizeCanvas()},50)});r.onRowCountChanged.subscribe(function(z,y){x.updateRowCount();x.render()});r.onRowsChanged.subscribe(function(z,y){x.invalidateRows(y.rows);x.render()});r.syncGridSelection(x,true);u.data("gridInstance",x)};var l=function(y,v,s,t){var u=4;var w=false;var x=null;var r=null;return g.Deferred(function(B){var D=function(F){var G=g("#verification-request-percent-complete");G.find("div.progress-label").remove();G.find("md-progress-linear").remove();var E=g('<div class="progress-label"></div>').text(F+"%");(h.injector.get("$compile")(g('<md-progress-linear ng-cloak ng-value="'+F+'" class="md-hue-2" md-mode="determinate" aria-label="Searching Queue"></md-progress-linear>'))(h.rootScope)).appendTo(G);G.append(E)};g("#verification-request-status-dialog").modal("setButtonModel",[{headerText:"Verifying Properties",buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){w=true;if(r!==null){clearTimeout(r);C()}}}}]);var C=function(){g("#verification-request-status-dialog").modal("hide");var E=w;if(d.isDefinedAndNotNull(x)){g.ajax({type:"DELETE",url:x.uri,dataType:"json"});if(d.isEmpty(x.results)){if(w===false){E=true;e.showOkDialog({headerText:"Verifying Properties",dialogContent:"There are no results."})}}}else{E=true}if(E){B.reject()}else{B.resolve(x.results)}};var A=function(E){D(x.percentCompleted);g("#verification-request-status-message").text(x.state);if(x.complete===true||w===true){C()}else{r=setTimeout(function(){r=null;z(Math.min(u,E*2))},E*1000)}};var z=function(E){g.ajax({type:"GET",url:x.uri,dataType:"json"}).done(function(F){x=F.request;A(E)}).fail(C).fail(i.handleAjaxError)};D(0);g("#verification-request-status-dialog").modal("show");g.ajax({type:"POST",url:v+"/config/verification-requests",data:JSON.stringify({request:{componentId:y,properties:s,attributes:t}}),dataType:"json",contentType:"application/json"}).done(function(E){x=E.request;A(1)}).fail(C).fail(i.handleAjaxError)}).promise()};return{init:function(){c();k();a();b()},verify:function(w,u,s,v,t,r){g.ajax({type:"POST",url:u+"/config/analysis",data:JSON.stringify({configurationAnalysis:{componentId:w,properties:s}}),dataType:"json",contentType:"application/json"}).done(function(z){var x=z.configurationAnalysis;if(x.supportsVerification===false){j(w,u,s,{},t,r)}else{var B=g.extend({},x.referencedAttributes,v);var A=g("#referenced-attributes-table").data("gridInstance");var y=A.getData();y.beginUpdate();g.each(B,function(C,D){y.addItem({id:C,name:C,value:D})});y.endUpdate();y.reSort();o(w,u,s,t,r);g("#referenced-attributes-dialog").modal("show")}}).fail(i.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.Storage","nf.ErrorHandler","nf.Client","nf.CanvasUtils","lodash","nf.ng.D3Helpers"],function(f,k,c,e,g,h,l,d,j,i){return(nf.Connection=b(f,k,c,e,g,h,l,d,j,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Connection=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.ErrorHandler"),require("nf.Client"),require("nf.CanvasUtils"),require("lodash-code"),require("nf.ng.D3Helpers")))}else{nf.Connection=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.ErrorHandler,a.nf.Client,a.nf.CanvasUtils,a._,a.nf.ng.D3Helpers)}}}(this,function(K,V,T,j,A,d,f,Z,ag,i){var o;var t;var S;var E;var Q={width:224};var g=(Q.width/2)-15-2;var G=6;var z=(Q.width/2)+10+1;var D=8;var k=true;var Y=function(ai){var ak=ai.datum();var ah,al;if(ak.bends.length>0){var aj=Math.min(Math.max(0,ak.labelIndex),ak.bends.length-1);ah=ak.bends[aj].x;al=ak.bends[aj].y}else{ah=(ak.start.x+ak.end.x)/2;al=(ak.start.y+ak.end.y)/2}ah-=(Q.width/2);al-=(ai.attr("height")/2);return{x:ah,y:al}};var q;var F;var B;var s;var ad;var W;var u;var I;var l=function(ai,ah){return Math.pow(ai.x-ah.x,2)+Math.pow(ai.y-ah.y,2)};var v=function(ai,ah){return Math.sqrt(l(ai,ah))};var N=function(al,ak,ai){var ah=l(ak,ai);if(ah===0){return Math.sqrt(l(al,ak))}var aj=((al.x-ak.x)*(ai.x-ak.x)+(al.y-ak.y)*(ai.y-ak.y))/ah;if(aj<0){return Math.sqrt(l(al,ak))}if(aj>1){return Math.sqrt(l(al,ai))}return Math.sqrt(l(al,{x:ak.x+aj*(ai.x-ak.x),y:ak.y+aj*(ai.y-ak.y)}))};var b=function(al,an){if(an.bends.length===0){return 0}var aj;var ai;var ah=[an.start].concat(an.bends,[an.end]);for(var ak=0;ak<ah.length;ak++){if(ak+1<ah.length){var am=N(al,ah[ak],ah[ak+1]);if(T.isUndefined(aj)||am<aj){aj=am;ai=ak}}}return ai};var M=function(ah){return ah.indexOf("INPUT_PORT")>=0};var C=function(ah){return ah.indexOf("OUTPUT_PORT")>=0};var R=function(ah){return ah.groupId!==Z.getGroupId()&&(M(ah.type)||C(ah.type))};var p=function(ah){if(T.isDefinedAndNotNull(ah.flowFileExpiration)){var ai=ah.flowFileExpiration.match(/^(\d+).*/);if(ai!==null&&ai.length>0){if(parseInt(ai[0],10)>0){return true}}}return false};var af=function(ah){return T.isDefinedAndNotNull(ah.loadBalanceStrategy)&&"DO_NOT_LOAD_BALANCE"!==ah.loadBalanceStrategy};var ab=function(ah){ah.sort(function(aj,ai){return aj.zIndex===ai.zIndex?0:aj.zIndex>ai.zIndex?1:-1})};var U=function(){return s.selectAll("g.connection").data(Array.from(q.values()),function(ah){return ah.id})};var X=function(aj,ai){if(aj.empty()){return aj}var ah=i.multiAttr(aj.append("g"),{id:function(ak){return"id-"+ak.id},"class":"connection"}).classed("selected",ai);i.multiAttr(ah.append("path"),{"class":"connection-path","pointer-events":"none"});i.multiAttr(ah.append("path"),{"class":"connection-selection-path","pointer-events":"none"});i.multiAttr(ah.append("path"),{"class":"connection-path-selectable","pointer-events":"stroke"}).on("mousedown.selection",function(ak){o.select(ak,V.select(this.parentNode));Z.setURLParameters()}).call(E.activate);return ah};var y=function(ai){var ah=false;if(T.isDefinedAndNotNull(ai.component.selectedRelationships)&&T.isDefinedAndNotNull(ai.component.availableRelationships)){K.each(ai.component.selectedRelationships,function(aj,ak){if(K.inArray(ak,ai.component.availableRelationships)===-1){ah=true;return false}})}return ah};var r=function(ai){var ah="normal";if(ai.permissions.canRead){if(P(ai)||n(ai)){ah="full"}else{if(y(ai)){ah="ghost"}}}else{ah="unauthorized"}return"url(#"+ah+")"};var c=function(ah){if(n(ah)||P(ah)){return"url(#connection-full-drop-shadow)"}else{return"url(#component-drop-shadow)"}};var n=function(ah){return ah.status.aggregateSnapshot.percentUseCount===100};var e=function(ai){var ah=ai.status.aggregateSnapshot.percentUseCount;if(T.isDefinedAndNotNull(ah)){return ah>=61&&ah<=85}return false};var m=function(ai){var ah=ai.status.aggregateSnapshot.percentUseCount;if(T.isDefinedAndNotNull(ah)){return ah>85}return false};var P=function(ah){return ah.status.aggregateSnapshot.percentUseBytes===100};var J=function(ai){var ah=ai.status.aggregateSnapshot.percentUseBytes;if(T.isDefinedAndNotNull(ah)){return ah>=61&&ah<=85}return false};var O=function(ai){var ah=ai.status.aggregateSnapshot.percentUseBytes;if(T.isDefinedAndNotNull(ah)){return ah>85}return false};var a=function(ah,ai){if(ah.empty()){return}var aj=true;var ak=true;var al=false;if(T.isDefinedAndNotNull(ai)){aj=T.isDefinedAndNotNull(ai.updatePath)?ai.updatePath:aj;ak=T.isDefinedAndNotNull(ai.updateLabel)?ai.updateLabel:ak;al=T.isDefinedAndNotNull(ai.transition)?ai.transition:al}if(aj===true){ah.classed("grouped",function(an){var am=false;if(an.permissions.canRead){if(T.isDefinedAndNotNull(an.component.selectedRelationships)&&an.component.selectedRelationships.length>1){am=true}}return am}).classed("ghost",function(an){var am=false;if(an.permissions.canRead){if(y(an)){am=true}}return am});ah.select("path.connection-path").classed("unauthorized",function(am){return am.permissions.canRead===false});ah.select("path.connection-path-selectable").on("dblclick",function(ap,at){if(at.permissions.canWrite&&at.permissions.canRead){var am=V.pointer(ap,this.parentNode);var aq=b({x:am[0],y:am[1]},at);var ao=at.component.bends.slice();ao.splice(aq,0,{x:am[0],y:am[1]});var an={id:at.id,bends:ao};var ar=at.component.labelIndex;if(ao.length===1){an.labelIndex=0}else{if(aq<=ar){an.labelIndex=ar+1}}w(at,an);ap.stopPropagation()}else{return null}})}ah.each(function(aR){var aG=V.select(this);if(aj===true){var aQ=Z.getConnectionSourceComponentId(aR);var at=V.select("#id-"+aQ).datum();var au;var aB;if(aR.bends.length>0){aB=aR.bends[aR.bends.length-1]}else{aB={x:at.position.x+(at.dimensions.width/2),y:at.position.y+(at.dimensions.height/2)}}if(T.isDefinedAndNotNull(aR.end)&&aR.end.dragging===true){au=aR.end;var aS=V.select("g.hover.connectable-destination");if(!aS.empty()){var aK=aS.datum();var am=Z.getPerimeterPoint(aB,{x:aK.position.x,y:aK.position.y,width:aK.dimensions.width,height:aK.dimensions.height});au.x=am.x;au.y=am.y}}else{var ao=Z.getConnectionDestinationComponentId(aR);var aU=V.select("#id-"+ao).datum();au=Z.getPerimeterPoint(aB,{x:aU.position.x,y:aU.position.y,width:aU.dimensions.width,height:aU.dimensions.height})}var aC;if(aR.bends.length>0){aC=aR.bends[0]}else{aC=au}var ax=Z.getPerimeterPoint(aC,{x:at.position.x,y:at.position.y,width:at.dimensions.width,height:at.dimensions.height});aR.start=ax;aR.end=au;i.multiAttr(Z.transition(aG.select("path.connection-path"),al),{d:function(){var aV=[aR.start].concat(aR.bends,[aR.end]);return I(aV)}});i.multiAttr(Z.transition(aG.select("path.connection-selection-path"),al),{d:function(){var aV=[aR.start].concat(aR.bends,[aR.end]);return I(aV)}});i.multiAttr(Z.transition(aG.select("path.connection-path-selectable"),al),{d:function(){var aV=[aR.start].concat(aR.bends,[aR.end]);return I(aV)}});var aA=aG.selectAll("rect.startpoint");var az=aG.selectAll("rect.endpoint");var aI=aG.selectAll("rect.midpoint");if(aR.permissions.canWrite&&aR.permissions.canRead){aA=aA.data([aR.start]);var aN=i.multiAttr(aA.enter().append("rect"),{"class":"startpoint linepoint","pointer-events":"all",width:8,height:8}).on("mousedown.selection",function(aV){o.select(aV,V.select(this.parentNode));Z.setURLParameters()}).call(E.activate);Z.transition(aA.merge(aN),al).attr("transform",function(aV){return"translate("+(aV.x-4)+", "+(aV.y-4)+")"});aA.exit().remove();var az=az.data([aR.end]);var ay=i.multiAttr(az.enter().append("rect"),{"class":"endpoint linepoint","pointer-events":"all",width:8,height:8}).on("mousedown.selection",function(aV){o.select(aV,V.select(this.parentNode));Z.setURLParameters()}).call(W).call(E.activate);Z.transition(az.merge(ay),al).attr("transform",function(aV){return"translate("+(aV.x-4)+", "+(aV.y-4)+")"});az.exit().remove();var aI=aI.data(aR.bends);var aF=i.multiAttr(aI.enter().append("rect"),{"class":"midpoint linepoint","pointer-events":"all",width:8,height:8}).on("dblclick",function(aW,aX){aW.stopPropagation();var aY=V.select(this.parentNode);var a1=aY.datum();var a2=Z.getConnectionSourceComponentId(a1);var a0=Z.getConnectionDestinationComponentId(a1);if(a2===a0&&aR.component.bends.length<=2){j.showOkDialog({headerText:"Connection",dialogContent:"Looping connections must have at least two bend points."});return}var aZ=[];var a3=-1;K.each(a1.component.bends,function(a5,a4){if(aX.x!==a4.x&&aX.y!==a4.y){aZ.push(a4)}else{a3=a5}});if(a3<0){return}var aY={id:a1.id,bends:aZ};var aV=a1.component.labelIndex;if(aZ.length<=1){aY.labelIndex=0}else{if(a3<=aV){aY.labelIndex=Math.max(0,aV-1)}}w(a1,aY)}).on("mousedown.selection",function(aV){o.select(aV,V.select(this.parentNode));Z.setURLParameters()}).call(ad).call(E.activate);Z.transition(aI.merge(aF),al).attr("transform",function(aV){return"translate("+(aV.x-4)+", "+(aV.y-4)+")"});aI.exit().remove()}else{aA.remove();az.remove();aI.remove()}}if(ak===true){var av=aG.select("g.connection-label-container");if(aG.classed("visible")){if(av.empty()){av=i.multiAttr(aG.insert("g","rect.startpoint"),{"class":"connection-label-container","pointer-events":"all"}).on("mousedown.selection",function(aV){o.select(aV,V.select(this.parentNode));Z.setURLParameters()}).call(E.activate).call(S.activate);i.multiAttr(av.append("rect"),{"class":"body",width:Q.width,x:0,y:0});i.multiAttr(av.append("rect"),{"class":"border",width:Q.width,fill:"transparent",stroke:"transparent"})}var aH=0;var aq=19;var aP=[];var aw=[];var aE=av.select("g.connection-from-container");var aT=av.select("g.connection-to-container");var aJ=av.select("g.connection-name-container");if(aR.permissions.canRead){if(R(aR.component.source)){if(aE.empty()){aE=i.multiAttr(av.append("g"),{"class":"connection-from-container"});aP.push(i.multiAttr(aE.append("rect"),{"class":"connection-label-background",width:Q.width,height:aq}));aw.push(i.multiAttr(aE.append("rect"),{"class":"connection-label-border",width:Q.width,height:1}));i.multiAttr(aE.append("text"),{"class":"stats-label",x:5,y:14}).text("From");i.multiAttr(aE.append("text"),{"class":"stats-value connection-from",x:43,y:14,width:130});i.multiAttr(aE.append("text"),{"class":"connection-from-run-status",x:208,y:14})}else{aP.push(aE.select("rect.connection-label-background"));aw.push(aE.select("rect.connection-label-border"))}aE.attr("transform",function(){var aV=(aq*aH++);return"translate(0, "+aV+")"});aE.select("text.connection-from").each(function(){var aV=V.select(this);aV.text(null).selectAll("title").remove();Z.ellipsis(aV,aR.component.source.name,"connection-from")}).append("title").text(function(){return aR.component.source.name});aE.select("text.connection-from-run-status").text(function(){if(aR.component.source.exists===false){return"\uf071"}else{if(aR.component.source.running===true){return"\uf04b"}else{return"\uf04d"}}}).classed("running",function(){if(aR.component.source.exists===false){return false}else{return aR.component.source.running}}).classed("stopped",function(){if(aR.component.source.exists===false){return false}else{return !aR.component.source.running}}).classed("is-missing-port",function(){return aR.component.source.exists===false})}else{aE.remove()}if(R(aR.component.destination)){if(aT.empty()){aT=i.multiAttr(av.append("g"),{"class":"connection-to-container"});aP.push(i.multiAttr(aT.append("rect"),{"class":"connection-label-background",width:Q.width,height:aq}));aw.push(i.multiAttr(aT.append("rect"),{"class":"connection-label-border",width:Q.width,height:1}));i.multiAttr(aT.append("text"),{"class":"stats-label",x:5,y:14}).text("To");i.multiAttr(aT.append("text"),{"class":"stats-value connection-to",x:25,y:14,width:145});i.multiAttr(aT.append("text"),{"class":"connection-to-run-status",x:208,y:14})}else{aP.push(aT.select("rect.connection-label-background"));aw.push(aT.select("rect.connection-label-border"))}aT.attr("transform",function(){var aV=(aq*aH++);return"translate(0, "+aV+")"});aT.select("text.connection-to").each(function(aW){var aV=V.select(this);aV.text(null).selectAll("title").remove();Z.ellipsis(aV,aW.component.destination.name,"connection-to")}).append("title").text(function(aV){return aV.component.destination.name});aT.select("text.connection-to-run-status").text(function(){if(aR.component.destination.exists===false){return"\uf071"}else{if(aR.component.destination.running===true){return"\uf04b"}else{return"\uf04d"}}}).classed("running",function(){if(aR.component.destination.exists===false){return false}else{return aR.component.destination.running}}).classed("stopped",function(){if(aR.component.destination.exists===false){return false}else{return !aR.component.destination.running}}).classed("is-missing-port",function(){return aR.component.destination.exists===false})}else{aT.remove()}var ar=Z.formatConnectionName(aR.component);if(!T.isBlank(ar)){if(aJ.empty()){aJ=i.multiAttr(av.append("g"),{"class":"connection-name-container"});aP.push(i.multiAttr(aJ.append("rect"),{"class":"connection-label-background",width:Q.width,height:aq}));aw.push(i.multiAttr(aJ.append("rect"),{"class":"connection-label-border",width:Q.width,height:1}));i.multiAttr(aJ.append("text"),{"class":"stats-label",x:5,y:14}).text("Name");i.multiAttr(aJ.append("text"),{"class":"stats-value connection-name",x:45,y:14,width:142})}else{aP.push(aJ.select("rect.connection-label-background"));aw.push(aJ.select("rect.connection-label-border"))}aJ.attr("transform",function(){var aV=(aq*aH++);return"translate(0, "+aV+")"});aJ.select("text.connection-name").each(function(){var aV=V.select(this);aV.text(null).selectAll("title").remove();Z.ellipsis(aV,ar,"connection-name")}).append("title").text(function(){return ar})}else{aJ.remove()}}else{aE.remove();aT.remove();aJ.remove()}var aO=3;var an=av.select("g.queued-container");if(an.empty()){an=i.multiAttr(av.append("g"),{"class":"queued-container"});aP.push(i.multiAttr(an.append("rect"),{"class":"connection-label-background",width:Q.width,height:aq+aO}));aw.push(i.multiAttr(an.append("rect"),{"class":"connection-label-border",width:Q.width,height:1}));i.multiAttr(an.append("text"),{"class":"stats-label",x:5,y:14}).text("Queued");var aL=i.multiAttr(an.append("text"),{"class":"stats-value queued",x:55,y:14});i.multiAttr(aL.append("tspan"),{"class":"count"});i.multiAttr(aL.append("tspan"),{"class":"size"});i.multiAttr(an.append("text"),{"class":"load-balance-icon",y:14}).text(function(){return"\uf042"}).append("title");i.multiAttr(an.append("text"),{"class":"expiration-icon",x:208,y:14}).text(function(){return"\uf017"}).append("title");var ap=aq+aO-4;var aM=i.multiAttr(an.append("g"),{transform:"translate("+G+", "+ap+")","class":"backpressure-object-container"});i.multiAttr(aM.append("rect"),{"class":"backpressure-tick object",width:1,height:3,x:0,y:0});i.multiAttr(aM.append("rect"),{"class":"backpressure-object",width:g,height:3,x:0,y:0});i.multiAttr(aM.append("rect"),{"class":"backpressure-tick object",width:1,height:3,x:g,y:0});i.multiAttr(aM.append("rect"),{"class":"backpressure-percent object",width:0,height:3,x:0,y:0});i.multiAttr(aM.append("rect"),{"class":"backpressure-tick object-prediction",width:1,height:3,x:g,y:0});var aD=i.multiAttr(an.append("g"),{transform:"translate("+z+", "+ap+")","class":"backpressure-data-size-container"});i.multiAttr(aD.append("rect"),{"class":"backpressure-tick data-size",width:1,height:3,x:0,y:0});i.multiAttr(aD.append("rect"),{"class":"backpressure-data-size",width:g,height:3,x:0,y:0}).append("title");i.multiAttr(aD.append("rect"),{"class":"backpressure-tick data-size",width:1,height:3,x:g,y:0});i.multiAttr(aD.append("rect"),{"class":"backpressure-percent data-size",width:0,height:3,x:0,y:0});i.multiAttr(aD.append("rect"),{"class":"backpressure-tick data-size-prediction",width:1,height:3,x:g,y:0})}else{aP.push(an.select("rect.connection-label-background"));aw.push(an.select("rect.connection-label-border"))}an.attr("transform",function(){var aV=(aq*aH++);return"translate(0, "+aV+")"});av.select("rect.body").attr("height",function(){return(aq*aH)+aO}).classed("unauthorized",function(){return aR.permissions.canRead===false});av.select("rect.border").attr("height",function(){return(aq*aH)+aO}).classed("unauthorized",function(){return aR.permissions.canRead===false});K.each(aP,function(aW,aV){if(aW%2===0){aV.attr("fill","#f4f6f7")}else{aV.attr("fill","#ffffff")}});K.each(aw,function(aW,aV){if(aW>0){aV.attr("fill","#c7d2d7")}else{aV.attr("fill","transparent")}});av.select("text.load-balance-icon").classed("hidden",function(){if(aR.permissions.canRead){return !af(aR.component)}else{return true}}).classed("load-balance-icon-active fa-rotate-90",function(aV){return aV.permissions.canRead&&aV.component.loadBalanceStatus==="LOAD_BALANCE_ACTIVE"}).classed("load-balance-icon-184",function(){return aR.permissions.canRead&&p(aR.component)}).classed("load-balance-icon-200",function(){return aR.permissions.canRead&&!p(aR.component)}).attr("x",function(){return aR.permissions.canRead&&p(aR.component)?192:208}).select("title").text(function(){if(aR.permissions.canRead){var aV=T.getComboOptionText(T.loadBalanceStrategyOptions,aR.component.loadBalanceStrategy);if("PARTITION_BY_ATTRIBUTE"===aR.component.loadBalanceStrategy){aV+=" ("+aR.component.loadBalancePartitionAttribute+")"}var aX="no compression";switch(aR.component.loadBalanceCompression){case"COMPRESS_ATTRIBUTES_ONLY":aX="'Attribute' compression";break;case"COMPRESS_ATTRIBUTES_AND_CONTENT":aX="'Attribute and content' compression";break}var aW="LOAD_BALANCE_ACTIVE"===aR.component.loadBalanceStatus?" Actively balancing...":"";return"Load Balance is configured with '"+aV+"' strategy and "+aX+"."+aW}else{return""}});av.select("text.expiration-icon").classed("hidden",function(){if(aR.permissions.canRead){return !p(aR.component)}else{return true}}).select("title").text(function(){if(aR.permissions.canRead){return"Expires FlowFiles older than "+aR.component.flowFileExpiration}else{return""}});av.select("rect.backpressure-object").classed("not-configured",function(){return T.isUndefinedOrNull(aR.status.aggregateSnapshot.percentUseCount)});av.selectAll("rect.backpressure-tick.object").classed("not-configured",function(){return T.isUndefinedOrNull(aR.status.aggregateSnapshot.percentUseCount)});av.selectAll("rect.backpressure-tick.object-prediction").classed("not-configured",function(){return T.isUndefinedOrNull(aR.status.aggregateSnapshot.percentUseCount)});av.select("rect.backpressure-data-size").classed("not-configured",function(){return T.isUndefinedOrNull(aR.status.aggregateSnapshot.percentUseBytes)});av.selectAll("rect.backpressure-tick.data-size").classed("not-configured",function(){return T.isUndefinedOrNull(aR.status.aggregateSnapshot.percentUseBytes)});av.selectAll("rect.backpressure-tick.data-size-prediction").classed("not-configured",function(){return T.isUndefinedOrNull(aR.status.aggregateSnapshot.percentUseBytes)});if(aR.permissions.canWrite){av.call(u)}aG.call(L)}else{if(!av.empty()){av.remove()}}}Z.transition(aG.select("g.connection-label-container"),al).attr("transform",function(){var aW=V.select(this).select("rect.body");var aV=Y(aW);return"translate("+aV.x+", "+aV.y+")"})})};var H=function(aj){var ah=ag.get(aj,"status.aggregateSnapshot.percentUseCount",0);var ai=ag.get(aj,"status.aggregateSnapshot.percentUseBytes",0);return Math.max(ah,ai)>=100};var x=function(an){var ap;var aj=ag.get(an,"status.aggregateSnapshot.percentUseCount");if(ag.isNumber(aj)){var ah=ag.get(an,"component.backPressureObjectThreshold");var aq=ag.get(an,"status.aggregateSnapshot.predictions");var al=["Queue: "+ag.clamp(aj,0,100)+"% full (based on "+ah+" object threshold)"];if(!ag.isNil(aq)){var ai=ag.get(aq,"predictedPercentCount",-1);var am=ag.get(aq,"predictedMillisUntilCountBackpressure",-1);var ao=ag.get(aq,"predictionIntervalSeconds",60*5);if(ag.isNumber(ai)&&ai>-1){al.push("Predicted queue (next "+(ao/60)+" mins): "+ag.clamp(ai,0,100)+"%")}else{al.push("Predicted queue (next "+(ao/60)+" mins): NA")}if(ag.isNumber(am)&&ag.inRange(am,0,Number.MAX_SAFE_INTEGER)&&!H(an)){var ak=T.formatPredictedDuration(am);al.push("Estimated time to back pressure: "+ak)}else{al.push("Estimated time to back pressure: "+(H(an)?"now":"NA"))}}else{al.push("Queue Prediction is not configured")}if(ag.isEmpty(al)){return""}else{if(ag.size(al)===1){return al[0]}else{ap=T.formatUnorderedList(al)}}}else{ap="Back Pressure Object Threshold is not configured"}return ap};var aa=function(al){var ao;var am=ag.get(al,"status.aggregateSnapshot.percentUseBytes");if(ag.isNumber(am)){var aq=ag.get(al,"component.backPressureDataSizeThreshold");var ap=ag.get(al,"status.aggregateSnapshot.predictions");var ai=["Queue: "+ag.clamp(am,0,100)+"% full (based on "+aq+" data size threshold)"];if(!ag.isNil(ap)){var aj=ag.get(ap,"predictedPercentBytes",-1);var ak=ag.get(ap,"predictedMillisUntilBytesBackpressure",-1);var an=ag.get(ap,"predictionIntervalSeconds",60*5);if(ag.isNumber(aj)&&aj>-1){ai.push("Predicted queue (next "+(an/60)+" mins): "+ag.clamp(aj,0,100)+"%")}else{ai.push("Predicted queue (next "+(an/60)+" mins): NA")}if(ag.isNumber(ak)&&ag.inRange(ak,0,Number.MAX_SAFE_INTEGER)&&!H(al)){var ah=T.formatPredictedDuration(ak);ai.push("Estimated time to back pressure: "+ah)}else{ai.push("Estimated time to back pressure: "+(H(al)?"now":"NA"))}}else{ai.push("Queue Prediction is not configured")}if(ag.isEmpty(ai)){return""}else{if(ag.size(ai)===1){return ai[0]}else{ao=T.formatUnorderedList(ai)}}}else{ao="Back Pressure Data Size Threshold is not configured"}return ao};var L=function(ah){if(ah.empty()){return}var ak=ah.select("g.connection-label-container");if(ak.select("text.penalized-icon").empty()){i.multiAttr(ak.select("g.queued-container").append("text"),{"class":"penalized-icon",y:14}).text(function(){return"\uf252"}).append("title")}ak.select("text.penalized-icon").classed("hidden",function(am){var al=ag.get(am,"status.aggregateSnapshot.flowFileAvailability",null);return al!=="HEAD_OF_QUEUE_PENALIZED"}).attr("x",function(){var al=0;if(!ak.select("text.expiration-icon").classed("hidden")){al+=16}if(!ak.select("text.load-balance-icon").classed("hidden")){al+=16}return 208-al}).select("title").text(function(){return"A FlowFile is currently penalized and data cannot be processed at this time."});var ai=K.Deferred(function(al){ah.select("text.queued tspan.count").text(function(ao){return T.substringBeforeFirst(ao.status.aggregateSnapshot.queued," ")});var an=ah.select("rect.backpressure-percent.data-size");i.multiAttr(an.transition().duration(400),{width:function(ao){if(T.isDefinedAndNotNull(ao.status.aggregateSnapshot.percentUseBytes)){return(g*ao.status.aggregateSnapshot.percentUseBytes)/100}else{return 0}}}).on("end",function(){an.classed("warning",function(ao){return J(ao)}).classed("error",function(ao){return O(ao)});al.resolve()});var am=ah.select("rect.backpressure-tick.data-size-prediction");i.multiAttr(am.transition().duration(400),{x:function(ap){var ao=ag.get(ap,"status.aggregateSnapshot.predictions.predictedPercentBytes",0);return(g*ag.clamp(ao,0,100))/100},display:function(ap){var ao=ag.get(ap,"status.aggregateSnapshot.predictions.predictedPercentBytes",-1);if(ao>=0){return"unset"}else{return"none"}}}).on("end",function(){am.classed("prediction-down",function(ap){var aq=ag.get(ap,"status.aggregateSnapshot.predictions.percentUseBytes",0);var ao=ag.get(ap,"status.aggregateSnapshot.predictions.predictedPercentBytes",0);return ao<aq})});ah.select("g.backpressure-data-size-container").each(function(ap){var ao=V.select("#back-pressure-size-tip-"+ap.id);if(ao.empty()){ao=V.select("#connection-tooltips").append("div").attr("id",function(){return"back-pressure-size-tip-"+ap.id}).attr("class","tooltip nifi-tooltip")}ao.html(function(){return K("<div></div>").append(aa(ap)).html()});Z.canvasTooltip(ao,V.select(this))})}).promise();var aj=K.Deferred(function(al){ah.select("text.queued tspan.size").text(function(ao){return" "+T.substringAfterFirst(ao.status.aggregateSnapshot.queued," ")});var an=ah.select("rect.backpressure-percent.object");i.multiAttr(an.transition().duration(400),{width:function(ao){if(T.isDefinedAndNotNull(ao.status.aggregateSnapshot.percentUseCount)){return(g*ao.status.aggregateSnapshot.percentUseCount)/100}else{return 0}}}).on("end",function(){an.classed("warning",function(ao){return e(ao)}).classed("error",function(ao){return m(ao)});al.resolve()});var am=ah.select("rect.backpressure-tick.object-prediction");i.multiAttr(am.transition().duration(400),{x:function(ap){var ao=ag.get(ap,"status.aggregateSnapshot.predictions.predictedPercentCount",0);return(g*ag.clamp(ao,0,100))/100},display:function(ap){var ao=ag.get(ap,"status.aggregateSnapshot.predictions.predictedPercentCount",-1);if(ao>=0){return"unset"}else{return"none"}}}).on("end",function(){am.classed("prediction-down",function(ap){var aq=ag.get(ap,"status.aggregateSnapshot.percentUseCount",0);var ao=ag.get(ap,"status.aggregateSnapshot.predictions.predictedPercentCount",0);return ao<aq})});ah.select("g.backpressure-object-container").each(function(ap){var ao=V.select("#back-pressure-count-tip-"+ap.id);if(ao.empty()){ao=V.select("#connection-tooltips").append("div").attr("id",function(){return"back-pressure-count-tip-"+ap.id}).attr("class","tooltip nifi-tooltip")}ao.html(function(){return K("<div></div>").append(x(ap)).html()});Z.canvasTooltip(ao,V.select(this))})}).promise();K.when(ai,aj).done(function(){i.multiAttr(ah.select("path.connection-path").classed("full",function(al){return n(al)||P(al)}),{"marker-end":r});ah.select("rect.border").classed("full",function(al){return n(al)||P(al)});i.multiAttr(ah.select("rect.body"),{filter:c})})};var w=function(aj,ai){var ah={revision:f.getRevision(aj),disconnectedNodeAcknowledged:A.isDisconnectionAcknowledged(),component:ai};return K.ajax({type:"PUT",url:aj.uri,data:JSON.stringify(ah),dataType:"json",contentType:"application/json"}).done(function(ak){ae.set(ak)}).fail(d.handleConfigurationUpdateAjaxError)};var h=function(ah){ah.each(function(ak){var aj=Z.getConnectionSourceComponentId(ak);var ai=Z.getConnectionDestinationComponentId(ak);Z.reloadConnectionSourceAndDestination(aj,ai)});ah.call(ac).remove()};var ac=function(ah){ah.each(function(ai){K("#back-pressure-size-tip-"+ai.id).remove();K("#back-pressure-count-tip-"+ai.id).remove()})};var ae={config:{selfLoopXOffset:(Q.width/2)+5,selfLoopYOffset:25},init:function(ah,ai,ak,aj){o=ah;E=ai;S=ak;t=aj;q=new Map();F=new Map();B=new Map();s=i.multiAttr(V.select("#canvas").append("g"),{"pointer-events":"stroke","class":"connections"});I=V.line().x(function(al){return al.x}).y(function(al){return al.y}).curve(V.curveLinear);ad=V.drag().on("start",function(al){al.sourceEvent.stopPropagation()}).on("drag",function(al,am){k=!al.sourceEvent.shiftKey;am.x=k?(Math.round(al.x/D)*D):al.x;am.y=k?(Math.round(al.y/D)*D):al.y;V.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}).on("end",function(ao){var al=V.select(this.parentNode);var aq=al.datum();var an=al.selectAll("rect.midpoint").data();if(an.length===aq.component.bends.length){var ap=false;for(var am=0;am<an.length&&!ap;am++){if(an[am].x!==aq.component.bends[am].x||an[am].y!==aq.component.bends[am].y){ap=true}}if(ap){w(aq,{id:aq.id,bends:an}).fail(function(){aq.bends=K.map(aq.component.bends,function(ar){return{x:ar.x,y:ar.y}});al.call(a,{updatePath:true,updateLabel:false})})}}ao.sourceEvent.stopPropagation()});W=V.drag().on("start",function(al,am){am.dragging=true;al.sourceEvent.stopPropagation()}).on("drag",function(al,am){am.x=al.x-8;am.y=al.y-8;V.select("g.hover").classed("connectable-destination",function(){return Z.isValidConnectionDestination(V.select(this))});V.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}).on("end",function(al,av){av.dragging=false;var am=V.select(this.parentNode);var ax=am.datum();var an=Z.getConnectionDestinationComponentId(ax);var aw=V.select("g.connectable-destination");if(aw.empty()){am.call(a,{updatePath:true,updateLabel:false})}else{if(Z.isProcessGroup(aw)||Z.isRemoteProcessGroup(aw)){t.showConfiguration(am,aw).done(function(){Z.reloadConnectionSourceAndDestination(null,an)}).fail(function(){am.call(a,{updatePath:true,updateLabel:false})})}else{var aq=aw.datum();var at=Z.getConnectableTypeForDestination(aw);var ar={revision:f.getRevision(ax),disconnectedNodeAcknowledged:A.isDisconnectionAcknowledged(),component:{id:ax.id,destination:{id:aq.id,groupId:Z.getGroupId(),type:at}}};if(ax.bends.length<2&&ax.sourceId===aq.id){var ao={x:aq.position.x+(aq.dimensions.width),y:aq.position.y+(aq.dimensions.height/2)};var au=ae.config.selfLoopXOffset;var ap=ae.config.selfLoopYOffset;ar.component.bends=[];ar.component.bends.push({x:(ao.x+au),y:(ao.y-ap)});ar.component.bends.push({x:(ao.x+au),y:(ao.y+ap)})}K.ajax({type:"PUT",url:ax.uri,data:JSON.stringify(ar),dataType:"json",contentType:"application/json"}).done(function(az){var ay=az.component;ae.set(az);Z.reloadConnectionSourceAndDestination(null,an);var aB=Z.getConnectionSourceComponentId(az);var aA=Z.getConnectionSourceComponentId(az);Z.reloadConnectionSourceAndDestination(aB,aA)}).fail(function(aA,ay,az){if(aA.status===400||aA.status===401||aA.status===403||aA.status===404||aA.status===409){j.showOkDialog({headerText:"Connection",dialogContent:T.escapeHtml(aA.responseText)});am.call(a,{updatePath:true,updateLabel:false})}else{d.handleAjaxError(aA,ay,az)}})}}al.sourceEvent.stopPropagation()});u=V.drag().on("start",function(al,am){al.sourceEvent.stopPropagation()}).on("drag",function(al,ar){if(T.isDefinedAndNotNull(ar)&&ar.bends.length>1){var ao=V.select("rect.label-drag");if(ao.empty()){var aq=V.select(this).select("rect.body");var ap=Y(aq);var am=Q.width;var aw=aq.attr("height");ao=V.select("#canvas").append("rect").attr("x",ap.x).attr("y",ap.y).attr("class","label-drag").attr("width",am).attr("height",aw).attr("stroke-width",function(){return 1/Z.getCanvasScale()}).attr("stroke-dasharray",function(){return 4/Z.getCanvasScale()}).datum({x:ap.x,y:ap.y,width:am,height:aw})}else{ao.attr("x",function(ax){ax.x+=al.dx;return ax.x}).attr("y",function(ax){ax.y+=al.dy;return ax.y})}var at=ao.datum();var av={x:at.x+(at.width/2),y:at.y+(at.height/2)};var an=-1;var au;K.each(ar.bends,function(az,ay){var ax={x:ay.x,y:ay.y};var aA=v(av,ax);if(an===-1||aA<au){an=az;au=aA}});ar.labelIndex=an;V.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}}).on("end",function(an,ao){if(ao.bends.length>1){var am=V.select("rect.label-drag");if(!am.empty()){am.remove()}if(ao.labelIndex!==ao.component.labelIndex){var al=V.select(this.parentNode);w(ao,{id:ao.id,labelIndex:ao.labelIndex}).fail(function(){ao.labelIndex=ao.component.labelIndex;al.call(a,{updatePath:true,updateLabel:false})})}}an.sourceEvent.stopPropagation()})},add:function(ai,ak){var an=false;if(T.isDefinedAndNotNull(ak)){an=T.isDefinedAndNotNull(ak.selectAll)?ak.selectAll:an}var aj=new Date().getTime();var ao=function(ap){B.set(ap.id,aj);q.set(ap.id,K.extend({type:"Connection"},ap))};if(K.isArray(ai)){K.each(ai,function(ap,aq){ao(aq)})}else{if(T.isDefinedAndNotNull(ai)){ao(ai)}}var al=U();var am=X(al.enter(),an);var ah=al.merge(am);ah.call(a,{updatePath:true,updateLabel:false}).call(ab)},isDisconnected:function(aj){if(aj.empty()){return false}var ai=new Map();var ak=new Map();var ah=true;aj.filter(function(al){return al.type==="Connection"}).each(function(al){ai.set(al.id,al)});aj.filter(function(al){return al.type!=="Connection"}).each(function(al){ak.set(al.id,al.component);K.each(ae.getComponentConnections(al.id),function(an,am){if(!ai.has(am.id)){ah=false;return false}})});if(ah){ai.forEach(function(al,am){if(ah){ah=ak.has(Z.getConnectionSourceComponentId(al))&&ak.has(Z.getConnectionDestinationComponentId(al))}})}return ah},set:function(am,ap){var ah=false;var al=false;var ai=false;if(T.isDefinedAndNotNull(ap)){ah=T.isDefinedAndNotNull(ap.selectAll)?ap.selectAll:ah;al=T.isDefinedAndNotNull(ap.transition)?ap.transition:al;ai=T.isDefinedAndNotNull(ap.overrideRevisionCheck)?ap.overrideRevisionCheck:ai}var an=function(aq){var ar=q.get(aq.id);if((f.isNewerRevision(ar,aq)&&!F.has(aq.id))||ai===true){q.set(aq.id,K.extend({type:"Connection"},aq))}};if(K.isArray(am)){K.each(Array.from(q.keys()),function(ar,at){var au=q.get(at);var aq=K.grep(am,function(av){return av.id===au.id});if(aq.length===0&&!B.has(at)){q["delete"](at)}});K.each(am,function(aq,ar){an(ar)})}else{if(T.isDefinedAndNotNull(am)){an(am)}}var ao=U();var ak=X(ao.enter(),ah);var aj=ao.merge(ak);aj.call(a,{updatePath:true,updateLabel:true,transition:al}).call(ab);ao.exit().call(h)},refresh:function(ah){if(T.isDefinedAndNotNull(ah)){V.select("#id-"+ah).call(a,{updatePath:true,updateLabel:true})}else{V.selectAll("g.connection").call(a,{updatePath:true,updateLabel:true})}},pan:function(){V.selectAll("g.connection.entering, g.connection.leaving").call(a,{updatePath:false,updateLabel:true})},remove:function(ai){var ah=new Date().getTime();if(K.isArray(ai)){K.each(ai,function(aj,ak){F.set(ak,ah);q["delete"](ak)})}else{F.set(ai,ah);q["delete"](ai)}U().exit().call(h)},removeAll:function(){ae.remove(Array.from(q.keys()))},reload:function(ai){if(q.has(ai)){var ah=q.get(ai);return K.ajax({type:"GET",url:ah.uri,dataType:"json"}).done(function(aj){ae.set(aj)})}},reloadStatus:function(ah){if(q.has(ah)){return K.ajax({type:"GET",url:"../nifi-api/flow/connections/"+encodeURIComponent(ah)+"/status",dataType:"json"}).done(function(ai){var aj=q.get(ah);aj.status=ai.connectionStatus;q.set(ah,aj);U().call(L)})}},getComponentConnections:function(ai){var ah=[];q.forEach(function(ak,aj){if(Z.getConnectionSourceComponentId(ak)===ai||Z.getConnectionDestinationComponentId(ak)===ai){ah.push(ak)}});return ah},get:function(ah){if(T.isUndefined(ah)){return Array.from(q.values())}else{return q.get(ah)}},expireCaches:function(ai){var ah=function(aj){aj.forEach(function(ak,al){if(ai>ak){aj["delete"](al)}})};ah(B);ah(F)}};return ae}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.CanvasUtils","nf.ng.D3Helpers"],function(g,f,h,d,e,c){return(nf.Funnel=b(g,f,h,d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Funnel=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.D3Helpers")))}else{nf.Funnel=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.D3Helpers)}}}(this,function(b,s,d,t,o,p){var i;var l;var e;var m;var c={width:48,height:48};var j;var r;var a;var q;var k=function(){return q.selectAll("g.funnel").data(Array.from(j.values()),function(u){return u.id})};var g=function(w,v){if(w.empty()){return w}var u=p.multiAttr(w.append("g"),{id:function(x){return"id-"+x.id},"class":"funnel component"}).classed("selected",v).call(o.position);p.multiAttr(u.append("rect"),{rx:2,ry:2,"class":"border",width:function(x){return x.dimensions.width},height:function(x){return x.dimensions.height},fill:"transparent",stroke:"transparent"});p.multiAttr(u.append("rect"),{rx:2,ry:2,"class":"body",width:function(x){return x.dimensions.width},height:function(x){return x.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});p.multiAttr(u.append("text"),{"class":"funnel-icon",x:9,y:34}).text("\ue803");u.call(e.activate).call(m.activate);return u};var h=function(u){if(u.empty()){return}u.select("rect.border").classed("unauthorized",function(v){return v.permissions.canRead===false});u.select("rect.body").classed("unauthorized",function(v){return v.permissions.canRead===false});u.each(function(){var v=s.select(this);o.editable(v,i,l)})};var f=function(u){u.remove()};var n={init:function(w,x,u,v){i=w;l=x;e=u;m=v;j=new Map();r=new Map();a=new Map();q=p.multiAttr(s.select("#canvas").append("g"),{"pointer-events":"all","class":"funnels"})},add:function(w,v){var z=false;if(d.isDefinedAndNotNull(v)){z=d.isDefinedAndNotNull(v.selectAll)?v.selectAll:z}var u=new Date().getTime();var A=function(B){a.set(B.id,u);j.set(B.id,b.extend({type:"Funnel",dimensions:c},B))};if(b.isArray(w)){b.each(w,function(C,B){A(B)})}else{if(d.isDefinedAndNotNull(w)){A(w)}}var x=k();var y=g(x.enter(),z);h(x.merge(y))},set:function(v,C){var u=false;var z=false;var w=false;if(d.isDefinedAndNotNull(C)){u=d.isDefinedAndNotNull(C.selectAll)?C.selectAll:u;z=d.isDefinedAndNotNull(C.transition)?C.transition:z;w=d.isDefinedAndNotNull(C.overrideRevisionCheck)?C.overrideRevisionCheck:w}var A=function(E){var D=j.get(E.id);if((t.isNewerRevision(D,E)&&!r.has(E.id))||w===true){j.set(E.id,b.extend({type:"Funnel",dimensions:c},E))}};if(b.isArray(v)){b.each(Array.from(j.keys()),function(E,G){var F=j.get(G);var D=b.grep(v,function(H){return H.id===F.id});if(D.length===0&&!a.has(G)){j["delete"](G)}});b.each(v,function(E,D){A(D)})}else{if(d.isDefinedAndNotNull(v)){A(v)}}var B=k();var y=g(B.enter(),u);var x=B.merge(y);x.call(h).call(o.position,z);B.exit().call(f)},get:function(u){if(d.isUndefined(u)){return Array.from(j.values())}else{return j.get(u)}},refresh:function(u){if(d.isDefinedAndNotNull(u)){s.select("#id-"+u).call(h)}else{s.selectAll("g.funnel").call(h)}},reload:function(v){if(j.has(v)){var u=j.get(v);return b.ajax({type:"GET",url:u.uri,dataType:"json"}).done(function(w){n.set(w)})}},position:function(u){s.select("#id-"+u).call(o.position)},remove:function(v){var u=new Date().getTime();if(b.isArray(v)){b.each(v,function(x,w){r.set(w,u);j["delete"](w)})}else{r.set(v,u);j["delete"](v)}k().exit().call(f)},removeAll:function(){n.remove(Array.from(j.keys()))},expireCaches:function(v){var u=function(w){w.forEach(function(x,y){if(v>x){w["delete"](y)}})};u(a);u(r)}};return n}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage","nf.Common","nf.Client","nf.CanvasUtils","nf.ng.D3Helpers"],function(h,g,e,i,d,f,c){return(nf.Label=b(h,g,e,i,d,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Label=b(require("jquery"),require("d3"),require("nf.Storage"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.D3Helpers")))}else{nf.Label=b(a.$,a.d3,a.nf.Storage,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.D3Helpers)}}}(this,function(e,z,g,k,B,u,w){var n;var r;var m;var l;var s;var j={width:148,height:148};var a=24;var i=64;var f;var y;var d;var b;var c;var v=8;var p=true;var q=function(){return b.selectAll("g.label").data(Array.from(f.values()),function(C){return C.id})};var x=function(C){C.sort(function(E,D){return E.zIndex===D.zIndex?0:E.zIndex>D.zIndex?1:-1})};var A=function(E,D){if(E.empty()){return E}var C=w.multiAttr(E.append("g"),{id:function(F){return"id-"+F.id},"class":"label component"}).classed("selected",D).call(u.position);w.multiAttr(C.append("rect"),{"class":"border",fill:"transparent",stroke:"transparent"});w.multiAttr(C.append("rect"),{"class":"body",filter:"url(#component-drop-shadow)","stroke-width":0});w.multiAttr(C.append("text"),{"xml:space":"preserve","font-weight":"bold",fill:"black","class":"label-value"});C.call(m.activate).call(s.activate).call(l.activate);return C};var h=function(C){if(C.empty()){return}w.multiAttr(C.select("rect.border"),{width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height}}).classed("unauthorized",function(D){return D.permissions.canRead===false});w.multiAttr(C.select("rect.body"),{width:function(D){return D.dimensions.width},height:function(D){return D.dimensions.height}}).style("fill",function(E){if(!E.permissions.canRead){return null}var D=o.defaultColor();if(k.isDefinedAndNotNull(E.component.style["background-color"])){D=E.component.style["background-color"]}return D}).classed("unauthorized",function(D){return D.permissions.canRead===false});C.each(function(H){var I=z.select(this);u.editable(I,n,r);var E=I.select("text.label-value");var F=I.selectAll("rect.labelpoint");if(H.permissions.canRead){E.attr("font-size",function(){var M="12px";if(k.isDefinedAndNotNull(H.component.style["font-size"])){M=H.component.style["font-size"]}return M});E.selectAll("tspan").remove();var L=[];if(k.isDefinedAndNotNull(H.component.label)){L=H.component.label.split("\n")}else{L.push("")}var G=o.defaultColor();if(k.isDefinedAndNotNull(H.component.style["background-color"])){G=H.component.style["background-color"]}e.each(L,function(N,M){E.append("tspan").attr("x","0.4em").attr("dy","1.2em").text(function(){return M==""?" ":M}).style("fill",function(O){return k.determineContrastColor(k.substringAfterLast(G,"#"))})});if(H.permissions.canWrite){var K=[{x:H.dimensions.width,y:H.dimensions.height}];var J=F.data(K);var D=w.multiAttr(J.enter().append("rect"),{"class":"labelpoint",width:10,height:10}).call(c);J.merge(D).attr("transform",function(M){return"translate("+(M.x-10)+", "+(M.y-10)+")"});J.exit().remove()}}else{E.selectAll("tspan").remove();F.remove()}})};var t=function(C){C.remove()};var o={config:{width:j.width,height:j.height},init:function(E,F,C,D,G){n=E;r=F;m=C;s=D;l=G;f=new Map();y=new Map();d=new Map();b=w.multiAttr(z.select("#canvas").append("g"),{"pointer-events":"all","class":"labels"});c=z.drag().on("start",function(H){H.sourceEvent.stopPropagation()}).on("drag",function(J){var H=z.select(this.parentNode);var I=H.datum();p=!J.sourceEvent.shiftKey;I.dimensions.width=Math.max(i,p?(Math.round(J.x/v)*v):J.x);I.dimensions.height=Math.max(a,p?(Math.round(J.y/v)*v):J.y);h(H)}).on("end",function(K){var I=z.select(this.parentNode);var J=I.datum();var L=false;if(k.isDefinedAndNotNull(J.component.width)||J.dimensions.width!==J.component.width){L=true}if(!L&&k.isDefinedAndNotNull(J.component.height)||J.dimensions.height!==J.component.height){L=true}if(L){var H={revision:B.getRevision(J),disconnectedNodeAcknowledged:g.isDisconnectionAcknowledged(),component:{id:J.id,width:J.dimensions.width,height:J.dimensions.height}};e.ajax({type:"PUT",url:J.uri,data:JSON.stringify(H),dataType:"json",contentType:"application/json"}).done(function(M){o.set(M)}).fail(function(){var N=j.width;if(k.isDefinedAndNotNull(J.component.width)){N=J.component.width}var M=j.height;if(k.isDefinedAndNotNull(J.component.height)){M=J.component.height}J.dimensions={width:N,height:M};I.call(h)})}K.sourceEvent.stopPropagation()})},add:function(G,E){var I=false;if(k.isDefinedAndNotNull(E)){I=k.isDefinedAndNotNull(E.selectAll)?E.selectAll:I}var D=new Date().getTime();var J=function(K){d.set(K.id,D);f.set(K.id,e.extend({type:"Label"},K))};if(e.isArray(G)){e.each(G,function(L,K){J(K)})}else{if(k.isDefinedAndNotNull(G)){J(G)}}var F=q();var H=A(F.enter(),I);var C=F.merge(H);C.call(h).call(x)},set:function(D,K){var C=false;var H=false;var E=false;if(k.isDefinedAndNotNull(K)){C=k.isDefinedAndNotNull(K.selectAll)?K.selectAll:C;H=k.isDefinedAndNotNull(K.transition)?K.transition:H;E=k.isDefinedAndNotNull(K.overrideRevisionCheck)?K.overrideRevisionCheck:E}var I=function(L){var M=f.get(L.id);if((B.isNewerRevision(M,L)&&!y.has(L.id))||E===true){f.set(L.id,e.extend({type:"Label"},L))}};if(e.isArray(D)){e.each(Array.from(f.keys()),function(M,O){var N=f.get(O);var L=e.grep(D,function(P){return P.id===N.id});if(L.length===0&&!d.has(O)){f["delete"](O)}});e.each(D,function(M,L){I(L)})}else{if(k.isDefinedAndNotNull(D)){I(D)}}var J=q();var G=A(J.enter(),C);var F=J.merge(G);F.call(h).call(u.position,H).call(x);J.exit().call(t)},get:function(C){if(k.isUndefined(C)){return Array.from(f.values())}else{return f.get(C)}},refresh:function(C){if(k.isDefinedAndNotNull(C)){z.select("#id-"+C).call(h)}else{z.selectAll("g.label").call(h)}},reload:function(D){if(f.has(D)){var C=f.get(D);return e.ajax({type:"GET",url:C.uri,dataType:"json"}).done(function(E){o.set(E)})}},position:function(C){z.select("#id-"+C).call(u.position)},remove:function(D){var C=new Date().getTime();if(e.isArray(D)){e.each(D,function(E,F){y.set(F,C);f["delete"](F)})}else{y.set(D,C);f["delete"](D)}q().exit().call(t)},removeAll:function(){o.remove(Array.from(f.keys()))},expireCaches:function(D){var C=function(E){E.forEach(function(F,G){if(D>F){E["delete"](G)}})};C(d);C(y)},defaultColor:function(){return"#fff7d7"}};return o}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Common","nf.Client","nf.CanvasUtils","nf.ng.D3Helpers"],function(g,f,i,h,d,e,c){return(nf.Port=b(g,f,i,h,d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Port=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.D3Helpers")))}else{nf.Port=b(a.$,a.d3,a.nf.Connection,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.D3Helpers)}}}(this,function(d,B,k,i,D,w,x){var o;var t;var l;var j;var u;var p=15;var m=25;var z={width:240,height:48};var q={width:240,height:80};var h=function(E){return E.allowRemoteAccess===true?q:z};var e;var A;var c;var g;var s=function(){return g.selectAll("g.input-port, g.output-port").data(Array.from(e.values()),function(E){return E.id})};var C=function(E){return E.allowRemoteAccess!==true};var y=function(E){return function(F){return E+(C(F)?0:m)}};var n=function(G,F){if(G.empty()){return G}var E=x.multiAttr(G.append("g"),{id:function(H){return"id-"+H.id},"class":function(H){if(H.portType==="INPUT_PORT"){return"input-port component"}else{return"output-port component"}}}).classed("selected",F).call(w.position);x.multiAttr(E.append("rect"),{"class":"border",width:function(H){return H.dimensions.width},height:function(H){return H.dimensions.height},fill:"transparent",stroke:"transparent"});x.multiAttr(E.append("rect"),{"class":"body",width:function(H){return H.dimensions.width},height:function(H){return H.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});x.multiAttr(E.append("rect"),{"class":"remote-banner",width:q.width,height:m,fill:"#e3e8eb"}).classed("hidden",C);x.multiAttr(E.append("text"),{"class":"port-icon",x:10,y:y(38)}).text(function(H){if(H.portType==="INPUT_PORT"){return"\ue832"}else{return"\ue833"}});x.multiAttr(E.append("text"),{x:70,y:y(25),width:95,height:30,"class":"port-name"});E.call(l.activate).call(u.activate).call(j.activate);E.filter(function(H){return H.permissions.canWrite&&H.permissions.canRead}).call(t.activate).call(o.activate);return E};var r=function(E){if(E.empty()){return}x.multiAttr(E.select("rect.border"),{height:function(F){return F.dimensions.height}}).classed("unauthorized",function(F){return F.permissions.canRead===false});x.multiAttr(E.select("rect.body"),{height:function(F){return F.dimensions.height}}).classed("unauthorized",function(F){return F.permissions.canRead===false});E.each(function(G){var F=B.select(this);var H=F.select("g.port-details");w.editable(F,o,t);if(F.classed("visible")){if(H.empty()){H=F.append("g").attr("class","port-details");x.multiAttr(H.append("text"),{"class":"port-transmission-icon",x:10,y:18}).classed("hidden",C);x.multiAttr(H.append("rect"),{"class":"bulletin-background",x:q.width-m,width:m,height:m}).classed("hidden",C);x.multiAttr(H.append("text"),{"class":"bulletin-icon",x:q.width-18,y:18}).text("\uf24a").classed("hidden",C);x.multiAttr(H.append("text"),{"class":"run-status-icon",x:50,y:y(25)});x.multiAttr(H.append("path"),{"class":"component-comments",transform:"translate("+(G.dimensions.width-2)+", "+(G.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});x.multiAttr(H.append("text"),{"class":"active-thread-count-icon",y:y(43)}).text("\ue83f");x.multiAttr(H.append("text"),{"class":"active-thread-count",y:y(43)})}if(G.permissions.canRead){F.select("rect.remote-banner").classed("hidden",C);x.multiAttr(F.select("text.port-icon"),{y:y(38)});H.select("text.port-transmission-icon").classed("hidden",C);H.select("rect.bulletin-background").classed("hidden",C);H.select("rect.bulletin-icon").classed("hidden",C);x.multiAttr(F.select("text.port-name").each(function(L){var K=B.select(this);var I=L.component.name;var J=I.split(/\s+/);K.text(null).selectAll("tspan, title").remove();if(J.length===1){w.ellipsis(K,I,"port-name")}else{w.multilineEllipsis(K,2,I,"port-name")}}),{y:y(25)}).append("title").text(function(I){return I.component.name});F.select("path.component-comments").style("visibility",i.isBlank(G.component.comments)?"hidden":"visible").attr("transform","translate("+(G.dimensions.width-2)+", "+(G.dimensions.height-10)+")").each(function(){var I=B.select("#comments-tip-"+G.id);if(i.isBlank(G.component.comments)){if(!I.empty()){I.remove()}}else{if(I.empty()){I=B.select("#port-tooltips").append("div").attr("id",function(){return"comments-tip-"+G.id}).attr("class","tooltip nifi-tooltip")}I.text(G.component.comments);w.canvasTooltip(I,B.select(this))}})}else{F.select("text.port-name").text(null);F.select("path.component-comments").style("visibility","hidden");F.call(b)}F.call(f);k.getComponentConnections(G.id).forEach(function(I){k.refresh(I.id)})}else{if(G.permissions.canRead){F.select("text.port-name").text(function(J){var I=J.component.name;if(I.length>p){return I.substring(0,p)+String.fromCharCode(8230)}else{return I}})}else{F.select("text.port-name").text(null)}F.call(b);if(!H.empty()){H.remove()}}})};var f=function(E){if(E.empty()){return}x.multiAttr(E.select("text.run-status-icon"),{fill:function(G){var F="#728e9b";if(G.status.aggregateSnapshot.runStatus==="Invalid"){F="#cf9f5d"}else{if(G.status.aggregateSnapshot.runStatus==="Running"){F="#7dc7a0"}else{if(G.status.aggregateSnapshot.runStatus==="Stopped"){F="#d18686"}}}return F},"font-family":function(G){var F="FontAwesome";if(G.status.aggregateSnapshot.runStatus==="Disabled"){F="flowfont"}return F},y:y(25)}).text(function(G){var F="";if(G.status.aggregateSnapshot.runStatus==="Disabled"){F="\ue802"}else{if(G.status.aggregateSnapshot.runStatus==="Invalid"){F="\uf071"}else{if(G.status.aggregateSnapshot.runStatus==="Running"){F="\uf04b"}else{if(G.status.aggregateSnapshot.runStatus==="Stopped"){F="\uf04d"}}}}return F}).each(function(G){var F=B.select("#run-status-tip-"+G.id);if(G.permissions.canRead&&!i.isEmpty(G.component.validationErrors)){if(F.empty()){F=B.select("#port-tooltips").append("div").attr("id",function(){return"run-status-tip-"+G.id}).attr("class","tooltip nifi-tooltip")}F.html(function(){var H=i.formatUnorderedList(G.component.validationErrors);if(H===null||H.length===0){return""}else{return d("<div></div>").append(H).html()}});w.canvasTooltip(F,B.select(this))}else{if(!F.empty()){F.remove()}}});x.multiAttr(E.select("text.port-transmission-icon"),{"font-family":function(F){if(F.status.transmitting===true){return"FontAwesome"}else{return"flowfont"}}}).text(function(F){if(F.status.transmitting===true){return"\uf140"}else{return"\ue80a"}}).classed("transmitting",function(F){if(F.status.transmitting===true){return true}else{return false}}).classed("not-transmitting",function(F){if(F.status.transmitting!==true){return true}else{return false}});E.each(function(H){var F=B.select(this);var G=0;w.activeThreadCount(F,H,function(I){G=I});F.select("text.active-thread-count-icon").attr("y",y(43));F.select("text.active-thread-count").attr("y",y(43));F.select("rect.bulletin-background").classed("has-bulletins",function(){return !i.isEmpty(H.status.aggregateSnapshot.bulletins)});w.bulletins(F,H,function(){return B.select("#port-tooltips")},G)})};var v=function(E){if(E.empty()){return}E.call(b).remove()};var b=function(E){E.each(function(F){d("#run-status-tip-"+F.id).remove();d("#bulletin-tip-"+F.id).remove();d("#comments-tip-"+F.id).remove()})};var a={init:function(G,H,E,F,I){o=G;t=H;l=E;u=F;j=I;e=new Map();A=new Map();c=new Map();g=x.multiAttr(B.select("#canvas").append("g"),{"pointer-events":"all","class":"ports"})},add:function(H,F){var J=false;if(i.isDefinedAndNotNull(F)){J=i.isDefinedAndNotNull(F.selectAll)?F.selectAll:J}var E=new Date().getTime();var K=function(L){c.set(L.id,E);e.set(L.id,d.extend({type:"Port",dimensions:h(L),status:{activeThreadCount:0}},L))};if(d.isArray(H)){d.each(H,function(M,L){K(L)})}else{if(i.isDefinedAndNotNull(H)){K(H)}}var G=s();var I=n(G.enter(),J);r(G.merge(I))},set:function(E,M){var F=false;var J=false;var G=false;if(i.isDefinedAndNotNull(M)){F=i.isDefinedAndNotNull(M.selectAll)?M.selectAll:F;J=i.isDefinedAndNotNull(M.transition)?M.transition:J;G=i.isDefinedAndNotNull(M.overrideRevisionCheck)?M.overrideRevisionCheck:G}var K=function(N){var O=e.get(N.id);if((D.isNewerRevision(O,N)&&!A.has(N.id))||G===true){e.set(N.id,d.extend({type:"Port",dimensions:h(N),status:{activeThreadCount:0}},N))}};if(d.isArray(E)){d.each(Array.from(e.keys()),function(O,P){var Q=e.get(P);var N=d.grep(E,function(R){return R.id===Q.id});if(N.length===0&&!c.has(P)){e["delete"](P)}});d.each(E,function(O,N){K(N)})}else{if(i.isDefinedAndNotNull(E)){K(E)}}var L=s();var I=n(L.enter(),F);var H=L.merge(I);H.call(r).call(w.position,J);L.exit().call(v)},get:function(E){if(i.isUndefined(E)){return Array.from(e.values())}else{return e.get(E)}},refresh:function(E){if(i.isDefinedAndNotNull(E)){B.select("#id-"+E).call(r)}else{B.selectAll("g.input-port, g.output-port").call(r)}},pan:function(){B.selectAll("g.input-port.entering, g.output-port.entering, g.input-port.leaving, g.output-port.leaving").call(r)},reload:function(F){if(e.has(F)){var E=e.get(F);return d.ajax({type:"GET",url:E.uri,dataType:"json"}).done(function(G){a.set(G)})}},position:function(E){B.select("#id-"+E).call(w.position)},remove:function(F){var E=new Date().getTime();if(d.isArray(F)){d.each(F,function(G,H){A.set(H,E);e["delete"](H)})}else{A.set(F,E);e["delete"](F)}s().exit().call(v)},removeAll:function(){a.remove(Array.from(e.keys()))},expireCaches:function(F){var E=function(G){G.forEach(function(H,I){if(F>H){G["delete"](I)}})};E(c);E(A)}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Common","nf.Client","nf.CanvasUtils","nf.Dialog","nf.ng.D3Helpers"],function(h,f,j,i,d,e,g,c){return(nf.ProcessGroup=b(h,f,j,i,d,e,g,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessGroup=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.Dialog"),require("nf.ng.D3Helpers")))}else{nf.ProcessGroup=b(a.$,a.d3,a.nf.Connection,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.Dialog,a.nf.ng.D3Helpers)}}}(this,function(g,A,k,j,B,v,p,w){var n;var t;var l;var u;var o=30;var i={width:384,height:176};var d;var z;var e;var q;var m=function(C){return j.isDefinedAndNotNull(C.versionedFlowState)};var s=function(){return q.selectAll("g.process-group").data(Array.from(d.values()),function(C){return C.id})};var x=function(E,C){if(E.empty()){return E}var D=w.multiAttr(E.append("g"),{id:function(F){return"id-"+F.id},"class":"process-group component"}).classed("selected",C).call(v.position);w.multiAttr(D.append("rect"),{"class":"border",width:function(F){return F.dimensions.width},height:function(F){return F.dimensions.height},fill:"transparent",stroke:"transparent"});w.multiAttr(D.append("rect"),{"class":"body",width:function(F){return F.dimensions.width},height:function(F){return F.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});w.multiAttr(D.append("rect"),{width:function(F){return F.dimensions.width},height:32,fill:"#b8c6cd"});w.multiAttr(D.append("text"),{x:10,y:20,width:300,height:16,"class":"process-group-name"});w.multiAttr(D.append("text"),{x:10,y:21,"class":"version-control"});D.on("dblclick",function(F,G){h.enterGroup(G.id)}).call(l.activate).call(u.activate);D.filter(function(F){return F.permissions.canWrite&&F.permissions.canRead}).on("mouseover.drop",function(J){var H=A.select(this);if(!H.classed("drop")){var I=H.datum();var G=A.select("rect.drag-selection");if(!G.empty()){var F=v.getSelection().filter(function(K){return I.id===K.id});if(F.empty()){H.classed("drop",function(){return k.isDisconnected(v.getSelection())})}}}}).on("mouseout.drop",function(F){A.select(this).classed("drop",false)}).call(t.activate).call(n.activate);return D};var b=10;var a=5;var y=function(C){if(C.empty()){return}C.select("rect.border").classed("unauthorized",function(D){return D.permissions.canRead===false});C.select("rect.body").classed("unauthorized",function(D){return D.permissions.canRead===false});C.each(function(L){var ac=A.select(this);var Y=ac.select("g.process-group-details");v.editable(ac,n,t);if(ac.classed("visible")){if(Y.empty()){Y=ac.append("g").attr("class","process-group-details");w.multiAttr(Y.append("rect"),{x:0,y:32,width:function(){return L.dimensions.width},height:24,fill:"#e3e8eb"});w.multiAttr(Y.append("rect"),{x:0,y:function(){return L.dimensions.height-24},width:function(){return L.dimensions.width},height:24,fill:"#e3e8eb"});w.multiAttr(Y.append("text"),{x:10,y:49,"class":"process-group-transmitting process-group-contents-icon","font-family":"FontAwesome"}).text("\uf140").append("title").text("Transmitting Remote Process Groups");w.multiAttr(Y.append("text"),{y:49,"class":"process-group-transmitting-count process-group-contents-count"});w.multiAttr(Y.append("text"),{y:49,"class":"process-group-not-transmitting process-group-contents-icon","font-family":"flowfont"}).text("\ue80a").append("title").text("Not Transmitting Remote Process Groups");w.multiAttr(Y.append("text"),{y:49,"class":"process-group-not-transmitting-count process-group-contents-count"});w.multiAttr(Y.append("text"),{y:49,"class":"process-group-running process-group-contents-icon","font-family":"FontAwesome"}).text("\uf04b").append("title").text("Running Components");w.multiAttr(Y.append("text"),{y:49,"class":"process-group-running-count process-group-contents-count"});w.multiAttr(Y.append("text"),{y:49,"class":"process-group-stopped process-group-contents-icon","font-family":"FontAwesome"}).text("\uf04d").append("title").text("Stopped Components");w.multiAttr(Y.append("text"),{y:49,"class":"process-group-stopped-count process-group-contents-count"});w.multiAttr(Y.append("text"),{y:49,"class":"process-group-invalid process-group-contents-icon","font-family":"FontAwesome"}).text("\uf071").append("title").text("Invalid Components");w.multiAttr(Y.append("text"),{y:49,"class":"process-group-invalid-count process-group-contents-count"});w.multiAttr(Y.append("text"),{y:49,"class":"process-group-disabled process-group-contents-icon","font-family":"flowfont"}).text("\ue802").append("title").text("Disabled Components");w.multiAttr(Y.append("text"),{y:49,"class":"process-group-disabled-count process-group-contents-count"});w.multiAttr(Y.append("text"),{x:10,y:function(){return L.dimensions.height-7},"class":"process-group-up-to-date process-group-contents-icon","font-family":"FontAwesome"}).text("\uf00c").append("title").text("Up to date Versioned Process Groups");w.multiAttr(Y.append("text"),{y:function(){return L.dimensions.height-7},"class":"process-group-up-to-date-count process-group-contents-count"});w.multiAttr(Y.append("text"),{y:function(){return L.dimensions.height-7},"class":"process-group-locally-modified process-group-contents-icon","font-family":"FontAwesome"}).text("\uf069").append("title").text("Locally modified Versioned Process Groups");w.multiAttr(Y.append("text"),{y:function(){return L.dimensions.height-7},"class":"process-group-locally-modified-count process-group-contents-count"});w.multiAttr(Y.append("text"),{y:function(){return L.dimensions.height-7},"class":"process-group-stale process-group-contents-icon","font-family":"FontAwesome"}).text("\uf0aa").append("title").text("Stale Versioned Process Groups");w.multiAttr(Y.append("text"),{y:function(){return L.dimensions.height-7},"class":"process-group-stale-count process-group-contents-count"});w.multiAttr(Y.append("text"),{y:function(){return L.dimensions.height-7},"class":"process-group-locally-modified-and-stale process-group-contents-icon","font-family":"FontAwesome"}).text("\uf06a").append("title").text("Locally modified and stale Versioned Process Groups");w.multiAttr(Y.append("text"),{y:function(){return L.dimensions.height-7},"class":"process-group-locally-modified-and-stale-count process-group-contents-count"});w.multiAttr(Y.append("text"),{y:function(){return L.dimensions.height-7},"class":"process-group-sync-failure process-group-contents-icon","font-family":"FontAwesome"}).text("\uf128").append("title").text("Sync failure Versioned Process Groups");w.multiAttr(Y.append("text"),{y:function(){return L.dimensions.height-7},"class":"process-group-sync-failure-count process-group-contents-count"});w.multiAttr(Y.append("rect"),{width:function(){return L.dimensions.width},height:19,x:0,y:66,fill:"#f4f6f7"});w.multiAttr(Y.append("rect"),{width:function(){return L.dimensions.width},height:1,x:0,y:84,fill:"#c7d2d7"});w.multiAttr(Y.append("rect"),{width:function(){return L.dimensions.width},height:19,x:0,y:85,fill:"#ffffff"});w.multiAttr(Y.append("rect"),{width:function(){return L.dimensions.width},height:1,x:0,y:103,fill:"#c7d2d7"});w.multiAttr(Y.append("rect"),{width:function(){return L.dimensions.width},height:19,x:0,y:104,fill:"#f4f6f7"});w.multiAttr(Y.append("rect"),{width:function(){return L.dimensions.width},height:1,x:0,y:122,fill:"#c7d2d7"});w.multiAttr(Y.append("rect"),{width:function(){return L.dimensions.width},height:19,x:0,y:123,fill:"#ffffff"});var X=w.multiAttr(Y.append("g"),{transform:"translate(6, 75)"});w.multiAttr(X.append("text"),{width:73,height:10,x:4,y:5,"class":"stats-label"}).text("Queued");w.multiAttr(X.append("text"),{width:73,height:10,x:4,y:24,"class":"stats-label"}).text("In");w.multiAttr(X.append("text"),{width:73,height:10,x:4,y:42,"class":"stats-label"}).text("Read/Write");w.multiAttr(X.append("text"),{width:73,height:10,x:4,y:60,"class":"stats-label"}).text("Out");var G=w.multiAttr(Y.append("g"),{transform:"translate(95, 75)"});var U=w.multiAttr(G.append("text"),{width:180,height:10,x:4,y:5,"class":"process-group-queued stats-value"});w.multiAttr(U.append("tspan"),{"class":"count"});w.multiAttr(U.append("tspan"),{"class":"size"});var P=w.multiAttr(G.append("text"),{width:180,height:10,x:4,y:24,"class":"process-group-in stats-value"});w.multiAttr(P.append("tspan"),{"class":"count"});w.multiAttr(P.append("tspan"),{"class":"size"});w.multiAttr(P.append("tspan"),{"class":"ports"});w.multiAttr(P.append("tspan"),{"class":"public-ports"});w.multiAttr(G.append("text"),{width:180,height:10,x:4,y:42,"class":"process-group-read-write stats-value"});var S=w.multiAttr(G.append("text"),{width:180,height:10,x:4,y:60,"class":"process-group-out stats-value"});w.multiAttr(S.append("tspan"),{"class":"ports"});w.multiAttr(S.append("tspan"),{"class":"public-ports"});w.multiAttr(S.append("tspan"),{"class":"count"});w.multiAttr(S.append("tspan"),{"class":"size"});var O=w.multiAttr(Y.append("g"),{transform:"translate(335, 75)"});w.multiAttr(O.append("text"),{width:25,height:10,x:4,y:24,"class":"stats-info"}).text("5 min");w.multiAttr(O.append("text"),{width:25,height:10,x:4,y:42,"class":"stats-info"}).text("5 min");w.multiAttr(O.append("text"),{width:25,height:10,x:4,y:60,"class":"stats-info"}).text("5 min");w.multiAttr(Y.append("path"),{"class":"component-comments",transform:"translate("+(L.dimensions.width-2)+", "+(L.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});w.multiAttr(Y.append("text"),{"class":"active-thread-count-icon",y:20}).text("\ue83f");w.multiAttr(Y.append("text"),{"class":"active-thread-count",y:20});w.multiAttr(Y.append("rect"),{"class":"bulletin-background",x:function(){return L.dimensions.width-24},y:32,width:24,height:24});w.multiAttr(Y.append("text"),{"class":"bulletin-icon",x:function(){return L.dimensions.width-17},y:49}).text("\uf24a")}var W=Y.select("text.process-group-transmitting").classed("transmitting",function(aj){return aj.permissions.canRead&&aj.activeRemotePortCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.activeRemotePortCount===0});var af=Y.select("text.process-group-transmitting-count").attr("x",function(){var aj=parseInt(W.attr("x"),10);return aj+Math.round(W.node().getComputedTextLength())+a}).text(function(aj){return aj.activeRemotePortCount});af.append("title").text("Transmitting Remote Process Groups");var F=Y.select("text.process-group-not-transmitting").classed("not-transmitting",function(aj){return aj.permissions.canRead&&aj.inactiveRemotePortCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.inactiveRemotePortCount===0}).attr("x",function(){var aj=parseInt(af.attr("x"),10);return aj+Math.round(af.node().getComputedTextLength())+b});var ad=Y.select("text.process-group-not-transmitting-count").attr("x",function(){var aj=parseInt(F.attr("x"),10);return aj+Math.round(F.node().getComputedTextLength())+a}).text(function(aj){return aj.inactiveRemotePortCount});ad.append("title").text("Not transmitting Remote Process Groups");var H=Y.select("text.process-group-running").classed("running",function(aj){return aj.permissions.canRead&&aj.component.runningCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.component.runningCount===0}).attr("x",function(){var aj=parseInt(ad.attr("x"),10);return aj+Math.round(ad.node().getComputedTextLength())+b});var N=Y.select("text.process-group-running-count").attr("x",function(){var aj=parseInt(H.attr("x"),10);return aj+Math.round(H.node().getComputedTextLength())+a}).text(function(aj){return aj.runningCount});N.append("title").text("Running Components");var I=Y.select("text.process-group-stopped").classed("stopped",function(aj){return aj.permissions.canRead&&aj.component.stoppedCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.component.stoppedCount===0}).attr("x",function(){var aj=parseInt(N.attr("x"),10);return aj+Math.round(N.node().getComputedTextLength())+b});var ae=Y.select("text.process-group-stopped-count").attr("x",function(){var aj=parseInt(I.attr("x"),10);return aj+Math.round(I.node().getComputedTextLength())+a}).text(function(aj){return aj.stoppedCount});ae.append("title").text("Stopped Components");var ab=Y.select("text.process-group-invalid").classed("invalid",function(aj){return aj.permissions.canRead&&aj.component.invalidCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.component.invalidCount===0}).attr("x",function(){var aj=parseInt(ae.attr("x"),10);return aj+Math.round(ae.node().getComputedTextLength())+b});var R=Y.select("text.process-group-invalid-count").attr("x",function(){var aj=parseInt(ab.attr("x"),10);return aj+Math.round(ab.node().getComputedTextLength())+a}).text(function(aj){return aj.invalidCount});R.append("title").text("Invalid Components");var J=Y.select("text.process-group-disabled").classed("disabled",function(aj){return aj.permissions.canRead&&aj.component.disabledCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.component.disabledCount===0}).attr("x",function(){var aj=parseInt(R.attr("x"),10);return aj+Math.round(R.node().getComputedTextLength())+b});var aa=Y.select("text.process-group-disabled-count").attr("x",function(){var aj=parseInt(J.attr("x"),10);return aj+Math.round(J.node().getComputedTextLength())+a}).text(function(aj){return aj.disabledCount});aa.append("title").text("Disabled Components");var ai=Y.select("text.process-group-up-to-date").classed("up-to-date",function(aj){return aj.permissions.canRead&&aj.component.upToDateCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.component.upToDateCount===0});var M=Y.select("text.process-group-up-to-date-count").attr("x",function(){var aj=parseInt(ai.attr("x"),10);return aj+Math.round(ai.node().getComputedTextLength())+a}).text(function(aj){return aj.upToDateCount});M.append("title").text("Up to date Versioned Process Groups");var V=Y.select("text.process-group-locally-modified").classed("locally-modified",function(aj){return aj.permissions.canRead&&aj.component.locallyModifiedCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.component.locallyModifiedCount===0}).attr("x",function(){var aj=parseInt(M.attr("x"),10);return aj+Math.round(M.node().getComputedTextLength())+b});var E=Y.select("text.process-group-locally-modified-count").attr("x",function(){var aj=parseInt(V.attr("x"),10);return aj+Math.round(V.node().getComputedTextLength())+a}).text(function(aj){return aj.locallyModifiedCount});E.append("title").text("Locally modified Versioned Process Groups");var Q=Y.select("text.process-group-stale").classed("stale",function(aj){return aj.permissions.canRead&&aj.component.staleCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.component.staleCount===0}).attr("x",function(){var aj=parseInt(E.attr("x"),10);return aj+Math.round(E.node().getComputedTextLength())+b});var K=Y.select("text.process-group-stale-count").attr("x",function(){var aj=parseInt(Q.attr("x"),10);return aj+Math.round(Q.node().getComputedTextLength())+a}).text(function(aj){return aj.staleCount});K.append("title").text("Stale Versioned Process Groups");var D=Y.select("text.process-group-locally-modified-and-stale").classed("locally-modified-and-stale",function(aj){return aj.permissions.canRead&&aj.component.locallyModifiedAndStaleCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.component.locallyModifiedAndStaleCount===0}).attr("x",function(){var aj=parseInt(K.attr("x"),10);return aj+Math.round(K.node().getComputedTextLength())+b});var T=Y.select("text.process-group-locally-modified-and-stale-count").attr("x",function(){var aj=parseInt(D.attr("x"),10);return aj+Math.round(D.node().getComputedTextLength())+a}).text(function(aj){return aj.locallyModifiedAndStaleCount});T.append("title").text("Locally modified and stale Versioned Process Groups");var ag=Y.select("text.process-group-sync-failure").classed("sync-failure",function(aj){return aj.permissions.canRead&&aj.component.syncFailureCount>0}).classed("zero",function(aj){return aj.permissions.canRead&&aj.component.syncFailureCount===0}).attr("x",function(){var aj=parseInt(T.attr("x"),10);return aj+Math.round(T.node().getComputedTextLength())+b-2});var Z=Y.select("text.process-group-sync-failure-count").attr("x",function(){var aj=parseInt(ag.attr("x"),10);return aj+Math.round(ag.node().getComputedTextLength())+a}).text(function(aj){return aj.syncFailureCount});Z.append("title").text("Sync failure Versioned Process Groups");var ah=ac.select("text.version-control").style("visibility",m(L)?"visible":"hidden").style("fill",function(){if(m(L)){var aj=L.versionedFlowState;if(aj==="SYNC_FAILURE"){return"#666666"}else{if(aj==="LOCALLY_MODIFIED_AND_STALE"){return"#BA554A"}else{if(aj==="STALE"){return"#BA554A"}else{if(aj==="LOCALLY_MODIFIED"){return"#666666"}else{return"#1A9964"}}}}}else{return"#000"}}).text(function(){if(m(L)){var aj=L.versionedFlowState;if(aj==="SYNC_FAILURE"){return"\uf128"}else{if(aj==="LOCALLY_MODIFIED_AND_STALE"){return"\uf06a"}else{if(aj==="STALE"){return"\uf0aa"}else{if(aj==="LOCALLY_MODIFIED"){return"\uf069"}else{return"\uf00c"}}}}}else{return""}});if(L.permissions.canRead){ah.each(function(){var aj=A.select("#version-control-tip-"+L.id);if(m(L)){if(aj.empty()){aj=A.select("#process-group-tooltips").append("div").attr("id",function(){return"version-control-tip-"+L.id}).attr("class","tooltip nifi-tooltip")}aj.html(function(){var ak=L.component.versionControlInformation;var am=g("<div></div>").text('Tracking to "'+ak.flowName+'" Version '+ak.version+' in "'+ak.registryName+" - "+ak.bucketName+'"');var al=g("<div></div>").text(j.getVersionControlTooltip(ak));return g("<div></div>").append(am).append("<br/>").append(al).html()});v.canvasTooltip(aj,A.select(this))}else{if(!aj.empty()){aj.remove()}}});ac.select("path.component-comments").style("visibility",j.isBlank(L.component.comments)?"hidden":"visible").each(function(){var aj=A.select("#comments-tip-"+L.id);if(j.isBlank(L.component.comments)){if(!aj.empty()){aj.remove()}}else{if(aj.empty()){aj=A.select("#process-group-tooltips").append("div").attr("id",function(){return"comments-tip-"+L.id}).attr("class","tooltip nifi-tooltip")}aj.text(L.component.comments);v.canvasTooltip(aj,A.select(this))}});w.multiAttr(ac.select("text.process-group-name"),{x:function(){if(m(L)){var aj=parseInt(ah.attr("x"),10);return aj+Math.round(ah.node().getComputedTextLength())+a}else{return 10}},width:function(){if(m(L)){var ak=parseInt(ah.attr("x"),10);var aj=parseInt(A.select(this).attr("x"),10);return 300-(aj-ak)}else{return 300}}}).each(function(ak){var aj=A.select(this);aj.text(null).selectAll("title").remove();v.ellipsis(aj,ak.component.name,"group-name")}).append("title").text(function(aj){return aj.component.name})}else{ac.select("path.component-comments").style("visibility","hidden");w.multiAttr(ac.select("text.process-group-name"),{x:10,width:316}).text(null);ac.call(c)}ac.call(f)}else{if(L.permissions.canRead){ac.select("text.process-group-name").text(function(ak){var aj=ak.component.name;if(aj.length>o){return aj.substring(0,o)+String.fromCharCode(8230)}else{return aj}})}else{ac.select("text.process-group-name").text(null)}ac.call(c);if(!Y.empty()){Y.remove()}}})};var f=function(C){if(C.empty()){return}C.select("text.process-group-queued tspan.count").text(function(D){return j.substringBeforeFirst(D.status.aggregateSnapshot.queued," ")});C.select("text.process-group-queued tspan.size").text(function(D){return" "+j.substringAfterFirst(D.status.aggregateSnapshot.queued," ")});C.select("text.process-group-in tspan.count").text(function(D){return j.substringBeforeFirst(D.status.aggregateSnapshot.input," ")});C.select("text.process-group-in tspan.size").text(function(D){return" "+j.substringAfterFirst(D.status.aggregateSnapshot.input," ")});C.select("text.process-group-in tspan.ports").text(function(D){return" "+String.fromCharCode(8594)+" "+D.inputPortCount});C.select("text.process-group-in tspan.public-ports").text(function(D){return D.publicInputPortCount>0?" ("+D.publicInputPortCount+" remote)":""});C.select("text.process-group-read-write").text(function(D){return D.status.aggregateSnapshot.read+" / "+D.status.aggregateSnapshot.written});C.select("text.process-group-out tspan.ports").text(function(D){return D.outputPortCount});C.select("text.process-group-out tspan.public-ports").text(function(D){return D.publicOutputPortCount>0?" ("+D.publicOutputPortCount+" remote) ":""});C.select("text.process-group-out tspan.count").text(function(D){return" "+String.fromCharCode(8594)+" "+j.substringBeforeFirst(D.status.aggregateSnapshot.output," ")});C.select("text.process-group-out tspan.size").text(function(D){return" "+j.substringAfterFirst(D.status.aggregateSnapshot.output," ")});C.each(function(F){var D=A.select(this);var E=0;v.activeThreadCount(D,F,function(G){E=G});D.select("rect.bulletin-background").classed("has-bulletins",function(){return !j.isEmpty(F.status.aggregateSnapshot.bulletins)});v.bulletins(D,F,function(){return A.select("#process-group-tooltips")},E)})};var r=function(C){if(C.empty()){return}C.call(c).remove()};var c=function(C){C.each(function(D){g("#bulletin-tip-"+D.id).remove();g("#version-control-tip-"+D.id).remove();g("#comments-tip-"+D.id).remove()})};var h={init:function(E,F,C,D){n=E;t=F;l=C;u=D;d=new Map();z=new Map();e=new Map();q=w.multiAttr(A.select("#canvas").append("g"),{"pointer-events":"all","class":"process-groups"})},add:function(I,D){var G=false;if(j.isDefinedAndNotNull(D)){G=j.isDefinedAndNotNull(D.selectAll)?D.selectAll:G}var C=new Date().getTime();var H=function(J){e.set(J.id,C);d.set(J.id,g.extend({type:"ProcessGroup",dimensions:i},J))};if(g.isArray(I)){g.each(I,function(J,K){H(K)})}else{if(j.isDefinedAndNotNull(I)){H(I)}}var E=s();var F=x(E.enter(),G);y(E.merge(F))},set:function(E,K){var C=false;var H=false;var D=false;if(j.isDefinedAndNotNull(K)){C=j.isDefinedAndNotNull(K.selectAll)?K.selectAll:C;H=j.isDefinedAndNotNull(K.transition)?K.transition:H;D=j.isDefinedAndNotNull(K.overrideRevisionCheck)?K.overrideRevisionCheck:D}var I=function(L){var M=d.get(L.id);if((B.isNewerRevision(M,L)&&!z.has(L.id))||D===true){d.set(L.id,g.extend({type:"ProcessGroup",dimensions:i},L))}};if(g.isArray(E)){g.each(Array.from(d.keys()),function(M,N){var O=d.get(N);var L=g.grep(E,function(P){return P.id===O.id});if(L.length===0&&!e.has(N)){d["delete"](N)}});g.each(E,function(L,M){I(M)})}else{if(j.isDefinedAndNotNull(E)){I(E)}}var J=s();var G=x(J.enter(),C);var F=J.merge(G);F.call(y).call(v.position,H);J.exit().call(r)},get:function(C){if(j.isUndefined(C)){return Array.from(d.values())}else{return d.get(C)}},refresh:function(C){if(j.isDefinedAndNotNull(C)){A.select("#id-"+C).call(y)}else{A.selectAll("g.process-group").call(y)}},pan:function(){A.selectAll("g.process-group.entering, g.process-group.leaving").call(y)},reload:function(D){if(d.has(D)){var C=d.get(D);return g.ajax({type:"GET",url:C.uri,dataType:"json"}).done(function(E){h.set(E)})}},position:function(C){A.select("#id-"+C).call(v.position)},remove:function(D){var C=new Date().getTime();if(g.isArray(D)){g.each(D,function(F,E){z.set(E,C);d["delete"](E)})}else{z.set(D,C);d["delete"](D)}s().exit().call(r)},removeAll:function(){h.remove(Array.from(d.keys()))},expireCaches:function(D){var C=function(E){E.forEach(function(F,G){if(D>F){E["delete"](G)}})};C(e);C(z)},enterGroup:function(C){u.hide();return v.reload(C).done(function(){var D=v.restoreUserView();if(D===false){v.fitCanvas()}v.setURLParameters(C,A.select())}).fail(function(){p.showOkDialog({headerText:"Process Group",dialogContent:"Unable to enter the selected group."})})}};return h}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Common","nf.Client","nf.CanvasUtils","nf.ng.D3Helpers"],function(g,f,i,h,d,e,c){return(nf.RemoteProcessGroup=b(g,f,i,h,d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroup=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.D3Helpers")))}else{nf.RemoteProcessGroup=b(a.$,a.d3,a.nf.Connection,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.D3Helpers)}}}(this,function(g,z,l,j,A,v,w){var n;var t;var m;var k;var u;var o=30;var h={width:384,height:176};var c;var y;var d;var x;var s=function(){return x.selectAll("g.remote-process-group").data(Array.from(c.values()),function(B){return B.id})};var f=function(D,B){if(D.empty()){return D}var C=w.multiAttr(D.append("g"),{id:function(E){return"id-"+E.id},"class":"remote-process-group component"}).classed("selected",B).call(v.position);w.multiAttr(C.append("rect"),{"class":"border",width:function(E){return E.dimensions.width},height:function(E){return E.dimensions.height},fill:"transparent",stroke:"transparent"});w.multiAttr(C.append("rect"),{"class":"body",width:function(E){return E.dimensions.width},height:function(E){return E.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});w.multiAttr(C.append("rect"),{width:function(E){return E.dimensions.width},height:32,fill:"#b8c6cd"});w.multiAttr(C.append("text"),{x:30,y:20,width:305,height:16,"class":"remote-process-group-name"});C.call(m.activate).call(u.activate).call(k.activate);return C};var r=function(B){if(B.empty()){return}B.select("rect.border").classed("unauthorized",function(C){return C.permissions.canRead===false});B.select("rect.body").classed("unauthorized",function(C){return C.permissions.canRead===false});B.each(function(H){var I=z.select(this);var F=I.select("g.remote-process-group-details");v.editable(I,n,t);if(I.classed("visible")){if(F.empty()){F=I.append("g").attr("class","remote-process-group-details");w.multiAttr(F.append("text"),{"class":"remote-process-group-transmission-status",x:10,y:20});w.multiAttr(F.append("rect"),{x:0,y:32,width:function(){return H.dimensions.width},height:24,fill:"#e3e8eb"});w.multiAttr(F.append("text"),{"class":"remote-process-group-transmission-secure",x:10,y:48});w.multiAttr(F.append("text"),{x:30,y:48,width:305,height:12,"class":"remote-process-group-uri"});w.multiAttr(F.append("rect"),{width:function(){return H.dimensions.width},height:19,x:0,y:66,fill:"#f4f6f7"});w.multiAttr(F.append("rect"),{width:function(){return H.dimensions.width},height:1,x:0,y:84,fill:"#c7d2d7"});w.multiAttr(F.append("rect"),{width:function(){return H.dimensions.width},height:19,x:0,y:85,fill:"#ffffff"});var G=w.multiAttr(F.append("g"),{transform:"translate(6, 75)"});w.multiAttr(G.append("text"),{width:73,height:10,x:4,y:5,"class":"stats-label"}).text("Sent");w.multiAttr(G.append("text"),{width:73,height:10,x:4,y:23,"class":"stats-label"}).text("Received");var J=w.multiAttr(F.append("g"),{transform:"translate(95, 75)"});var C=w.multiAttr(J.append("text"),{width:180,height:10,x:4,y:5,"class":"remote-process-group-sent stats-value"});w.multiAttr(C.append("tspan"),{"class":"count"});w.multiAttr(C.append("tspan"),{"class":"size"});w.multiAttr(C.append("tspan"),{"class":"ports"});var D=w.multiAttr(J.append("text"),{width:180,height:10,x:4,y:23,"class":"remote-process-group-received stats-value"});w.multiAttr(D.append("tspan"),{"class":"ports"});w.multiAttr(D.append("tspan"),{"class":"count"});w.multiAttr(D.append("tspan"),{"class":"size"});var E=w.multiAttr(F.append("g"),{transform:"translate(335, 75)"});w.multiAttr(E.append("text"),{width:25,height:10,x:4,y:5,"class":"stats-info"}).text("5 min");w.multiAttr(E.append("text"),{width:25,height:10,x:4,y:23,"class":"stats-info"}).text("5 min");w.multiAttr(F.append("rect"),{x:0,y:function(){return H.dimensions.height-24},width:function(){return H.dimensions.width},height:24,fill:"#e3e8eb"});w.multiAttr(F.append("text"),{x:10,y:168,"class":"remote-process-group-last-refresh"});w.multiAttr(F.append("path"),{"class":"component-comments",transform:"translate("+(H.dimensions.width-2)+", "+(H.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});w.multiAttr(F.append("text"),{"class":"active-thread-count-icon",y:20}).text("\ue83f");w.multiAttr(F.append("text"),{"class":"active-thread-count",y:20});w.multiAttr(F.append("rect"),{"class":"bulletin-background",x:function(){return H.dimensions.width-24},y:32,width:24,height:24});w.multiAttr(F.append("text"),{"class":"bulletin-icon",x:function(){return H.dimensions.width-17},y:49}).text("\uf24a")}if(H.permissions.canRead){F.select("text.remote-process-group-uri").each(function(L){var K=z.select(this);K.text(null).selectAll("title").remove();v.ellipsis(K,L.component.targetUris,"rpg-uri")}).append("title").text(function(K){return K.component.name});F.select("text.remote-process-group-transmission-secure").text(function(L){var K="";if(L.component.targetSecure===true){K="\uf023"}else{K="\uf09c"}return K}).each(function(L){var K=z.select("#transmission-secure-"+L.id);if(K.empty()){K=z.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"transmission-secure-"+L.id}).attr("class","tooltip nifi-tooltip")}K.text(function(){if(L.component.targetSecure===true){return"Site-to-Site is secure."}else{return"Site-to-Site is NOT secure."}});v.canvasTooltip(K,z.select(this))});F.select("path.component-comments").style("visibility",j.isBlank(H.component.comments)?"hidden":"visible").each(function(){var K=z.select("#comments-tip-"+H.id);if(j.isBlank(H.component.comments)){if(!K.empty()){K.remove()}}else{if(K.empty()){K=z.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"comments-tip-"+H.id}).attr("class","tooltip nifi-tooltip")}K.text(H.component.comments);v.canvasTooltip(K,z.select(this))}});F.select("text.remote-process-group-last-refresh").text(function(K){if(j.isDefinedAndNotNull(K.component.flowRefreshed)){return K.component.flowRefreshed}else{return"Remote flow not current"}});I.select("text.remote-process-group-name").each(function(L){var K=z.select(this);K.text(null).selectAll("title").remove();v.ellipsis(K,L.component.name,"rpg-name")}).append("title").text(function(K){return K.component.name})}else{F.select("text.remote-process-group-uri").text(null);F.select("text.remote-process-group-transmission-secure").text(null);F.select("path.component-comments").style("visibility","hidden");F.select("text.remote-process-group-last-refresh").text(null);I.select("text.remote-process-group-name").text(null);I.call(a)}I.call(e)}else{if(H.permissions.canRead){I.select("text.remote-process-group-name").text(function(L){var K=L.component.name;if(K.length>o){return K.substring(0,o)+String.fromCharCode(8230)}else{return K}})}else{I.select("text.remote-process-group-name").text(null)}I.call(a);if(!F.empty()){F.remove()}}})};var b=function(B){return B.status.validationStatus==="INVALID"};var p=function(C){var B=[];if(!j.isEmpty(C.component.authorizationIssues)){B=B.concat(C.component.authorizationIssues)}if(!j.isEmpty(C.component.validationErrors)){B=B.concat(C.component.validationErrors)}return B};var e=function(B){if(B.empty()){return}B.select("text.remote-process-group-sent tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.sent," ")});B.select("text.remote-process-group-sent tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.sent," ")});B.select("text.remote-process-group-sent tspan.ports").text(function(C){return" "+String.fromCharCode(8594)+" "+C.inputPortCount});B.select("text.remote-process-group-received tspan.ports").text(function(C){return C.outputPortCount+" "+String.fromCharCode(8594)+" "});B.select("text.remote-process-group-received tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.received," ")});B.select("text.remote-process-group-received tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.received," ")});B.select("text.remote-process-group-transmission-status").text(function(D){var C="";if(b(D)){C="\uf071"}else{if(D.status.transmissionStatus==="Transmitting"){C="\uf140"}else{C="\ue80a"}}return C}).attr("font-family",function(D){var C="";if(b(D)||D.status.transmissionStatus==="Transmitting"){C="FontAwesome"}else{C="flowfont"}return C}).classed("invalid",function(C){return b(C)}).classed("transmitting",function(C){return !b(C)&&C.status.transmissionStatus==="Transmitting"}).classed("not-transmitting",function(C){return !b(C)&&C.status.transmissionStatus!=="Transmitting"}).each(function(D){var C=z.select("#authorization-issues-"+D.id);if(D.permissions.canRead&&b(D)){if(C.empty()){C=z.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"authorization-issues-"+D.id}).attr("class","tooltip nifi-tooltip")}C.html(function(){var E=j.formatUnorderedList(p(D));if(E===null||E.length===0){return""}else{return g("<div></div>").append(E).html()}});v.canvasTooltip(C,z.select(this))}else{if(!C.empty()){C.remove()}}});B.each(function(E){var C=z.select(this);var D=0;v.activeThreadCount(C,E,function(F){D=F});C.select("rect.bulletin-background").classed("has-bulletins",function(){return !j.isEmpty(E.status.aggregateSnapshot.bulletins)});v.bulletins(C,E,function(){return z.select("#remote-process-group-tooltips")},D)})};var i=function(B){if(B.empty()){return}B.call(a).remove()};var a=function(B){B.each(function(C){g("#bulletin-tip-"+C.id).remove();g("#authorization-issues-"+C.id).remove();g("#transmission-secure-"+C.id).remove();g("#comments-tip-"+C.id).remove()})};var q={init:function(D,E,B,C,F){n=D;t=E;m=B;u=C;k=F;c=new Map();y=new Map();d=new Map();x=w.multiAttr(z.select("#canvas").append("g"),{"pointer-events":"all","class":"remote-process-groups"})},add:function(H,C){var F=false;if(j.isDefinedAndNotNull(C)){F=j.isDefinedAndNotNull(C.selectAll)?C.selectAll:F}var B=new Date().getTime();var G=function(I){d.set(I.id,B);c.set(I.id,g.extend({type:"RemoteProcessGroup",dimensions:h},I))};if(g.isArray(H)){g.each(H,function(I,J){G(J)})}else{if(j.isDefinedAndNotNull(H)){G(H)}}var D=s();var E=f(D.enter(),F);r(D.merge(E))},set:function(B,J){var C=false;var G=false;var D=false;if(j.isDefinedAndNotNull(J)){C=j.isDefinedAndNotNull(J.selectAll)?J.selectAll:C;G=j.isDefinedAndNotNull(J.transition)?J.transition:G;D=j.isDefinedAndNotNull(J.overrideRevisionCheck)?J.overrideRevisionCheck:D}var H=function(K){var L=c.get(K.id);if((A.isNewerRevision(L,K)&&!y.has(K.id))||D===true){c.set(K.id,g.extend({type:"RemoteProcessGroup",dimensions:h},K))}};if(g.isArray(B)){g.each(Array.from(c.keys()),function(L,M){var N=c.get(M);var K=g.grep(B,function(O){return O.id===N.id});if(K.length===0&&!d.has(M)){c["delete"](M)}});g.each(B,function(K,L){H(L)})}else{if(j.isDefinedAndNotNull(B)){H(B)}}var I=s();var F=f(I.enter(),C);var E=I.merge(F);E.call(r).call(v.position,G);I.exit().call(i)},get:function(B){if(j.isUndefined(B)){return Array.from(c.values())}else{return c.get(B)}},refresh:function(B){if(j.isDefinedAndNotNull(B)){z.select("#id-"+B).call(r)}else{z.selectAll("g.remote-process-group").call(r)}},pan:function(){z.selectAll("g.remote-process-group.entering, g.remote-process-group.leaving").call(r)},reload:function(C){if(c.has(C)){var B=c.get(C);return g.ajax({type:"GET",url:B.uri,dataType:"json"}).done(function(D){q.set(D);var E=l.getComponentConnections(C);g.each(E,function(G,F){if(F.permissions.canRead){l.reload(F.id)}})})}},position:function(B){z.select("#id-"+B).call(v.position)},remove:function(C){var B=new Date().getTime();if(g.isArray(C)){g.each(C,function(E,D){y.set(D,B);c["delete"](D)})}else{y.set(C,B);c["delete"](C)}s().exit().call(i)},removeAll:function(){q.remove(Array.from(c.keys()))},expireCaches:function(C){var B=function(D){D.forEach(function(E,F){if(C>E){D["delete"](F)}})};B(d);B(y)}};return q}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.ClusterSummary","nf.CanvasUtils","nf.ng.D3Helpers"],function(h,g,i,e,c,f,d){return(nf.Processor=b(h,g,i,e,c,f,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Processor=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.ClusterSummary"),require("nf.CanvasUtils"),require("nf.ng.D3Helpers")))}else{nf.Processor=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.ClusterSummary,a.nf.CanvasUtils,a.nf.ng.D3Helpers)}}}(this,function(e,B,i,C,h,v,w){var m;var s;var k;var j;var u;var n=25;var g={width:352,height:128};var z;var A;var c;var r;var q=function(){return r.selectAll("g.processor").data(Array.from(z.values()),function(D){return D.id})};var d=function(F,E){if(F.empty()){return F}var D=w.multiAttr(F.append("g"),{id:function(G){return"id-"+G.id},"class":"processor component"}).classed("selected",E).call(v.position);w.multiAttr(D.append("rect"),{"class":"border",width:function(G){return G.dimensions.width},height:function(G){return G.dimensions.height},fill:"transparent",stroke:"transparent"});w.multiAttr(D.append("rect"),{"class":"body",width:function(G){return G.dimensions.width},height:function(G){return G.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});w.multiAttr(D.append("text"),{x:75,y:18,width:230,height:14,"class":"processor-name"});w.multiAttr(D.append("rect"),{x:0,y:0,width:50,height:50,"class":"processor-icon-container"});w.multiAttr(D.append("text"),{x:9,y:35,"class":"processor-icon"}).text("\ue807");w.multiAttr(D.append("circle"),{r:9,cx:12,cy:12,"class":"restricted-background"});w.multiAttr(D.append("text"),{x:7.75,y:17,"class":"restricted"}).text("\uf132");w.multiAttr(D.append("circle"),{r:9,cx:38,cy:36,"class":"is-primary-background"});w.multiAttr(D.append("text"),{x:34.75,y:40,"class":"is-primary"}).text("P").append("title").text(function(G){return"This component is only scheduled to execute on the Primary Node"});D.call(k.activate).call(u.activate).call(j.activate);return D};var y=function(D){if(D.empty()){return}D.select("rect.border").classed("unauthorized",function(E){return E.permissions.canRead===false}).classed("ghost",function(E){return E.permissions.canRead===true&&E.component.extensionMissing===true});D.select("rect.body").classed("unauthorized",function(E){return E.permissions.canRead===false});D.each(function(J){var G=B.select(this);var E=G.select("g.processor-canvas-details");v.editable(G,m,s);if(G.classed("visible")){if(E.empty()){E=G.append("g").attr("class","processor-canvas-details");w.multiAttr(E.append("text"),{"class":"run-status-icon",x:55,y:23,width:14,height:14});w.multiAttr(E.append("text"),{"class":"processor-type",x:75,y:32,width:230,height:12});w.multiAttr(E.append("text"),{"class":"processor-bundle",x:75,y:45,width:200,height:12});w.multiAttr(E.append("rect"),{width:function(){return J.dimensions.width},height:19,x:0,y:50,fill:"#f4f6f7"});w.multiAttr(E.append("rect"),{width:function(){return J.dimensions.width},height:1,x:0,y:68,fill:"#c7d2d7"});w.multiAttr(E.append("rect"),{width:function(){return J.dimensions.width},height:19,x:0,y:69,fill:"#ffffff"});w.multiAttr(E.append("rect"),{width:function(){return J.dimensions.width},height:1,x:0,y:87,fill:"#c7d2d7"});w.multiAttr(E.append("rect"),{width:function(){return J.dimensions.width},height:20,x:0,y:88,fill:"#f4f6f7"});w.multiAttr(E.append("rect"),{width:function(){return J.dimensions.width},height:1,x:0,y:106,fill:"#c7d2d7"});w.multiAttr(E.append("rect"),{width:function(){return J.dimensions.width},height:19,x:0,y:107,fill:"#ffffff"});var M=w.multiAttr(E.append("g"),{transform:"translate(10, 55)"});w.multiAttr(M.append("text"),{width:73,height:10,y:9,"class":"stats-label"}).text("In");w.multiAttr(M.append("text"),{width:73,height:10,y:27,"class":"stats-label"}).text("Read/Write");w.multiAttr(M.append("text"),{width:73,height:10,y:46,"class":"stats-label"}).text("Out");w.multiAttr(M.append("text"),{width:73,height:10,y:65,"class":"stats-label"}).text("Tasks/Time");var F=w.multiAttr(E.append("g"),{transform:"translate(85, 55)"});var L=w.multiAttr(F.append("text"),{width:180,height:9,y:9,"class":"processor-in stats-value"});w.multiAttr(L.append("tspan"),{"class":"count"});w.multiAttr(L.append("tspan"),{"class":"size"});w.multiAttr(F.append("text"),{width:180,height:10,y:27,"class":"processor-read-write stats-value"});var H=w.multiAttr(F.append("text"),{width:180,height:10,y:46,"class":"processor-out stats-value"});w.multiAttr(H.append("tspan"),{"class":"count"});w.multiAttr(H.append("tspan"),{"class":"size"});w.multiAttr(F.append("text"),{width:180,height:10,y:65,"class":"processor-tasks-time stats-value"});var K=E.append("g").attr("transform","translate(305, 55)");w.multiAttr(K.append("text"),{width:25,height:10,y:9,"class":"stats-info"}).text("5 min");w.multiAttr(K.append("text"),{width:25,height:10,y:27,"class":"stats-info"}).text("5 min");w.multiAttr(K.append("text"),{width:25,height:10,y:46,"class":"stats-info"}).text("5 min");w.multiAttr(K.append("text"),{width:25,height:10,y:65,"class":"stats-info"}).text("5 min");w.multiAttr(E.append("path"),{"class":"component-comments",transform:"translate("+(J.dimensions.width-2)+", "+(J.dimensions.height-10)+")",d:"m0,0 l0,8 l-8,0 z"});w.multiAttr(E.append("text"),{"class":"active-thread-count-icon",y:46}).text("\ue83f");w.multiAttr(E.append("text"),{"class":"active-thread-count",y:46});w.multiAttr(E.append("rect"),{"class":"bulletin-background",x:function(N){return J.dimensions.width-24},width:24,height:24});w.multiAttr(E.append("text"),{"class":"bulletin-icon",x:function(N){return J.dimensions.width-17},y:17}).text("\uf24a")}if(J.permissions.canRead){G.select("text.processor-name").each(function(O){var N=B.select(this);N.text(null).selectAll("title").remove();v.ellipsis(N,O.component.name,"processor-name")}).append("title").text(function(N){return N.component.name});G.select("text.processor-type").each(function(O){var N=B.select(this);N.text(null).selectAll("title").remove();v.ellipsis(N,i.formatType(O.component),"processor-type")}).append("title").text(function(N){return i.formatType(N.component)});G.select("text.processor-bundle").each(function(O){var N=B.select(this);N.text(null).selectAll("title").remove();v.ellipsis(N,i.formatBundle(O.component.bundle),"processor-bundle")}).append("title").text(function(N){return i.formatBundle(N.component.bundle)});G.select("path.component-comments").style("visibility",i.isBlank(J.component.config.comments)?"hidden":"visible").each(function(){var N=B.select("#comments-tip-"+J.id);if(i.isBlank(J.component.config.comments)){if(!N.empty()){N.remove()}}else{if(N.empty()){N=B.select("#processor-tooltips").append("div").attr("id",function(){return"comments-tip-"+J.id}).attr("class","tooltip nifi-tooltip")}N.text(J.component.config.comments);v.canvasTooltip(N,B.select(this))}})}else{G.select("text.processor-name").text(null);G.select("text.processor-type").text(null);G.select("text.processor-bundle").text(null);G.select("path.component-comments").style("visibility","hidden");G.call(b)}G.call(f)}else{if(J.permissions.canRead){G.select("text.processor-name").text(function(O){var N=O.component.name;if(N.length>n){return N.substring(0,n)+String.fromCharCode(8230)}else{return N}})}else{G.select("text.processor-name").text(null)}G.call(b);if(!E.empty()){E.remove()}}G.select("rect.processor-icon-container").classed("unauthorized",!J.permissions.canRead);G.select("text.processor-icon").classed("unauthorized",!J.permissions.canRead);G.select("rect.border").classed("unauthorized",!J.permissions.canRead);if(J.permissions.canRead){if(i.isDefinedAndNotNull(J.component.style["background-color"])){var I=J.component.style["background-color"];G.select("rect.processor-icon-container").style("fill",function(N){return I});G.select("rect.border").style("stroke",function(N){return I})}}G.select("text.processor-icon").style("fill",function(O){var N=p.defaultIconColor();if(!O.permissions.canRead){return N}if(i.isDefinedAndNotNull(O.component.style["background-color"])){N=O.component.style["background-color"];if(N.toLowerCase()==="#ffffff"){N=p.defaultIconColor()}else{N=i.determineContrastColor(i.substringAfterLast(N,"#"))}}return N});G.select("circle.restricted-background").style("visibility",l);G.select("text.restricted").style("visibility",l);G.select("circle.is-primary-background").style("visibility",o);G.select("text.is-primary").style("visibility",o)})};var l=function(D){if(!D.permissions.canRead){return"hidden"}return D.component.restricted?"visible":"hidden"};var o=function(D){return h.isClustered()&&D.status.aggregateSnapshot.executionNode==="PRIMARY"?"visible":"hidden"};var x=function(D){return(D.permissions.canRead&&!i.isEmpty(D.component.validationErrors))||D.status.aggregateSnapshot.runStatus==="Validating"};var a=function(E){if(E.permissions.canRead&&!i.isEmpty(E.component.validationErrors)){var D=i.formatUnorderedList(E.component.validationErrors);if(D===null||D.length===0){return""}else{return D}}else{return"Validating..."}};var f=function(D){if(D.empty()){return}w.multiAttr(D.select("text.run-status-icon"),{fill:function(F){var E="#728e9b";if(F.status.aggregateSnapshot.runStatus==="Validating"){E="#a8a8a8"}else{if(F.status.aggregateSnapshot.runStatus==="Invalid"){E="#cf9f5d"}else{if(F.status.aggregateSnapshot.runStatus==="Running"){E="#7dc7a0"}else{if(F.status.aggregateSnapshot.runStatus==="Stopped"){E="#d18686"}}}}return E},"font-family":function(F){var E="FontAwesome";if(F.status.aggregateSnapshot.runStatus==="Disabled"){E="flowfont"}return E}}).classed("fa-spin",function(E){return E.status.aggregateSnapshot.runStatus==="Validating"}).text(function(F){var E="";if(F.status.aggregateSnapshot.runStatus==="Disabled"){E="\ue802"}else{if(F.status.aggregateSnapshot.runStatus==="Validating"){E="\uf1ce"}else{if(F.status.aggregateSnapshot.runStatus==="Invalid"){E="\uf071"}else{if(F.status.aggregateSnapshot.runStatus==="Running"){E="\uf04b"}else{if(F.status.aggregateSnapshot.runStatus==="Stopped"){E="\uf04d"}}}}}return E}).each(function(F){var E=B.select("#run-status-tip-"+F.id);if(x(F)){if(E.empty()){E=B.select("#processor-tooltips").append("div").attr("id",function(){return"run-status-tip-"+F.id}).attr("class","tooltip nifi-tooltip")}E.html(function(){return e("<div></div>").append(a(F)).html()});v.canvasTooltip(E,B.select(this))}else{if(!E.empty()){E.remove()}}});D.select("text.processor-in tspan.count").text(function(E){return i.substringBeforeFirst(E.status.aggregateSnapshot.input," ")});D.select("text.processor-in tspan.size").text(function(E){return" "+i.substringAfterFirst(E.status.aggregateSnapshot.input," ")});D.select("text.processor-read-write").text(function(E){return E.status.aggregateSnapshot.read+" / "+E.status.aggregateSnapshot.written});D.select("text.processor-out tspan.count").text(function(E){return i.substringBeforeFirst(E.status.aggregateSnapshot.output," ")});D.select("text.processor-out tspan.size").text(function(E){return" "+i.substringAfterFirst(E.status.aggregateSnapshot.output," ")});D.select("text.processor-tasks-time").text(function(E){return E.status.aggregateSnapshot.tasks+" / "+E.status.aggregateSnapshot.tasksDuration});D.each(function(F){var E=B.select(this);v.activeThreadCount(E,F);E.select("rect.bulletin-background").classed("has-bulletins",function(){return !i.isEmpty(F.status.aggregateSnapshot.bulletins)});v.bulletins(E,F,function(){return B.select("#processor-tooltips")},286)})};var t=function(D){if(D.empty()){return}D.call(b).remove()};var b=function(D){D.each(function(E){e("#run-status-tip-"+E.id).remove();e("#bulletin-tip-"+E.id).remove();e("#comments-tip-"+E.id).remove()})};var p={init:function(F,G,D,E,H){m=F;s=G;k=D;u=E;j=H;z=new Map();A=new Map();c=new Map();r=w.multiAttr(B.select("#canvas").append("g"),{"pointer-events":"all","class":"processors"})},add:function(D,F){var I=false;if(i.isDefinedAndNotNull(F)){I=i.isDefinedAndNotNull(F.selectAll)?F.selectAll:I}var E=new Date().getTime();var J=function(K){c.set(K.id,E);z.set(K.id,e.extend({type:"Processor",dimensions:g},K))};if(e.isArray(D)){e.each(D,function(K,L){J(L)})}else{if(i.isDefinedAndNotNull(D)){J(D)}}var G=q();var H=d(G.enter(),I);y(G.merge(H))},set:function(I,L){var D=false;var H=false;var E=false;if(i.isDefinedAndNotNull(L)){D=i.isDefinedAndNotNull(L.selectAll)?L.selectAll:D;H=i.isDefinedAndNotNull(L.transition)?L.transition:H;E=i.isDefinedAndNotNull(L.overrideRevisionCheck)?L.overrideRevisionCheck:E}var J=function(N){var M=z.get(N.id);if((C.isNewerRevision(M,N)&&!A.has(N.id))||E===true){z.set(N.id,e.extend({type:"Processor",dimensions:g},N))}};if(e.isArray(I)){e.each(Array.from(z.keys()),function(N,O){var P=z.get(O);var M=e.grep(I,function(Q){return Q.id===P.id});if(M.length===0&&!c.has(O)){z["delete"](O)}});e.each(I,function(M,N){J(N)})}else{if(i.isDefinedAndNotNull(I)){J(I)}}var K=q();var G=d(K.enter(),D);var F=K.merge(G);F.call(y);F.call(v.position,H);K.exit().call(t)},get:function(D){if(i.isUndefined(D)){return Array.from(z.values())}else{return z.get(D)}},refresh:function(D){if(i.isDefinedAndNotNull(D)){B.select("#id-"+D).call(y)}else{B.selectAll("g.processor").call(y)}},position:function(D){B.select("#id-"+D).call(v.position)},pan:function(){B.selectAll("g.processor.entering, g.processor.leaving").call(y)},reload:function(E){if(z.has(E)){var D=z.get(E);return e.ajax({type:"GET",url:D.uri,dataType:"json"}).done(function(F){p.set(F)})}},remove:function(E){var D=new Date().getTime();if(e.isArray(E)){e.each(E,function(F,G){A.set(G,D);z["delete"](G)})}else{A.set(E,D);z["delete"](E)}q().exit().call(t)},removeAll:function(){p.remove(Array.from(z.keys()))},expireCaches:function(E){var D=function(F){F.forEach(function(G,H){if(E>G){F["delete"](H)}})};D(c);D(A)},defaultFillColor:function(){return"#FFFFFF"},defaultIconColor:function(){return"#ad9897"}};return p}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Processor","nf.ClusterSummary","nf.CustomUi","nf.Verify","nf.UniversalCapture","nf.Connection"],function(f,o,c,e,h,p,d,i,n,m,l,g,j,k){return(nf.ProcessorConfiguration=b(f,o,c,e,h,p,d,i,n,m,l,g,j,k))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorConfiguration=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Processor"),require("nf.ClusterSummary"),require("nf.CustomUi"),require("nf.Verify"),require("nf.UniversalCapture"),require("nf.Connection")))}else{nf.ProcessorConfiguration=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Processor,a.nf.ClusterSummary,a.nf.CustomUi,a.nf.Verify,a.nf.UniversalCapture,a.nf.Connection)}}}(this,function(e,h,j,p,f,D,x,E,o,i,a,y,w,k){var B;var l=[0,25,50,100,250,500,1000,2000];var A="status.aggregateSnapshot.activeThreadCount",g="status.aggregateSnapshot.runStatus",c="bulletins";var v=null;var r=function(F){var G=[{text:"Timer driven",value:"TIMER_DRIVEN",description:"Processor will be scheduled to run on an interval defined by the run schedule."}];G.push({text:"CRON driven",value:"CRON_DRIVEN",description:"Processor will be scheduled to run on at specific times based on the specified CRON string."});return G};var d=function(F){return[{text:"All nodes",value:"ALL",description:"Processor will be scheduled to run on all nodes",disabled:F.executionNodeRestricted===true},{text:"Primary node",value:"PRIMARY",description:"Processor will be scheduled to run only on the primary node"}]};var q=function(L){var N=e('<span class="relationship-name-value hidden"></span>').text(L.name);var K=e('<div class="processor-terminate-relationship nf-checkbox"></div>');var M=e('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text("terminate");if(L.autoTerminate===true){K.addClass("checkbox-checked")}else{K.addClass("checkbox-unchecked")}var I=e('<div class="processor-terminate-relationship-container"></div>').append(K).append(M);var P=e('<div class="processor-retry-relationship nf-checkbox"></div>');var J=e('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text("retry");if(L.retry===true){P.addClass("checkbox-checked")}else{P.addClass("checkbox-unchecked")}var G=e('<div class="processor-retry-relationship-container"></div>').append(P).append(J);var O=e("<div></div>").text(L.name);var F=e('<div class="processor-relationship-container"></div>').append(O).append(I).append(G).append(N).appendTo("#auto-action-relationship-names");if(!j.isBlank(L.description)){var H=e('<div class="relationship-description"></div>').text(L.description);F.append(H)}return F};var C=function(){var H=e("#processor-configuration").data("processorDetails");var K=false;var L=t("terminate");e.each(H.relationships,function(N,O){if(O.autoTerminate===true){if(e.inArray(O.name,L)===-1){K=true;return false}}else{if(O.autoTerminate===false){if(e.inArray(O.name,L)>=0){K=true;return false}}}});if(K){return true}var J=false;var I=t("retry");e.each(H.relationships,function(N,O){if(O.retry===true){if(e.inArray(O.name,I)===-1){J=true;return false}}else{if(O.retry===false){if(e.inArray(O.name,I)>=0){J=true;return false}}}});if(J){return true}var M=e("#scheduling-strategy-combo").combo("getSelectedOption").value;if(M!==(H.config.schedulingStrategy+"")){return true}if(H.supportsParallelProcessing===true){var F;if(M==="CRON_DRIVEN"){F=e("#cron-driven-concurrently-schedulable-tasks")}else{F=e("#timer-driven-concurrently-schedulable-tasks")}if(F.val()!==(H.config.concurrentlySchedulableTaskCount+"")){return true}}var G;if(M==="CRON_DRIVEN"){G=e("#cron-driven-scheduling-period")}else{G=e("#timer-driven-scheduling-period")}if(j.isDefinedAndNotNull(G)&&G.val()!==(H.config.schedulingPeriod+"")){return true}if(e("#execution-node-combo").combo("getSelectedOption").value!==(H.config.executionNode+"")){return true}if(e("#processor-name").val()!==H.name){return true}if(e("#processor-enabled").hasClass("checkbox-checked")&&H.state==="DISABLED"){return true}else{if(e("#processor-enabled").hasClass("checkbox-unchecked")&&(H.state==="RUNNING"||H.state==="STOPPED")){return true}}if(e("#penalty-duration").val()!==(H.config.penaltyDuration+"")){return true}if(e("#yield-duration").val()!==(H.config.yieldDuration+"")){return true}if(e("#bulletin-level-combo").combo("getSelectedOption").value!==(H.config.bulletinLevel+"")){return true}if(e("#processor-comments").val()!==H.config.comments){return true}return e("#processor-properties").propertytable("isSaveRequired")};var m=function(H){var J={};var F=e("#scheduling-strategy-combo").combo("getSelectedOption").value;var O;if(F==="CRON_DRIVEN"){O=e("#cron-driven-concurrently-schedulable-tasks")}else{O=e("#timer-driven-concurrently-schedulable-tasks")}if(!O.is(":disabled")){J.concurrentlySchedulableTaskCount=O.val()}var K;if(F==="CRON_DRIVEN"){K=e("#cron-driven-scheduling-period")}else{K=e("#timer-driven-scheduling-period")}if(j.isDefinedAndNotNull(K)){J.schedulingPeriod=K.val()}J.executionNode=e("#execution-node-combo").combo("getSelectedOption").value;J.penaltyDuration=e("#penalty-duration").val();J.yieldDuration=e("#yield-duration").val();J.bulletinLevel=e("#bulletin-level-combo").combo("getSelectedOption").value;J.schedulingStrategy=F;J.comments=e("#processor-comments").val();if(H.supportsBatching===true){var G=e("#run-duration-slider").slider("value");J.runDurationMillis=l[G]}var M=t("terminate");var N=t("retry");J.autoTerminatedRelationships=M;J.retriedRelationships=N;if(N.length>0){J.retryCount=e("#retry-attempt-count").val();J.backoffMechanism=e("input:radio[name ='backoffPolicy']:checked").val();J.maxBackoffPeriod=e("#max-backoff-period").val()}var L=e("#processor-properties").propertytable("marshalProperties");if(e.isEmptyObject(L)===false){J.properties=L}if(H.supportsSensitiveDynamicProperties===true){J.sensitiveDynamicPropertyNames=e("#processor-properties").propertytable("getSensitiveDynamicPropertyNames")}var I={};I.id=e("#processor-id").text();I.name=e("#processor-name").val();I.config=J;if(e("#processor-enabled").hasClass("checkbox-unchecked")){I.state="DISABLED"}else{if(e("#processor-enabled").hasClass("checkbox-checked")){I.state="STOPPED"}}var P={};P.component=I;return P};var t=function(H){var G=e("#auto-action-relationship-names");var F=[];e.each(G.children(),function(I,L){var K=e(L);var J=K.children("div.processor-"+H+"-relationship-container").children("div.processor-"+H+"-relationship");if(J.hasClass("checkbox-checked")){F.push(K.children("span.relationship-name-value").text())}});return F};var z=function(G){var I=[];var H=G.component;var F=H.config;if(j.isDefinedAndNotNull(F.concurrentlySchedulableTaskCount)&&!e.isNumeric(F.concurrentlySchedulableTaskCount)){I.push("Concurrent tasks must be an integer value")}if(j.isDefinedAndNotNull(F.schedulingPeriod)&&j.isBlank(F.schedulingPeriod)){I.push("Run schedule must be specified")}if(j.isBlank(F.penaltyDuration)){I.push("Penalty duration must be specified")}if(j.isBlank(F.yieldDuration)){I.push("Yield duration must be specified")}if(I.length>0){p.showOkDialog({dialogContent:j.formatUnorderedList(I),headerText:"Configuration Error"});return false}else{return true}};var b=function(G){var F=k.getComponentConnections(G.id);e.each(F,function(I,H){if(H.permissions.canRead){if(H.sourceId===G.id){k.reload(H.id)}}})};var s=function(){return e.Deferred(function(F){e("#processor-properties").propertytable("saveRow");if(C()){p.showYesNoDialog({headerText:"Processor Configuration",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){F.resolve()},yesHandler:function(){var G=e("#processor-configuration").data("processorDetails");u(G).done(function(){F.resolve()}).fail(function(){F.reject()})}})}else{F.resolve()}}).promise()};var u=function(F){var G=m(F);if(z(G)){var H=o.get(F.id);G.revision=D.getRevision(H);G.disconnectedNodeAcknowledged=f.isDisconnectionAcknowledged();return e.ajax({type:"PUT",data:JSON.stringify(G),url:H.uri,dataType:"json",contentType:"application/json"}).done(function(I){o.set(I)}).fail(h.handleConfigurationUpdateAjaxError)}else{return e.Deferred(function(I){I.reject()}).promise()}};var n=function(H,I){v=I;var F=e("#processor-properties-verification-results");if(F.is(":visible")===false){e("#processor-properties").css("bottom","40%").propertytable("resetTableSize");F.show()}var G=e("#processor-properties-verification-results-listing");if(G.get(0).scrollHeight>Math.round(G.innerHeight())){G.css("border-width","1px")}};return{init:function(F){B=F;e("#processor-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"processor-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"processor-scheduling-tab-content"},{name:"Properties",tabContentId:"processor-properties-tab-content"},{name:"Relationships",tabContentId:"processor-relationships-tab-content"},{name:"Comments",tabContentId:"processor-comments-tab-content"}],select:function(){w.removeAllPropertyDetailDialogs();if(e(this).text()==="Properties"){e("#processor-properties").propertytable("resetTableSize")}e("#processor-properties").propertytable("saveRow")}});e("#processor-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Processor",handler:{close:function(){e("#auto-action-relationship-names").empty();e("#processor-properties").propertytable("cancelEdit").propertytable("clear");e("#processor-configuration").removeData("processorDetails");e("#processor-properties-verification-results").hide();e("#processor-properties-verification-results-listing").css("border-width","0").empty();e("#processor-properties").css("bottom","0");v=null;if(B.supportsStatusBar){e("#processor-configuration-status-bar").statusbar("disconnect")}},open:function(){j.toggleScrollable(e("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});if(B.supportsStatusBar){e("#processor-configuration-status-bar").statusbar("processor")}e("#bulletin-level-combo").combo({options:[{text:"DEBUG",value:"DEBUG"},{text:"INFO",value:"INFO"},{text:"WARN",value:"WARN"},{text:"ERROR",value:"ERROR"},{text:"NONE",value:"NONE"}]});e("#run-duration-slider").slider({min:0,max:l.length-1,change:function(H,I){var G=e("#processor-configuration").data("processorDetails");if(I.value>0&&(G.inputRequirement==="INPUT_FORBIDDEN"||G.inputRequirement==="INPUT_ALLOWED")){e("#run-duration-data-loss").show()}else{e("#run-duration-data-loss").hide()}}});e("#processor-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-processor-property-container",descriptorDeferred:function(H,G){var I=e("#processor-configuration").data("processorDetails");var J=o.get(I.id);return e.ajax({type:"GET",url:J.uri+"/descriptors",data:{propertyName:H,sensitive:G},dataType:"json"}).fail(h.handleAjaxError)},parameterDeferred:function(G,H){return e.Deferred(function(I){if(j.isDefinedAndNotNull(H)){var J=x.getParameterContext();if(j.isDefinedAndNotNull(J)){e.ajax({type:"GET",url:"../nifi-api/parameter-contexts/"+encodeURIComponent(J.id),data:{includeInheritedParameters:"true"},dataType:"json"}).done(function(K){I.resolve(K.component.parameters.map(function(L){return L.parameter}).filter(function(L){return L.sensitive===G}))}).fail(function(){I.resolve([])})}else{I.resolve([])}}else{I.resolve([])}}).promise()},goToServiceDeferred:s,getParameterContext:function(G){return x.getParameterContext()}})},showConfiguration:function(H,F){if(x.isProcessor(H)){var I=H.datum();var G=I.component;var J=[];J.push(o.reload(G.id));J.push(e.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(G.id),dataType:"json"}));e.when.apply(window,J).done(function(U,X){var V=U[0];var P=V.bulletins;G=V.component;var Q=X[0].componentHistory;e("#processor-configuration").data("processorDetails",G);var O="checkbox-checked";if(G.state==="DISABLED"){O="checkbox-unchecked"}e("#processor-id").text(G.id);e("#processor-type").text(j.formatType(G));e("#processor-configuration").modal("setSubtitle",j.formatType(G));e("#processor-bundle").text(j.formatBundle(G.bundle));e("#processor-name").val(G.name);e("#processor-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(O);e("#penalty-duration").val(G.config.penaltyDuration);e("#yield-duration").val(G.config.yieldDuration);e("#processor-comments").val(G.config.comments);if(G.supportsBatching===true){e("#run-duration-setting-container").show();var W=l.indexOf(G.config.runDurationMillis);e("#run-duration-slider").slider("value",W)}else{e("#run-duration-setting-container").hide()}e("#bulletin-level-combo").combo("setSelectedOption",{value:G.config.bulletinLevel});var L=G.config.schedulingStrategy;e("#scheduling-strategy-combo").combo({options:r(G),selectedOption:{value:L},select:function(aa){if(aa.value==="CRON_DRIVEN"){e("#timer-driven-options").hide();e("#cron-driven-options").show()}else{e("#timer-driven-options").show();e("#cron-driven-options").hide()}}});var K=G.config.executionNode;e("#execution-node-combo").combo({options:d(G),selectedOption:{value:K}});e("#execution-node-options").show();var Z=G.config.defaultConcurrentTasks;e("#timer-driven-concurrently-schedulable-tasks").val(Z.TIMER_DRIVEN);e("#cron-driven-concurrently-schedulable-tasks").val(Z.CRON_DRIVEN);var S;if(L==="CRON_DRIVEN"){S=e("#cron-driven-concurrently-schedulable-tasks").val(G.config.concurrentlySchedulableTaskCount)}else{S=e("#timer-driven-concurrently-schedulable-tasks").val(G.config.concurrentlySchedulableTaskCount)}if(j.isDefinedAndNotNull(S)){if(G.supportsParallelProcessing===true){S.prop("disabled",false)}else{S.prop("disabled",true)}}var M=G.config.defaultSchedulingPeriod;e("#cron-driven-scheduling-period").val(M.CRON_DRIVEN);e("#timer-driven-scheduling-period").val(M.TIMER_DRIVEN);if(G.config.schedulingStrategy==="CRON_DRIVEN"){e("#cron-driven-scheduling-period").val(G.config.schedulingPeriod)}else{e("#timer-driven-scheduling-period").val(G.config.schedulingPeriod)}if(!j.isEmpty(G.relationships)){e.each(G.relationships,function(aa,ab){q(ab)});var T=(function(){var aa=e("#auto-action-relationship-names").find("div.nf-checkbox.processor-retry-relationship.checkbox-checked").length?true:false;if(aa){e("#processor-relationships-tab-content .settings-right").show()}else{e("#processor-relationships-tab-content .settings-right").hide()}});T();e("#auto-action-relationship-names").on("change","div.nf-checkbox.processor-retry-relationship",function(){T()})}else{e("#auto-action-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}if(j.isDefinedAndNotNull(G.config.backoffMechanism)){if(G.config.backoffMechanism==="PENALIZE_FLOWFILE"){e(".backoff-policy-setting #penalizeFlowFile").prop("checked",true)}else{if(G.config.backoffMechanism==="YIELD_PROCESSOR"){e(".backoff-policy-setting #yieldEntireProcessor").prop("checked",true)}}}if(j.isDefinedAndNotNull(G.config.maxBackoffPeriod)){e(".max-backoff-setting #max-backoff-period").val(G.config.maxBackoffPeriod)}if(j.isDefinedAndNotNull(G.config.retryCount)){e(".retry-count-setting #retry-attempt-count").val(G.config.retryCount)}var R=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){return !x.supportsModification(H)},handler:{click:function(){e("#processor-properties").propertytable("saveRow");u(G).done(function(aa){b(G);e("#processor-configuration").modal("hide");E.digest()})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#processor-configuration").modal("hide")}}}];if(j.isDefinedAndNotNull(G.config.customUiUrl)&&G.config.customUiUrl!==""){R.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var aa=function(){e("#processor-configuration").modal("hide");a.showCustomUi(V,G.config.customUiUrl,true).done(function(){o.reload(G.id);b(G)})};e("#processor-properties").propertytable("saveRow");if(C()){p.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:aa,yesHandler:function(){u(G).done(function(ab){aa()})}})}else{aa()}}}})}if(B.supportsStatusBar){var Y=j.getFormattedBulletins(P);var N=j.formatUnorderedList(Y);e("#processor-configuration-status-bar").statusbar("observe",{processor:G.id,bulletins:N},function(){e("#processor-configuration").modal("refreshButtons")});if(j.isDefinedAndNotNull(B.nfActions)&&j.getKeyValue(V,A)!=0){e("#processor-configuration-status-bar").statusbar("buttons",[{buttonText:"Terminate",clazz:"fa fa-hourglass-end button-icon",color:{hover:"#C7D2D7",base:"transparent",text:"#004849"},disabled:function(){return x.supportsModification(H)},handler:{click:function(){var aa=function(){var ab=o.get(G.id);if(j.getKeyValue(ab,A)!=0){p.showOkDialog({dialogContent:"Terminate threads request was processed, but active threads still persist. Please try again later.",headerText:"Unable to Terminate"})}else{e("#processor-configuration-status-bar").statusbar("refreshButtons");e("#processor-configuration").modal("refreshButtons")}e("#processor-configuration-status-bar").statusbar("showButtons")};e("#processor-configuration-status-bar").statusbar("hideButtons");B.nfActions.terminate(H,aa)}}}])}}e("#processor-configuration").modal("setButtonModel",R);e("#processor-properties").propertytable("setGroupId",G.parentGroupId).propertytable("setSupportsSensitiveDynamicProperties",G.supportsSensitiveDynamicProperties).propertytable("loadProperties",G.config.properties,G.config.descriptors,Q.propertyHistory).propertytable("setPropertyVerificationCallback",function(aa){y.verify(G.id,V.uri,aa,v,n,e("#processor-properties-verification-results-listing"))});e("#processor-configuration").modal("show");e("#processor-configuration div.relationship-name").ellipsis();if(e("#processor-configuration-tabs").find(".selected-tab").text()==="Properties"){e("#processor-properties").propertytable("resetTableSize")}if(typeof F=="function"){F()}}).fail(h.handleAjaxError)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.UniversalCapture","nf.Dialog","nf.ErrorHandler","nf.CustomUi","nf.ClusterSummary","nf.CanvasUtils"],function(g,h,j,f,i,e,c,d){return(nf.ProcessorDetails=b(g,h,j,f,i,e,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorDetails=b(require("jquery"),require("nf.Common"),require("nf.UniversalCapture"),require("nf.Dialog"),require("nf.ErrorHandler"),require("nf.CustomUi"),require("nf.ClusterSummary"),require("nf.CanvasUtils")))}else{nf.ProcessorDetails=b(a.$,a.nf.Common,a.nf.UniversalCapture,a.nf.Dialog,a.nf.ErrorHandler,a.nf.CustomUi,a.nf.ClusterSummary,a.nf.CanvasUtils)}}}(this,function(e,b,f,d,g,h,i,c){var a;var j=function(q){var s=e('<span class="relationship-name-value hidden"></span>').text(q.name);var p=e('<div class="processor-terminate-relationship nf-checkbox disabled"></div>');var r=e('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text("terminate");if(q.autoTerminate===true){p.addClass("checkbox-checked")}else{p.addClass("checkbox-unchecked")}var n=e('<div class="processor-terminate-relationship-container"></div>').append(p).append(r);var u=e('<div class="processor-retry-relationship nf-checkbox disabled"></div>');var o=e('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text("retry");if(q.retry===true){u.addClass("checkbox-checked")}else{u.addClass("checkbox-unchecked")}var l=e('<div class="processor-retry-relationship-container"></div>').append(u).append(o);var t=e("<div></div>").text(q.name);var k=e('<div class="processor-relationship-container"></div>').append(t).append(n).append(l).append(s).appendTo("#read-only-auto-action-relationship-names");if(!b.isBlank(q.description)){var m=e('<div class="relationship-description"></div>').text(q.description);k.append(m)}return k};return{init:function(k){a=k;e("#processor-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"details-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"details-scheduling-tab-content"},{name:"Properties",tabContentId:"details-processor-properties-tab-content"},{name:"Relationships",tabContentId:"details-processor-relationships-tab-content"},{name:"Comments",tabContentId:"details-processor-comments-tab-content"}],select:function(){f.removeAllPropertyDetailDialogs();if(e(this).text()==="Properties"){e("#read-only-processor-properties").propertytable("resetTableSize")}}});e("#processor-details").modal({headerText:"Processor Details",scrollableContentStyle:"scrollable",handler:{close:function(){e("#read-only-auto-action-relationship-names").empty();e("#read-only-processor-properties").propertytable("clear");b.clearField("read-only-processor-id");b.clearField("read-only-processor-type");b.clearField("read-only-processor-name");b.clearField("read-only-concurrently-schedulable-tasks");b.clearField("read-only-scheduling-period");b.clearField("read-only-penalty-duration");b.clearField("read-only-yield-duration");b.clearField("read-only-run-duration");b.clearField("read-only-bulletin-level");b.clearField("read-only-execution-node");b.clearField("read-only-execution-status");b.clearField("read-only-processor-comments");e("#processor-details").removeData("processorDetails");e("#processor-details").removeData("processorHistory");if(a.supportsStatusBar){e("#processor-details-status-bar").statusbar("disconnect")}},open:function(){b.toggleScrollable(e("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});if(a.supportsStatusBar){e("#processor-details-status-bar").statusbar("processor")}e("#read-only-processor-properties").propertytable(Object.assign({supportsGoTo:a.supportsGoTo,readOnly:true},c&&{getParameterContext:function(l){return c.getParameterContext()}}))},showDetails:function(m,n){var l=e.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(n),dataType:"json"}).done(function(p){if(b.isDefinedAndNotNull(p.component)){var r=p.component;e("#processor-details").data("processorDetails",r);e("#processor-details").modal("setSubtitle",b.formatType(r));b.populateField("read-only-processor-id",r.id);b.populateField("read-only-processor-type",b.formatType(r));b.populateField("read-only-processor-bundle",b.formatBundle(r.bundle));b.populateField("read-only-processor-name",r.name);b.populateField("read-only-concurrently-schedulable-tasks",r.config.concurrentlySchedulableTaskCount);b.populateField("read-only-scheduling-period",r.config.schedulingPeriod);b.populateField("read-only-penalty-duration",r.config.penaltyDuration);b.populateField("read-only-yield-duration",r.config.yieldDuration);b.populateField("read-only-run-duration",b.formatDuration(r.config.runDurationMillis));b.populateField("read-only-bulletin-level",r.config.bulletinLevel);b.populateField("read-only-processor-comments",r.config.comments);var o=true;var t=r.config.schedulingStrategy;if(t==="CRON_DRIVEN"){t="CRON driven"}else{t="Timer driven"}b.populateField("read-only-scheduling-strategy",t);if(o===true){e("#read-only-run-schedule").show()}else{e("#read-only-run-schedule").hide()}var s=r.config.executionNode;if(s==="ALL"){s="All nodes"}else{if(s==="PRIMARY"){s="Primary node only"}}b.populateField("read-only-execution-node",s);e("#read-only-execution-node-options").show();if(!b.isEmpty(r.relationships)){e.each(r.relationships,function(u,v){j(v)});var q=(function(){var u=e("#read-only-auto-action-relationship-names").find("div.nf-checkbox.processor-retry-relationship.checkbox-checked").length?true:false;if(u){e("#details-processor-relationships-tab-content .settings-right").show()}else{e("#details-processor-relationships-tab-content .settings-right").hide()}});q()}else{e("#read-only-auto-action-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}if(b.isDefinedAndNotNull(r.config.backoffMechanism)){if(r.config.backoffMechanism==="PENALIZE_FLOWFILE"){e(".details-backoff-policy-setting #penalizeFlowFile").prop("checked",true)}else{if(r.config.backoffMechanism==="YIELD_PROCESSOR"){e(".details-backoff-policy-setting #yieldEntireProcessor").prop("checked",true)}}}if(b.isDefinedAndNotNull(r.config.maxBackoffPeriod)){e(".details-max-backoff-setting #details-max-backoff-period").text(r.config.maxBackoffPeriod)}if(b.isDefinedAndNotNull(r.config.retryCount)){e(".details-retry-count-setting #details-retry-attempt-count").text(r.config.retryCount)}}});var k=e.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(n),dataType:"json"}).done(function(o){var p=o.componentHistory;e("#processor-details").data("processorHistory",p)});e.when(l,k).done(function(t,x){var u=t[0];var o=u.component;var w=x[0];var r=w.componentHistory;var v;e("#read-only-processor-properties").propertytable("setGroupId",o.parentGroupId).propertytable("loadProperties",o.config.properties,o.config.descriptors,r.propertyHistory);var s=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#processor-details").modal("hide")}}}];if(top===window&&b.isDefinedAndNotNull(h)&&b.isDefinedAndNotNull(o.config.customUiUrl)&&o.config.customUiUrl!==""){s.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#processor-details").modal("hide");h.showCustomUi(u,o.config.customUiUrl,false)}}})}if(a.supportsStatusBar&&b.isDefinedAndNotNull(a.nfCanvasUtils)){var y=b.getFormattedBulletins(u.bulletins);var q=b.formatUnorderedList(y);e("#processor-details-status-bar").statusbar("observe",{processor:o.id,bulletins:q});v=a.nfCanvasUtils.getSelectionById(o.id);if(b.isDefinedAndNotNull(a.nfActions)&&a.nfCanvasUtils.isProcessor(v)&&a.nfCanvasUtils.canModify(v)){var p=function(){var z=e("#processor-details-tabs").find(".selected-tab").text();e("#processor-configuration-tabs").find('.tab:contains("'+z+'")').trigger("click");e("#processor-details").modal("hide");e("#processor-details-status-bar").statusbar("showButtons")};e("#processor-details-status-bar").statusbar("buttons",[{buttonHtml:'<i class="fa fa-stop stop-configure-icon" aria-hidden="true"></i><span>Stop & Configure</span>',clazz:"button button-icon auto-width",color:{hover:"#C7D2D7",base:"transparent",text:"#004849"},disabled:function(){return !a.nfCanvasUtils.isStoppable(v)},handler:{click:function(){e("#processor-details-status-bar").statusbar("hideButtons");a.nfActions.stopAndConfigure(v,p)}}},{buttonText:"Configure",clazz:"fa fa-cog button-icon",color:{hover:"#C7D2D7",base:"transparent",text:"#004849"},disabled:function(){return a.nfCanvasUtils.isStoppable(v)},handler:{click:function(){e("#processor-details-status-bar").statusbar("hideButtons");a.nfActions.showConfiguration(v,p)}}}])}}e("#processor-details").modal("setButtonModel",s).modal("show");e("#processor-details div.relationship-name").ellipsis()}).fail(g.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage","nf.ErrorHandler","nf.Common","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Label"],function(f,j,g,i,c,k,d,h,e){return(nf.LabelConfiguration=b(f,j,g,i,c,k,d,h,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.LabelConfiguration=b(require("jquery"),require("d3"),require("nf.Storage"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Label")))}else{nf.LabelConfiguration=b(a.$,a.d3,a.nf.Storage,a.nf.ErrorHandler,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Label)}}}(this,function(e,i,f,h,b,j,c,g,d){var a="";return{init:function(){e("#label-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Label",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var o=this;var p=i.select("#id-"+a).datum();var n=e("#label-value").val();var q=e("#label-font-size").combo("getSelectedOption");var m={revision:j.getRevision(p),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{id:a,label:n,style:{"font-size":q.value}}};e.ajax({type:"PUT",url:p.uri,data:JSON.stringify(m),dataType:"json",contentType:"application/json"}).done(function(r){d.set(r);g.digest();o.modal("hide")}).fail(h.handleConfigurationUpdateAjaxError)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){a=""},open:function(){e("#label-value").focus()}}});var l=[];for(var k=12;k<=24;k+=2){l.push({text:k+"px",value:k+"px"})}e("#label-font-size").combo({options:l,selectedOption:{value:"12px"},select:function(n){var m=e("#label-value");m.css({"font-size":n.value,"line-height":n.value}).val(m.val())}})},showConfiguration:function(l){if(c.isLabel(l)){var n=l.datum();var k="";if(b.isDefinedAndNotNull(n.component.label)){k=n.component.label}var m="12px";if(b.isDefinedAndNotNull(n.component.style["font-size"])){m=n.component.style["font-size"]}a=n.id;e("#label-value").val(k);e("#label-font-size").combo("setSelectedOption",{value:m});e("#label-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Port"],function(g,k,j,c,e,h,l,d,i,f){return(nf.PortConfiguration=b(g,k,j,c,e,h,l,d,i,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PortConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Port")))}else{nf.PortConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Port)}}}(this,function(f,j,i,b,d,g,k,c,h,e){var a=function(){f("#port-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Port",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var o=f("#port-id").text();var m=j.select("#id-"+o).datum();var l={id:o,name:f("#port-name").val(),comments:f("#port-comments").val()};if(f("#port-concurrent-task-container").is(":visible")){l.concurrentlySchedulableTaskCount=f("#port-concurrent-tasks").val()}if(f("#port-enabled").hasClass("checkbox-unchecked")){l.state="DISABLED"}else{if(f("#port-enabled").hasClass("checkbox-checked")){l.state="STOPPED"}}if(f("#failure-port").hasClass("checkbox-checked")){l.portFunction="FAILURE"}else{l.portFunction="STANDARD"}var n={revision:k.getRevision(m),disconnectedNodeAcknowledged:g.isDisconnectionAcknowledged(),component:l};f.ajax({type:"PUT",data:JSON.stringify(n),url:m.uri,dataType:"json",contentType:"application/json"}).done(function(p){e.set(p);h.digest();f("#port-configuration").modal("hide")}).fail(i.handleConfigurationUpdateAjaxError)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#port-configuration").modal("hide")}}}],handler:{close:function(){f("#port-id").text("");f("#port-name").val("");f("#port-enabled").removeClass("checkbox-unchecked checkbox-checked");f("#port-concurrent-tasks").val("");f("#port-comments").val("")}}})};return{init:function(){a()},showConfiguration:function(n){if(c.isInputPort(n)||c.isOutputPort(n)){var o=n.datum();var l="checkbox-checked";if(o.component.state==="DISABLED"){l="checkbox-unchecked"}if(o.allowRemoteAccess===true){f("#port-concurrent-task-container").show()}else{f("#port-concurrent-task-container").hide()}if(c.isOutputPort(n)){f("#port-failure-container").show()}else{f("#port-failure-container").hide()}f("#port-id").text(o.id);f("#port-name").val(o.component.name);f("#port-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(l);f("#port-concurrent-tasks").val(o.component.concurrentlySchedulableTaskCount);f("#port-comments").val(o.component.comments);var m="checkbox-unchecked";if(o.component.portFunction==="FAILURE"){m="checkbox-checked"}f("#failure-port").removeClass("checkbox-unchecked checkbox-checked").addClass(m);f("#port-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.CanvasUtils"],function(d,e,c){return(nf.PortDetails=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PortDetails=b(require("jquery"),require("nf.Common"),require("nf.CanvasUtils")))}else{nf.PortDetails=b(a.$,a.nf.Common,a.nf.CanvasUtils)}}}(this,function(b,c,a){return{init:function(){b("#port-details").modal({scrollableContentStyle:"scrollable",headerText:"Port Details",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#port-details").modal("hide")}}}],handler:{close:function(){c.clearField("read-only-port-name");c.clearField("read-only-port-id");c.clearField("read-only-port-comments")}}})},showDetails:function(d){if(a.isInputPort(d)||a.isOutputPort(d)){var e=d.datum();c.populateField("read-only-port-name",e.component.name);c.populateField("read-only-port-id",e.id);c.populateField("read-only-port-allow-remote-access",true===e.allowRemoteAccess?"true":"false");c.populateField("read-only-port-concurrent-tasks",e.component.concurrentlySchedulableTaskCount);c.populateField("read-only-port-comments",e.component.comments);b("#port-details").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.ProcessGroup","nf.Shell","nf.CanvasUtils"],function(h,k,j,f,g,i,l,c,d,e){return(nf.ProcessGroupConfiguration=b(h,k,j,f,g,i,l,c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessGroupConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ProcessGroup"),require("nf.Shell"),require("nf.CanvasUtils")))}else{nf.ProcessGroupConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ProcessGroup,a.nf.Shell,a.nf.CanvasUtils)}}}(this,function(e,t,g,i,k,f,u,h,r,o){var d;var m;var b;var s={urls:{api:"../nifi-api",parameterContexts:"../nifi-api/flow/parameter-contexts"}};var l=function(){};var c=function(){return e("#process-group-controller-services-table")};var a=function(v,x){var y;if(e("#parameter-contexts-recursive").hasClass("checkbox-unchecked")){y="DIRECT_CHILDREN"}else{y="ALL_DESCENDANTS"}var w={revision:u.getRevision({revision:{version:v}}),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),processGroupUpdateStrategy:y,component:{id:x,name:e("#process-group-name").val(),comments:e("#process-group-comments").val(),parameterContext:{id:e("#process-group-parameter-context-combo").combo("getSelectedOption").value},executionEngine:e("#process-group-execution-engine-combo").combo("getSelectedOption").value,maxConcurrentTasks:e("#process-group-max-concurrent-tasks").val(),statelessFlowTimeout:e("#process-group-stateless-flow-timeout").val(),flowfileConcurrency:e("#process-group-flowfile-concurrency-combo").combo("getSelectedOption").value,flowfileOutboundPolicy:e("#process-group-outbound-policy-combo").combo("getSelectedOption").value,defaultFlowFileExpiration:e("#process-group-default-flowfile-expiration").val(),defaultBackPressureObjectThreshold:e("#process-group-default-back-pressure-object-threshold").val(),defaultBackPressureDataSizeThreshold:e("#process-group-default-back-pressure-data-size-threshold").val(),logFileSuffix:e("#process-group-log-file-suffix").val()}};e.ajax({type:"PUT",data:JSON.stringify(w),url:s.urls.api+"/process-groups/"+encodeURIComponent(x),dataType:"json",contentType:"application/json"}).done(function(A){if(A.permissions.canRead&&A.component.parentGroupId===o.getGroupId()){h.set(A)}k.showOkDialog({headerText:"Process Group Configuration",dialogContent:"Process group configuration successfully saved."});e("#process-group-configuration-save").off("click").on("click",function(){a(A.revision.version,x)});var z=s.urls.api+"/flow/process-groups/"+encodeURIComponent(x)+"/controller-services";e.ajax({type:"GET",url:z,dataType:"json",data:{uiOnly:true}}).done(function(B){var D=c();i.cleanUpTooltips(D,"div.has-errors");var C=D.data("gridInstance");var E=C.getData();e.each(B.controllerServices,function(G,F){E.updateItem(F.id,F)})});o.reload()}).fail(g.handleConfigurationUpdateAjaxError)};var n=function(x){var A=function(){e("#read-only-process-group-name").text("Unauthorized");e("#read-only-process-group-comments").text("Unauthorized");e("#read-only-process-group-execution-engine").text("Unauthorized");e("#read-only-process-group-max-concurrent-tasks").text("Unauthorized");e("#read-only-process-group-stateless-flow-timeout").text("Unauthorized");e("#read-only-process-group-default-flowfile-expiration").text("Unauthorized");e("#read-only-process-group-default-back-pressure-object-threshold").text("Unauthorized");e("#read-only-process-group-default-back-pressure-data-size-threshold").text("Unauthorized")};var z=function(C){if(C){e("#process-group-configuration div.editable").show();e("#process-group-configuration div.read-only").hide();e("#process-group-configuration-save").show()}else{e("#process-group-configuration div.editable").hide();e("#process-group-configuration div.read-only").show();e("#process-group-configuration-save").hide()}};e("#process-group-id").text(x);e("#process-group-configuration-refresh-button").off("click").on("click",function(){n(x)});e("#add-process-group-configuration-controller-service").off("click").on("click",function(){var D=e("#process-group-configuration-tabs li.selected-tab").text();if(D==="Controller Services"){var C=s.urls.api+"/process-groups/"+encodeURIComponent(x)+"/controller-services";d.promptNewControllerService(C,c())}});var y=e.Deferred(function(C){e.ajax({type:"GET",url:s.urls.api+"/process-groups/"+encodeURIComponent(x),dataType:"json",data:{uiOnly:true}}).done(function(D){e("#process-group-configuration").data("process-group",D);var G=D.component;if(D.permissions.canWrite){e("#process-group-name").removeClass("unset").val(G.name);e("#process-group-comments").removeClass("unset").val(G.comments);e("#process-group-execution-engine-combo").removeClass("unset").combo({options:[{text:"Inherited",value:"INHERITED",description:"Use whichever Execution Engine the parent Process Group is configured to use."},{text:"Standard",value:"STANDARD",description:"Use the Standard NiFi Execution Engine. See the User Guide for additional details."},{text:"Stateless",value:"STATELESS",description:"Run the dataflow using the Stateless Execution Engine. See the User Guide for additional detials."}],selectedOption:{value:G.executionEngine},select:function(I){if(I.value==="STATELESS"){e("#stateless-group-options").show()}else{e("#stateless-group-options").hide()}}});e("#process-group-max-concurrent-tasks").removeClass("unset").val(G.maxConcurrentTasks);e("#process-group-stateless-flow-timeout").removeClass("unset").val(G.statelessFlowTimeout);e("#process-group-flowfile-concurrency-combo").removeClass("unset").combo({options:[{text:"Single FlowFile Per Node",value:"SINGLE_FLOWFILE_PER_NODE",description:"Only a single FlowFile is to be allowed to enter the Process Group at a time on each node in the cluster. While that FlowFile may be split into many or spawn many children, no additional FlowFiles will be allowed to enter the Process Group through a Local Input Port until the previous FlowFile - and all of its child/descendent FlowFiles - have been processed."},{text:"Single Batch Per Node",value:"SINGLE_BATCH_PER_NODE",description:"When an Input Port pulls a FlowFile into the Process Group, FlowFiles will continue to be ingested into the Process Group until all input queues have been emptied. At that point, no additional FlowFiles will be allowed to enter the Process Group through a Local Input Port until the entire batch of FlowFiles has been processed."},{text:"Unbounded",value:"UNBOUNDED",description:"The number of FlowFiles that can be processed concurrently is unbounded."}],selectedOption:{value:G.flowfileConcurrency}});e("#process-group-outbound-policy-combo").removeClass("unset").combo({options:[{text:"Stream When Available",value:"STREAM_WHEN_AVAILABLE",description:"FlowFiles that are queued up to be transferred out of a Process Group by an Output Port will be transferred out of the Process Group as soon as they are available."},{text:"Batch Output",value:"BATCH_OUTPUT",description:"FlowFiles that are queued up to be transferred out of a Process Group by an Output Port will remain queued until all FlowFiles in the Process Group are ready to be transferred out of the group. The FlowFiles will then be transferred out of the group. This setting will be ignored if the FlowFile Concurrency is Unbounded."}],selectedOption:{value:G.flowfileOutboundPolicy}});e("#process-group-default-flowfile-expiration").removeClass("unset").val(G.defaultFlowFileExpiration);e("#process-group-default-back-pressure-object-threshold").removeClass("unset").val(G.defaultBackPressureObjectThreshold);e("#process-group-default-back-pressure-data-size-threshold").removeClass("unset").val(G.defaultBackPressureDataSizeThreshold);e("#process-group-log-file-suffix").removeClass("unset").val(G.logFileSuffix);e("#process-group-configuration-header-text").text(G.name+" Configuration");z(true);e("#process-group-configuration-save").off("click").on("click",function(){a(D.revision.version,D.id)})}else{if(D.permissions.canRead){e("#read-only-process-group-name").text(G.name);e("#read-only-process-group-comments").text(G.comments);var E;if(G.executionEngine=="INHERITED"){E="Inherited"}else{if(G.executionEngine=="STANDARD"){E="Standard"}else{if(G.executionEngine=="STATELESS"){E="Stateless"}}}e("#read-only-process-group-execution-engine").text(E);e("#read-only-process-group-max-concurrent-tasks").text(G.maxConcurrentTasks);e("#read-only-process-group-stateless-flow-timeout").text(G.maxConcurrentTasks);var H;if(G.flowfileConcurrency=="UNBOUNDED"){H="Unbounded"}else{if(G.flowfileConcurrency=="SINGLE_FLOWFILE_PER_NODE"){H="Single FlowFile Per Node"}else{if(G.flowfileConcurrency=="SINGLE_BATCH_PER_NODE"){H="Single Batch Per Node"}else{H="Unknown"}}}e("#read-only-process-group-flowfile-concurrency").text(H);var F=G.flowfileOutboundPolicy=="BATCH_OUTPUT"?"Batch Output":"Stream When Available";e("#read-only-process-group-outbound-policy").text(F);e("#process-group-configuration-header-text").text(G.name+" Configuration");e("#process-group-default-flowfile-expiration").text(G.defaultFlowFileExpiration);e("#process-group-default-back-pressure-object-threshold").text(G.defaultBackPressureObjectThreshold);e("#process-group-default-back-pressure-data-size-threshold").text(G.defaultBackPressureDataSizeThreshold);e("#read-only-process-group-default-flowfile-expiration").text(G.defaultFlowFileExpiration);e("#read-only-process-group-default-back-pressure-object-threshold").text(G.defaultBackPressureObjectThreshold);e("#read-only-process-group-default-back-pressure-data-size-threshold").text(G.defaultBackPressureDataSizeThreshold);e("#read-only-process-group-log-file-suffix").text(G.logFileSuffix)}else{A()}z(false)}C.resolve(D)}).fail(function(G,D,E){if(G.status===403){var F;if(x===o.getGroupId()){F={permissions:{canRead:false,canWrite:o.canWriteCurrentGroup()}}}else{F=h.get(x)}e("#process-group-configuration").data("process-group",F);A();z(false);C.resolve(F)}else{C.reject(G,D,E)}})}).promise();var v=s.urls.api+"/flow/process-groups/"+encodeURIComponent(x)+"/controller-services";var w=d.loadControllerServices(v,c());var B=e.ajax({type:"GET",url:s.urls.parameterContexts,dataType:"json"});return e.when(y,w,B).done(function(F,I,D){var J=I[0];var K=D[0];e("#process-group-configuration-last-refreshed").text(J.currentTime);var E=K.parameterContexts;var L=[{text:"No parameter context",value:null}];var C=i.sortParameterContextsAlphabeticallyBasedOnAuthorization(E);C.forEach(function(N){var M;if(N.permissions.canRead){M={text:N.component.name,value:N.id,description:N.component.description}}else{M={disabled:true,text:N.id,value:N.id}}L.push(M)});var H={text:"Create new parameter context...",value:undefined,optionClass:"unset"};if(i.canModifyParameterContexts()){L.push(H)}var G={options:L,select:function(M){var N=this;if(typeof M.value==="undefined"){e("#parameter-context-dialog").modal("setHeaderText","Add Parameter Context").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(e("#parameter-context-name").val()!==""){return false}return true},handler:{click:function(){m.addParameterContext(function(P){L.pop();var O={text:P.component.name,value:P.component.id,description:P.component.description};L.push(O);if(i.canModifyParameterContexts()){L.push(H)}G.selectedOption={value:P.component.id};N.combo("destroy").combo(G)})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e(this).modal("hide")}}}]).modal("show");if(e("#parameter-context-dialog").hasClass("read-only")){e("#parameter-context-dialog").removeClass("read-only");e("#parameter-context-dialog").addClass("edit-mode")}if(!e("#parameter-context-id-setting").hasClass("hidden")){e("#parameter-context-id-setting").addClass("hidden")}e("#parameter-context-name").focus()}}};if(i.isDefinedAndNotNull(F.parameterContext)){G.selectedOption={value:F.parameterContext.id}}e("#process-group-parameter-context-combo").combo("destroy").combo(G);e("#parameter-contexts-recursive").removeClass().addClass("nf-checkbox checkbox-unchecked")}).fail(g.handleAjaxError)};var p=function(){r.showContent("#process-group-configuration").done(function(){q()});e("#process-group-configuration-tabs").find(".selected-tab").click();j.resetTableSize()};var q=function(){e("#process-group-configuration").removeData("process-group");e("#process-group-configuration-save").mouseout();e("#process-group-id").text("");e("#process-group-name").val("");e("#process-group-comments").val("");e("#process-group-execution-engine").val("INHERITED");e("#process-group-max-concurrent-tasks").val("1");e("#process-group-stateless-flow-timeout").val("1 min");e("#process-group-default-flowfile-expiration").val("");e("#process-group-default-back-pressure-object-threshold").val("");e("#process-group-default-back-pressure-data-size-threshold").val("");e("#process-group-configuration-header-text").text("Process Group Configuration")};var j={init:function(w,v){d=w;m=v;e("#process-group-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-process-group-configuration-tab-content"},{name:"Controller Services",tabContentId:"process-group-controller-services-tab-content"}],select:function(){var y=e("#process-group-configuration").data("process-group");var z=i.isDefinedAndNotNull(y)?y.permissions.canWrite:false;var x=e(this).text();if(x==="General"){e("#flow-cs-availability").hide();e("#add-process-group-configuration-controller-service").hide();if(z){e("#process-group-configuration-save").show()}else{e("#process-group-configuration-save").hide()}}else{e("#flow-cs-availability").show();e("#process-group-configuration-save").hide();if(z){e("#add-process-group-configuration-controller-service").show();e("#process-group-controller-services-tab-content").css("top","32px")}else{e("#add-process-group-configuration-controller-service").hide();e("#process-group-controller-services-tab-content").css("top","0")}j.resetTableSize()}}});l();d.init(c())},resetTableSize:function(){d.resetTableSize(c())},showConfiguration:function(v){return n(v).done(p)},loadConfiguration:function(v){return n(v)},selectControllerService:function(v){var w=c().data("gridInstance");var x=w.getData();var y=x.getRowById(v);w.setSelectedRows([y]);w.scrollRowIntoView(y);e("#process-group-configuration-tabs").find("li:eq(1)").click()}};return j}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Storage","nf.Client","nf.CanvasUtils","nf.ProcessGroupConfiguration","nf.ng.Bridge"],function(g,d,j,e,h,k,f,c,i){return(nf.ComponentState=b(g,j,e,h,k,f,c,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ComponentState=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ProcessGroupConfiguration"),require("nf.ng.Bridge")))}else{nf.ComponentVersion=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.ProcessGroupConfiguration,a.nf.ng.Bridge)}}}(this,function(h,k,e,i,n,f,c,j){var a;var d;var b=function(o){if(o.type==="ReportingTask"){return"../nifi-api/flow/reporting-task-types"}else{if(o.type==="FlowAnalysisRule"){return"../nifi-api/flow/flow-analysis-rule-types"}else{if(o.type==="ControllerService"){return"../nifi-api/flow/controller-service-types"}else{return"../nifi-api/flow/processor-types"}}}};var g=function(o){if(o.type==="ReportingTask"){return"reportingTaskTypes"}else{if(o.type==="ControllerService"){return"controllerServiceTypes"}else{if(o.type==="FlowAnalysisRule"){return"flowAnalysisRuleTypes"}else{return"processorTypes"}}}};var m=function(){var o=Array.from(a.keys());h.each(o,function(q,p){a["delete"](p)});h("#component-version-controller-service-apis").empty();h("#component-version-controller-service-apis-container").hide();h("#component-version-name").text("");h("#component-version-bundle").text("");h("#component-version-tags").text("");h("#component-version-restriction").removeClass("unset").text("");h("#component-version-description").text("");h("#component-version-selector").combo("destroy");h("#component-version-dialog").removeData("component")};var l=function(q){var r=a.get(q.value);if(e.isDefinedAndNotNull(r.usageRestriction)){h("#component-version-restriction").text(r.usageRestriction)}else{h("#component-version-restriction").addClass("unset").text("No restriction")}if(!e.isEmpty(r.controllerServiceApis)){var o=e.getFormattedServiceApis(r.controllerServiceApis);var p=e.formatUnorderedList(o);h("#component-version-controller-service-apis").empty().append(p);h("#component-version-controller-service-apis-container").show()}h("#component-version-tags").text(r.tags.join(", "));h("#component-version-description").text(r.description)};return{init:function(o){a=new Map();d=o;h("#component-version-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Component Version",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var r=h("#component-version-selector").combo("getSelectedOption");var s=a.get(r.value);var q=h("#component-version-dialog").data("component");var p={revision:n.getRevision(q),disconnectedNodeAcknowledged:i.isDisconnectionAcknowledged(),component:{id:q.id,bundle:{group:s.bundle.group,artifact:s.bundle.artifact,version:s.bundle.version}}};h.ajax({type:"PUT",url:q.uri,data:JSON.stringify(p),dataType:"json",contentType:"application/json"}).done(function(u){if(q.type==="Processor"){f.getComponentByType(q.type).set(u);j.digest()}else{if(q.type==="ControllerService"){var t=q.component.parentGroupId;h.Deferred(function(v){if(e.isDefinedAndNotNull(t)){if(h("#process-group-configuration").is(":visible")){c.loadConfiguration(t).done(function(){v.resolve()})}else{c.showConfiguration(t).done(function(){v.resolve()})}}else{if(h("#settings").is(":visible")){d.loadSettings().done(function(){v.resolve()})}else{d.showSettings().done(function(){v.resolve()})}}}).done(function(){if(e.isDefinedAndNotNull(t)){c.selectControllerService(q.id)}else{d.selectControllerService(q.id)}})}else{if(q.type==="ReportingTask"){h.Deferred(function(v){if(h("#settings").is(":visible")){d.loadSettings().done(function(){v.resolve()})}else{d.showSettings().done(function(){v.resolve()})}}).done(function(){d.selectReportingTask(q.id)})}else{if(q.type==="FlowAnalysisRule"){h.Deferred(function(v){if(h("#settings").is(":visible")){d.loadSettings().done(function(){v.resolve()})}else{d.showSettings().done(function(){v.resolve()})}}).done(function(){d.selectFlowAnalysisRule(q.id)})}}}}}).fail(k.handleAjaxError);this.modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){m()}}})},promptForVersionChange:function(o){var p={bundleGroupFilter:o.component.bundle.group,bundleArtifactFilter:o.component.bundle.artifact};if(g(o)==="controllerServiceTypes"){p.typeFilter=o.component.type}else{p.type=o.component.type}return h.ajax({type:"GET",url:b(o)+"?"+h.param(p),dataType:"json"}).done(function(q){var r=[];var s;h.each(q[g(o)],function(t,w){var v=w.type;a.set(w.bundle.version,w);var u={text:w.bundle.version,value:w.bundle.version,description:e.escapeHtml(w.description)};if(w.bundle.version===o.component.bundle.version){s=u}r.push(u)});r.sort(function(u,t){return -e.sortVersion(u.text,t.text)});h("#component-version-name").text(o.component.name);h("#component-version-bundle").text(e.formatBundle(o.component.bundle));h("#component-version-selector").combo({options:r,selectedOption:s,select:l});h("#component-version-dialog").data("component",o).modal("show")}).fail(k.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.RemoteProcessGroup"],function(g,k,j,d,f,h,l,e,i,c){return(nf.RemoteProcessGroupConfiguration=b(g,k,j,d,f,h,l,e,i,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.RemoteProcessGroup")))}else{nf.RemoteProcessGroupConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.RemoteProcessGroup)}}}(this,function(e,i,h,b,d,f,j,c,g,a){return{init:function(){e("#remote-process-group-configuration").modal({headerText:"Configure Remote Process Group",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var k=e("#remote-process-group-id").text();var l=i.select("#id-"+k).datum();var m={revision:j.getRevision(l),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{id:k,targetUris:e("#remote-process-group-urls").val(),communicationsTimeout:e("#remote-process-group-timeout").val(),yieldDuration:e("#remote-process-group-yield-duration").val(),transportProtocol:e("#remote-process-group-transport-protocol-combo").combo("getSelectedOption").value,proxyHost:e("#remote-process-group-proxy-host").val(),proxyPort:e("#remote-process-group-proxy-port").val(),proxyUser:e("#remote-process-group-proxy-user").val(),proxyPassword:e("#remote-process-group-proxy-password").val(),localNetworkInterface:e("#remote-process-group-local-network-interface").val()}};e.ajax({type:"PUT",data:JSON.stringify(m),url:l.uri,dataType:"json",contentType:"application/json"}).done(function(n){a.set(n);g.digest();e("#remote-process-group-configuration").modal("hide")}).fail(h.handleConfigurationUpdateAjaxError)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#remote-process-group-configuration").modal("hide")}}}],handler:{close:function(){e("#remote-process-group-id").text("");e("#remote-process-group-name").text("");e("#remote-process-group-urls").val("");e("#remote-process-group-timeout").val("");e("#remote-process-group-yield-duration").val("");e("#remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:"RAW"});e("#remote-process-group-local-network-interface").val("");e("#remote-process-group-proxy-host").val("");e("#remote-process-group-proxy-port").val("");e("#remote-process-group-proxy-user").val("");e("#remote-process-group-proxy-password").val("")}}});e("#remote-process-group-transport-protocol-combo").combo({options:[{text:"RAW",value:"RAW"},{text:"HTTP",value:"HTTP"}]})},showConfiguration:function(k){if(c.isRemoteProcessGroup(k)){var l=k.datum();e("#remote-process-group-id").text(l.id);e("#remote-process-group-name").text(l.component.name);e("#remote-process-group-urls").val(l.component.targetUris);e("#remote-process-group-timeout").val(l.component.communicationsTimeout);e("#remote-process-group-yield-duration").val(l.component.yieldDuration);e("#remote-process-group-proxy-host").val(l.component.proxyHost);e("#remote-process-group-proxy-port").val(l.component.proxyPort);e("#remote-process-group-proxy-user").val(l.component.proxyUser);e("#remote-process-group-proxy-password").val(l.component.proxyPassword);e("#remote-process-group-local-network-interface").val(l.component.localNetworkInterface);e("#remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:l.component.transportProtocol});e("#remote-process-group-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.CanvasUtils"],function(d,e,c){return(nf.RemoteProcessGroupDetails=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupDetails=b(require("jquery"),require("nf.Common"),require("nf.CanvasUtils")))}else{nf.RemoteProcessGroupDetails=b(a.$,a.nf.Common,a.nf.CanvasUtils)}}}(this,function(b,c,a){return{init:function(){b("#remote-process-group-details").modal({headerText:"Remote Process Group Details",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#remote-process-group-details").modal("hide")}}}],handler:{close:function(){c.clearField("read-only-remote-process-group-id");c.clearField("read-only-remote-process-group-name");c.clearField("read-only-remote-process-group-urls");c.clearField("read-only-remote-process-group-timeout");c.clearField("read-only-remote-process-group-yield-duration");c.clearField("read-only-remote-process-group-transport-protocol");c.clearField("read-only-remote-process-group-local-network-interface");c.clearField("read-only-remote-process-group-proxy-host");c.clearField("read-only-remote-process-group-proxy-port");c.clearField("read-only-remote-process-group-proxy-user");c.clearField("read-only-remote-process-group-proxy-password")}}})},showDetails:function(d){if(a.isRemoteProcessGroup(d)){var e=d.datum();c.populateField("read-only-remote-process-group-id",e.id);c.populateField("read-only-remote-process-group-name",e.component.name);c.populateField("read-only-remote-process-group-urls",e.component.targetUris);c.populateField("read-only-remote-process-group-timeout",e.component.communicationsTimeout);c.populateField("read-only-remote-process-group-yield-duration",e.component.yieldDuration);c.populateField("read-only-remote-process-group-transport-protocol",e.component.transportProtocol);c.populateField("read-only-remote-process-group-local-network-interface",e.component.localNetworkInterface);c.populateField("read-only-remote-process-group-proxy-host",e.component.proxyHost);c.populateField("read-only-remote-process-group-proxy-port",e.component.proxyPort);c.populateField("read-only-remote-process-group-proxy-user",e.component.proxyUser);c.populateField("read-only-remote-process-group-proxy-password",e.component.proxyPassword);b("#remote-process-group-details").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.RemoteProcessGroup"],function(g,k,j,d,f,h,l,e,i,c){return(nf.RemoteProcessGroupPorts=b(g,k,j,d,f,h,l,e,i,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupPorts=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.RemoteProcessGroup")))}else{nf.RemoteProcessGroupPorts=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.RemoteProcessGroup)}}}(this,function(g,n,l,c,e,i,o,d,j,b){var h=function(){g("#remote-port-configuration").modal({headerText:"Configure Remote Port",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var r=g("#remote-port-concurrent-tasks").val();var q=g("#remote-port-batch-count").val();var w=new Array();if(!g.isNumeric(r)){w.push("Concurrent tasks must be an integer value.")}if(q&&!g.isNumeric(q)){w.push("Batch Settings: count must be an integer value.")}if(w.length==0){var p=g("#remote-process-group-ports-id").text();var v=n.select("#id-"+p).datum();var u=g("#remote-port-id").text();var t={revision:o.getRevision(v),disconnectedNodeAcknowledged:i.isDisconnectionAcknowledged(),remoteProcessGroupPort:{id:u,groupId:p,useCompression:g("#remote-port-use-compression").hasClass("checkbox-checked"),concurrentlySchedulableTaskCount:r,batchSettings:{count:q,size:g("#remote-port-batch-size").val(),duration:g("#remote-port-batch-duration").val()}}};var s="/output-ports/";if(g("#remote-port-type").text()==="input"){s="/input-ports/"}g.ajax({type:"PUT",data:JSON.stringify(t),url:v.uri+s+encodeURIComponent(u),dataType:"json",contentType:"application/json"}).done(function(x){v.revision=x.revision;var y=x.remoteProcessGroupPort;var A="No";if(y.useCompression===true){A="Yes"}g("#"+u+"-concurrent-tasks").text(y.concurrentlySchedulableTaskCount);g("#"+u+"-compression").text(A);var z=a(y);g("#"+u+"-batch-count").text(z.count);g("#"+u+"-batch-size").text(z.size);g("#"+u+"-batch-duration").text(z.duration);g("#remote-port-configuration").modal("hide")}).fail(l.handleConfigurationUpdateAjaxError)}else{e.showOkDialog({headerText:"Configuration Error",dialogContent:w.reduce(function(x,y){return typeof(x)==="string"?x+" "+y:y})})}}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#remote-port-configuration").modal("hide")}}}],handler:{close:function(){g("#remote-port-id").text("");g("#remote-port-name").text("");g("#remote-port-concurrent-tasks").val("");g("#remote-port-use-compression").removeClass("checkbox-checked checkbox-unchecked");g("#remote-port-batch-count").val("");g("#remote-port-batch-size").val("");g("#remote-port-batch-duration").val("")}}})};var k=function(){g("#remote-process-group-ports").modal({scrollableContentStyle:"scrollable",headerText:"Remote Process Group Ports",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var p=g("#remote-process-group-ports-id").text();var r=n.select("#id-"+p);var q=r.datum();if(d.canModify(r)){b.reload(q.id)}g("#remote-process-group-ports").modal("hide")}}}],handler:{close:function(){g("#remote-process-group-ports-id").text("");g("#remote-process-group-ports-name").text("");g("#remote-process-group-ports-urls").text("");var p=g("#remote-process-group-ports");c.cleanUpTooltips(p,"div.remote-port-removed");c.cleanUpTooltips(p,"div.concurrent-tasks-info");g("#remote-process-group-input-ports-container").empty();g("#remote-process-group-output-ports-container").empty()}}})};var a=function(q){var p={};var r=q.batchSettings;if(r){p.count=typeof(r.count)==="number"?r.count:"No value set";p.size=r.size?r.size:"No value set";p.duration=r.duration?r.duration:"No value set"}else{p.count="No value set";p.size="No value set";p.duration="No value set"}return p};var f=function(D,B,w){var t=c.escapeHtml(B.id);var x=g('<div class="remote-port-container"></div>').appendTo(D);var I=g('<div class="remote-port-edit-container"></div>').appendTo(x);var u=g('<div class="remote-port-details-container"></div>').appendTo(x);var z=g("#remote-process-group-ports-id").text();var v=n.select("#id-"+z);if(d.canOperate(v)){var J=function(L){var M;if(L.connected===true){if(L.transmitting===true){M=(j.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary enabled-active-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope));M.click()}else{if(L.exists===true){M=(j.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary enabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope))}else{M=(j.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope))}}}else{if(L.transmitting===true){M=(j.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary disabled-active-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope))}else{M=(j.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope))}}return M};var C=J(B);C.appendTo(I);if(d.canModify(v)){if(B.exists===true&&B.connected===true){var H=g('<button class="button edit-remote-port fa fa-pencil"></button>').click(function(){var P=g("#"+t+"-name").text();var O=g("#"+t+"-concurrent-tasks").text();var L=g("#"+t+"-compression").text()==="Yes";var N=g("#"+t+"-batch-count").text();var M=g("#"+t+"-batch-size").text();var Q=g("#"+t+"-batch-duration").text();m(B.id,P,O,L,N,M,Q,w)}).appendTo(I);if(B.transmitting===true){H.hide()}else{H.show()}}else{if(B.exists===false){g('<div class="remote-port-removed" />').appendTo(I).qtip(g.extend({},c.config.tooltipConfig,{content:"This port has been removed."}))}}}if(c.isDefinedAndNotNull(C)){var K=function(){var L=g("#remote-process-group-ports-id").text();var O=n.select("#id-"+L).datum();var P=false;if(C.hasClass("enabled-inactive-transmission")){P=true}var N={revision:o.getRevision(O),disconnectedNodeAcknowledged:i.isDisconnectionAcknowledged(),state:P?"TRANSMITTING":"STOPPED"};var M="/output-ports/";if(w==="input"){M="/input-ports/"}g.ajax({type:"PUT",data:JSON.stringify(N),url:O.uri+M+encodeURIComponent(B.id)+"/run-status",dataType:"json",contentType:"application/json"}).done(function(Q){O.revision=Q.revision;var R=Q.remoteProcessGroupPort;if(R.exists===false){C.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("disabled-inactive-transmission").off("click");if(c.isDefinedAndNotNull(H)){H.hide()}}else{if(R.transmitting===true){C.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("enabled-active-transmission");if(c.isDefinedAndNotNull(H)){H.hide()}}else{C.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("enabled-inactive-transmission");if(c.isDefinedAndNotNull(H)){H.show()}}}}).fail(function(T,Q,R){var S=J(B);S.click(K);C.replaceWith(S);C=S;l.handleConfigurationUpdateAjaxError(T,Q,R)})};C.click(K)}}else{if(B.transmitting===true){(j.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary enabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope)).appendTo(I)}else{(j.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(j.rootScope)).appendTo(I)}}g('<div id="'+t+'-id" class="remote-port-id hidden"></div>').text(B.id).appendTo(u);g('<div id="'+t+'-name" class="remote-port-name ellipsis"></div>').text(B.name).appendTo(u);g('<div class="clear"></div>').appendTo(u);if(c.isBlank(B.comments)){g('<div class="remote-port-description unset">No description specified.</div>').appendTo(u)}else{g('<div class="remote-port-description"></div>').text(B.comments).appendTo(u)}g('<div class="clear"></div>').appendTo(u);var E=g('<div class="concurrent-task-container"></div>').appendTo(u);var y=g('<div class="setting-field"></div>').append(g('<div id="'+t+'-concurrent-tasks"></div>').text(B.concurrentlySchedulableTaskCount));g('<div><div class="setting-name">Concurrent tasks<div class="processor-setting concurrent-tasks-info fa fa-question-circle"></div></div></div>').append(y).appendTo(E).find("div.concurrent-tasks-info").qtip(g.extend({},c.config.tooltipConfig,{content:"The number of tasks that should be concurrently scheduled for this port."}));var q=g('<div class="compression-container"></div>').appendTo(u);var p="No";if(B.useCompression===true){p="Yes"}g('<div><div class="setting-name">Compressed</div><div class="setting-field"><div id="'+t+'-compression">'+p+"</div></div></div>").appendTo(q);g('<div class="clear"></div>').appendTo(u);var s=g('<div class="batch-settings-container"></div>').append(g('<div class="setting-name">Batch Settings<div class="processor-setting batch-settings-info fa fa-question-circle"></div></div>')).appendTo(u);s.find("div.batch-settings-info").qtip(g.extend({},nf.Common.config.tooltipConfig,{content:(w==="input"?"The batch settings to control how this NiFi sends data to the remote input port in a transaction. This NiFi will transfer as much flow files as they are queued in incoming relationships, until any of these limits is met. If none of these setting is specified, this NiFi uses 500 milliseconds batch duration by default.":"The batch settings to tell the remote NiFi how this NiFi prefers to receive data from the remote output port in a transaction. The remote NiFi will use these settings as a hint to control batch data transferring. However, actual behavior depends on the version of remote NiFi instance. Recent version of NiFi uses 5 seconds for batch duration if none of these setting is specified.")}));var G=a(B);var r=g('<div class="setting-field"></div>').append(g('<div id="'+t+'-batch-count"></div>').text(G.count));var F=g('<div class="setting-field"></div>').append(g('<div id="'+t+'-batch-size"></div>').text(G.size));var A=g('<div class="setting-field"></div>').append(g('<div id="'+t+'-batch-duration"></div>').text(G.duration));g('<div class="batch-setting"><div class="setting-name">Count<div class="processor-setting"></div></div></div>').append(r).appendTo(s);g('<div class="batch-setting"><div class="setting-name">Size<div class="processor-setting"></div></div></div>').append(F).appendTo(s);g('<div class="batch-setting"><div class="setting-name">Duration<div class="processor-setting"></div></div></div>').append(A).appendTo(s);g('<div class="clear"></div>').appendTo(x);x.find(".ellipsis").ellipsis();j.digest()};var m=function(s,t,v,w,q,u,r,p){g("#remote-port-id").text(s);g("#remote-port-type").text(p);var x="checkbox-unchecked";if(w===true){x="checkbox-checked"}g("#remote-port-use-compression").addClass(x);g("#remote-port-concurrent-tasks").val(v);g("#remote-port-batch-count").val(q==="No value set"?null:q);g("#remote-port-batch-size").val(u==="No value set"?null:u);g("#remote-port-batch-duration").val(r==="No value set"?null:r);g("#remote-port-name").text(t).ellipsis();g("#remote-port-configuration").modal("show")};return{init:function(){h();k()},showPorts:function(p){if(d.isRemoteProcessGroup(p)){var q=p.datum();g.ajax({type:"GET",url:q.uri,dataType:"json"}).done(function(t){var w=t.component;b.set(t);g("#remote-process-group-ports-id").text(w.id);g("#remote-process-group-ports-name").text(w.name);g("#remote-process-group-ports-urls").text(w.targetUris);var r=w.contents;if(c.isDefinedAndNotNull(r)){var A=[];var u=[];var s=function(C,B){var E=C.name.toUpperCase();var D=B.name.toUpperCase();return E<D?-1:(E>D?1:0)};var y=g("#remote-process-group-input-ports-container");g.each(r.inputPorts,function(C,B){if(B.connected===true){A.push(B)}else{u.push(B)}});A.sort(s);u.sort(s);g.each(A,function(C,B){f(y,B,"input")});g.each(u,function(C,B){f(y,B,"input")});if(c.isEmpty(A)&&c.isEmpty(u)){g('<div class="unset"></div>').text("No ports to display").appendTo(y)}var v=[];var z=[];var x=g("#remote-process-group-output-ports-container");g.each(r.outputPorts,function(B,C){if(C.connected===true){v.push(C)}else{z.push(C)}});v.sort(s);z.sort(s);g.each(v,function(B,C){f(x,C,"output")});g.each(z,function(B,C){f(x,C,"output")});if(c.isEmpty(v)&&c.isEmpty(z)){g('<div class="unset"></div>').text("No ports to display").appendTo(x)}}g("#remote-process-group-ports").modal("show")}).fail(l.handleAjaxError)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.CanvasUtils","nf.Connection"],function(f,j,i,c,e,g,k,d,h){return(nf.ConnectionConfiguration=b(f,j,i,c,e,g,k,d,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ConnectionConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.Connection")))}else{nf.ConnectionConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.CanvasUtils,a.nf.Connection)}}}(this,function(x,I,d,H,j,s,g,M,Q){var e;var r;var o;var i;var n=75;var L=200;var t=false;var D={urls:{api:"../nifi-api",prioritizers:"../nifi-api/flow/prioritizers"}};var h=function(){I.select("path.connector").remove()};var w=function(){x("div.available-relationship").bind("change",function(){x("#connection-configuration").modal("refreshButtons")})};var b=function(R){if(M.isProcessor(R)){return x.Deferred(function(S){G(R).done(function(U){if(!H.isEmpty(U.relationships)){x.each(U.relationships,function(V,W){z(W.name)});w();var T=x("#relationship-names").children("div");if(T.length===1){T.children("div.available-relationship").removeClass("checkbox-unchecked").addClass("checkbox-checked")}x("#connection-configuration").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){return v().length===0||y()},handler:{click:function(){E(v())}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},disabled:function(){return y()},handler:{click:function(){x("#connection-configuration").modal("hide")}}}]);S.resolve()}else{j.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+H.escapeHtml(U.name)+"' does not support any relationships."});l();S.reject()}}).fail(function(){S.reject()})}).promise()}else{return x.Deferred(function(T){var S;if(M.isInputPort(R)){S=F(R)}else{if(M.isRemoteProcessGroup(R)){S=f(R)}else{if(M.isProcessGroup(R)){S=J(R)}else{S=m(R)}}}S.done(function(){x("#connection-configuration").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){return y()},handler:{click:function(){E()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},disabled:function(){return y()},handler:{click:function(){x("#connection-configuration").modal("hide")}}}]);T.resolve()}).fail(function(){T.reject()})}).promise()}};var F=function(R){return x.Deferred(function(T){var S=R.datum();var U=S.permissions.canRead?S.component.name:S.id;x("#input-port-source").show();x("#input-port-source-name").text(U).attr("title",U);x("#connection-source-id").val(S.id);x("#connection-source-component-id").val(S.id);x("#connection-source-group-id").val(M.getGroupId());x("#connection-source-group-name").text(M.getGroupName());T.resolve()}).promise()};var m=function(R){return x.Deferred(function(T){var S=R.datum();x("#funnel-source").show();x("#connection-source-id").val(S.id);x("#connection-source-component-id").val(S.id);x("#connection-source-group-id").val(M.getGroupId());x("#connection-source-group-name").text(M.getGroupName());T.resolve()}).promise()};var G=function(R){return x.Deferred(function(T){var S=R.datum();var U=S.permissions.canRead?S.component.name:S.id;var V=S.permissions.canRead?H.substringAfterLast(S.component.type,"."):"Processor";x("#processor-source").show();x("#processor-source-name").text(U).attr("title",U);x("#processor-source-type").text(V).attr("title",V);x("#connection-source-id").val(S.id);x("#connection-source-component-id").val(S.id);x("#connection-source-group-id").val(M.getGroupId());x("#connection-source-group-name").text(M.getGroupName());x("#relationship-names-container").show();T.resolve(S.component)})};var J=function(R){return x.Deferred(function(S){var T=R.datum();x.ajax({type:"GET",url:D.urls.api+"/flow/process-groups/"+encodeURIComponent(T.id),dataType:"json"}).done(function(U){var Z=U.processGroupFlow;var Y=U.permissions.canRead?Z.breadcrumb.breadcrumb.name:Z.id;var aa=Z.flow;var V=[];var X=0;x.each(aa.outputPorts,function(ac,ad){if(ad.allowRemoteAccess){X++;return}if(ad.permissions.canRead&&ad.permissions.canWrite){var ab=ad.component;V.push({text:ab.name,value:ab.id,description:H.escapeHtml(ab.comments)})}});if(!H.isEmpty(V)){x("#output-port-source").show();V.sort(function(ac,ab){return ac.text.localeCompare(ab.text)});x("#output-port-options").combo({options:V,maxHeight:300,select:function(ab){x("#connection-source-id").val(ab.value)}});x("#connection-source-component-id").val(Z.id);x("#connection-source-group-id").val(Z.id);x("#connection-source-group-name").text(Y);S.resolve()}else{var W="'"+H.escapeHtml(Y)+"' does not have any local output ports.";if(H.isEmpty(aa.outputPorts)===false&&aa.outputPorts.length>X){W="Not authorized for any local output ports in '"+H.escapeHtml(Y)+"'."}j.showOkDialog({headerText:"Connection Configuration",dialogContent:W});l();S.reject()}}).fail(function(W,U,V){d.handleAjaxError(W,U,V);S.reject()})}).promise()};var f=function(R){return x.Deferred(function(S){var T=R.datum();x.ajax({type:"GET",url:T.uri,dataType:"json"}).done(function(U){var W=U.component;var X=W.contents;if(!H.isEmpty(X.outputPorts)){x("#output-port-source").show();var V=[];x.each(X.outputPorts,function(Y,Z){V.push({text:Z.name,value:Z.id,disabled:Z.exists===false,description:H.escapeHtml(Z.comments)})});V.sort(function(Z,Y){return Z.text.localeCompare(Y.text)});x("#output-port-options").combo({options:V,maxHeight:300,select:function(Y){x("#connection-source-id").val(Y.value)}});x("#connection-source-component-id").val(W.id);x("#connection-source-group div.setting-name").text("Within Remote Group");x("#connection-remote-source-url").text(W.targetUri).show();x("#connection-source-group-id").val(W.id);x("#connection-source-group-name").text(W.name);S.resolve()}else{j.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+H.escapeHtml(W.name)+"' does not have any output ports."});l();S.reject()}}).fail(function(W,U,V){d.handleAjaxError(W,U,V);S.reject()})}).promise()};var a=function(R){if(M.isOutputPort(R)){return p(R)}else{if(M.isProcessor(R)){return C(R)}else{if(M.isRemoteProcessGroup(R)){return N(R)}else{if(M.isFunnel(R)){return u(R)}else{return P(R)}}}}};var p=function(R){return x.Deferred(function(S){var U=R.datum();var T=U.permissions.canRead?U.component.name:U.id;x("#output-port-destination").show();x("#output-port-destination-name").text(T).attr("title",T);x("#connection-destination-id").val(U.id);x("#connection-destination-component-id").val(U.id);x("#connection-destination-group-id").val(M.getGroupId());x("#connection-destination-group-name").text(M.getGroupName());S.resolve()}).promise()};var u=function(R){return x.Deferred(function(T){var S=R.datum();x("#funnel-destination").show();x("#connection-destination-id").val(S.id);x("#connection-destination-component-id").val(S.id);x("#connection-destination-group-id").val(M.getGroupId());x("#connection-destination-group-name").text(M.getGroupName());T.resolve()}).promise()};var C=function(R){return x.Deferred(function(T){var S=R.datum();var U=S.permissions.canRead?S.component.name:S.id;var V=S.permissions.canRead?H.substringAfterLast(S.component.type,"."):"Processor";x("#processor-destination").show();x("#processor-destination-name").text(U).attr("title",U);x("#processor-destination-type").text(V).attr("title",V);x("#connection-destination-id").val(S.id);x("#connection-destination-component-id").val(S.id);x("#connection-destination-group-id").val(M.getGroupId());x("#connection-destination-group-name").text(M.getGroupName());T.resolve()}).promise()};var P=function(R){return x.Deferred(function(S){var T=R.datum();x.ajax({type:"GET",url:D.urls.api+"/flow/process-groups/"+encodeURIComponent(T.id),dataType:"json"}).done(function(U){var X=U.processGroupFlow;var W=U.permissions.canRead?X.breadcrumb.breadcrumb.name:X.id;var Y=X.flow;var V=[];x.each(Y.inputPorts,function(aa,Z){if(!Z.allowRemoteAccess){V.push({text:Z.permissions.canRead?Z.component.name:Z.id,value:Z.id,description:Z.permissions.canRead?H.escapeHtml(Z.component.comments):null})}});if(!H.isEmpty(V)){x("#input-port-destination").show();V.sort(function(aa,Z){return aa.text.localeCompare(Z.text)});x("#input-port-options").combo({options:V,maxHeight:300,select:function(Z){x("#connection-destination-id").val(Z.value)}});x("#connection-destination-component-id").val(X.id);x("#connection-destination-group-id").val(X.id);x("#connection-destination-group-name").text(W);S.resolve()}else{j.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+H.escapeHtml(W)+"' does not have any local input ports."});l();S.reject()}}).fail(function(W,U,V){d.handleAjaxError(W,U,V);S.reject()})}).promise()};var N=function(R,S){return x.Deferred(function(T){var U=R.datum();x.ajax({type:"GET",url:U.uri,dataType:"json"}).done(function(V){var X=V.component;var Y=X.contents;if(!H.isEmpty(Y.inputPorts)){x("#input-port-destination").show();var W=[];x.each(Y.inputPorts,function(aa,Z){W.push({text:Z.name,value:Z.id,disabled:Z.exists===false,description:H.escapeHtml(Z.comments)})});W.sort(function(aa,Z){return aa.text.localeCompare(Z.text)});x("#input-port-options").combo({options:W,maxHeight:300,select:function(Z){x("#connection-destination-id").val(Z.value)}});x("#connection-destination-component-id").val(X.id);x("#connection-destination-group div.setting-name").text("Within Remote Group");x("#connection-remote-destination-url").text(X.targetUri).show();x("#connection-destination-group-id").val(X.id);x("#connection-destination-group-name").text(X.name);T.resolve()}else{j.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+H.escapeHtml(X.name)+"' does not have any input ports."});l();T.reject()}}).fail(function(X,V,W){d.handleAjaxError(X,V,W);T.reject()})}).promise()};var O=function(R){return x.Deferred(function(T){var U=R.datum();var S=U.permissions.canRead?U.component.name:U.id;x("#read-only-output-port-source").show();x("#connection-source-component-id").val(U.id);x("#connection-source-group-id").val(U.id);x("#connection-source-group-name").text(S);if(M.isRemoteProcessGroup(R)){x("#connection-source-group div.setting-name").text("Within Remote Group");if(U.permissions.canRead){x("#connection-remote-source-url").text(U.component.targetUri).show()}}T.resolve()}).promise()};var k=function(R){if(M.isProcessor(R)){return G(R)}else{if(M.isInputPort(R)){return F(R)}else{if(M.isFunnel(R)){return m(R)}else{return O(R)}}}};var A=function(R,S){if(M.isProcessor(R)){return C(R)}else{if(M.isOutputPort(R)){return p(R)}else{if(M.isRemoteProcessGroup(R)){return N(R,S)}else{if(M.isFunnel(R)){return u(R)}else{return P(R)}}}}};var z=function(S){var R=x('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text(S);var T=x('<span class="relationship-name-value hidden"></span>').text(S);return x('<div class="available-relationship-container"><div class="available-relationship nf-checkbox checkbox-unchecked"></div></div>').append(R).append(T).appendTo("#relationship-names")};var c=function(R){var S=(t!==R);t=R;if(S){x("#connection-configuration").modal("refreshButtons")}};var y=function(){return t};var E=function(T){c(true);var aq=x("#connection-source-id").val();var an=x("#connection-destination-id").val();var av=x("#connection-source-component-id").val();var ak=I.select("#id-"+av);var ao=x("#connection-destination-component-id").val();var ac=I.select("#id-"+ao);var aD=ak.datum();var ad=ac.datum();var U=[];if(av===ao){var aj={x:aD.position.x+(aD.dimensions.width),y:aD.position.y+(aD.dimensions.height/2)};var ap=Q.config.selfLoopXOffset;var ar=Q.config.selfLoopYOffset;U.push({x:(aj.x+ap),y:(aj.y-ar)});U.push({x:(aj.x+ap),y:(aj.y+ar)})}else{var aB=[];var au=Q.getComponentConnections(av);x.each(au,function(aG,aJ){var aH=M.getConnectionSourceComponentId(aJ);var aI=M.getConnectionDestinationComponentId(aJ);if((aH===av&&aI===ao)||(aI===av&&aH===ao)){aB.push(aJ)}});if(aB.length>0){var V=false;x.each(aB,function(aG,aH){if(H.isEmpty(aH.bends)){V=true;return false}});if(V===true){var al=[aD.position.x+(aD.dimensions.width/2),aD.position.y+(aD.dimensions.height/2)];var S=[ad.position.x+(ad.dimensions.width/2),ad.position.y+(ad.dimensions.height/2)];var ai=((al[1]-S[1])/(al[0]-S[0]));var az=ai<=1&&ai>=-1;var at=function(aG,aI){var aH=false;x.each(aB,function(aJ,aK){if(!H.isEmpty(aK.bends)){if(az){if(aK.bends[0].y===aI){aH=true;return false}}else{if(aK.bends[0].x===aG){aH=true;return false}}}});return aH};var Z=(al[0]+S[0])/2;var af=(al[1]+S[1])/2;var ay=az?0:L;var ah=az?n:0;var aA=false;while(aA===false){if(at(Z-ay,af-ah)===false){U.push({x:(Z-ay),y:(af-ah)});aA=true}else{if(at(Z+ay,af+ah)===false){U.push({x:(Z+ay),y:(af+ah)});aA=true}}if(az){ah+=n}else{ay+=L}}}}}var X=x("#connection-source-group-id").val();var R=x("#connection-destination-group-id").val();var aE=M.getConnectableTypeForSource(ak);var ag=M.getConnectableTypeForDestination(ac);var aa=x("#connection-name").val();var W=x("#flow-file-expiration").val();var aC=x("#back-pressure-object-threshold").val();var aF=x("#back-pressure-data-size-threshold").val();var am=x("#prioritizer-selected").sortable("toArray");var ae=x("#load-balance-strategy-combo").combo("getSelectedOption").value;var ab="DO_NOT_LOAD_BALANCE"!==ae;var Y=ab&&"PARTITION_BY_ATTRIBUTE"===ae?x("#load-balance-partition-attribute").val():"";var ax=ab?x("#load-balance-compression-combo").combo("getSelectedOption").value:"DO_NOT_COMPRESS";if(K()){var aw={revision:g.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{name:aa,source:{id:aq,groupId:X,type:aE},destination:{id:an,groupId:R,type:ag},selectedRelationships:T,flowFileExpiration:W,backPressureDataSizeThreshold:aF,backPressureObjectThreshold:aC,bends:U,prioritizers:am,loadBalanceStrategy:ae,loadBalancePartitionAttribute:Y,loadBalanceCompression:ax}};x.ajax({type:"POST",url:D.urls.api+"/process-groups/"+encodeURIComponent(M.getGroupId())+"/connections",data:JSON.stringify(aw),dataType:"json",contentType:"application/json"}).done(function(aG){r.add({connections:[aG]},{selectAll:true});c(false);x("#connection-configuration").modal("hide");M.reloadConnectionSourceAndDestination(av,ao);r.updateVisibility();e.refresh()}).fail(function(aI,aG,aH){c(false);d.handleConfigurationUpdateAjaxError(aI,aG,aH)})}};var B=function(ag){c(true);var Y=x("#connection-id").text();var S=x("#connection-uri").val();var ae=x("#connection-source-component-id").val();var R=x("#connection-destination-component-id").val();var ac=I.select("#id-"+R);var V=M.getConnectableTypeForDestination(ac);var ah=x("#connection-destination-id").val();var af=x("#connection-destination-group-id").val();var ab=x("#connection-name").val();var aa=x("#flow-file-expiration").val();var T=x("#back-pressure-object-threshold").val();var ai=x("#back-pressure-data-size-threshold").val();var ak=x("#prioritizer-selected").sortable("toArray");var aj=x("#load-balance-strategy-combo").combo("getSelectedOption").value;var W="DO_NOT_LOAD_BALANCE"!==aj;var Z=W&&"PARTITION_BY_ATTRIBUTE"===aj?x("#load-balance-partition-attribute").val():"";var X=W?x("#load-balance-compression-combo").combo("getSelectedOption").value:"DO_NOT_COMPRESS";if(K()){var ad=Q.get(Y);var U={revision:g.getRevision(ad),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{id:Y,name:ab,destination:{id:ah,groupId:af,type:V},selectedRelationships:ag,flowFileExpiration:aa,backPressureDataSizeThreshold:ai,backPressureObjectThreshold:T,prioritizers:ak,loadBalanceStrategy:aj,loadBalancePartitionAttribute:Z,loadBalanceCompression:X}};return x.ajax({type:"PUT",url:S,data:JSON.stringify(U),dataType:"json",contentType:"application/json"}).done(function(al){c(false);x("#connection-configuration").modal("hide");Q.set(al);M.reloadConnectionSourceAndDestination(ae,R)}).fail(function(an,al,am){c(false);d.handleConfigurationUpdateAjaxError(an,al,am)})}else{return x.Deferred(function(al){al.reject()}).promise()}};var v=function(){var S=x("#relationship-names");var R=[];x.each(S.children(),function(T,W){var V=x(W);var U=V.children("div.available-relationship");if(U.hasClass("checkbox-checked")){R.push(V.children("span.relationship-name-value").text())}});return R};var K=function(){var R=[];if(H.isBlank(x("#flow-file-expiration").val())){R.push("File expiration must be specified")}if(!x.isNumeric(x("#back-pressure-object-threshold").val())){R.push("Back pressure object threshold must be an integer value")}if(H.isBlank(x("#back-pressure-data-size-threshold").val())){R.push("Back pressure data size threshold must be specified")}if(x("#load-balance-strategy-combo").combo("getSelectedOption").value==="PARTITION_BY_ATTRIBUTE"&&H.isBlank(x("#load-balance-partition-attribute").val())){R.push('Cannot set Load Balance Strategy to "Partition by attribute" without providing a partitioning "Attribute Name"')}if(R.length>0){j.showOkDialog({headerText:"Configuration Error",dialogContent:H.formatUnorderedList(R)});return false}else{return true}};var l=function(){var T=x("#prioritizer-selected");var R=x("#prioritizer-available");T.children().detach().appendTo(R).find("div.draggable-control").remove();var S=R.children("li").get();S.sort(function(V,U){var X=x(V).text().toUpperCase();var W=x(U).text().toUpperCase();return(X<W)?-1:(X>W)?1:0});x.each(S,function(){x(this).detach()});x.each(S,function(){x(this).appendTo(R)});x("#connection-name").val("");x("#relationship-names").css("border-width","0").empty();x("#relationship-names-container").hide();H.clearField("connection-id");x("#processor-source").hide();x("#input-port-source").hide();x("#output-port-source").hide();x("#read-only-output-port-source").hide();x("#funnel-source").hide();x("#processor-destination").hide();x("#input-port-destination").hide();x("#output-port-destination").hide();x("#funnel-destination").hide();x("#connection-source-id").val("");x("#connection-source-component-id").val("");x("#connection-source-group-id").val("");x("#connection-destination-id").val("");x("#connection-destination-component-id").val("");x("#connection-destination-group-id").val("");x("#output-port-options").empty();x("#input-port-options").empty();x("#load-balance-strategy-combo").combo("setSelectedOption",H.loadBalanceStrategyOptions[0]);x("#load-balance-partition-attribute").val("");x("#load-balance-compression-combo").combo("setSelectedOption",H.loadBalanceCompressionOptions[0]);h()};var q={init:function(S,R){e=S;r=R;x("#relationship-names-container").hide();x("#connection-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Connection",handler:{close:function(){l()},open:function(){H.toggleScrollable(x("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});x("#connection-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"connection-details-tab-content"},{name:"Settings",tabContentId:"connection-settings-tab-content"}]});x("#load-balance-strategy-combo").combo({options:H.loadBalanceStrategyOptions,select:function(T){if(T.value==="PARTITION_BY_ATTRIBUTE"){x("#load-balance-partition-attribute-setting-separator").show();x("#load-balance-partition-attribute-setting").show()}else{x("#load-balance-partition-attribute-setting-separator").hide();x("#load-balance-partition-attribute-setting").hide()}if(T.value==="DO_NOT_LOAD_BALANCE"){x("#load-balance-compression-setting").hide()}else{x("#load-balance-compression-setting").show()}}});x("#load-balance-compression-combo").combo({options:H.loadBalanceCompressionOptions});x.ajax({type:"GET",url:D.urls.prioritizers,dataType:"json"}).done(function(T){x.each(T.prioritizerTypes,function(V,W){q.addAvailablePrioritizer("#prioritizer-available",W)});var U=true;x("#prioritizer-available").sortable({containment:x("#connection-settings-tab-content").find(".settings-right"),connectWith:"ul",placeholder:"ui-state-highlight",scroll:true,opacity:0.6,beforeStop:function(V,W){if(x("#prioritizer-available").find(".ui-sortable-placeholder").length){U=false}},stop:function(W,X){const V=U;U=true;return V}});x("#prioritizer-selected").sortable({containment:x("#connection-settings-tab-content").find(".settings-right"),placeholder:"selected",scroll:true,opacity:0.6,receive:function(V,W){q.addControlsForSelectedPrioritizer(W.item)},update:function(V,W){x("#connection-configuration").modal("refreshButtons")}});x("#prioritizer-available, #prioritizer-selected").disableSelection();x(document).on("dblclick","#prioritizer-available li",function(){var V=x(this).detach().appendTo(x("#prioritizer-selected"));q.addControlsForSelectedPrioritizer(V);x("#connection-configuration").modal("refreshButtons")})}).fail(d.handleAjaxError);q.sortAvailablePrioritizers()},addAvailablePrioritizer:function(W,U){var T=U.type;var S=H.substringAfterLast(T,".");var V=x(W);var R=x("<li></li>").append(x('<span style="float: left;"></span>').text(S)).attr("id",T).addClass("ui-state-default").appendTo(V);if(H.isDefinedAndNotNull(U.description)){x('<div class="fa fa-question-circle"></div>').appendTo(R).qtip(x.extend({content:H.escapeHtml(U.description)},H.config.tooltipConfig))}},sortAvailablePrioritizers:function(){var R=x("#prioritizer-available");R.children("li").detach().sort(function(V,U){var T=x(V).text();var S=x(U).text();return T.localeCompare(S)}).appendTo(R)},addControlsForSelectedPrioritizer:function(R){var S=x('<div class="draggable-control"><div class="fa fa-remove"></div></div>').on("click",function(){S.remove();x("#prioritizer-available").append(R);q.sortAvailablePrioritizers();x("#connection-configuration").modal("refreshButtons")}).appendTo(R)},createConnection:function(U,V,S){var T=I.select("#id-"+U);var R=I.select("#id-"+V);if(T.empty()||R.empty()){return}x("#connection-source-group div.setting-name").text("Within Group");x("#connection-destination-group div.setting-name").text("Within Group");x("#connection-remote-source-url").hide();x("#connection-remote-destination-url").hide();x.when(b(T),a(R)).done(function(){x("#flow-file-expiration").val(S.flowfileExpiration);x("#back-pressure-object-threshold").val(S.objectThreshold);x("#back-pressure-data-size-threshold").val(S.dataSizeThreshold);x("#connection-configuration-tabs").find("li:first").click();x("#connection-configuration").modal("setHeaderText","Create Connection").modal("show");x("#connection-configuration div.relationship-name").ellipsis();H.populateField("connection-id",null);var W=x("#relationship-names");if(W.is(":visible")&&W.get(0).scrollHeight>Math.round(W.innerHeight())){W.css("border-width","1px")}}).fail(function(){h()})},showConfiguration:function(S,R){return x.Deferred(function(U){var V=S.datum();var T=V.component;var Y=M.getConnectionSourceComponentId(V);var W=I.select("#id-"+Y);if(H.isUndefinedOrNull(R)){var X=M.getConnectionDestinationComponentId(V);R=I.select("#id-"+X)}x("#connection-source-group div.setting-name").text("Within Group");x("#connection-destination-group div.setting-name").text("Within Group");x("#connection-remote-source-url").hide();x("#connection-remote-destination-url").hide();x.when(k(W),A(R,T.destination)).done(function(){var ab=T.availableRelationships;var aa=T.selectedRelationships;if(H.isDefinedAndNotNull(ab)||H.isDefinedAndNotNull(aa)){x.each(ab,function(ae,ad){z(ad)});w();x.each(aa,function(af,ad){if(x.inArray(ad,ab)===-1){var ag=z(ad);x(ag).children("div.relationship-name").addClass("undefined")}var ae=x("#relationship-names").children("div");x.each(ae,function(ah,aj){var ai=x(aj).children("span.relationship-name-value");if(ai.text()===ad){x(aj).children("div.available-relationship").removeClass("checkbox-unchecked").addClass("checkbox-checked")}})})}if(M.isProcessGroup(W)||M.isRemoteProcessGroup(W)){x("#connection-source-id").val(T.source.id);x("#read-only-output-port-name").text(T.source.name).attr("title",T.source.name)}if(M.isProcessGroup(R)||M.isRemoteProcessGroup(R)){var Z=R.datum();if(T.destination.groupId===Z.id){x("#input-port-options").combo("setSelectedOption",{value:T.destination.id})}}x("#connection-name").val(T.name);x("#flow-file-expiration").val(T.flowFileExpiration);x("#back-pressure-object-threshold").val(T.backPressureObjectThreshold);x("#back-pressure-data-size-threshold").val(T.backPressureDataSizeThreshold);x("#load-balance-strategy-combo").combo("setSelectedOption",{value:T.loadBalanceStrategy});x("#load-balance-compression-combo").combo("setSelectedOption",{value:T.loadBalanceCompression});x("#load-balance-partition-attribute").val(T.loadBalancePartitionAttribute);H.populateField("connection-id",T.id);x.each(T.prioritizers,function(ad,ae){var af=x("#prioritizer-available").children('li[id="'+ae+'"]');q.addControlsForSelectedPrioritizer(af);af.detach().appendTo("#prioritizer-selected")});x("#connection-uri").val(V.uri);x("#connection-configuration").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(M.isProcessor(W)){return v().length===0||y()}return y()},handler:{click:function(){c(true);if(M.isProcessor(W)){B(v()).done(function(){U.resolve()}).fail(function(){U.reject()}).always(function(){c(false)})}else{B(undefined).done(function(){U.resolve()}).fail(function(){U.reject()}).always(function(){c(false)})}}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},disabled:function(){return y()},handler:{click:function(){x("#connection-configuration").modal("hide");U.reject()}}}]);x("#connection-configuration").modal("setHeaderText","Configure Connection").modal("show");x("#connection-configuration div.relationship-name").ellipsis();var ac=x("#relationship-names");if(ac.is(":visible")&&ac.get(0).scrollHeight>Math.round(ac.innerHeight())){ac.css("border-width","1px")}}).fail(function(){U.reject()})}).promise()}};return q}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.ErrorHandler"],function(c,d,e){return(nf.ConnectionDetails=b(c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ConnectionDetails=b(require("jquery"),require("nf.Common"),require("nf.ErrorHandler")))}else{nf.ConnectionDetails=b(a.$,a.nf.Common,a.nf.ErrorHandler)}}}(this,function(d,b,g){var j=function(o,q,p){if(p.type==="PROCESSOR"){return k(o,q,p)}else{if(p.type==="FUNNEL"){return l(o,q,p)}else{if(p.type==="REMOTE_OUTPUT_PORT"){return f(o,q,p)}else{return n(o,q,p)}}}};var k=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(p.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(p.name).addClass("ellipsis").attr("title",p.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var l=function(o,q,p){return d.Deferred(function(r){d("#read-only-connection-source-label").text("From funnel");d("#read-only-connection-source").text("funnel").attr("title","funnel");d("#read-only-connection-source-group-name").text(q);r.resolve()}).promise()};var f=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);d("#read-only-connection-source-group div.setting-name").text("Within Remote Group");d("#read-only-connection-remote-source-url").text(t.targetUri).show();r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);d("#read-only-connection-source-group div.setting-name").text("Within Remote Group");r.resolve()}else{r.reject(u,s,t)}})}).promise()};var n=function(o,q,p){return d.Deferred(function(r){if(o===p.groupId){d("#read-only-connection-source-label").text("From input");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var e=function(p,q,o){if(o.type==="PROCESSOR"){return a(p,q,o)}else{if(o.type==="FUNNEL"){return m(p,q,o)}else{if(o.type==="REMOTE_INPUT_PORT"){return i(p,q,o)}else{return c(p,q,o)}}}};var a=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(o.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(o.name).addClass("ellipsis").attr("title",o.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var m=function(p,q,o){return d.Deferred(function(r){d("#read-only-connection-target-label").text("To funnel");d("#read-only-connection-target").text("funnel").attr("title","funnel");d("#read-only-connection-target-group-name").text(q);r.resolve()}).promise()};var i=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);d("#read-only-connection-target-group div.setting-name").text("Within Remote Group");d("#read-only-connection-remote-target-url").text(t.targetUri).show();r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);d("#read-only-connection-target-group div.setting-name").text("Within Remote Group");r.resolve()}else{r.reject(u,s,t)}})}).promise()};var c=function(p,q,o){return d.Deferred(function(r){if(p===o.groupId){d("#read-only-connection-target-label").text("To output");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var h=function(o){d('<div class="available-relationship-container"></div>').append(d('<div class="relationship-name"></div>').text(o)).appendTo("#read-only-relationship-names")};return{init:function(){d("#connection-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"read-only-connection-details-tab-content"},{name:"Settings",tabContentId:"read-only-connection-settings-tab-content"}]});d("#connection-details").modal({headerText:"Connection Details",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){d("#connection-details").modal("hide")}}}],handler:{close:function(){d("#read-only-relationship-names").empty();b.clearField("read-only-connection-name");b.clearField("read-only-connection-id");d("#read-only-connection-source-label").text("");d("#read-only-connection-source").empty();d("#read-only-connection-source-group div.setting-name").text("Within Group");d("#read-only-connection-source-group-name").text("");d("#read-only-connection-remote-source-url").text("").hide();d("#read-only-connection-target-label").text("");d("#read-only-connection-target").empty();d("#read-only-connection-target-group div.setting-name").text("Within Group");d("#read-only-connection-target-group-name").text("");d("#read-only-connection-remote-target-url").text("").hide();d("#read-only-relationship-names").css("border-width","0").empty();b.clearField("read-only-flow-file-expiration");b.clearField("read-only-back-pressure-object-threshold");b.clearField("read-only-back-pressure-data-size-threshold");b.clearField("read-only-load-balance-strategy");b.clearField("read-only-load-balance-partition-attribute");b.clearField("read-only-load-balance-compression");d("#read-only-prioritizers").empty()},open:function(){b.toggleScrollable(d("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}})},showDetails:function(p,r){var q=d.ajax({type:"GET",url:"../nifi-api/flow/process-groups/"+encodeURIComponent(p),dataType:"json"});var o=d.ajax({type:"GET",url:"../nifi-api/connections/"+encodeURIComponent(r),dataType:"json"});d.when(q,o).done(function(w,u){var v=w[0];var x=u[0];if(x.permissions.canRead){var t=x.component;var z=v.permissions.canRead?v.processGroupFlow.breadcrumb.breadcrumb.name:v.processGroupFlow.id;var y=j(v.id,z,t.source);var s=e(v.id,z,t.destination);d.when(y,s).done(function(){var B=t.availableRelationships;var A=t.selectedRelationships;if(b.isDefinedAndNotNull(B)||b.isDefinedAndNotNull(A)){d.each(B,function(G,F){h(F)});d.each(A,function(H,F){if(d.inArray(F,B)===-1){var I=h(F);d(I).children("div.relationship-name").addClass("undefined")}var G=d("#read-only-relationship-names").children("div");d.each(G.children("div.relationship-name"),function(K,J){var L=d(J);if(L.text()===F){L.css("font-weight","bold")}})});d("#selected-relationship-text").show();d("#read-only-relationship-names-container").show()}else{d("#selected-relationship-text").hide();d("#read-only-relationship-names-container").hide()}b.populateField("read-only-connection-name",t.name);b.populateField("read-only-connection-id",t.id);b.populateField("read-only-flow-file-expiration",t.flowFileExpiration);b.populateField("read-only-back-pressure-object-threshold",t.backPressureObjectThreshold);b.populateField("read-only-back-pressure-data-size-threshold",t.backPressureDataSizeThreshold);b.populateField("read-only-load-balance-strategy",b.getComboOptionText(b.loadBalanceStrategyOptions,t.loadBalanceStrategy));b.populateField("read-only-load-balance-partition-attribute",t.loadBalancePartitionAttribute);b.populateField("read-only-load-balance-compression",b.getComboOptionText(b.loadBalanceCompressionOptions,t.loadBalanceCompression));if(t.loadBalanceStrategy==="PARTITION_BY_ATTRIBUTE"){d("#read-only-load-balance-partition-attribute-setting").show()}else{d("#read-only-load-balance-partition-attribute-setting").hide()}if(t.loadBalanceStrategy==="DO_NOT_LOAD_BALANCE"){d("#read-only-load-balance-compression-setting").hide()}else{d("#read-only-load-balance-compression-setting").show()}if(b.isDefinedAndNotNull(t.prioritizers)&&t.prioritizers.length>0){var E=d("<ol></ol>").css("list-style","decimal inside none");d.each(t.prioritizers,function(F,G){E.append(d("<li></li>").text(b.substringAfterLast(G,".")))});d("#read-only-prioritizers").append(E)}else{var C=d('<span class="unset">No value set</span>');d("#read-only-prioritizers").append(C)}d("#connection-details-tabs").find("li:first").click();d("#connection-details").modal("show");var D=d("#read-only-relationship-names");if(D.is(":visible")&&D.get(0).scrollHeight>Math.round(D.innerHeight())){D.css("border-width","1px")}}).fail(g.handleAjaxError)}}).fail(g.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.CanvasUtils","nf.ng.Bridge"],function(f,e,g,d,c){return(nf.ContextMenu=b(f,e,g,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ContextMenu=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ng.Bridge")))}else{nf.ContextMenu=b(a.$,a.d3,a.nf.Common,a.nf.CanvasUtils,a.nf.ng.Bridge)}}}(this,function(K,Y,U,ad,r){var C;var O=function(ah){return ad.getParentGroupId()!==null&&ah.empty()};var ab=function(ah){if(ah.size()==1&&ad.isProcessor(ah)&&ad.canModify(ah)&&(ad.isConfigurable(ah)||b(ah))){return true}else{return ad.isConfigurable(ah)}};var n=function(ah){var ai;if(ah.empty()){ai=ad.getParameterContext()}else{if(ad.isProcessGroup(ah)){var aj=ah.datum();ai=aj.parameterContext}}if(U.isDefinedAndNotNull(ai)){return U.isDefinedAndNotNull(ai)&&ai.permissions.canRead===true}return false};var M=function(ah){if(ah.size()==1&&ad.isProcessor(ah)&&ad.canModify(ah)){return !ab(ah)}else{return ad.hasDetails(ah)}};var x=function(ah){return ad.areDeletable(ah)};var V=function(ah){return ad.canWriteCurrentGroup()&&(ah.empty()||ad.canRead(ah))};var d=function(ah){return ad.canWriteCurrentGroup()&&ah.empty()};var ac=function(ah){return ad.getComponentByType("Connection").isDisconnected(ah)&&ad.canModify(ah)};var N=function(ah){return ad.canEnable(ah)};var G=function(ah){return ad.canDisable(ah)};var I=function(ah){return ad.isManagedAuthorizer()&&ad.canManagePolicies(ah)};var s=function(ah){return ad.areRunnable(ah)};var R=function(ah){return ad.areStoppable(ah)};var b=function(aj){if(aj.size()!==1){return false}if(ad.canOperate(aj)===false){return false}var ah=false;if(ad.isProcessor(aj)){var ak=aj.datum();var ai=ak.status.aggregateSnapshot;ah=ai.runStatus!=="Running"&&ai.activeThreadCount>0}return ah};var m=function(ah){if(ah.size()!==1){return false}return ad.isProcessor(ah)||ad.isProcessGroup(ah)||ad.isRemoteProcessGroup(ah)||ad.isConnection(ah)};var S=function(ah){if(ah.size()!==1){return false}if(ad.canRead(ah)===false){return false}return ad.isProcessor(ah)};var y=function(ah){return ah.size()===1&&!ad.isConnection(ah)};var i=function(ah){return ad.isCopyable(ah)};var e=function(ah){return ad.isPastable()};var Z=function(ah){return ah.empty()};var B=function(ah){if(ah.size()!==1){return false}if(ad.canModify(ah)===false){return false}return ad.isConnection(ah)||ad.isLabel(ah)};var t=function(ah){return ad.canAlign(ah)};var A=function(ah){return ad.isColorable(ah)};var af=function(ah){if(ah.size()!==1){return false}return ad.isConnection(ah)};var p=function(ah){if(ah.size()!==1){return false}return ad.isFunnel(ah)||ad.isProcessor(ah)||ad.isProcessGroup(ah)||ad.isRemoteProcessGroup(ah)||ad.isInputPort(ah)||(ad.isOutputPort(ah)&&ad.getParentGroupId()!==null)};var v=function(ah){if(ah.size()!==1){return false}return ad.isFunnel(ah)||ad.isProcessor(ah)||ad.isProcessGroup(ah)||ad.isRemoteProcessGroup(ah)||ad.isOutputPort(ah)||(ad.isInputPort(ah)&&ad.getParentGroupId()!==null)};var o=function(ai){if(ai.size()!==1){return false}if(ad.canRead(ai)===false||ad.canModify(ai)===false){return false}if(ad.isProcessor(ai)){var ah=ai.datum();return ah.component.persistsState===true}else{return false}};var P=function(ai){if(ai.size()!==1){return false}if(ad.canRead(ai)===false||ad.canModify(ai)===false){return false}if(ad.isProcessor(ai)){var ah=ai.datum();return ah.component.multipleVersionsAvailable===true}else{return false}};var a=function(ah){if(ah.size()!==1){return false}return ad.isProcessGroup(ah)};var L=function(ah){if(ah.size()!==1){return false}return s(ah)&&ad.isProcessor(ah)};var E=function(ah){return(ah.empty()&&ad.canReadCurrentGroup())||(ah.size()===1&&ad.isProcessGroup(ah)&&ad.canRead(ah))};var Q=function(ah){if(U.canVersionFlows()===false){return false}if(ah.empty()){if(ad.getParentGroupId()===null){return false}return ad.canReadCurrentGroup()&&ad.canWriteCurrentGroup()}if(a(ah)===true){return ad.canRead(ah)&&ad.canModify(ah)}return false};var W=function(ai){if(Q(ai)===false){return false}if(ai.empty()){var ah=r.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ah.length>0){var aj=ah[ah.length-1];if(aj.permissions.canRead){return U.isUndefinedOrNull(aj.breadcrumb.versionControlInformation)}else{return false}}else{return false}}var ak=ai.datum();return U.isUndefinedOrNull(ak.component.versionControlInformation)};var T=function(ah){var ai=w(ah);return ai!==null&&ai.state==="LOCALLY_MODIFIED"};var ae=function(ah){var ai=w(ah);return ai!==null&&ai.state==="LOCALLY_MODIFIED_AND_STALE"};var f=function(ah){var ai=w(ah);return ai!==null&&(ai.state==="LOCALLY_MODIFIED"||ai.state==="LOCALLY_MODIFIED_AND_STALE")};var ag=function(ah){var ai=w(ah);return ai!==null&&ai.state!=="LOCALLY_MODIFIED"&&ai.state!=="LOCALLY_MODIFIED_AND_STALE"&&ai.state!=="SYNC_FAILURE"};var J=function(ah){var ai=w(ah);return ai!==null};var w=function(ai){if(Q(ai)===false){return null}var ak;if(ai.empty()){var ah=r.injector.get("breadcrumbsCtrl").getBreadcrumbs();if(ah.length>0){var aj=ah[ah.length-1];if(aj.permissions.canRead){ak=aj.breadcrumb.versionControlInformation}else{return null}}else{return null}}else{var al=ai.datum();ak=al.component.versionControlInformation}if(U.isDefinedAndNotNull(ak)){return ak}return null};var u=function(ah){if(ah.size()!==1){return false}return !ad.isLabel(ah)&&!ad.isConnection(ah)&&!ad.isProcessGroup(ah)&&!ad.isRemoteProcessGroup(ah)&&U.canAccessProvenance()};var q=function(ah){if(ah.size()!==1){return false}return ad.isProcessor(ah)&&U.canAccessProvenance()};var c=function(ah){if(ah.size()!==1){return false}if(ad.canRead(ah)===false){return false}return ad.isRemoteProcessGroup(ah)};var F=function(ah){if(ad.canOperate(ah)===false){return false}return ad.canAllStartTransmitting(ah)};var k=function(ah){if(ad.canOperate(ah)===false){return false}return ad.canAllStopTransmitting(ah)};var aa=function(ah){return af(ah)};var l=function(ah){return af(ah)};var z=function(ah){if(ad.canModify(ah)===false){return false}return !ah.empty()&&ad.getComponentByType("Connection").isDisconnected(ah)&&ad.getParentGroupId()!==null};var H=function(ah){ah.remove().find(".group-menu-item").each(function(){var ai=K(this).attr("id");H(K("#"+ai+"-sub-menu"))})};var j=function(ai,ak){var aj=K('<div class="context-menu-item"></div>').attr("id",ak.id).on("mouseenter",function(){K(this).addClass("hover");ai.find(".group-menu-item").not("#"+ak.id).each(function(){var al=K(this).attr("id");H(K("#"+al+"-sub-menu"))})}).on("mouseleave",function(){K(this).removeClass("hover")}).appendTo(ai);var ah=K('<div class="context-menu-item-img"></div>').addClass(ak.clazz).appendTo(aj);if(U.isDefinedAndNotNull(ak.imgStyle)){ah.addClass(ak.imgStyle)}K('<div class="context-menu-item-text"></div>').text(ak.text).appendTo(aj);if(ak.isGroup){K('<div class="fa fa-caret-right context-menu-group-item-img"></div>').appendTo(aj)}K('<div class="clear"></div>').appendTo(aj);return aj};var g=function(ai,ah){ai.css({left:ah.x+"px",top:ah.y+"px"}).show()};var X=function(aj,ai,ah){C[aj](ai,ah);D.hide()};var h=[{id:"reload-menu-item",condition:Z,menuItem:{clazz:"fa fa-refresh",text:"Refresh",action:"reload"}},{id:"leave-group-menu-item",condition:O,menuItem:{clazz:"fa fa-level-up",text:"Leave group",action:"leaveGroup"}},{separator:true},{id:"show-configuration-menu-item",condition:ab,menuItem:{clazz:"fa fa-gear",text:"Configure",action:"showConfiguration"}},{id:"show-details-menu-item",condition:M,menuItem:{clazz:"fa fa-gear",text:"View configuration",action:"showDetails"}},{id:"parameters-menu-item",condition:n,menuItem:{clazz:"fa",text:"Parameters",action:"openParameterContext"}},{separator:true},{id:"version-menu-item",groupMenuItem:{clazz:"fa",text:"Version"},menuItems:[{id:"start-version-control-menu-item",condition:W,menuItem:{clazz:"fa fa-upload",text:"Start version control",action:"saveFlowVersion"}},{separator:true},{id:"commit-menu-item",condition:T,menuItem:{clazz:"fa fa-upload",text:"Commit local changes",action:"saveFlowVersion"}},{id:"force-commit-menu-item",condition:ae,menuItem:{clazz:"fa fa-upload",text:"Commit local changes",action:"forceSaveFlowVersion"}},{id:"local-changes-menu-item",condition:f,menuItem:{clazz:"fa",text:"Show local changes",action:"showLocalChanges"}},{id:"revert-menu-item",condition:f,menuItem:{clazz:"fa fa-undo",text:"Revert local changes",action:"revertLocalChanges"}},{id:"change-version-menu-item",condition:ag,menuItem:{clazz:"fa",text:"Change version",action:"changeFlowVersion"}},{separator:true},{id:"stop-version-control-menu-item",condition:J,menuItem:{clazz:"fa",text:"Stop version control",action:"stopVersionControl"}}]},{separator:true},{id:"enter-group-menu-item",condition:a,menuItem:{clazz:"fa fa-sign-in",text:"Enter group",action:"enterGroup"}},{separator:true},{id:"start-menu-item",condition:s,menuItem:{clazz:"fa fa-play",text:"Start",action:"start"}},{id:"stop-menu-item",condition:R,menuItem:{clazz:"fa fa-stop",text:"Stop",action:"stop"}},{id:"run-once-menu-item",condition:L,menuItem:{clazz:"fa fa-caret-right",text:"Run Once",action:"runOnce"}},{id:"terminate-menu-item",condition:b,menuItem:{clazz:"fa fa-hourglass-end",text:"Terminate",action:"terminate"}},{id:"enable-menu-item",condition:N,menuItem:{clazz:"fa fa-flash",text:"Enable",action:"enable"}},{id:"disable-menu-item",condition:G,menuItem:{clazz:"icon icon-enable-false",text:"Disable",action:"disable"}},{id:"enable-transmission-menu-item",condition:F,menuItem:{clazz:"fa fa-bullseye",text:"Enable transmission",action:"enableTransmission"}},{id:"disable-transmission-menu-item",condition:k,menuItem:{clazz:"icon icon-transmit-false",text:"Disable transmission",action:"disableTransmission"}},{separator:true},{id:"enable-all-controller-services-menu-item",condition:a,menuItem:{clazz:"fa fa-flash",text:"Enable all controller services",action:"enableAllControllerServices"}},{id:"enable-all-controller-services-menu-item-noselection",condition:Z,menuItem:{clazz:"fa fa-flash",text:"Enable all controller services",action:"enableAllControllerServices"}},{id:"disable-all-controller-services-menu-item",condition:a,menuItem:{clazz:"icon icon-enable-false",text:"Disable all controller services",action:"disableAllControllerServices"}},{id:"disable-all-controller-services-menu-item-noselection",condition:Z,menuItem:{clazz:"icon icon-enable-false",text:"Disable all controller services",action:"disableAllControllerServices"}},{separator:true},{id:"data-provenance-menu-item",condition:u,menuItem:{clazz:"icon icon-provenance",imgStyle:"context-menu-provenance",text:"View data provenance",action:"openProvenance"}},{id:"data-provenance-replay-last-menu-item",condition:q,groupMenuItem:{clazz:"fa fa-repeat",text:"Replay last event"},menuItems:[{id:"replay-last-all-nodes-menu-item",condition:q,menuItem:{text:"All nodes",action:"replayLastAllNodes"}},{id:"replay-last-primary-node-menu-item",condition:q,menuItem:{text:"Primary node",action:"replayLastPrimaryNode"}}]},{separator:true},{id:"show-stats-menu-item",condition:m,menuItem:{clazz:"fa fa-area-chart",text:"View status history",action:"showStats"}},{id:"view-state-menu-item",condition:o,menuItem:{clazz:"fa fa-tasks",text:"View state",action:"viewState"}},{id:"list-queue-menu-item",condition:l,menuItem:{clazz:"fa fa-list",text:"List queue",action:"listQueue"}},{id:"show-usage-menu-item",condition:S,menuItem:{clazz:"fa fa-book",text:"View documentation",action:"showUsage"}},{id:"view-menu-item",groupMenuItem:{clazz:"icon icon-connect",text:"View connections"},menuItems:[{id:"show-upstream-menu-item",condition:v,menuItem:{clazz:"icon",text:"Upstream",action:"showUpstream"}},{id:"show-downstream-menu-item",condition:p,menuItem:{clazz:"icon",text:"Downstream",action:"showDownstream"}}]},{separator:true},{id:"refresh-remote-flow-menu-item",condition:c,menuItem:{clazz:"fa fa-refresh",text:"Refresh remote",action:"refreshRemoteFlow"}},{separator:true},{id:"remote-ports-menu-item",condition:c,menuItem:{clazz:"fa fa-cloud",text:"Manage remote ports",action:"remotePorts"}},{id:"manage-policies-menu-item",condition:I,menuItem:{clazz:"fa fa-key",text:"Manage access policies",action:"managePolicies"}},{id:"change-version-menu-item",condition:P,menuItem:{clazz:"fa fa-exchange",text:"Change version",action:"changeVersion"}},{separator:true},{id:"show-source-menu-item",condition:af,menuItem:{clazz:"fa fa-long-arrow-left",text:"Go to source",action:"showSource"}},{id:"show-destination-menu-item",condition:af,menuItem:{clazz:"fa fa-long-arrow-right",text:"Go to destination",action:"showDestination"}},{separator:true},{id:"align-menu-item",groupMenuItem:{clazz:"fa",text:"Align"},menuItems:[{id:"align-horizontal-menu-item",condition:t,menuItem:{clazz:"fa fa-align-center fa-rotate-90",text:"Horizontally",action:"alignHorizontal"}},{id:"align-vertical-menu-item",condition:t,menuItem:{clazz:"fa fa-align-center",text:"Vertically",action:"alignVertical"}}]},{id:"to-front-menu-item",condition:B,menuItem:{clazz:"fa fa-clone",text:"Bring to front",action:"toFront"}},{id:"center-menu-item",condition:y,menuItem:{clazz:"fa fa-crosshairs",text:"Center in view",action:"center"}},{id:"fill-color-menu-item",condition:A,menuItem:{clazz:"fa fa-paint-brush",text:"Change color",action:"fillColor"}},{id:"open-uri-menu-item",condition:c,menuItem:{clazz:"fa fa-external-link",text:"Go to",action:"openUri"}},{separator:true},{id:"move-into-parent-menu-item",condition:z,menuItem:{clazz:"fa fa-arrows",text:"Move to parent group",action:"moveIntoParent"}},{id:"group-menu-item",condition:ac,menuItem:{clazz:"icon icon-group",text:"Group",action:"group"}},{separator:true},{id:"download-menu-item",groupMenuItem:{clazz:"fa",text:"Download flow definition"},menuItems:[{id:"download-menu-item-without",condition:E,menuItem:{clazz:"fa",text:"Without external services",action:"downloadFlowWithoutExternalServices"}},{id:"download-menu-item-with",condition:E,menuItem:{clazz:"fa",text:"With external services",action:"downloadFlowWithExternalServices"}}]},{separator:true},{id:"upload-template-menu-item",condition:d,menuItem:{clazz:"icon icon-template-import",text:"Upload template",action:"uploadTemplate"}},{id:"template-menu-item",condition:V,menuItem:{clazz:"icon icon-template-save",text:"Create template",action:"template"}},{separator:true},{id:"copy-menu-item",condition:i,menuItem:{clazz:"fa fa-copy",text:"Copy",action:"copy"}},{id:"paste-menu-item",condition:e,menuItem:{clazz:"fa fa-paste",text:"Paste",action:"paste"}},{separator:true},{id:"empty-queue-menu-item",condition:aa,menuItem:{clazz:"fa fa-minus-circle",text:"Empty queue",action:"emptyQueue"}},{id:"empty-all-queues-menu-item",condition:a,menuItem:{clazz:"fa fa-minus-circle",text:"Empty all queues",action:"emptyAllQueues"}},{id:"empty-all-queues-menu-item-noselection",condition:Z,menuItem:{clazz:"fa fa-minus-circle",text:"Empty all queues",action:"emptyAllQueues"}},{id:"delete-menu-item",condition:x,menuItem:{clazz:"fa fa-trash",text:"Delete",action:"delete"}}];var D={init:function(ah){C=ah;K("#context-menu").on("contextmenu",function(ai){ai.preventDefault();ai.stopPropagation()})},show:function(ai){nf.ContextMenu.hide();var am=K("#context-menu").empty();var ap=K("#canvas-body").get(0);var av=K("#banner-footer").get(0);var an=K("#breadcrumbs").get(0);var at=ad.getSelection();var aq=Y.pointer(ai,ap);var aj=function(aw,ax){return aw+ax.width()>ap.clientWidth};var ak=function(ax,aw){return ax+aw.height()>(ap.clientHeight-an.clientHeight-av.clientHeight)};var au=function(ax,ay,aw){j(ax,{id:ay,clazz:aw.clazz,imgStyle:aw.imgStyle,text:aw.text,isGroup:false}).on("click",function(az){X(aw.action,at,az)}).on("contextmenu",function(az){X(aw.action,at,az);az.preventDefault();az.stopPropagation()})};var ar=function(ay,ax,aw,az){j(ay,{id:ax,clazz:aw.clazz,imgStyle:aw.imgStyle,text:aw.text,isGroup:true}).addClass("group-menu-item").on("mouseenter",function(){if(K("#"+ax+"-sub-menu").length==0){var aE=K(this);var aB=ay.position();var aD=aE.position();var aA=aB.left+aD.left+aE.width();var aF=aB.top+aD.top;var aC=K('<div class="context-menu unselectable sub-menu"></div>').attr("id",ax+"-sub-menu").appendTo("body");ah(aC,az);if(aj(aA,aC)){aA-=(aC.width()+aE.width()-4)}if(ak(aF,aC)){aF-=(aC.height()-aE.height())}aC.css({top:aF+"px",left:aA+"px"}).show()}})};var ao=function(ax){if(ax.separator){return true}else{if(ax.menuItem){return ax.condition(at)}else{var aw=[];K.each(ax.menuItems,function(ay,az){if(ao(az)){aw.push(az)}});return aw.length>0}}};var ah=function(az,aw){var ax=false;K.each(aw,function(aA,aB){if(aB.separator&&ax){K('<div class="context-menu-item-separator"></div>').appendTo(az);ax=false}else{if(al(az,aB)){ax=true}}});var ay=az.children().last();if(ay.hasClass("context-menu-item-separator")){ay.remove()}};var al=function(ay,aw){var ax=false;if(aw.menuItem){ax=aw.condition(at);if(ax){au(ay,aw.id,aw.menuItem)}}else{if(aw.groupMenuItem){var aA=[];K.each(aw.menuItems,function(aC,aB){if(ao(aB)){aA.push(aB)}});var az=K.grep(aA,function(aB){return U.isUndefinedOrNull(aB.separator)});ax=az.length>0;if(ax){ar(ay,aw.id,aw.groupMenuItem,aA)}}}return ax};ah(am,h);if(aj(aq[0],am)){aq[0]=ap.clientWidth-am.width()-2}if(ak(aq[1],am)){aq[1]=ap.clientHeight-an.clientHeight-av.clientHeight-am.height()-9}g(am,{x:aq[0],y:aq[1]});r.digest()},hide:function(){K("#context-menu").hide();K("div.context-menu.sub-menu").remove()},activate:function(ah){ah.on("contextmenu.selection",function(ai){D.show(ai);ai.preventDefault();ai.stopPropagation()})}};return D}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.CanvasUtils"],function(d,c){return(nf.QuickSelect=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.QuickSelect=b(require("d3"),require("nf.CanvasUtils")))}else{nf.QuickSelect=b(a.d3,a.nf.CanvasUtils)}}}(this,function(d,c){var b;var a={init:function(e){b=e},quickSelect:function(f){var e=c.getSelection();if(c.isConfigurable(e)){b.showConfiguration(e)}else{if(c.hasDetails(e)){b.showDetails(e)}}f.preventDefault();f.stopPropagation()},activate:function(e){e.on("dblclick",function(f){a.quickSelect(f)})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.ng.Bridge","nf.ContextMenu","nf.CanvasUtils"],function(f,d,c,e){return(nf.Selectable=b(f,d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Selectable=b(require("d3"),require("nf.ng.Bridge"),require("nf.ContextMenu"),require("nf.CanvasUtils")))}else{nf.Selectable=b(a.d3,a.nf.ng.Bridge,a.nf.ContextMenu,a.nf.CanvasUtils)}}}(this,function(d,b,a,c){var e={select:function(h,f){a.hide();if(!f.classed("selected")){if(!h.shiftKey){d.selectAll("g.selected").classed("selected",false)}f.classed("selected",true)}else{if(h.shiftKey){f.classed("selected",false)}}b.digest();h.stopPropagation()},activate:function(f){f.on("mousedown.selection",function(g){e.select(g,d.select(this));c.setURLParameters()})}};return e}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.CanvasUtils","nf.ContextMenu","nf.Label","nf.ng.D3Helpers"],function(g,f,h,e,c,i,d){return(nf.Birdseye=b(g,f,h,e,c,i,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Birdseye=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ContextMenu"),require("nf.Label"),require("nf.ng.D3Helpers")))}else{nf.Birdseye=b(a.$,a.d3,a.nf.Common,a.nf.CanvasUtils,a.nf.ContextMenu,a.nf.Label,a.nf.ng.D3Helpers)}}}(this,function(g,m,d,e,k,f,l){var h;var c;var j;var i=function(G){var E=e.getCanvasTranslate();var V=e.getCanvasScale();E=[E[0]/V,E[1]/V];var y=m.select("#canvas").node().getBoundingClientRect();var n=(y.left/V)-E[0];var A=((y.top-e.getCanvasOffset())/V)-E[1];var F=(y.right/V)-E[0];var t=(y.bottom/V)-E[1];var I=g("#canvas-container");var J=I.width()/V;var T=I.height()/V;var z=-E[0];var N=-E[1];var U=z+J;var w=N+T;var L=Math.min(n,z);var O=Math.min(A,N);var q=Math.max(F,U);var R=Math.max(t,w);var S=q-L;var o=R-O;var D=g("#birdseye");var C=D.width();var v=D.height();var M=C/S;var u=v/o;var K=Math.min(M,u);var s=[0,0];var p=[0,0];if(E[0]<0&&E[1]<0){s=[0,0];p=[-E[0],-E[1]]}else{if(E[0]>=0&&E[1]<0){s=[E[0],0];p=[0,-E[1]]}else{if(E[0]<0&&E[1]>=0){s=[0,E[1]];p=[-E[0],0]}else{s=[E[0],E[1]];p=[0,0]}}}var Q=0;var x=-n;if(E[0]<0){if(E[0]<x){Q=x}else{Q=x-(x-E[0])}}else{if(E[0]<x){Q=x-E[0]}}var P=0;var H=-A;if(E[1]<0){if(E[1]<H){P=H}else{P=H-(H-E[1])}}else{if(E[1]<H){P=H-E[1]}}s=[s[0]+Q,s[1]+P];p=[p[0]+Q,p[1]+P];c.attr("transform","scale("+K+")");j.attr("transform","translate("+s+")");l.multiAttr(m.select("rect.birdseye-brush"),{width:J,height:T,"stroke-width":(2/K),transform:function(W){W.x=p[0];W.y=p[1];return"translate("+p+")"}});var B=m.select("#birdseye-canvas").node();var r=B.getContext("2d");r.save();r.setTransform(1,0,0,1,0,0);r.clearRect(0,0,B.width,B.height);r.restore();r.save();r.translate(s[0]*K,s[1]*K);r.scale(K,K);g.each(G.labels,function(X,Y){var W=f.defaultColor();if(Y.permissions.canRead){if(d.isDefinedAndNotNull(Y.component.style["background-color"])){W=Y.component.style["background-color"]}}r.fillStyle=W;r.fillRect(Y.position.x,Y.position.y,Y.dimensions.width,Y.dimensions.height)});r.fillStyle="#ad9897";g.each(G.funnels,function(W,X){r.fillRect(X.position.x,X.position.y,X.dimensions.width,X.dimensions.height)});r.fillStyle="#bbdcde";g.each(G.ports,function(W,X){r.fillRect(X.position.x,X.position.y,X.dimensions.width,X.dimensions.height)});r.fillStyle="#728e9b";g.each(G.remoteProcessGroups,function(W,X){r.fillRect(X.position.x,X.position.y,X.dimensions.width,X.dimensions.height)});g.each(G.processGroups,function(W,X){r.fillRect(X.position.x,X.position.y,X.dimensions.width,X.dimensions.height)});g.each(G.processors,function(X,Y){var W="#dde4eb";if(Y.permissions.canRead){if(d.isDefinedAndNotNull(Y.component.style["background-color"])){W=Y.component.style["background-color"];if(W==="#ffffff"){W="#dde4eb"}}}r.fillStyle=W;r.fillRect(Y.position.x,Y.position.y,Y.dimensions.width,Y.dimensions.height)});r.restore()};var b=true;var a={init:function(n){h=n;var q=g("#birdseye");m.select("#birdseye").append("canvas").attr("id","birdseye-canvas").attr("width",q.width()).attr("height",q.height());var p=m.select("#birdseye").append("svg").attr("width",q.width()).attr("height",q.height());c=p.append("g").attr("class","birdseye");j=c.append("g").attr("pointer-events","none");var o=m.drag().subject(function(r){return{x:r.x,y:r.y,source:"birdseye"}}).on("drag",function(r,s){s.x+=r.dx;s.y+=r.dy;m.select(this).attr("transform",function(){return"translate("+s.x+", "+s.y+")"});e.translateCanvas([-r.dx,-r.dy])}).on("end",function(){h.updateVisibility();e.persistUserView();a.refresh()});l.multiAttr(c.append("g"),{"pointer-events":"all","class":"birdseye-brush-container"}).append("rect").attr("class","birdseye-brush moveable").datum({x:0,y:0}).call(o)},refresh:function(){if(b){i(h.get())}},updateBirdseyeVisibility:function(n){var o=g("#birdseye");if(n){o.show();b=true;i(h.get())}else{o.hide();b=false}}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage","nf.Connection","nf.Birdseye","nf.CanvasUtils","nf.Common","nf.Dialog","nf.Client","nf.ErrorHandler"],function(g,l,h,j,c,e,d,f,k,i){return(nf.Draggable=b(g,l,h,j,c,e,d,f,k,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Draggable=b(require("jquery"),require("d3"),require("nf.Storage"),require("nf.Connection"),require("nf.Birdseye"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.ErrorHandler")))}else{nf.Draggable=b(a.$,a.d3,a.nf.Storage,a.nf.Connection,a.nf.Birdseye,a.nf.CanvasUtils,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.ErrorHandler)}}}(this,function(g,q,i,l,a,d,c,f,p,k){var m;var h;var o=8;var n=true;var j=function(s){var v=new Map();var u=s.datum();var w={x:u.x-u.original.x,y:u.y-u.original.y};if(w.x===0&&w.y===0){return}var r=q.selectAll("g.connection.selected");var t=q.selectAll("g.component.selected");if(d.canModify(r)===false||d.canModify(t)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}r.each(function(y){var x=e.updateConnectionPosition(y,w);if(x!==null){v.set(y.id,x)}});t.each(function(y){var x=l.getComponentConnections(y.id);g.each(x,function(B,A){if(!v.has(A.id)&&d.getConnectionSourceComponentId(A)===d.getConnectionDestinationComponentId(A)){var z=e.updateConnectionPosition(l.get(A.id),w);if(z!==null){v.set(A.id,z)}}});v.set(y.id,e.updateComponentPosition(y,w))});e.refreshConnections(v)};var b=function(s){var r=q.selectAll("g.component.selected, g.connection.selected").classed("selected",false);if(d.canModify(r)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}if(d.canModify(s)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Not authorized to modify the destination group."});return}d.moveComponents(r,s)};var e={init:function(r){m=r;h=q.drag().on("start",function(s){s.sourceEvent.stopPropagation()}).on("drag",function(v){var t=q.select("rect.drag-selection");if(t.empty()){var u=q.selectAll("g.component.selected");var s=null,x=null,y=null,w=null;u.each(function(B){if(s===null||B.position.x<s){s=B.position.x}if(y===null||B.position.y<y){y=B.position.y}var A=B.position.x+B.dimensions.width;var z=B.position.y+B.dimensions.height;if(x===null||A>x){x=A}if(w===null||z>w){w=z}});q.select("#canvas").append("rect").attr("rx",6).attr("ry",6).attr("x",s).attr("y",y).attr("class","drag-selection").attr("pointer-events","none").attr("width",x-s).attr("height",w-y).attr("stroke-width",function(){return 1/d.getCanvasScale()}).attr("stroke-dasharray",function(){return 4/d.getCanvasScale()}).datum({original:{x:s,y:y},x:s,y:y})}else{n=!v.sourceEvent.shiftKey;t.attr("x",function(z){z.x+=v.dx;return n?(Math.round(z.x/o)*o):z.x}).attr("y",function(z){z.y+=v.dy;return n?(Math.round(z.y/o)*o):z.y})}}).on("end",function(t){t.sourceEvent.stopPropagation();var s=q.select("rect.drag-selection");if(s.empty()){return}var u=q.select("g.drop").classed("drop",false);if(u.empty()){j(s)}else{b(u)}s.remove()})},updateComponentPosition:function(t,u){var s={x:n?(Math.round((t.position.x+u.x)/o)*o):t.position.x+u.x,y:n?(Math.round((t.position.y+u.y)/o)*o):t.position.y+u.y};var r={revision:p.getRevision(t),disconnectedNodeAcknowledged:i.isDisconnectionAcknowledged(),component:{id:t.id,position:s}};return g.Deferred(function(v){g.ajax({type:"PUT",url:t.uri,data:JSON.stringify(r),dataType:"json",contentType:"application/json"}).done(function(w){d.getComponentByType(t.type).set(w);v.resolve({type:t.type,id:t.id})}).fail(function(y,w,x){k.handleAjaxError(y,w,x);v.reject()})}).promise()},updateConnectionPosition:function(t,u){if(t.bends.length===0){return null}var s=g.map(t.bends,function(v){return{x:v.x+u.x,y:v.y+u.y}});var r={revision:p.getRevision(t),disconnectedNodeAcknowledged:i.isDisconnectionAcknowledged(),component:{id:t.id,bends:s}};return g.Deferred(function(v){g.ajax({type:"PUT",url:t.uri,data:JSON.stringify(r),dataType:"json",contentType:"application/json"}).done(function(w){l.set(w);v.resolve({type:t.type,id:t.id})}).fail(function(y,w,x){k.handleAjaxError(y,w,x);v.reject()})}).promise()},refreshConnections:function(r){if(r.size>0){g.when.apply(window,Array.from(r.values())).done(function(){var s=g.makeArray(arguments);var t=new Set();g.each(s,function(w,v){if(v.type==="Connection"){t.add(v.id)}else{var u=l.getComponentConnections(v.id);g.each(u,function(y,x){t.add(x.id)})}});t.forEach(function(u){l.refresh(u)})}).always(function(){a.refresh()})}},activate:function(r){r.classed("moveable",true).call(h)},deactivate:function(r){r.classed("moveable",false).on(".drag",null)}};return e}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.Connection","nf.ConnectionConfiguration","nf.CanvasUtils","nf.ng.D3Helpers"],function(e,g,f,d,c){return(nf.Connectable=b(e,g,f,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Connectable=b(require("d3"),require("nf.Connection"),require("nf.ConnectionConfiguration"),require("nf.CanvasUtils"),require("nf.ng.D3Helpers")))}else{nf.Connectable=b(a.d3,a.nf.Connection,a.nf.ConnectionConfiguration,a.nf.CanvasUtils,a.nf.ng.D3Helpers)}}}(this,function(i,f,d,c,h){var j;var a;var g;var b={urls:{api:"../nifi-api",}};var e=function(k){return !k.shiftKey&&i.select("rect.drag-selection").empty()&&i.select("rect.component-selection").empty()};return{init:function(){a=i.select("#canvas");j=i.drag().subject(function(k,l){g=i.pointer(k,a.node());return{x:g[0],y:g[1]}}).on("start",function(m){m.sourceEvent.stopPropagation();c.getSelection().classed("selected",false);var n=i.select(this.parentNode).classed("selected",true);i.select(this).classed("dragging",true);var l=n.datum();const k=i.pointer(m,a.node());h.multiAttr(a.insert("path",":first-child").datum({sourceId:l.id,sourceWidth:l.dimensions.width/2,x:l.position.x+(l.dimensions.width/2),y:l.position.y+(l.dimensions.height/2)}),{"class":"connector",d:function(o){return"M"+o.x+" "+o.y+"L"+o.x+" "+o.y}});i.select(this).attr("transform",function(){return"translate("+k[0]+", "+(k[1]+20)+")"});a.node().appendChild(this)}).on("drag",function(l){i.select(this).attr("transform",function(){return"translate("+l.x+", "+(l.y+50)+")"});var k=i.select("g.hover").classed("connectable-destination",function(){return(Math.abs(g[0]-l.x)>10||Math.abs(g[1]-l.y)>10)&&c.isValidConnectionDestination(i.select(this))});i.select("path.connector").classed("connectable",function(){if(k.empty()){return false}return k.classed("connectable-destination")}).attr("d",function(t){if(!k.empty()&&k.classed("connectable-destination")){var o=k.datum();if(t.sourceId===o.id){var m=t.x;var s=t.y;var q=t.sourceWidth/2;var p=f.config.selfLoopXOffset;var r=f.config.selfLoopYOffset;return"M"+m+" "+s+"L"+(m+q+p)+" "+(s-r)+"L"+(m+q+p)+" "+(s+r)+"Z"}else{var n=c.getPerimeterPoint(t,{x:o.position.x,y:o.position.y,width:o.dimensions.width,height:o.dimensions.height});return"M"+t.x+" "+t.y+"L"+n.x+" "+n.y}}else{return"M"+t.x+" "+t.y+"L"+l.x+" "+l.y}})}).on("end",function(l,r){l.sourceEvent.stopPropagation();var t=i.select(this);var o=i.select("path.connector");var m=o.datum();var s=i.select("g.connectable-destination");if(s.empty()){var k=i.select("#id-"+m.sourceId);var q=k.datum();var p=i.pointer(l,k.node());if(p[0]<0||p[0]>q.dimensions.width||p[1]<0||p[1]>q.dimensions.height){t.remove()}else{t.classed("dragging",false).attr("transform",function(){return"translate("+r.origX+", "+r.origY+")"});k.node().appendChild(this)}o.remove()}else{t.remove();var n=s.datum();$.ajax({type:"GET",url:b.urls.api+"/process-groups/"+encodeURIComponent(n.component.parentGroupId),dataType:"json"}).done(function(u){var v={flowfileExpiration:u.component.defaultFlowFileExpiration,objectThreshold:u.component.defaultBackPressureObjectThreshold,dataSizeThreshold:u.component.defaultBackPressureDataSizeThreshold,};d.createConnection(m.sourceId,n.id,v)})}})},activate:function(k){k.classed("connectable",true).on("mouseenter.connectable",function(o,p){if(e(o)){var m=i.select(this);if(c.isValidConnectionSource(m)){var n=i.select("text.add-connect");if(n.empty()){var l=(p.dimensions.width/2)-14;var q=(p.dimensions.height/2)+14;m.append("text").attr("class","add-connect").attr("transform","translate("+l+", "+q+")").text("\ue834").datum({origX:l,origY:q}).call(j)}}}}).on("mouseleave.connectable",function(){var l=i.select(this).select("text.add-connect");if(!l.empty()&&!l.classed("dragging")){l.remove()}}).on("mouseover.connectable",function(){i.select(this).classed("hover",function(l){return e(l)})}).on("mouseout.connection",function(){i.select(this).classed("hover connectable-destination",false)})},deactivate:function(k){k.classed("connectable",false).on("mouseenter.connectable",null).on("mouseleave.connectable",null).on("mouseover.connectable",null).on("mouseout.connectable",null)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.ng.Bridge","nf.Label","nf.Funnel","nf.Port","nf.RemoteProcessGroup","nf.ProcessGroup","nf.Processor","nf.Connection","nf.ConnectionConfiguration","nf.CanvasUtils","nf.Connectable","nf.Draggable","nf.Selectable","nf.ContextMenu","nf.QuickSelect"],function(d,s,f,t,k,p,c,m,e,l,h,q,r,j,n,i,o,g){return(nf.Graph=b(d,s,f,t,k,p,c,m,e,l,h,q,r,j,n,i,o,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Graph=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.ng.Bridge"),require("nf.Label"),require("nf.Funnel"),require("nf.Port"),require("nf.RemoteProcessGroup"),require("nf.ProcessGroup"),require("nf.Processor"),require("nf.Connection"),require("nf.ConnectionConfiguration"),require("nf.CanvasUtils"),require("nf.Connectable"),require("nf.Draggable"),require("nf.Selectable"),require("nf.ContextMenu"),require("nf.QuickSelect")))}else{nf.Graph=b(a.$,a.d3,a.nf.Common,a.nf.ng.Bridge,a.nf.Label,a.nf.Funnel,a.nf.Port,a.nf.RemoteProcessGroup,a.nf.ProcessGroup,a.nf.Processor,a.nf.Connection,a.nf.ConnectionConfiguration,a.nf.CanvasUtils,a.nf.Connectable,a.nf.Draggable,a.nf.Selectable,a.nf.ContextMenu,a.nf.QuickSelect)}}}(this,function(b,u,e,v,j,q,a,l,d,k,g,r,s,i,n,h,o,f){var p=function(w){if(e.isDefinedAndNotNull(w.inputPorts)&&e.isDefinedAndNotNull(w.outputPorts)){return w.inputPorts.concat(w.outputPorts)}else{if(e.isDefinedAndNotNull(w.inputPorts)){return w.inputPorts}else{if(e.isDefinedAndNotNull(w.outputPorts)){return w.outputPorts}else{return[]}}}};var m=function(w){if(e.isDefinedAndNotNull(w.inputPortStatusSnapshots)&&e.isDefinedAndNotNull(w.outputPortStatusSnapshots)){return w.inputPortStatusSnapshots.concat(w.outputPortStatusSnapshots)}else{if(e.isDefinedAndNotNull(w.inputPortStatusSnapshots)){return w.inputPortStatusSnapshots}else{if(e.isDefinedAndNotNull(w.outputPortStatusSnapshots)){return w.outputPortStatusSnapshots}else{return[]}}}};var t=function(){var E=b("#canvas-container");var z=s.getCanvasTranslate();var A=s.getCanvasScale();z=[z[0]/A,z[1]/A];var w=E.width()/A;var x=E.height()/A;var B=-z[0]-w;var y=-z[1]-x;var G=B+(w*3);var I=y+(x*3);var D=function(N){if(!s.shouldRenderPerScale()){return false}var M=N.position.x;var L=N.position.y;var K=M+N.dimensions.width;var J=L+N.dimensions.height;return B<K&&G>M&&y<J&&I>L};var F=function(L){if(!s.shouldRenderPerScale()){return false}var J,M;if(L.bends.length>0){var K=Math.min(Math.max(0,L.labelIndex),L.bends.length-1);J=L.bends[K].x;M=L.bends[K].y}else{J=(L.start.x+L.end.x)/2;M=(L.start.y+L.end.y)/2}return B<J&&G>J&&y<M&&I>M};var C=function(N,J){var L=u.select("#id-"+N.id);var M=J(N);var K=L.classed("visible");L.classed("visible",M).classed("entering",function(){return M&&!K}).classed("leaving",function(){return !M&&K})};var H=c.get();b.each(H.processors,function(J,K){C(K,D)});b.each(H.ports,function(J,K){C(K,D)});b.each(H.processGroups,function(J,K){C(K,D)});b.each(H.remoteProcessGroups,function(J,K){C(K,D)});b.each(H.connections,function(J,K){C(K,F)})};var c={init:function(){j.init(i,n,h,o,f);q.init(i,n,h,o);a.init(i,n,h,o,f);l.init(i,n,h,o,f);d.init(i,n,h,o);k.init(i,n,h,o,f);g.init(h,o,f,r);return s.showDeepLink(true)},add:function(y,w){var x=false;if(e.isDefinedAndNotNull(w)){x=e.isDefinedAndNotNull(w.selectAll)?w.selectAll:x}if(x){s.getSelection().classed("selected",false)}var z=p(y);j.add(y.labels,w);q.add(y.funnels,w);l.add(y.remoteProcessGroups,w);a.add(z,w);d.add(y.processGroups,w);k.add(y.processors,w);g.add(y.connections,w);if(x){v.digest()}},set:function(y,w){var x=false;if(e.isDefinedAndNotNull(w)){x=e.isDefinedAndNotNull(w.selectAll)?w.selectAll:x}if(x){s.getSelection().classed("selected",false)}var z=p(y);j.set(y.labels,w);q.set(y.funnels,w);l.set(y.remoteProcessGroups,w);a.set(z,w);d.set(y.processGroups,w);k.set(y.processors,w);g.set(y.connections,w);if(x){v.digest()}},expireCaches:function(w){j.expireCaches(w);q.expireCaches(w);l.expireCaches(w);a.expireCaches(w);d.expireCaches(w);k.expireCaches(w);g.expireCaches(w)},get:function(){return{labels:j.get(),funnels:q.get(),ports:a.get(),remoteProcessGroups:l.get(),processGroups:d.get(),processors:k.get(),connections:g.get()}},getComponentByType:function(w){switch(w){case"Label":return j;break;case"Funnel":return q;break;case"Port":return a;break;case"RemoteProcessGroup":return l;break;case"ProcessGroup":return d;break;case"Processor":return k;break;case"Connection":return g;break;default:throw new Error("Unknown component type.");break}},removeAll:function(){j.removeAll();q.removeAll();a.removeAll();l.removeAll();d.removeAll();k.removeAll();g.removeAll()},pan:function(){a.pan();l.pan();d.pan();k.pan();g.pan()},updateVisibility:function(){t();c.pan();s.setURLParameters()},getSelection:function(){return u.selectAll("g.component.selected, g.connection.selected")},reload:function(w){var x=w.datum();if(x.permissions.canRead){if(s.isProcessor(w)){k.reload(x.id)}else{if(s.isInputPort(w)){a.reload(x.id)}else{if(s.isRemoteProcessGroup(w)){l.reload(x.id)}}}}}};return c}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ng.Bridge","nf.ErrorHandler","nf.Dialog","nf.Storage","nf.Common","nf.Client","nf.CanvasUtils","nf.ProcessGroup","nf.ProcessGroupConfiguration","nf.Graph","nf.Birdseye"],function(i,k,m,h,j,f,n,g,d,e,l,c){return(nf.FlowVersion=b(i,k,m,h,j,f,n,g,d,e,l,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.FlowVerison=b(require("jquery"),require("nf.ng.Bridge"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Storage"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ProcessGroup"),require("nf.ProcessGroupConfiguration"),require("nf.Graph"),require("nf.Birdseye")))}else{nf.FlowVersion=b(a.$,a.nf.ng.Bridge,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Storage,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ProcessGroup,a.nf.ProcessGroupConfiguration,a.nf.Graph,a.nf.Birdseye)}}}(this,function(v,k,b,h,o,E,f,K,r,z,n,d){var p=null;var u={autosizeColsMode:Slick.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var L=function(){v("#save-flow-version-registry-combo").combo("destroy").hide();v("#save-flow-version-bucket-combo").combo("destroy").hide();v("#save-flow-version-label").text("");v("#save-flow-version-registry").text("").hide();v("#save-flow-version-bucket").text("").hide();v("#save-flow-version-name").text("").hide();v("#save-flow-version-description").removeClass("unset blank").text("").hide();v("#save-flow-version-name-field").val("").hide();v("#save-flow-version-description-field").val("").hide();v("#save-flow-version-change-comments").val("");v("#save-flow-version-process-group-id").removeData("versionControlInformation").removeData("revision").text("");v("#save-flow-version-action").text("")};var D=function(){v("#revert-local-changes-process-group-id").text("");A(v("#revert-local-changes-table"),v("#revert-local-changes-filter"),v("#displayed-revert-local-changes-entries"),v("#total-revert-local-changes-entries"))};var a=function(){A(v("#show-local-changes-table"),v("#show-local-changes-filter"),v("#displayed-show-local-changes-entries"),v("#total-show-local-changes-entries"))};var A=function(W,S,U,V){var R=W.data("gridInstance");if(E.isDefinedAndNotNull(R)){R.setSelectedRows([]);R.resetActiveCell();var T=R.getData();T.setItems([]);T.setFilterArgs({searchString:""})}S.val("");U.text("0");V.text("0")};var m=function(){var R=v("#import-flow-version-table").data("gridInstance");if(E.isDefinedAndNotNull(R)){R.setSelectedRows([]);R.resetActiveCell();var S=R.getData();S.setItems([])}};var Q=function(){v("#import-flow-version-dialog").removeData("pt");v("#import-flow-version-registry-combo").combo("destroy").hide();v("#import-flow-version-bucket-combo").combo("destroy").hide();v("#import-flow-version-name-combo").combo("destroy").hide();v("#import-flow-version-registry").text("").hide();v("#import-flow-version-bucket").text("").hide();v("#import-flow-version-name").text("").hide();m();v("#import-flow-version-process-group-id").removeData("versionControlInformation").removeData("revision").text("");v("#import-flow-version-container").hide();v("#import-flow-version-label").text("");v("#keep-parameter-context-container").hide()};var O=function(T,R,V,S,U,W){return v.ajax({type:"GET",url:"../nifi-api/flow/registries",dataType:"json"}).done(function(X){var Y=[];if(E.isDefinedAndNotNull(X.registries)&&X.registries.length>0){X.registries.sort(function(aa,Z){return aa.registry.name>Z.registry.name});v.each(X.registries,function(aa,ab){var Z=ab.registry;Y.push({text:Z.name,value:Z.id,description:E.escapeHtml(Z.description),disabled:Z.validationStatus!=="VALID"})})}else{Y.push({text:"No available registries",value:null,optionClass:"unset",disabled:true})}R.combo({options:Y,select:function(Z){l(T,Z,V,S,U,W)}})}).fail(b.handleAjaxError)};var P=function(R,U,S,T,V){return v.ajax({type:"GET",url:"../nifi-api/flow/registries/"+encodeURIComponent(R)+"/buckets",dataType:"json"}).done(function(W){var X=[];if(E.isDefinedAndNotNull(W.buckets)&&W.buckets.length>0){W.buckets.sort(function(Z,Y){if(Z.permissions.canRead===false&&Y.permissions.canRead===false){return 0}else{if(Z.permissions.canRead===false){return -1}else{if(Y.permissions.canRead===false){return 1}}}return Z.bucket.name>Y.bucket.name});v.each(W.buckets,function(Z,Y){if(Y.permissions.canRead===true){var aa=Y.bucket;if(V(Y)){X.push({text:aa.name,value:aa.id,description:E.escapeHtml(aa.description)})}}})}if(X.length===0){X.push({text:"No available buckets",value:null,optionClass:"unset",disabled:true});if(E.isDefinedAndNotNull(S)){S.combo("destroy").combo({options:[{text:"No available flows",value:null,optionClass:"unset",disabled:true}]})}}U.combo("destroy").combo({options:X,select:T})}).fail(b.handleAjaxError)};var l=function(S,V,U,R,T,X){var W=function(){U.combo("destroy").combo({options:[{text:"No available buckets",value:null,optionClass:"unset",disabled:true}]});if(E.isDefinedAndNotNull(R)){R.combo("destroy").combo({options:[{text:"No available flows",value:null,optionClass:"unset",disabled:true}]})}S.modal("refreshButtons")};if(V.disabled===true){W()}else{U.combo("destroy").combo({options:[{text:"Loading buckets...",value:null,optionClass:"unset",disabled:true}]});if(E.isDefinedAndNotNull(R)){R.combo("destroy").combo({options:[{text:"Loading flows...",value:null,optionClass:"unset",disabled:true}]});m()}P(V.value,U,R,T,X).fail(function(){W()})}};var c=function(R){v("#save-flow-version-dialog").modal("refreshButtons")};var x=function(){var R=v("#save-flow-version-process-group-id").text();var T=v("#save-flow-version-process-group-id").data("revision");var W={processGroupRevision:f.getRevision({revision:{version:T.version}}),disconnectedNodeAcknowledged:o.isDisconnectionAcknowledged()};var U=v("#save-flow-version-process-group-id").data("versionControlInformation");if(E.isDefinedAndNotNull(U)){W.versionedFlow={registryId:U.registryId,bucketId:U.bucketId,flowId:U.flowId,comments:v("#save-flow-version-change-comments").val(),action:v("#save-flow-version-action").text()}}else{var S=v("#save-flow-version-registry-combo").combo("getSelectedOption");var V=v("#save-flow-version-bucket-combo").combo("getSelectedOption");W.versionedFlow={registryId:S.value,bucketId:V.value,flowName:v("#save-flow-version-name-field").val(),description:v("#save-flow-version-description-field").val(),comments:v("#save-flow-version-change-comments").val(),action:v("#save-flow-version-action").text()}}return v.ajax({type:"POST",data:JSON.stringify(W),url:"../nifi-api/versions/process-groups/"+encodeURIComponent(R),dataType:"json",contentType:"application/json"}).done(function(X){if("SYNC_FAILURE"===X.versionControlInformation.state){h.showOkDialog({headerText:"Error",dialogContent:X.versionControlInformation.stateExplanation})}}).fail(b.handleAjaxError)};var M=function(R,T){var S=function(V,U){var X=E.isBlank(V[R.columnId]);var W=E.isBlank(U[R.columnId]);if(X&&W){return 0}else{if(X){return 1}else{if(W){return -1}}}return V[R.columnId]===U[R.columnId]?0:V[R.columnId]>U[R.columnId]?1:-1};T.sort(S,R.sortAsc)};var t=function(){var W=v("#import-flow-version-table");var T=function(ab,Y,aa,Z,X){return E.escapeHtml(aa)};var S=function(ae,Y,ad,aa,X){var ac=new Date();var Z=ac.getTimezoneOffset()*60*1000;var ab=new Date(X.timestamp+Z+p);return E.formatDateTime(ab)};var R=[{id:"version",name:"Version",field:"version",formatter:T,sortable:true,resizable:true,width:75,maxWidth:75},{id:"timestamp",name:"Created",field:"timestamp",formatter:S,sortable:true,resizable:true,width:175,maxWidth:175},{id:"changeComments",name:"Comments",field:"comments",sortable:true,resizable:true,formatter:T}];var V=new Slick.Data.DataView({inlineFilters:false});M({columnId:"version",sortAsc:false},V);var U=new Slick.Grid(W,V,R,u);U.setSelectionModel(new Slick.RowSelectionModel());U.registerPlugin(new Slick.AutoTooltips());U.setSortColumn("version",false);U.onSort.subscribe(function(Y,X){M({columnId:X.sortCol.id,sortAsc:X.sortAsc},V)});U.onSelectedRowsChanged.subscribe(function(Y,X){v("#import-flow-version-dialog").modal("refreshButtons")});U.onDblClick.subscribe(function(Y,X){if(v("#import-flow-version-label").is(":visible")){s()}else{B().always(function(){v("#import-flow-version-dialog").modal("hide")})}});V.onRowCountChanged.subscribe(function(Y,X){U.updateRowCount();U.render()});V.onRowsChanged.subscribe(function(Y,X){U.invalidateRows(X.rows);U.render()});V.syncGridSelection(U,true);W.data("gridInstance",U)};var J=function(Y,V,aa,S){var Z=function(){return V.val()};var U=function(){var ad=Y.data("gridInstance");if(E.isDefinedAndNotNull(ad)){var ae=ad.getData();ae.setFilterArgs({searchString:Z()});ae.refresh()}};var T=function(ag,ad){if(ad.searchString===""){return true}try{var ak=new RegExp(ad.searchString,"i")}catch(ai){return false}var ae=ag.componentId.search(ak)>=0;var aj=ag.differenceType.search(ak)>=0;var af=ag.difference.search(ak)>=0;var ah=false;if(E.isDefinedAndNotNull(ag.componentName)){ah=ag.componentName.search(ak)>=0}return ae||ah||aj||af};V.on("keyup",function(){U()});var X=function(ah,ae,ag,af,ad){return E.escapeHtml(ag)};var ac=function(ai,ae,ah,ag,ad){var af="";if(ad.differenceType!=="Component Removed"&&E.isDefinedAndNotNull(ad.processGroupId)){af+='<div class="pointer go-to-component fa fa-long-arrow-right" title="Go To"></div>'}return af};var ab=[{id:"componentName",name:"Component Name",field:"componentName",formatter:X,sortable:true,resizable:true},{id:"differenceType",name:"Change Type",field:"differenceType",formatter:X,sortable:true,resizable:true},{id:"difference",name:"Difference",field:"difference",formatter:X,sortable:true,resizable:true},{id:"actions",name:"&nbsp;",formatter:ac,sortable:false,resizable:false,width:25}];var R=new Slick.Data.DataView({inlineFilters:false});R.setFilterArgs({searchString:Z()});R.setFilter(T);M({columnId:"componentName",sortAsc:true},R);var W=new Slick.Grid(Y,R,ab,u);W.setSelectionModel(new Slick.RowSelectionModel());W.registerPlugin(new Slick.AutoTooltips());W.setSortColumn("componentName",true);W.onSort.subscribe(function(ae,ad){M({columnId:ad.sortCol.id,sortAsc:ad.sortAsc},R)});W.onClick.subscribe(function(ag,ae){var af=v(ag.target);var ad=R.getItem(ae.row);if(W.getColumns()[ae.cell].id==="actions"){if(af.hasClass("go-to-component")){if(ad.componentType==="Controller Service"){z.showConfiguration(ad.processGroupId).done(function(){z.selectControllerService(ad.componentId);Y.closest(".large-dialog").modal("hide")})}else{K.showComponent(ad.processGroupId,ad.componentId).done(function(){Y.closest(".large-dialog").modal("hide")})}}}});R.onRowCountChanged.subscribe(function(ae,ad){W.updateRowCount();W.render();aa.text(E.formatInteger(ad.current))});R.onRowsChanged.subscribe(function(ae,ad){W.invalidateRows(ad.rows);W.render()});R.syncGridSelection(W,true);Y.data("gridInstance",W);aa.text("0");S.text("0")};var H=function(U){v("#import-flow-version-dialog").data("pt",U);var R=v("#import-flow-version-registry-combo").combo("destroy").combo({options:[{text:"Loading registries...",value:null,optionClass:"unset",disabled:true}]}).show();var T=v("#import-flow-version-bucket-combo").combo("destroy").combo({options:[{text:"Loading buckets...",value:null,optionClass:"unset",disabled:true}]}).show();var S=v("#import-flow-version-name-combo").combo("destroy").combo({options:[{text:"Loading flows...",value:null,optionClass:"unset",disabled:true}]}).show();v("#keep-parameter-context-container").show();O(v("#import-flow-version-dialog"),R,T,S,F,function(V){return true}).done(function(){v("#import-flow-version-dialog").modal("setHeaderText","Import Version").modal("setButtonModel",[{buttonText:"Import",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:N,handler:{click:function(){B().always(function(){v("#import-flow-version-dialog").modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){v(this).modal("hide")}}}]).modal("show");v("#keepExistingParameterContext").removeClass("checkbox-unchecked").addClass("checkbox-checked");v("#new-process-group-dialog").modal("hide")})};var i=function(S,T,R){return v.ajax({type:"GET",url:"../nifi-api/flow/registries/"+encodeURIComponent(S)+"/buckets/"+encodeURIComponent(T)+"/flows/"+encodeURIComponent(R)+"/details",dataType:"json"}).done(function(U){var V=v("#import-flow-version-details");var W=v("#import-flow-description-container");if(U.versionedFlow.description){V.text(U.versionedFlow.description);if(V.get(0).scrollHeight>Math.round(W.innerHeight())){W.css("border-width","1px")}else{W.css("border-width","0")}}else{V.text("No description provided.");W.css("border-width","0")}}).fail(b.handleAjaxError)};var y=function(S,V,R){var T=v("#import-flow-version-table").data("gridInstance");var U=T.getData();U.beginUpdate();T.setSelectedRows([]);T.resetActiveCell();U.setItems([]);return v.ajax({type:"GET",url:"../nifi-api/flow/registries/"+encodeURIComponent(S)+"/buckets/"+encodeURIComponent(V)+"/flows/"+encodeURIComponent(R)+"/versions",dataType:"json"}).done(function(W){if(E.isDefinedAndNotNull(W.versionedFlowSnapshotMetadataSet)&&W.versionedFlowSnapshotMetadataSet.length>0){v.each(W.versionedFlowSnapshotMetadataSet,function(Y,X){U.addItem(v.extend({id:X.versionedFlowSnapshotMetadata.version},X.versionedFlowSnapshotMetadata))})}else{h.showOkDialog({headerText:"Flow Versions",dialogContent:"This flow does not have any versions available."})}}).fail(b.handleAjaxError).always(function(){U.endUpdate();U.reSort();T.invalidate()})};var G=function(R,S,T){return v.ajax({type:"GET",url:"../nifi-api/flow/registries/"+encodeURIComponent(R)+"/buckets/"+encodeURIComponent(S)+"/flows",dataType:"json"}).done(function(U){var V=[];if(E.isDefinedAndNotNull(U.versionedFlows)&&U.versionedFlows.length>0){U.versionedFlows.sort(function(X,W){return X.versionedFlow.flowName>W.versionedFlow.flowName});v.each(U.versionedFlows,function(X,W){var Y=W.versionedFlow;V.push({text:Y.flowName,value:Y.flowId,description:E.escapeHtml(Y.description)})})}else{V.push({text:"No available flows",value:null,optionClass:"unset",disabled:true})}v("#import-flow-version-name-combo").combo("destroy").combo({options:V,select:function(W){if(E.isDefinedAndNotNull(W.value)){T(R,S,W.value);i(R,S,W.value)}else{var X=v("#import-flow-version-table").data("gridInstance");var Y=X.getData();Y.beginUpdate();Y.setItems([]);Y.endUpdate()}}})}).fail(b.handleAjaxError)};var q=function(S,T,R){y(S,T,R).done(function(){v("#import-flow-version-dialog").modal("refreshButtons")})};var F=function(S){m();if(E.isDefinedAndNotNull(S.value)){v("#import-flow-version-name-combo").combo("destroy").combo({options:[{text:"Loading flows...",value:null,optionClass:"unset",disabled:true}]});var R=v("#import-flow-version-registry-combo").combo("getSelectedOption");G(R.value,S.value,q)}else{v("#import-flow-version-name-combo").combo("destroy").combo({options:[{text:"No available flows",value:null,optionClass:"unset",disabled:true}]})}};var B=function(){var X=v("#import-flow-version-dialog").data("pt");var U=v("#import-flow-version-registry-combo").combo("getSelectedOption");var Y=v("#import-flow-version-bucket-combo").combo("getSelectedOption");var R=v("#import-flow-version-name-combo").combo("getSelectedOption");var T=v("#import-flow-version-table").data("gridInstance");var S=T.getSelectedRows();var W=T.getDataItem(S[0]);var V={revision:f.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:o.isDisconnectionAcknowledged(),component:{position:{x:X.x,y:X.y},versionControlInformation:{registryId:U.value,bucketId:Y.value,flowId:R.value,version:W.version}}};return v.ajax({type:"POST",data:JSON.stringify(V),url:"../nifi-api/process-groups/"+encodeURIComponent(K.getGroupId())+"/process-groups?"+v.param({parameterContextHandlingStrategy:v("#keepExistingParameterContext").hasClass("checkbox-checked")?"KEEP_EXISTING":"REPLACE"}),dataType:"json",contentType:"application/json"}).done(function(Z){n.add({processGroups:[Z]},{selectAll:true});n.updateVisibility();d.refresh()}).fail(b.handleAjaxError)};var N=function(){var T=v("#import-flow-version-table").data("gridInstance");if(E.isDefinedAndNotNull(T)){var U=T.getSelectedRows();if(v("#import-flow-version-label").is(":visible")){if(U.length===1){var S=T.getDataItem(U[0]);var R=parseInt(v("#import-flow-version-label").text(),10);return R===S.version}else{return true}}else{return U.length!==1}}else{return true}};var s=function(){var ac=null;var T=null;var W=false;var S=v("#import-flow-version-process-group-id").text();var ad=v("#import-flow-version-process-group-id").data("revision");var ae=v("#import-flow-version-process-group-id").data("versionControlInformation");var R=v("#import-flow-version-table").data("gridInstance");var aa=R.getSelectedRows();var X=R.getDataItem(aa[0]);v("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){W=true;v("#change-version-status-dialog").modal("setButtonModel",[]);if(ac!==null){clearTimeout(ac);ab()}}}}]);v("#import-flow-version-dialog").modal("hide");var U=function(){var af={processGroupRevision:f.getRevision({revision:{version:ad.version}}),disconnectedNodeAcknowledged:o.isDisconnectionAcknowledged(),versionControlInformation:{groupId:S,registryId:ae.registryId,bucketId:ae.bucketId,flowId:ae.flowId,version:X.version}};return v.ajax({type:"POST",data:JSON.stringify(af),url:"../nifi-api/versions/update-requests/process-groups/"+encodeURIComponent(S),dataType:"json",contentType:"application/json"}).done(function(){g(0);v("#change-version-status-dialog").modal("show")}).fail(b.handleAjaxError)};var Y=function(){Z().done(V)};var Z=function(){return v.ajax({type:"GET",url:T.uri,dataType:"json"}).fail(ab).fail(b.handleAjaxError)};var ab=function(){if(W===true){v("#change-version-status-message").text("The change version request has been cancelled.");v("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){v(this).modal("hide")}}}])}if(E.isDefinedAndNotNull(T)){v.ajax({type:"DELETE",url:T.uri+"?"+v.param({disconnectedNodeAcknowledged:o.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(af){T=af.request;e(S);if(E.isDefinedAndNotNull(T.failureReason)){v("#change-version-status-dialog").modal("hide");h.showOkDialog({headerText:"Change Version",dialogContent:E.escapeHtml(T.failureReason)})}else{g(T.percentCompleted);v("#change-version-status-message").text("This Process Group version has changed.");v("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){v(this).modal("hide")}}}])}})}};var V=function(af){T=af.request;if(T.complete===true||W===true){ab()}else{g(T.percentCompleted);v("#change-version-status-message").text(T.state);ac=setTimeout(function(){ac=null;Y()},2000)}};U().done(V)};var C=function(R){return v.Deferred(function(S){if(R===K.getGroupId()){v.ajax({type:"GET",url:"../nifi-api/versions/process-groups/"+encodeURIComponent(R),dataType:"json"}).done(function(U){S.resolve(U)}).fail(function(){S.reject()})}else{var T=r.get(R);if(T.permissions.canRead===true&&T.permissions.canWrite===true){S.resolve({processGroupRevision:T.revision,versionControlInformation:T.component.versionControlInformation})}else{S.reject()}}}).promise()};var I=function(R,S){if(K.getGroupId()===R){k.injector.get("breadcrumbsCtrl").updateVersionControlInformation(R,S);k.digest()}else{r.reload(R)}};var e=function(R){if(K.getGroupId()===R){v.ajax({type:"GET",url:"../nifi-api/flow/process-groups/"+encodeURIComponent(R),dataType:"json"}).done(function(T){n.set(T.processGroupFlow.flow);n.updateVisibility();var S=k.injector.get("breadcrumbsCtrl");S.resetBreadcrumbs();S.generateBreadcrumbs(T.processGroupFlow.breadcrumb);k.digest()}).fail(b.handleAjaxError)}else{r.reload(R)}};var g=function(S){var T=v("#change-version-percent-complete");T.find("div.progress-label").remove();T.find("md-progress-linear").remove();var R=v('<div class="progress-label"></div>').text(S+"%");(k.injector.get("$compile")(v('<md-progress-linear ng-cloak ng-value="'+S+'" class="md-hue-2" md-mode="determinate" aria-label="Searching Queue"></md-progress-linear>'))(k.rootScope)).appendTo(T);T.append(R)};var w=function(R,S,Y,X){var T=Y.data("gridInstance");var U=T.getData();U.beginUpdate();T.setSelectedRows([]);T.resetActiveCell();U.setItems([]);var W=C(R).done(function(Z){if(E.isDefinedAndNotNull(Z.versionControlInformation)){var aa=Z.versionControlInformation;S.text("The following changes have been made to "+aa.flowName+" (Version "+aa.version+").")}else{h.showOkDialog({headerText:"Change Version",dialogContent:"This Process Group is not currently under version control."})}});var V=v.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(R)+"/local-modifications",dataType:"json"}).done(function(Z){if(E.isDefinedAndNotNull(Z.componentDifferences)&&Z.componentDifferences.length>0){var aa=0;v.each(Z.componentDifferences,function(ac,ab){v.each(ab.differences,function(ad,ae){U.addItem({id:aa++,componentId:ab.componentId,componentName:ab.componentName,componentType:ab.componentType,processGroupId:ab.processGroupId,differenceType:ae.differenceType,difference:ae.difference})})});U.endUpdate();U.reSort();T.invalidate();X.text(E.formatInteger(aa))}else{h.showOkDialog({headerText:"Local Changes",dialogContent:"This Process Group does not have any local changes."})}}).fail(b.handleAjaxError);return v.when(W,V)};var j=function(R){C(R).done(function(V){if(E.isDefinedAndNotNull(V.versionControlInformation)){var aa=null;var Z=null;var W=false;v("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){W=true;v("#change-version-status-dialog").modal("setButtonModel",[]);if(aa!==null){clearTimeout(aa);Y()}}}}]);v("#import-flow-version-dialog").modal("hide");var T=function(){var ab={processGroupRevision:f.getRevision({revision:{version:V.processGroupRevision.version}}),disconnectedNodeAcknowledged:o.isDisconnectionAcknowledged(),versionControlInformation:V.versionControlInformation};return v.ajax({type:"POST",data:JSON.stringify(ab),url:"../nifi-api/versions/revert-requests/process-groups/"+encodeURIComponent(R),dataType:"json",contentType:"application/json"}).done(function(){g(0);v("#change-version-status-dialog").modal("show")}).fail(b.handleAjaxError)};var U=function(){X().done(S)};var X=function(){return v.ajax({type:"GET",url:Z.uri,dataType:"json"}).fail(Y).fail(b.handleAjaxError)};var Y=function(){if(W===true){v("#change-version-status-message").text("The revert request has been cancelled.");v("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){v(this).modal("hide")}}}])}if(E.isDefinedAndNotNull(Z)){v.ajax({type:"DELETE",url:Z.uri+"?"+v.param({disconnectedNodeAcknowledged:o.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(ab){Z=ab.request;e(R);if(E.isDefinedAndNotNull(Z.failureReason)){v("#change-version-status-dialog").modal("hide");h.showOkDialog({headerText:"Revert Local Changes",dialogContent:E.escapeHtml(Z.failureReason)})}else{g(Z.percentCompleted);v("#change-version-status-message").text("This Process Group version has changed.");v("#change-version-status-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){v(this).modal("hide")}}}])}})}};var S=function(ab){Z=ab.request;if(Z.complete===true||W===true){Y()}else{g(Z.percentCompleted);v("#change-version-status-message").text(Z.state);aa=setTimeout(function(){aa=null;U()},2000)}};T().done(S)}else{h.showOkDialog({headerText:"Revert Changes",dialogContent:"This Process Group is not currently under version control."})}}).fail(b.handleAjaxError)};return{init:function(R){p=R;v("#save-flow-version-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Save Flow Version",buttons:[{buttonText:"Save",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(v("#save-flow-version-registry-combo").is(":visible")){var S=v("#save-flow-version-registry-combo").combo("getSelectedOption");var T=v("#save-flow-version-bucket-combo").combo("getSelectedOption");if(E.isDefinedAndNotNull(S)&&E.isDefinedAndNotNull(T)){return S.disabled===true||T.disabled===true}else{return true}}else{return false}},handler:{click:function(){var S=v("#save-flow-version-process-group-id").text();x().done(function(T){I(S,T.versionControlInformation)});v(this).modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){v(this).modal("hide")}}}],handler:{close:function(){L()}}});v("#import-flow-version-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){Q()}}});v("#change-version-status-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Change Flow Version",handler:{close:function(){v("#change-version-status-dialog").modal("setButtonModel",[])}}});v("#revert-local-changes-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Revert Local Changes",buttons:[{buttonText:"Revert",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var S=v("#revert-local-changes-process-group-id").text();j(S);v(this).modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){v(this).modal("hide")}}}],handler:{close:function(){D()}}});v("#show-local-changes-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Show Local Changes",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){v(this).modal("hide")}}}],handler:{close:function(){a()}}});t();J(v("#revert-local-changes-table"),v("#revert-local-changes-filter"),v("#displayed-revert-local-changes-entries"),v("#total-revert-local-changes-entries"));J(v("#show-local-changes-table"),v("#show-local-changes-filter"),v("#displayed-show-local-changes-entries"),v("#total-show-local-changes-entries"))},showImportFlowDialog:function(R){H(R)},showFlowVersionDialog:function(R,T){var S=true;return v.Deferred(function(U){C(R).done(function(V){if(E.isDefinedAndNotNull(V.versionControlInformation)){var Y=V.versionControlInformation;v("#save-flow-version-registry").text(Y.registryName).show();v("#save-flow-version-bucket").text(Y.bucketName).show();if(T=="COMMIT"){v("#save-flow-version-label").text(Y.version+1).show()}else{v("#save-flow-version-label").hide()}v("#save-flow-version-name").text(Y.flowName).show();E.populateField("save-flow-version-description",Y.flowDescription);v("#save-flow-version-description").show();v("#save-flow-version-process-group-id").data("versionControlInformation",Y);v("#save-flow-version-action").text(T);v("#save-flow-version-label").css("margin-top","-15px");S=false;U.resolve()}else{var W=v("#save-flow-version-registry-combo").combo("destroy").combo({options:[{text:"Loading registries...",value:null,optionClass:"unset",disabled:true}]}).show();var X=v("#save-flow-version-bucket-combo").combo("destroy").combo({options:[{text:"Loading buckets...",value:null,optionClass:"unset",disabled:true}]}).show();v("#save-flow-version-label").text(1).show();v("#save-flow-version-name-field").show();v("#save-flow-version-description-field").show();v("#save-flow-version-action").text(T);v("#save-flow-version-label").css("margin-top","0");O(v("#save-flow-version-dialog"),W,X,null,c,function(Z){return Z.permissions.canWrite===true}).done(function(){U.resolve()}).fail(function(){U.reject()})}v("#save-flow-version-process-group-id").data("revision",V.processGroupRevision).text(R)}).fail(b.handleAjaxError)}).done(function(){v("#save-flow-version-dialog").modal("show");if(S){v("#save-flow-version-name-field").focus()}else{v("#save-flow-version-change-comments").focus()}}).fail(function(){v("#save-flow-version-dialog").modal("refreshButtons")}).promise()},revertLocalChanges:function(R){w(R,v("#revert-local-changes-message"),v("#revert-local-changes-table"),v("#total-revert-local-changes-entries")).done(function(){v("#revert-local-changes-process-group-id").text(R);v("#revert-local-changes-dialog").modal("show")})},showLocalChanges:function(R){w(R,v("#show-local-changes-message"),v("#show-local-changes-table"),v("#total-show-local-changes-entries")).done(function(){v("#show-local-changes-dialog").modal("show")})},showChangeFlowVersionDialog:function(R){return v.Deferred(function(S){C(R).done(function(T){if(E.isDefinedAndNotNull(T.versionControlInformation)){var U=T.versionControlInformation;v("#import-flow-version-registry").text(U.registryName).show();v("#import-flow-version-bucket").text(U.bucketName).show();v("#import-flow-version-name").text(U.flowName).show();v("#import-flow-version-container").show();v("#import-flow-version-label").text(U.version);v("#keep-parameter-context-container").hide();v("#import-flow-version-process-group-id").data("versionControlInformation",U).data("revision",T.processGroupRevision).text(R);y(U.registryId,U.bucketId,U.flowId).done(function(){S.resolve()}).fail(function(){h.showOkDialog({headerText:"Change Version",dialogContent:"Unable to load available versions for this Process Group."});S.reject()})}else{h.showOkDialog({headerText:"Change Version",dialogContent:"This Process Group is not currently under version control."});S.reject()}}).fail(b.handleAjaxError)}).done(function(){v("#import-flow-version-dialog").modal("setHeaderText","Change Version").modal("setButtonModel",[{buttonText:"Change",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:N,handler:{click:function(){s()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){v(this).modal("hide")}}}]).modal("show")}).promise()},stopVersionControl:function(R){h.showYesNoDialog({headerText:"Stop Version Control",dialogContent:"Are you sure you want to stop version control?",noText:"Cancel",yesText:"Disconnect",yesHandler:function(){v.ajax({type:"GET",url:"../nifi-api/versions/process-groups/"+encodeURIComponent(R),dataType:"json"}).done(function(S){if(E.isDefinedAndNotNull(S.versionControlInformation)){var T=f.getRevision({revision:{version:S.processGroupRevision.version}});v.ajax({type:"DELETE",url:"../nifi-api/versions/process-groups/"+encodeURIComponent(R)+"?"+v.param(v.extend({disconnectedNodeAcknowledged:o.isDisconnectionAcknowledged()},T)),dataType:"json",contentType:"application/json"}).done(function(U){I(R,undefined);h.showOkDialog({headerText:"Disconnect",dialogContent:"This Process Group is no longer under version control."})}).fail(b.handleAjaxError)}else{h.showOkDialog({headerText:"Disconnect",dialogContent:"This Process Group is not currently under version control."})}}).fail(b.handleAjaxError)}})}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.FilteredDialogCommon=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.FilteredDialogCommon=b(require("jquery")))}else{nf.FilteredDialogCommon=b(a.$)}}}(this,function(a){var b={addKeydownListener:function(e,d,c){var f=[a.ui.keyCode.UP,a.ui.keyCode.PAGE_UP,a.ui.keyCode.DOWN,a.ui.keyCode.PAGE_DOWN];a(e).off("keydown").on("keydown",function(j){var i=j.keyCode?j.keyCode:j.which;if(a.inArray(i,f)===-1||j.shiftKey||j.altKey||j.ctrlKey){return}var h=d.getSelectedRows();if(h.length>0){if(i===a.ui.keyCode.PAGE_UP){d.navigatePageUp();return}if(i===a.ui.keyCode.PAGE_DOWN){d.navigatePageDown();return}var g=h[0];if(i===a.ui.keyCode.UP){g=Math.max(g-1,0)}else{g=Math.min(g+1,c.getLength()-1)}b.choseRow(d,g);d.scrollRowIntoView(g,false)}})},choseFirstRow:function(c){b.choseRow(c,0)},choseRow:function(d,c){d.setSelectedRows([c]);d.setActiveCell(c,0)}};return b}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.ErrorHandler"],function(e,c,f,d,g){return(nf.StatusHistory=b(e,c,f,d,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.StatusHistory=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.ErrorHandler")))}else{nf.StatusHistory=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.ErrorHandler)}}}(this,function(e,y,i,t,g){var x={nifiInstanceId:"nifi-instance-id",nifiInstanceLabel:"NiFi",type:{processor:"Processor",inputPort:"Input Port",outputPort:"Output Port",processGroup:"Process Group",remoteProcessGroup:"Remote Process Group",connection:"Connection",funnel:"Funnel",template:"Template",label:"Label",node:"Node"},urls:{api:"../nifi-api"}};var w={DURATION:function(A){return i.formatDuration(A)},COUNT:function(A){if(A%1===0){return i.formatInteger(A)}else{return i.formatFloat(A)}},DATA_SIZE:function(A){return i.formatDataSize(A)},FRACTION:function(A){return i.formatFloat(A/1000000)}};var o=null;var c=null;var r=null;var d=null;var l=function(C,G,E,B,F){e("#status-history-last-refreshed").text(E.generated);var A={groupId:C,id:G,type:B,instances:[]};var D=E.fieldDescriptors;A.details=E.componentDetails;A.selectedDescriptor=i.isUndefined(F)?D[0]:F;if(i.isDefinedAndNotNull(E.aggregateSnapshots)&&E.aggregateSnapshots.length>1){A.instances.push({id:x.nifiInstanceId,label:x.nifiInstanceLabel,snapshots:E.aggregateSnapshots})}else{k();return}e.each(E.nodeSnapshots,function(I,H){if(i.isDefinedAndNotNull(H.statusSnapshots)&&H.statusSnapshots.length>1){A.instances.push({id:H.nodeId,label:H.address+":"+H.apiPort,snapshots:H.statusSnapshots})}});if(A.instances.length>0){e("#status-history-dialog").data("status-history",A);s(A,D)}else{k()}};var h=function(C){e("#status-history-last-refreshed").text(C.generated);var A={type:"Node",instances:[]};var B=C.fieldDescriptors;A.details=C.componentDetails;A.selectedDescriptor=B[0];if(i.isDefinedAndNotNull(C.aggregateSnapshots)&&C.aggregateSnapshots.length>1){A.instances.push({id:x.nifiInstanceId,label:x.nifiInstanceLabel,snapshots:C.aggregateSnapshots})}else{k();return}e.each(C.nodeSnapshots,function(E,D){if(i.isDefinedAndNotNull(D.statusSnapshots)&&D.statusSnapshots.length>1){A.instances.push({id:D.nodeId,label:D.address+":"+D.apiPort,snapshots:D.statusSnapshots})}});if(A.instances.length>0){e("#status-history-dialog").data("status-history",A);s(A,B)}else{k()}};var k=function(){t.showOkDialog({headerText:"Status History",dialogContent:"Insufficient history, please try again later."})};var s=function(A,B){if(d===null){d={}}e.each(A.instances,function(D,C){C.snapshots.forEach(function(G){var F=new Date();var E=F.getTimezoneOffset()*60*1000;G.timestamp=new Date(G.timestamp+E+o)})});n(B,A.selectedDescriptor)};var n=function(C,B){var A=[];e.each(C,function(D,E){A.push({text:E.label,value:E.field,description:i.escapeHtml(E.description)})});e("#status-history-metric-combo").combo({selectedOption:{value:B.field},options:A,select:function(E){var F=null;e.each(C,function(G,H){if(E.value===H.field){F=H;return false}});if(F!==null){if(r===null||r.field!==F.field){c=null}r=F;var D=e("#status-history-dialog").data("status-history");D.selectedDescriptor=F;e("#status-history-dialog").data("status-history",D);m()}}});e("#status-history-dialog").modal("show")};var a=function(){return e("#status-history-chart-container").parent().outerHeight()-e("#status-history-chart-control-container").outerHeight()-parseInt(e("#status-history-chart-control-container").css("margin-top"),10)};var z=function(){return e("body").height()-e("#status-history-chart-control-container").outerHeight()-e("#status-history-refresh-container").outerHeight()-parseInt(e("#status-history-chart-control-container").css("margin-top"),10)-parseInt(e(".dialog-content").css("top"))-parseInt(e(".dialog-content").css("bottom"))};var v=function(){return e("body").width()-e("#status-history-details").innerWidth()-parseInt(e("#status-history-dialog").css("left"),10)-parseInt(e(".dialog-content").css("left"))-parseInt(e(".dialog-content").css("right"))};var m=function(){var ai=e("#status-history-dialog");if(ai.is(":visible")){var ab=ai.data("status-history");var ah=ab.selectedDescriptor;e("#status-history-details").empty();var D=p("Status History");Object.entries(ab.details).forEach(function(aw,ax){j(D,aw,ax)});var F={top:15,right:20,bottom:25,left:75};var Y=y.scaleOrdinal(y.schemeCategory10);var C=[];e.each(ab.instances,function(ax,aw){C.push(aw.label)});Y.domain(C);var at=[];e.each(ab.instances,function(ax,aw){if(i.isUndefinedOrNull(d[aw.id])){d[aw.id]=true}at.push({id:aw.id,label:aw.label,values:e.map(aw.snapshots,function(ay){return{timestamp:ay.timestamp,value:ay.statusMetrics[ah.field]}}),visible:d[aw.id]===true})});var P=function(aw){if(aw.getMilliseconds()){return y.timeFormat(":%S.%L")(aw)}else{if(aw.getSeconds()){return y.timeFormat(":%S")(aw)}else{if(aw.getMinutes()||aw.getHours()){return y.timeFormat("%H:%M")(aw)}else{if(aw.getDay()&&aw.getDate()!==1){return y.timeFormat("%a %d")(aw)}else{if(aw.getDate()!==1){return y.timeFormat("%b %d")(aw)}else{if(aw.getMonth()){return y.timeFormat("%B")(aw)}else{return y.timeFormat("%Y")(aw)}}}}}}};var O=e("#status-history-chart-container").empty();if(O.hasClass("ui-resizable")){O.resizable("destroy");O.removeAttr("style")}O.height(a());var A=O.outerWidth()-F.left-F.right;var B=O.outerHeight()-F.top-F.bottom;W=e("#status-history-container").width();if(A>W){A=W}an=z();if(B>an){B=an}var af=y.scaleTime().range([0,A]);var V=y.axisBottom(af).ticks(5).tickFormat(P);var ae=y.scaleLinear().range([B,0]);var G=y.axisLeft(ae).tickFormat(w[ah.formatter]);var H=y.line().curve(y.curveMonotoneX).x(function(aw){return af(aw.timestamp)}).y(function(aw){return ae(aw.value)});var N=y.select("#status-history-chart-container").append("svg").attr("style","pointer-events: none;").attr("width",O.parent().width()).attr("height",O.innerHeight());var I=N.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",A).attr("height",B);var av=N.append("g").attr("transform","translate("+F.left+", "+F.top+")");var E=y.min(at,function(aw){return y.min(aw.values,function(ax){return ax.timestamp})});var L=y.max(at,function(aw){return y.max(aw.values,function(ax){return ax.timestamp})});j(D,"Start",i.formatDateTime(E));j(D,"End",i.formatDateTime(L));af.domain([E,L]);ae.domain([q(at),u(at)]);av.append("g").attr("class","x axis").attr("transform","translate(0, "+B+")").call(V);av.append("g").attr("class","y axis").call(G).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").attr("text-anchor","end").text(ah.label);var ac=av.selectAll(".status").data(at).enter().append("g").attr("clip-path","url(#clip)").attr("class","status");ac.append("path").attr("class",function(aw){return"chart-line chart-line-"+aw.id}).attr("d",function(aw){return H(aw.values)}).attr("stroke",function(aw){return Y(aw.label)}).classed("hidden",function(aw){return aw.visible===false}).append("title").text(function(aw){return aw.label});ac.each(function(aw){var ax=y.select(this).append("g").attr("class",function(){return"mark-group mark-group-"+aw.id}).classed("hidden",function(ay){return ay.visible===false});ax.selectAll("circle.mark").data(aw.values).enter().append("circle").attr("style","pointer-events: all;").attr("class","mark").attr("cx",function(ay){return af(ay.timestamp)}).attr("cy",function(ay){return ae(ay.value)}).attr("fill",function(){return Y(aw.label)}).attr("r",1.5).append("title").text(function(ay){return aw.label+" -- "+w[ah.formatter](ay.value)})});N.attr("width",O.parent().width()).attr("height",O.innerHeight());I.attr("width",A).attr("height",B);av.select(".x.axis").attr("transform","translate(0, "+B+")");var U=e("#status-history-chart-control-container").empty();var S=U.innerHeight()-F.top-F.bottom;var al=y.scaleTime().range([0,A]);var K=y.axisBottom(al).ticks(5).tickFormat(P);var ap=y.scaleLinear().range([S,0]);var aj=y.axisLeft(ap).tickValues(ae.domain()).tickFormat(w[ah.formatter]);var R=y.line().curve(y.curveMonotoneX).x(function(aw){return al(aw.timestamp)}).y(function(aw){return ap(aw.value)});var ag=y.select("#status-history-chart-control-container").append("svg").attr("width",O.parent().width()).attr("height",S+F.top+F.bottom);var X=ag.append("g").attr("transform","translate("+F.left+", "+F.top+")");al.domain(af.domain());ap.domain(ae.domain());X.append("g").attr("class","x axis").attr("transform","translate(0, "+S+")").call(K);X.append("g").attr("class","y axis").call(aj);var au=X.selectAll(".status").data(at).enter().append("g").attr("class","status");au.append("path").attr("class",function(aw){return"chart-line chart-line-"+aw.id}).attr("d",function(aw){return R(aw.values)}).attr("stroke",function(aw){return Y(aw.label)}).classed("hidden",function(aw){return d[aw.id]===false}).append("title").text(function(aw){return aw.label});var M=function(){var aB=e.map(at,function(aH){var aF=af.domain();var aG=ae.domain();var aI=e.extend({},aH);return e.extend(aI,{values:e.grep(aH.values,function(aJ){return aJ.timestamp.getTime()>=aF[0].getTime()&&aJ.timestamp.getTime()<=aF[1].getTime()&&aJ.value>=aG[0]&&aJ.value<=aG[1]})})});var aw=e.grep(aB,function(aF){return aF.id!==x.nifiInstanceId&&aF.visible&&aF.values.length>0});var aA=aw.length===0?"NA":w[ah.formatter](q(aw));var az=aw.length===0?"NA":w[ah.formatter](f(aw));var ax=aw.length===0?"NA":w[ah.formatter](u(aw));e("#node-aggregate-statistics").text(aA+" / "+ax+" / "+az);var aD=e.grep(aB,function(aF){return aF.id===x.nifiInstanceId&&aF.visible&&aF.values.length>0});var aE=aD.length===0?"NA":w[ah.formatter](q(aD));var aC=aD.length===0?"NA":w[ah.formatter](f(aD));var ay=aD.length===0?"NA":w[ah.formatter](u(aD));e("#cluster-aggregate-statistics").text(aE+" / "+ay+" / "+aC)};var ar=function(aw,ax){af.domain(aw);ae.domain(ax);ac.selectAll(".chart-line").attr("d",function(ay){return H(ay.values)});ac.selectAll("circle.mark").attr("cx",function(ay){return af(ay.timestamp)}).attr("cy",function(ay){return ae(ay.value)}).attr("r",function(){return y.brushSelection(Q.node())===null?1.5:4});av.select(".x.axis").call(V);av.select(".y.axis").call(G)};var J=function(){c=y.brushSelection(Q.node());var ax,aw;if(c===null){var ay=e.grep(at,function(az){return az.visible});if(ay.length===0){aw=ap.domain()}else{aw=[y.min(ay,function(az){return y.min(az.values,function(aA){return aA.value})}),y.max(ay,function(az){return y.max(az.values,function(aA){return aA.value})})]}ax=al.domain()}else{ax=[c[0][0],c[1][0]].map(al.invert,al);aw=[c[1][1],c[0][1]].map(ap.invert,ap)}ar(ax,aw);M()};var am=y.brush().extent([[al.range()[0],ap.range()[1]],[al.range()[1],ap.range()[0]]]).on("brush",J);var Q=X.append("g").attr("class","brush").on("click",J).call(am);if(i.isDefinedAndNotNull(c)){am=am.move(Q,c)}X.select("rect.selection").attr("style","pointer-events: all;").on("dblclick",function(){if(c!==null){var aw=ap.range();am.move(Q,[[c[0][0],aw[1]],[c[1][0],aw[0]]])}});var ad=e.grep(at,function(aw){return aw.id!==x.nifiInstanceId}).sort(function(ax,aw){return ax.label<aw.label?-1:ax.label>aw.label?1:0});var aq=function(ax,aw){var az=e("<div></div>").addClass("legend-label nf-checkbox-label").css("color",Y(aw.label)).text(aw.label).ellipsis();var ay=e('<div class="nf-checkbox"></div>').on("click",function(){var aA=y.selectAll("path.chart-line-"+aw.id);var aC=y.select("g.mark-group-"+aw.id);var aB=aC.classed("hidden");aA.classed("hidden",function(){return !aB});aC.classed("hidden",function(){return !aB});aw.visible=aB;d[aw.id]=aw.visible;J()}).addClass(aw.visible?"checkbox-checked":"checkbox-unchecked");e('<div class="legend-entry"></div>').append(ay).append(az).on("mouseenter",function(){y.selectAll("path.chart-line-"+aw.id).classed("over",true)}).on("mouseleave",function(){y.selectAll("path.chart-line-"+aw.id).classed("over",false)}).appendTo(ax)};var aa=e.grep(at,function(aw){return aw.id===x.nifiInstanceId});var ak=p("NiFi");j(ak,"Min / Max / Mean","","cluster-aggregate-statistics");aq(ak,aa[0]);if(ad.length>0){var Z=p("Nodes");j(Z,"Min / Max / Mean","","node-aggregate-statistics");e.each(ad,function(ax,aw){aq(Z,aw)})}J();var W,an,T,ao;O.append('<div class="ui-resizable-handle ui-resizable-se"></div>').resizable({minWidth:425,minHeight:150,handles:{se:".ui-resizable-se"},resize:function(ay,ax){ao=e("#status-history-dialog");var aw={};if(i.isDefinedAndNotNull(ao.data("nf-dialog"))){aw=ao.data("nf-dialog")}aw["min-width"]=(ao.width()/e(window).width())*100+"%";aw["min-height"]=(ao.height()/e(window).height())*100+"%";aw.responsive["fullscreen-width"]=ao.outerWidth()+"px";aw.responsive["fullscreen-height"]=ao.outerHeight()+"px";W=v();if(ax.helper.width()>W){ax.helper.width(W);aw.responsive["fullscreen-width"]=e(window).width()+"px";aw["min-width"]="100%"}an=z();if(ax.helper.height()>an){ax.helper.height(an);aw.responsive["fullscreen-height"]=e(window).height()+"px";aw["min-height"]="100%"}T=a();if(ax.helper.height()<T){ax.helper.height(T)}aw["min-width"]=(parseInt(aw["min-width"],10)>=100)?"100%":aw["min-width"];aw["min-height"]=(parseInt(aw["min-height"],10)>=100)?"100%":aw["min-height"];ao.data("nfDialog",aw);ao.css("min-width",(O.outerWidth()+e("#status-history-details").outerWidth()+40));ao.css("min-height",(O.outerHeight()+e("#status-history-refresh-container").outerHeight()+e("#status-history-chart-control-container").outerHeight()+e(".dialog-buttons").outerHeight()+e(".dialog-header").outerHeight()+40+5));ao.center()},stop:m})}};var q=function(A){return y.min(A,function(B){return y.min(B.values,function(C){return C.value})})};var u=function(A){return y.max(A,function(B){return y.max(B.values,function(C){return C.value})})};var f=function(B){var C=0;var A=y.sum(B,function(D){C+=D.values.length;return y.sum(D.values,function(E){return E.value})});return A/C};var p=function(B){var A=e('<div class="status-history-detail"></div>').appendTo("#status-history-details");e('<div class="detail-container-label"></div>').text(B).appendTo(A);return e("<div></div>").appendTo(A)};var j=function(B,D,E,F){var C=e('<div class="detail-item"></div>').appendTo(B);e('<div class="setting-name"></div>').text(D).appendTo(C);var A=e('<div class="setting-field"></div>').text(E).appendTo(C);if(i.isDefinedAndNotNull(F)){A.attr("id",F)}};var b={init:function(A){o=A;e("#status-history-refresh-button").click(function(){var B=e("#status-history-dialog").data("status-history");if(B!==null){if(B.type===x.type.processor){b.showProcessorChart(B.groupId,B.id,B.selectedDescriptor)}else{if(B.type===x.type.processGroup){b.showProcessGroupChart(B.groupId,B.id,B.selectedDescriptor)}else{if(B.type===x.type.remoteProcessGroup){b.showRemoteProcessGroupChart(B.groupId,B.id,B.selectedDescriptor)}else{if(B.type===x.type.node){b.showNodeChart()}else{b.showConnectionChart(B.groupId,B.id,B.selectedDescriptor)}}}}}});e("#status-history-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Status History",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){e("#status-history-dialog").removeData("status-history");e("#status-history-chart-container").empty();e("#status-history-chart-control-container").empty();e("#status-history-details").empty();c=null;r=null;d=null},open:m}});e(window).on("resize",function(B){if(B.target===window){m()}i.toggleScrollable(e("#status-history-details").get(0))})},showConnectionChart:function(A,B,C){e.ajax({type:"GET",url:x.urls.api+"/flow/connections/"+encodeURIComponent(B)+"/status/history",dataType:"json"}).done(function(D){l(A,B,D.statusHistory,x.type.connection,C)}).fail(g.handleAjaxError)},showProcessorChart:function(A,C,B){e.ajax({type:"GET",url:x.urls.api+"/flow/processors/"+encodeURIComponent(C)+"/status/history",dataType:"json"}).done(function(D){l(A,C,D.statusHistory,x.type.processor,B)}).fail(g.handleAjaxError)},showNodeChart:function(){e.ajax({type:"GET",url:x.urls.api+"/controller/status/history",dataType:"json"}).done(function(A){h(A.statusHistory)}).fail(g.handleAjaxError)},showProcessGroupChart:function(B,A,C){e.ajax({type:"GET",url:x.urls.api+"/flow/process-groups/"+encodeURIComponent(A)+"/status/history",dataType:"json"}).done(function(D){l(B,A,D.statusHistory,x.type.processGroup,C)}).fail(g.handleAjaxError)},showRemoteProcessGroupChart:function(B,A,C){e.ajax({type:"GET",url:x.urls.api+"/flow/remote-process-groups/"+encodeURIComponent(A)+"/status/history",dataType:"json"}).done(function(D){l(B,A,D.statusHistory,x.type.remoteProcessGroup,C)}).fail(g.handleAjaxError)}};return b}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.Dialog","nf.Shell","nf.ng.Bridge","nf.ClusterSummary","nf.ErrorHandler","nf.Storage","nf.CanvasUtils"],function(h,e,f,g,c,j,l,k,i,d){return(nf.QueueListing=b(h,e,f,g,c,j,l,k,i,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.QueueListing=b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.Dialog"),require("nf.Shell"),require("nf.ng.Bridge"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Storage"),require("nf.CanvasUtils")))}else{nf.QueueListing=b(a.$,a.Slick,a.nf.Common,a.nf.Dialog,a.nf.Shell,a.nf.ng.Bridge,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Storage,a.nf.CanvasUtils)}}}(this,function(c,n,h,i,o,r,g,e,d,m){var p={urls:{}};var l=function(){c("#listing-request-status-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Queue Listing",handler:{close:function(){c("#listing-request-status-dialog").modal("setButtonModel",[])}}})};var q=function(){var s=function(C,z,B,A,y){return'<div class="pointer show-flowfile-details fa fa-info-circle" title="View Details" style="float: left;"></div>'};var x=function(C,z,B,A,y){return h.formatDataSize(B)};var u=function(C,z,B,A,y){return h.formatDuration(B)};var t=function(C,z,B,A,y){if(B==0){return"No"}return h.formatDuration(B)};var w=[{id:"moreDetails",field:"moreDetails",name:"&nbsp;",sortable:false,resizable:false,formatter:s,width:50,maxWidth:50},{id:"position",name:"Position",field:"position",sortable:false,resizable:false,width:75,maxWidth:75,formatter:h.genericValueFormatter},{id:"uuid",name:"UUID",field:"uuid",sortable:false,resizable:true,formatter:h.genericValueFormatter},{id:"filename",name:"Filename",field:"filename",sortable:false,resizable:true,formatter:h.genericValueFormatter},{id:"size",name:"File Size",field:"size",sortable:false,resizable:true,defaultSortAsc:false,formatter:x},{id:"queuedDuration",name:"Queued Duration",field:"queuedDuration",sortable:false,resizable:true,formatter:u},{id:"lineageDuration",name:"Lineage Duration",field:"lineageDuration",sortable:false,resizable:true,formatter:u},{id:"penalized",name:"Penalized",field:"penaltyExpiresIn",sortable:false,resizable:false,width:100,maxWidth:100,formatter:t}];if(g.isConnectedToCluster()){w.push({id:"clusterNodeAddress",name:"Node",field:"clusterNodeAddress",sortable:false,resizable:true,formatter:h.genericValueFormatter})}var v=function(E,z,D,A,y){var C="";var B=(y.size>0)?false:true;C+='<div class="icon download-flowfile-content fa fa-download '+((B)?"disabled":"pointer")+'" title="'+((B)?"No content available to download":"Download content")+'" aria-hidden="true"></div>';if(h.isContentViewConfigured()){C+='<div class="icon view-flowfile-content fa fa-eye '+((B)?"disabled":"pointer")+'" title="'+((B)?"No content available to view":"View content")+'" aria-hidden="true"></div>'}if(h.canAccessProvenance()){C+='<div title="Provenance" class="pointer icon icon-provenance view-provenance" aria-hidden="true"></div>'}return C};w.push({id:"actions",name:"&nbsp;",resizable:false,formatter:v,sortable:false,width:75,maxWidth:75});return w};var b=function(t){var s=((h.isDefinedAndNotNull(t.uri))?t.uri:c("#flowfile-uri").text())+"/content";var v={};var u=(h.isDefinedAndNotNull(t.clusterNodeId))?t.clusterNodeId:c("#flowfile-cluster-node-id").text();if(!h.isBlank(u)){v.clusterNodeId=u}if(c.isEmptyObject(v)){window.open(s)}else{window.open(s+"?"+c.param(v))}};var f=function(t){var s=((h.isDefinedAndNotNull(t.uri))?t.uri:c("#flowfile-uri").text())+"/content";var w={};var u=(h.isDefinedAndNotNull(t.clusterNodeId))?t.clusterNodeId:c("#flowfile-cluster-node-id").text();if(!h.isBlank(u)){w.clusterNodeId=u}if(c.isEmptyObject(w)===false){s=s+"?"+c.param(w)}var v=c("#nifi-content-viewer-url").text();if(v.indexOf("?")===-1){v+="?"}else{v+="&"}var x={ref:s};window.open(v+c.param(x))};var a=function(t){var u=4;var w=false;var v=null;var s=null;return c.Deferred(function(y){var B=function(D){var E=c("#listing-request-percent-complete");E.find("div.progress-label").remove();E.find("md-progress-linear").remove();var C=c('<div class="progress-label"></div>').text(D+"%");(r.injector.get("$compile")(c('<md-progress-linear ng-cloak ng-value="'+D+'" class="md-hue-2" md-mode="determinate" aria-label="Searching Queue"></md-progress-linear>'))(r.rootScope)).appendTo(E);E.append(C)};c("#listing-request-status-dialog").modal("setButtonModel",[{headerText:"Queue Listing",buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){w=true;if(s!==null){clearTimeout(s);x()}}}}]);var x=function(){c("#listing-request-status-dialog").modal("hide");var E=w;if(h.isDefinedAndNotNull(v)){c.ajax({type:"DELETE",url:v.uri,dataType:"json"});if(h.isEmpty(v.flowFileSummaries)){if(w===false){E=true;i.showOkDialog({headerText:"Queue Listing",dialogContent:"The queue has no FlowFiles."})}}else{c("#total-flowfiles-count").text(h.formatInteger(v.queueSize.objectCount));c("#total-flowfiles-size").text(h.formatDataSize(v.queueSize.byteCount));c("#queue-listing-last-refreshed").text(v.lastUpdated);var D=c("#queue-listing-table");var G=c("#queue-listing-message");if(v.sourceRunning===true||v.destinationRunning===true){if(v.souceRunning===true&&v.destinationRunning===true){G.text("The source and destination of this queue are currently running. This listing may no longer be accurate.").show()}else{if(v.sourceRunning===true){G.text("The source of this queue is currently running. This listing may no longer be accurate.").show()}else{if(v.destinationRunning===true){G.text("The destination of this queue is currently running. This listing may no longer be accurate.").show()}}}}else{G.text("").hide()}var F=c("#queue-listing-table").data("gridInstance");F.setColumns(q());var C=F.getData();C.beginUpdate();C.setItems(v.flowFileSummaries,"uuid");C.endUpdate()}}else{E=true}if(E){y.reject()}else{y.resolve()}};var A=function(C){B(v.percentCompleted);c("#listing-request-status-message").text(v.state);if(v.finished===true||w===true){x()}else{s=setTimeout(function(){s=null;z(Math.min(u,C*2))},C*1000)}};var z=function(C){c.ajax({type:"GET",url:v.uri,dataType:"json"}).done(function(D){v=D.listingRequest;A(C)}).fail(x).fail(e.handleAjaxError)};c.ajax({type:"POST",url:"../nifi-api/flowfile-queues/"+t.id+"/listing-requests",dataType:"json",contentType:"application/json"}).done(function(C){B(0);c("#listing-request-status-dialog").modal("show");v=C.listingRequest;A(1)}).fail(x).fail(e.handleAjaxError)}).promise()};var j=function(s){var t=function(w,x){c('<div class="flowfile-detail"></div>').append(c('<div class="detail-name"></div>').text(w)).append(c('<div class="detail-value">'+h.formatValue(x)+"</div>").ellipsis()).append(c('<div class="clear"></div>')).appendTo("#additional-flowfile-details")};var u=function(w,x){if(h.isDefinedAndNotNull(x)){w.removeClass("unset").text(x)}else{w.addClass("unset").text("No value set")}};var v={};if(h.isDefinedAndNotNull(s.clusterNodeId)){v.clusterNodeId=s.clusterNodeId}c.ajax({type:"GET",url:s.uri,data:v,dataType:"json"}).done(function(x){var z=x.flowFile;var w=h.isDefinedAndNotNull(z.contentClaimFileSize)?z.contentClaimFileSize:h.formatDataSize(0);c("#flowfile-uri").text(z.uri);c("#flowfile-uuid").html(h.formatValue(z.uuid));c("#flowfile-filename").html(h.formatValue(z.filename));c("#flowfile-queue-position").html(h.formatValue(z.position));c("#flowfile-file-size").html(h.formatValue(w));c("#flowfile-queued-duration").text(h.formatDuration(z.queuedDuration));c("#flowfile-lineage-duration").text(h.formatDuration(z.lineageDuration));c("#flowfile-penalized").text(z.penaltyExpiresIn==0?"No":h.formatDuration(z.penaltyExpiresIn));if(h.isDefinedAndNotNull(s.clusterNodeId)){c("#flowfile-cluster-node-id").text(s.clusterNodeId);t("Node Address",s.clusterNodeAddress)}if(h.isDefinedAndNotNull(z.contentClaimContainer)){u(c("#content-container"),z.contentClaimContainer);u(c("#content-section"),z.contentClaimSection);u(c("#content-identifier"),z.contentClaimIdentifier);u(c("#content-offset"),z.contentClaimOffset);u(c("#content-bytes"),z.contentClaimFileSizeBytes);var B=c("#content-size");u(B,z.contentClaimFileSize);if(h.isDefinedAndNotNull(z.contentClaimFileSize)){B.attr("title",h.formatInteger(z.contentClaimFileSizeBytes)+" bytes")}c("#flowfile-content-details").show();c("#flowfile-with-no-content").hide()}else{c("#flowfile-content-details").hide();c("#flowfile-with-no-content").show()}var y=c("#flowfile-attributes-container");var A=Object.keys(z.attributes).sort();A.forEach(function(C){var D=z.attributes[C];var E=c('<div class="attribute-detail"></div>').append(c('<div class="attribute-name">'+h.formatValue(C)+"</div>").ellipsis()).appendTo(y);E.append(c('<div class="attribute-value">'+h.formatValue(D)+"</div>").ellipsis()).append('<div class="clear"></div>')});c("#flowfile-details-dialog").modal("show")}).fail(e.handleAjaxError)};var k={init:function(){l();c("#queue-listing-refresh-button").click(function(){var v=c("#queue-listing-table").data("connection");a(v)});var t={autosizeColsMode:n.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var s=new n.Data.DataView({inlineFilters:false});s.setItems([]);var u=new n.Grid("#queue-listing-table",s,q(),t);u.setSelectionModel(new n.RowSelectionModel());u.registerPlugin(new n.AutoTooltips());u.onClick.subscribe(function(y,v){var x=c(y.target);var w=s.getItem(v.row);if(u.getColumns()[v.cell].id==="moreDetails"){if(x.hasClass("show-flowfile-details")){j(w)}}else{if(u.getColumns()[v.cell].id==="actions"){if(x.hasClass("view-provenance")){c("#shell-close-button").click();o.showPage("provenance?"+c.param({flowFileUuid:w.uuid}))}else{if(x.hasClass("download-flowfile-content")&&!x.hasClass("disabled")){b(w)}else{if(x.hasClass("view-flowfile-content")&&!x.hasClass("disabled")){f(w)}}}}}});s.onRowCountChanged.subscribe(function(w,v){u.updateRowCount();u.render();c("#displayed-flowfiles").text(v.current)});s.onRowsChanged.subscribe(function(w,v){u.invalidateRows(v.rows);u.render()});c("#queue-listing-table").data("gridInstance",u);c("#displayed-flowfiles").text("0")},initFlowFileDetailsDialog:function(){c("#content-download").on("click",b);if(h.isContentViewConfigured()){c("#content-view").show();c("#content-view").on("click",f)}c("#flowfile-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"flowfile-details-tab-content"},{name:"Attributes",tabContentId:"flowfile-attributes-tab-content"}]});c("#flowfile-details-dialog").modal({scrollableContentStyle:"scrollable",headerText:"FlowFile",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){c("#flowfile-details-dialog").modal("hide")}}}],handler:{close:function(){c("#flowfile-attributes-container").empty();c("#flowfile-cluster-node-id").text("");c("#additional-flowfile-details").empty()},open:function(){h.toggleScrollable(c("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}})},resetTableSize:function(){var s=c("#queue-listing-table").data("gridInstance");if(h.isDefinedAndNotNull(s)){s.resizeCanvas()}},listQueue:function(s){a(s).done(function(){var t="";if(s.permissions.canRead){t=m.formatConnectionName(s.component)}if(t===""){t="Connection"}c("#queue-listing-header-text").text(t);o.showContent("#queue-listing-container").done(function(){c("#queue-listing-table").removeData("connection");var v=c("#queue-listing-table").data("gridInstance");var u=v.getData();u.beginUpdate();u.setItems([],"uuid");u.endUpdate();c("#displayed-flowfiles, #total-flowfiles-count").text("0");c("#total-flowfiles-size").text(h.formatDataSize(0))});k.resetTableSize();c("#queue-listing-table").data("connection",s)})}};return k}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.ErrorHandler","nf.Common","nf.Client","nf.Storage","nf.CanvasUtils","nf.ng.Bridge","nf.Dialog","nf.Shell"],function(h,d,k,e,l,i,f,j,g,c){return(nf.PolicyManagement=b(h,d,k,e,l,i,f,j,g,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PolicyManagement=b(require("jquery"),require("Slick"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Client"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Dialog"),require("nf.Shell")))}else{nf.PolicyManagement=b(a.$,a.Slick,a.nf.ErrorHandler,a.nf.Common,a.nf.Client,a.nf.Storage,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Dialog,a.nf.Shell)}}}(this,function(z,a,e,I,g,u,L,p,h,H){var D={urls:{api:"../nifi-api",searchTenants:"../nifi-api/tenants/search-results"}};var i=false;var j=false;var q=false;var v=function(){z("#new-policy-user-button").on("click",function(){z("#search-users-dialog").modal("show");z("#search-users-field").focus()});z("#delete-policy-button").on("click",function(){y()});z("#search-users-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Users/Groups",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var O=z("#policy-table").data("gridInstance");var N=O.getData();N.beginUpdate();z.each(f(z("#allowed-users")),function(Q,P){N.addItem(P)});z.each(f(z("#allowed-groups")),function(P,Q){N.addItem(Q)});N.endUpdate();J();z("#search-users-dialog").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){z("#search-users-dialog").modal("hide")}}}],handler:{close:function(){z("#search-users-field").userSearchAutocomplete("reset").val("");z("#allowed-users, #allowed-groups").empty()}}});z(document).on("click","div.remove-allowed-entity",function(){z(this).closest("li").remove()});z.widget("nf.userSearchAutocomplete",z.ui.autocomplete,{delay:500,reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-no-matches)")},_normalize:function(O){var N=[];N.push(O);return N},_renderMenu:function(Q,O){var S=O[0];var P=K();var R=o();var N=this;z.each(S.userGroups,function(T,U){if(z.inArray(U.id,P)===-1){N._renderGroup(Q,z.extend({type:"group"},U))}});z.each(S.users,function(T,U){if(z.inArray(U.id,R)===-1){N._renderUser(Q,z.extend({type:"user"},U))}});if(Q.children().length===0){Q.append('<li class="unset search-no-matches">No users matched the search terms</li>')}},_resizeMenu:function(){var N=this.menu.element;N.width(z("#search-users-field").outerWidth()-2)},_renderUser:function(P,O){var N=z("<a></a>").text(O.component.identity);return z("<li></li>").data("ui-autocomplete-item",O).append(N).appendTo(P)},_renderGroup:function(O,N){var Q=z("<span></span>").text(N.component.identity);var P=z("<a></a>").append('<div class="fa fa-users"></div>').append(Q);return z("<li></li>").data("ui-autocomplete-item",N).append(P).appendTo(O)}});z("#search-users-field").userSearchAutocomplete({minLength:0,appendTo:"#search-users-results",position:{my:"left top",at:"left bottom",offset:"0 1"},source:function(O,N){z.ajax({type:"GET",data:{q:O.term},dataType:"json",url:D.urls.searchTenants}).done(function(P){N(P)})},select:function(N,O){A(O.item);z(this).val("");return false}})};var K=function(){var Q=z("#policy-table").data("gridInstance");var P=Q.getData();var O=[];var N=P.getItems();z.each(N,function(R,S){if(S.type==="group"){O.push(S.id)}});z.each(f(z("#allowed-groups")),function(R,S){O.push(S.id)});return O};var f=function(N){var O=[];N.children("li").each(function(Q,P){var R=z(P).data("tenant");if(I.isDefinedAndNotNull(R)){O.push(R)}});return O};var o=function(){var Q=z("#policy-table").data("gridInstance");var O=Q.getData();var P=[];var N=O.getItems();z.each(N,function(R,S){if(S.type==="user"){P.push(S.id)}});z.each(f(z("#allowed-users")),function(S,R){P.push(R.id)});return P};var A=function(N){var P=N.type==="user"?z("#allowed-users"):z("#allowed-groups");var Q=z("<span></span>").addClass("allowed-entity ellipsis").text(N.component.identity).ellipsis();var O=z("<div></div>").addClass("remove-allowed-entity fa fa-trash");z("<li></li>").data("tenant",N).append(Q).append(O).appendTo(P)};var d=function(N){return N==="controller"||N==="parameter-contexts"||N==="counters"||N==="policies"||N==="tenants"};var m=function(N){return N==="proxy"||N==="restricted-components"};var B=function(){z("#override-policy-dialog").modal({headerText:"Override Policy",buttons:[{buttonText:"Override",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){k(z("#copy-policy-radio-button").is(":checked"));z(this).modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){z(this).modal("hide")}}}],handler:{close:function(){z("#copy-policy-radio-button").prop("checked",true)}}});z("#create-policy-link, #add-local-admin-link").on("click",function(){k(false)});z("#override-policy-link").on("click",function(){z("#override-policy-dialog").modal("show")});z("#policy-type-list").combo({options:[I.getPolicyTypeListing("flow"),I.getPolicyTypeListing("controller"),I.getPolicyTypeListing("parameter-contexts"),I.getPolicyTypeListing("provenance"),I.getPolicyTypeListing("restricted-components"),I.getPolicyTypeListing("policies"),I.getPolicyTypeListing("tenants"),I.getPolicyTypeListing("site-to-site"),I.getPolicyTypeListing("system"),I.getPolicyTypeListing("proxy"),I.getPolicyTypeListing("counters")],select:function(X){if(i){z("#selected-policy-type").text(X.value);if(d(X.value)){z("#restricted-component-required-permissions").hide();z("#restriction-message").hide();z("#controller-policy-target").combo("setSelectedOption",{value:"read"}).show()}else{z("#controller-policy-target").hide();if(m(X.value)){z("#selected-policy-action").text("write")}else{z("#selected-policy-action").text("read")}if(X.value==="restricted-components"){if(!j){var W="regardless of restrictions";var T=L.getComponentRestrictions();var V=T.requiredPermissions;var U=[{text:W,value:"",description:"Allows users to create/modify all restricted components regardless of restrictions."}];V.forEach(function(Y,Z){if(Z!==X.value){U.push({text:"requiring '"+Y+"'",value:Z,description:"Allows users to create/modify restricted components requiring '"+I.escapeHtml(Y)+"'"})}});U.sort(function(Z,Y){if(Z.text===W){return -1}else{if(Y.text===W){return 1}}return Z.text<Y.text?-1:Z.text>Y.text?1:0});z("#restricted-component-required-permissions").combo({options:U,select:function(Y){if(Y.text===W){z("#restriction-message").hide()}else{z("#restriction-message").show()}b()}})}z("#restricted-component-required-permissions").show()}else{z("#restriction-message").hide();z("#restricted-component-required-permissions").hide()}b()}}}});z("#controller-policy-target").combo({options:[{text:"view",value:"read"},{text:"modify",value:"write"}],select:function(T){if(i){z("#selected-policy-action").text(T.value);b()}}});z("#component-policy-target").combo({options:[{text:"view the component",value:"read-component",description:"Allows users to view component configuration details"},{text:"modify the component",value:"write-component",description:"Allows users to modify component configuration details"},{text:"operate the component",value:"operate-component",description:"Allows users to operate components by changing component run status (start/stop/enable/disable), remote port transmission status, or terminating processor threads"},{text:"view provenance",value:"read-provenance",description:"Allows users to view provenance events generated by this component"},{text:"view the data",value:"read-data",description:"Allows users to view metadata and content for this component in flowfile queues in outbound connections and through provenance events"},{text:"modify the data",value:"write-data",description:"Allows users to empty flowfile queues in outbound connections and submit replays through provenance events"},{text:"receive data via site-to-site",value:"write-receive-data",description:"Allows this port to receive data from these NiFi instances",disabled:true},{text:"send data via site-to-site",value:"write-send-data",description:"Allows this port to send data to these NiFi instances",disabled:true},{text:"view the policies",value:"read-policies",description:"Allows users to view the list of users who can view/modify this component"},{text:"modify the policies",value:"write-policies",description:"Allows users to modify the list of users who can view/modify this component"}],select:function(T){if(i){var U=z("#selected-policy-component-type").text();if(T.value==="read-component"){z("#selected-policy-action").text("read")}else{if(T.value==="write-component"){z("#selected-policy-action").text("write")}else{if(T.value==="operate-component"){z("#selected-policy-action").text("write");U=("operation/"+U)}else{if(T.value==="read-data"){z("#selected-policy-action").text("read");U=("data/"+U)}else{if(T.value==="write-data"){z("#selected-policy-action").text("write");U=("data/"+U)}else{if(T.value==="read-provenance"){z("#selected-policy-action").text("read");U=("provenance-data/"+U)}else{if(T.value==="read-policies"){z("#selected-policy-action").text("read");U=("policies/"+U)}else{if(T.value==="write-policies"){z("#selected-policy-action").text("write");U=("policies/"+U)}else{if(T.value==="write-receive-data"){z("#selected-policy-action").text("write");U="data-transfer/input-ports"}else{if(T.value==="write-send-data"){z("#selected-policy-action").text("write");U="data-transfer/output-ports"}}}}}}}}}}z("#selected-policy-type").text(U);if(!q){b()}}}});var N=function(Y,U,X,W,T){var V="";if(T.type==="group"){V+='<div class="fa fa-users"></div>'}V+=I.escapeHtml(T.component.identity);return V};var R=function(aa,V,Z,X,U){var W="";var T=z("#policy-table").data("policy");var Y=z("#delete-policy-button").is(":disabled")===false;if(T.permissions.canWrite===true&&Y){W+='<div title="Remove" class="pointer delete-user fa fa-trash"></div>'}return W};var Q=[{id:"identity",name:"User",sortable:true,resizable:true,formatter:N}];if(L.isConfigurableAuthorizer()){Q.push({id:"actions",name:"&nbsp;",sortable:false,resizable:false,formatter:R,width:100,maxWidth:100})}var P={autosizeColsMode:a.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false};var O=new a.Data.DataView({inlineFilters:false});O.setItems([]);M({columnId:"identity",sortAsc:true},O);var S=new a.Grid("#policy-table",O,Q,P);S.setSelectionModel(new a.RowSelectionModel());S.registerPlugin(new a.AutoTooltips());S.setSortColumn("identity",true);S.onSort.subscribe(function(U,T){M({columnId:T.sortCol.id,sortAsc:T.sortAsc},O)});S.onClick.subscribe(function(W,T){var V=z(W.target);var U=O.getItem(T.row);if(S.getColumns()[T.cell].id==="actions"){if(V.hasClass("delete-user")){G(U)}}});O.onRowCountChanged.subscribe(function(U,T){S.updateRowCount();S.render();z("#displayed-policy-users").text(T.current)});O.onRowsChanged.subscribe(function(U,T){S.invalidateRows(T.rows);S.render()});z("#policy-table").data("gridInstance",S);z("#displayed-policy-users").text("0")};var M=function(N,P){var O=function(S,Q){if(S.permissions.canRead&&Q.permissions.canRead){var R=I.isDefinedAndNotNull(S.component[N.columnId])?S.component[N.columnId]:"";var T=I.isDefinedAndNotNull(Q.component[N.columnId])?Q.component[N.columnId]:"";return R===T?0:R>T?1:-1}else{if(!S.permissions.canRead&&!Q.permissions.canRead){return 0}if(S.permissions.canRead){return 1}else{return -1}}};P.sort(O,N.sortAsc)};var G=function(N){h.showYesNoDialog({headerText:"Update Policy",dialogContent:"Remove '"+I.escapeHtml(N.component.identity)+"' from this policy?",yesHandler:function(){r(N)}})};var r=function(O){var P=z("#policy-table").data("gridInstance");var N=P.getData();N.beginUpdate();N.deleteItem(O.id);N.endUpdate();J()};var y=function(){h.showYesNoDialog({headerText:"Delete Policy",dialogContent:"By deleting this policy, the permissions for this component will revert to the inherited policy if applicable.",yesText:"Delete",noText:"Cancel",yesHandler:function(){l()}})};var l=function(){var N=z("#policy-table").data("policy");var O=g.getRevision(N);if(I.isDefinedAndNotNull(N)){z.ajax({type:"DELETE",url:N.uri+"?"+z.param(z.extend({disconnectedNodeAcknowledged:u.isDisconnectionAcknowledged()},O)),dataType:"json"}).done(function(){b()}).fail(function(R,P,Q){e.handleAjaxError(R,P,Q);t();b()})}else{h.showOkDialog({headerText:"Delete Policy",dialogContent:"No policy selected"})}};var n=function(){var N=z("#selected-policy-component-id").text();var P=z("#selected-policy-type").text();if(N!==""){P+=("/"+N)}if(P==="restricted-components"){var O=z("#restricted-component-required-permissions").combo("getSelectedOption").value;if(!I.isBlank(O)){P+=("/"+O)}}return{action:z("#selected-policy-action").text(),resource:"/"+P}};var E=function(R,P){var Q=z("#policy-table").data("gridInstance");var O=Q.getData();O.beginUpdate();var N=[];z.each(R,function(T,S){N.push(z.extend({type:"user"},S))});z.each(P,function(S,T){N.push(z.extend({type:"group"},T))});O.setItems(N);O.endUpdate();O.reSort();Q.invalidate();Q.getSelectionModel().setSelectedRows([])};var s=function(Q){if(Q==="/policies"){return z("<span>Showing effective policy inherited from all policies.</span>")}else{if(Q==="/controller"){return z("<span>Showing effective policy inherited from the controller.</span>")}else{if(Q==="/parameter-contexts"){return z("<span>Showing effective policy inherited from global parameter context policy.</span>")}else{var N=I.substringAfterLast(Q,"/");var P=N;var O=p.injector.get("breadcrumbsCtrl").getBreadcrumbs();z.each(O,function(R,S){if(S.id===N){P=S.label;return false}});return z("<span>Showing effective policy inherited from Process Group </span>").append(z('<span class="link ellipsis" style="max-width: 200px; vertical-align: top;"></span>').text(P).attr("title",P).on("click",function(){z("#shell-close-button").click();L.getComponentByType("ProcessGroup").enterGroup(N).done(function(){L.getSelection().classed("selected",false);p.digest()})})).append("<span>.</span>")}}}};var w=function(O){var P=O.component;var N=n();c();z("#policy-table").data("policy",O);if(N.resource===P.resource){if(L.isConfigurableAuthorizer()){z("#delete-policy-button").prop("disabled",P.configurable===false||O.permissions.canWrite===false);z("#new-policy-user-button").prop("disabled",P.configurable===false||O.permissions.canWrite===false)}}else{z("#policy-message").append(s(P.resource));if(L.isConfigurableAuthorizer()){z("#override-policy-message").show();z("#delete-policy-button").prop("disabled",true);z("#new-policy-user-button").prop("disabled",true)}}E(P.users,P.userGroups)};var b=function(){var N=n();var O;if(N.resource.startsWith("/policies")){if(N.resource.endsWith("/policies")){z("#admin-policy-message").show()}O=z.Deferred(function(P){z.ajax({type:"GET",url:"../nifi-api/policies/"+N.action+N.resource,dataType:"json"}).done(function(Q){z("#policy-last-refreshed").text(Q.generated);if(Q.permissions.canRead===true){var R=Q.component;if(N.resource===R.resource){w(Q)}else{t();z("#policy-message").text("No component specific administrators.");if(L.isConfigurableAuthorizer()){z("#add-local-admin-message").show()}}}else{t();z("#policy-message").text("No component specific administrators.");if(L.isConfigurableAuthorizer()){z("#add-local-admin-message").show()}}P.resolve()}).fail(function(S,Q,R){if(S.status===404){t();z("#policy-message").text("No component specific administrators.");if(L.isConfigurableAuthorizer()){z("#add-local-admin-message").show()}P.resolve()}else{if(S.status===403){t();z("#policy-message").text("Not authorized to access the policy for the specified resource.");P.resolve()}else{t();P.reject();e.handleAjaxError(S,Q,R)}}})}).promise()}else{if(N.resource.startsWith("/restricted-components")){z("#admin-policy-message").hide();O=z.Deferred(function(P){z.ajax({type:"GET",url:"../nifi-api/policies/"+N.action+N.resource,dataType:"json"}).done(function(Q){z("#policy-last-refreshed").text(Q.generated);if(Q.permissions.canRead===true){var R=Q.component;if(N.resource===R.resource){w(Q)}else{t();z("#policy-message").text("No restriction specific users.");if(L.isConfigurableAuthorizer()){z("#new-policy-message").show()}}}else{t();z("#policy-message").text("Not authorized to view the policy.");if(L.isConfigurableAuthorizer()){z("#new-policy-message").show()}}P.resolve()}).fail(function(S,Q,R){if(S.status===404){t();if(N.resource==="/restricted-components"){z("#policy-message").text('No users with permission "regardless of restrictions."')}else{z("#policy-message").text("No users with permission to specific restriction.")}if(L.isConfigurableAuthorizer()){z("#new-policy-message").show()}P.resolve()}else{if(S.status===403){t();z("#policy-message").text("Not authorized to access the policy for the specified resource.");P.resolve()}else{t();P.reject();e.handleAjaxError(S,Q,R)}}})}).promise()}else{z("#admin-policy-message").hide();O=z.Deferred(function(P){z.ajax({type:"GET",url:"../nifi-api/policies/"+N.action+N.resource,dataType:"json"}).done(function(Q){z("#policy-last-refreshed").text(Q.generated);if(Q.permissions.canRead===true){w(Q)}else{t();z("#policy-message").text("Not authorized to view the policy.");if(L.isConfigurableAuthorizer()){z("#override-policy-message").show()}}P.resolve()}).fail(function(S,Q,R){if(S.status===404){t();z("#policy-message").text("No policy for the specified resource.");if(L.isConfigurableAuthorizer()){z("#new-policy-message").show()}P.resolve()}else{if(S.status===403){t();z("#policy-message").text("Not authorized to access the policy for the specified resource.");P.resolve()}else{t();P.reject();e.handleAjaxError(S,Q,R)}}})}).promise()}}return O};var k=function(S){var R=n();var U=[];var Q=[];if(S===true){var T=z("#policy-table").data("gridInstance");var P=T.getData();var O=P.getItems();z.each(O,function(W,X){var V=z.extend({},X);if(V.type==="user"){U.push(V)}else{Q.push(V)}delete V.type})}var N={revision:g.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:u.isDisconnectionAcknowledged(),component:{action:R.action,resource:R.resource,users:U,userGroups:Q}};z.ajax({type:"POST",url:"../nifi-api/policies",data:JSON.stringify(N),dataType:"json",contentType:"application/json"}).done(function(V){if(V.permissions.canRead===true){w(V)}else{t();b()}}).fail(e.handleAjaxError)};var J=function(){var T=z("#policy-table").data("gridInstance");var R=T.getData();var S=[];var Q=[];var P=R.getItems();z.each(P,function(V,W){var U=z.extend({},W);if(U.type==="user"){S.push(U)}else{Q.push(U)}delete U.type});var N=z("#policy-table").data("policy");if(I.isDefinedAndNotNull(N)){var O={revision:g.getRevision(N),disconnectedNodeAcknowledged:u.isDisconnectionAcknowledged(),component:{id:N.id,users:S,userGroups:Q}};z.ajax({type:"PUT",url:N.uri,data:JSON.stringify(O),dataType:"json",contentType:"application/json"}).done(function(U){if(U.permissions.canRead===true){w(U)}else{t();b()}}).fail(function(W,U,V){e.handleAjaxError(W,U,V);t();b()}).always(function(){L.reload()})}else{h.showOkDialog({headerText:"Update Policy",dialogContent:"No policy selected"})}};var C=function(){H.showContent("#policy-management").always(function(){F()});x.resetTableSize()};var c=function(){z("#policy-message").text("").empty();if(L.isConfigurableAuthorizer()){z("#new-policy-message").hide();z("#override-policy-message").hide();z("#add-local-admin-message").hide()}};var t=function(){c();if(L.isConfigurableAuthorizer()){z("#delete-policy-button").prop("disabled",true);z("#new-policy-user-button").prop("disabled",true)}z("#policy-table").removeData("policy");E([],[])};var F=function(){t();z("#selected-policy-type").text("");z("#selected-policy-action").text("");z("#selected-policy-component-id").text("");z("#selected-policy-component-type").text("");z("div.policy-selected-component-container").hide()};var x={init:function(){v();B();if(L.isConfigurableAuthorizer()){z("#delete-policy-button").show();z("#new-policy-user-button").show()}z("#policy-refresh-button").on("click",function(){b()});t();i=true},resetTableSize:function(){var N=z("#policy-table");if(N.is(":visible")){var O=N.data("gridInstance");if(I.isDefinedAndNotNull(O)){O.resizeCanvas()}}},showControllerServicePolicy:function(N){q=true;c();z("#component-policy-controls").show();z("#global-policy-controls").hide();if(N.permissions.canRead===true){z("#policy-selected-controller-service-container div.policy-selected-component-name").text(N.component.name)}else{z("#policy-selected-controller-service-container div.policy-selected-component-name").text(N.id)}z("#policy-selected-controller-service-container").show();z("#selected-policy-component-id").text(N.id);z("#selected-policy-component-type").text("controller-services");z("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"read-provenance"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});q=false;return b().always(C)},showReportingTaskPolicy:function(N){q=true;c();z("#component-policy-controls").show();z("#global-policy-controls").hide();if(N.permissions.canRead===true){z("#policy-selected-reporting-task-container div.policy-selected-component-name").text(N.component.name)}else{z("#policy-selected-reporting-task-container div.policy-selected-component-name").text(N.id)}z("#policy-selected-reporting-task-container").show();z("#selected-policy-component-id").text(N.id);z("#selected-policy-component-type").text("reporting-tasks");z("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"read-provenance"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});q=false;return b().always(C)},showParameterProviderPolicy:function(N){q=true;c();z("#component-policy-controls").show();z("#global-policy-controls").hide();if(N.permissions.canRead===true){z("#policy-selected-parameter-provider-container div.policy-selected-component-name").text(N.component.name)}else{z("#policy-selected-parameter-provider-container div.policy-selected-component-name").text(N.id)}z("#policy-selected-parameter-provider-container").show();z("#selected-policy-component-id").text(N.id);z("#selected-policy-component-type").text("parameter-providers");z("#component-policy-target").combo("setOptionEnabled",{value:"operate-component"},false).combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"read-provenance"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});q=false;return b().always(C)},showTemplatePolicy:function(N){q=true;c();z("#component-policy-controls").show();z("#global-policy-controls").hide();if(N.permissions.canRead===true){z("#policy-selected-template-container div.policy-selected-component-name").text(N.template.name)}else{z("#policy-selected-template-container div.policy-selected-component-name").text(N.id)}z("#policy-selected-template-container").show();z("#selected-policy-component-id").text(N.id);z("#selected-policy-component-type").text("templates");z("#component-policy-target").combo("setOptionEnabled",{value:"operate-component"},false).combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"read-provenance"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});q=false;return b().always(C)},showParameterContextPolicy:function(N){q=true;c();z("#component-policy-controls").show();z("#global-policy-controls").hide();if(N.permissions.canRead===true){z("#policy-selected-parameter-context-container div.policy-selected-component-name").text(N.component.name)}else{z("#policy-selected-parameter-context-container div.policy-selected-component-name").text(N.id)}z("#policy-selected-parameter-context-container").show();z("#selected-policy-component-id").text(N.id);z("#selected-policy-component-type").text("parameter-contexts");z("#component-policy-target").combo("setOptionEnabled",{value:"operate-component"},false).combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"read-provenance"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});q=false;return b().always(C)},showComponentPolicy:function(N){q=true;c();z("#component-policy-controls").show();z("#global-policy-controls").hide();z("#policy-selected-component-container").show();var O;if(N.empty()){z("#selected-policy-component-id").text(L.getGroupId());O="process-groups";z("#component-policy-target").combo("setOptionEnabled",{value:"operate-component"},true).combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},true).combo("setOptionEnabled",{value:"read-provenance"},true).combo("setOptionEnabled",{value:"write-data"},true)}else{var P=N.datum();z("#selected-policy-component-id").text(P.id);if(L.isProcessor(N)){O="processors"}else{if(L.isProcessGroup(N)){O="process-groups"}else{if(L.isInputPort(N)){O="input-ports"}else{if(L.isOutputPort(N)){O="output-ports"}else{if(L.isRemoteProcessGroup(N)){O="remote-process-groups"}else{if(L.isLabel(N)){O="labels"}else{if(L.isFunnel(N)){O="funnels"}}}}}}}z("#component-policy-target").combo("setOptionEnabled",{value:"operate-component"},!L.isLabel(N)).combo("setOptionEnabled",{value:"write-receive-data"},L.isInputPort(N)&&P.allowRemoteAccess===true).combo("setOptionEnabled",{value:"write-send-data"},L.isOutputPort(N)&&P.allowRemoteAccess===true).combo("setOptionEnabled",{value:"read-data"},!L.isLabel(N)).combo("setOptionEnabled",{value:"write-data"},!L.isLabel(N))}z("#selected-policy-component-type").text(O);z("#component-policy-target").combo("setSelectedOption",{value:"read-component"});q=false;return b().always(C)},showGlobalPolicies:function(){c();z("#component-policy-controls").hide();z("#global-policy-controls").show();var N=z("#policy-type-list").combo("getSelectedOption").value;z("#selected-policy-type").text(N);if(d(N)){z("#selected-policy-action").text(z("#controller-policy-target").combo("getSelectedOption").value)}else{if(m(N)){z("#selected-policy-action").text("write")}else{z("#selected-policy-action").text("read")}}return b().always(C)}};return x}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","d3","nf.Client","nf.Dialog","nf.Storage","nf.Common","nf.CanvasUtils","nf.ng.Bridge","nf.ErrorHandler","nf.FilteredDialogCommon","nf.Shell","nf.ComponentState","nf.ComponentVersion","nf.PolicyManagement","nf.Processor","nf.ProcessGroup","nf.ProcessGroupConfiguration","lodash"],function(f,o,r,t,m,g,j,n,u,h,e,q,c,d,p,l,i,k,s){return(nf.ParameterContexts=b(f,o,r,t,m,g,j,n,u,h,e,q,c,d,p,l,i,k,s))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ParameterContexts=b(require("jquery"),require("Slick"),require("d3"),require("nf.Client"),require("nf.Dialog"),require("nf.Storage"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.Shell"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.PolicyManagement"),require("nf.Processor"),require("nf.ProcessGroup"),require("nf.ProcessGroupConfiguration"),require("lodash")))}else{nf.ParameterContexts=b(a.$,a.Slick,a.d3,a.nf.Client,a.nf.Dialog,a.nf.Storage,a.nf.Common,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.Shell,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.PolicyManagement,a.nf.Processor,a.nf.ProcessGroup,a.nf.ProcessGroupConfiguration,a._)}}}(this,function(al,v,Q,B,U,k,R,H,t,V,r,g,av,T,J,E,a,z,P){var i;var aa={urls:{parameterContexts:"../nifi-api/parameter-contexts"}};var y={autosizeColsMode:v.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var s={autosizeColsMode:v.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,editable:false,enableAddRow:false,autoEdit:false,multiSelect:false,rowHeight:24};var O=function(aA,ax,az,ay,aw){if(!aw.permissions.canRead){return'<span class="blank">'+R.escapeHtml(aw.id)+"</span>"}return R.escapeHtml(aw.component.name)};var p=function(aB,ax,aA,ay,aw){var az=aw.component?aw.component:null;if(az&&az.parameterProviderConfiguration){if(!aw.permissions.canRead){return'<span class="blank">'+R.escapeHtml(az.parameterProviderConfiguration.id)+"</span>"}return R.escapeHtml(az.parameterProviderConfiguration.component.parameterGroupName+" from "+az.parameterProviderConfiguration.component.parameterProviderName)}};var F=function(aw,ay){var ax=function(aB,az){if(aB.permissions.canRead&&az.permissions.canRead){var aA=P.get(aB,"component["+aw.columnId+"]","");var aC=P.get(az,"component["+aw.columnId+"]","");return aA===aC?0:aA>aC?1:-1}else{if(!aB.permissions.canRead&&!az.permissions.canRead){return 0}if(aB.permissions.canRead){return 1}else{return -1}}};ay.sort(ax,aw.sortAsc)};var Z=null;var b=function(aw,ay){var ax=function(aB,az){if(aB.isInherited===false&&az.isInherited===true){return -1}if(aB.isInherited===true&&az.isInherited===false){return 1}if(aw.columnId==="name"){var aA=P.get(aB,"["+aw.columnId+"]","");var aC=P.get(az,"["+aw.columnId+"]","");return aA===aC?0:aA>aC?1:-1}};ay.sort(ax,aw.sortAsc)};var m=function(){R.cleanUpTooltips(al("#parameter-table"),"div.fa-question-circle, div.fa-info");al("#parameter-context-name").val("");al("#parameter-context-name-read-only").text("");al("#parameter-context-description-field").val("");al("#parameter-context-description-read-only").text("");al("#parameter-context-referencing-components").empty();al("#parameter-table, #add-parameter").show();al("#parameter-context-tabs").show();al("#parameter-context-tabs").find(".tab")[0].click();al("#parameter-context-update-status").hide();al("#process-group-parameter").text("");al("#parameter-process-group-id").text("").removeData("revision");al("#parameter-referencing-components-context").removeClass("unset").attr("title","").text("");al("#parameter-context-provider-setting").hide();var aw=al("#parameter-table").data("gridInstance");var ax=aw.getData();aw.setSelectedRows([]);ax.setItems([]);d();A();Z=null;ah=0;c=null};var I=function(){al("#parameter-name").val("");al("#parameter-value-field").val("");al("#parameter-description-field").val("");al("#parameter-sensitive-radio-button").prop("checked",false);al("#parameter-not-sensitive-radio-button").prop("checked",false);al("#parameter-name").prop("disabled",false);al("#parameter-sensitive-radio-button").prop("disabled",false);al("#parameter-not-sensitive-radio-button").prop("disabled",false);al("#parameter-set-empty-string-field").removeClass("checkbox-checked").addClass("checkbox-unchecked");al("#parameter-value-field").prop("disabled",false)};var au=function(){var az=[];var ay=al("#parameter-table");var aw=ay.data("gridInstance");var ax=aw.getData();al.each(ax.getItems(),function(){var aA={name:this.name};if(this.hidden===true&&this.isNew!==true&&this.provided!==true){az.push({parameter:aA})}else{if(this.isNew===true){aA.value=this.value;aA.sensitive=this.sensitive;aA.description=this.description;az.push({parameter:aA})}else{if(this.isModified===true){aA.sensitive=this.sensitive;if(this.hasValueChanged){aA.value=this.value;if(P.isEmpty(this.value)&&!this.isEmptyStringSet){aA.valueRemoved=true}}aA.description=this.description;az.push({parameter:aA})}}}});return az};var M=function(){var aw=al("#parameter-context-selected").sortable("toArray");return aw.map(function(ay){var ax=al("#parameter-context-selected").find("li#"+ay+" span").text();return{id:ay,component:{id:ay,name:ax}}})};var ac=function(){if(!al("#parameter-dialog").hasClass("hidden")){ad()}return al.Deferred(function(aw){if(al("#parameter-context-update-status").is(":visible")){N();aw.resolve()}else{var ax=au();if(al.isEmptyObject(ax)){N();aw.resolve()}else{U.showYesNoDialog({headerText:"Parameters",dialogContent:"Save changes before leaving parameter context configuration?",noHandler:function(){N();aw.resolve()},yesHandler:function(){aq(c).done(function(){aw.resolve()}).fail(function(){aw.reject()})}})}}}).promise()};var af=function(aw){var ax=aw.get(0).scrollHeight>Math.round(aw.innerHeight())||aw.get(0).scrollWidth>Math.round(aw.innerWidth());if(aw.is(":visible")&&ax){aw.css("border-width","1px")}else{aw.css("border-width","0px")}};var N=function(){al("#parameter-context-dialog").modal("hide")};var x=function(az,aw){var ax=R.getFormattedBulletins(az);var ay=R.formatUnorderedList(ax);aw.addClass("has-bulletins").show().qtip(al.extend({},H.config.systemTooltipConfig,{content:ay}))};var C=function(aA,ax){var aw=al('<li class="referencing-component-container"></li>').appendTo(ax);var az=aA.component;al('<div class="referencing-component-state"></div>').addClass(function(){if(R.isDefinedAndNotNull(az.state)){var aB=al(this);var aD=az.state.toLowerCase();if(aD==="stopped"&&!R.isEmpty(az.validationErrors)){aD="invalid";var aC=R.formatUnorderedList(az.validationErrors);aB.qtip(al.extend({},H.config.systemTooltipConfig,{content:aC}))}return aD}else{return""}}).appendTo(aw);al('<span class="parameter-context-referencing-component-name link ellipsis"></span>').prop("title",az.name).text(az.name).on("click",function(){ac().done(function(){al("#shell-dialog").modal("hide");H.showComponent(aA.processGroup.id,az.id)})}).appendTo(aw);var ay=al('<div class="referencing-component-bulletins"></div>').addClass(az.id+"-referencing-bulletins");ay.appendTo(aw);if(!R.isEmpty(aA.bulletins)){x(aA.bulletins,ay)}al('<span class="referencing-component-active-thread-count"></span>').text(function(){if(R.isDefinedAndNotNull(az.activeThreadCount)&&az.activeThreadCount>0){return"("+az.activeThreadCount+")"}else{return""}}).appendTo(aw)};var W=function(az,aw){var aA=al('<li class="referencing-component-container"></li>').appendTo(aw);var ax=az.component;al('<div class="referencing-component-state"></div>').addClass(function(){if(R.isDefinedAndNotNull(ax.state)){var aB=al(this);var aD=ax.state==="ENABLED"?"enabled":"disabled";if(aD==="disabled"&&!R.isEmpty(ax.validationErrors)){aD="invalid";var aC=R.formatUnorderedList(ax.validationErrors);aB.qtip(al.extend({},H.config.systemTooltipConfig,{content:aC}))}return aD}else{return""}}).appendTo(aA);var ay=al('<div class="referencing-component-bulletins"></div>').addClass(ax.id+"-referencing-bulletins").appendTo(aA);if(!R.isEmpty(az.bulletins)){x(az.bulletins,ay)}al('<span class="parameter-context-referencing-component-name link ellipsis"></span>').prop("title",ax.name).text(ax.name).on("click",function(){ac().done(function(){al("#shell-dialog").modal("hide");a.enterGroup(ax.processGroupId);z.showConfiguration(ax.processGroupId).done(function(){z.selectControllerService(ax.id)})})}).appendTo(aA)};var h=function(ax){var aw=function(aE,aD){if(aE.hasClass("expanded")){aE.removeClass("expanded").addClass("collapsed");aD.hide()}else{aE.removeClass("collapsed").addClass("expanded");aD.show()}};var aA=[];var aB=[];var ay=[];var aC=al("#parameter-context-usage .referencing-components-loading");var az=al.Deferred(function(aD){aC.addClass("ajax-loading");aD.resolve()});az.then(function(){d()}).then(function(){var aE=al("#parameter-referencing-components-container").empty();if(R.isUndefined(ax)){al('<div class="referencing-component-container"><span class="unset">Pending Apply</span></div>').appendTo(aE)}else{al.each(ax,function(aJ,aK){if(aK.permissions.canRead===true&&aK.permissions.canWrite===true){if(aK.component.referenceType==="PROCESSOR"){aA.push(aK)}else{aB.push(aK)}}else{ay.push(aK)}});var aI={};al.each(aA,function(aJ,aK){if(aI[aK.processGroup.id]){aI[aK.processGroup.id].referencingProcessors.push(aK);aI[aK.processGroup.id].id=aK.processGroup.id;aI[aK.processGroup.id].name=aK.processGroup.name}else{aI[aK.processGroup.id]={referencingProcessors:[],referencingControllerServices:[],unauthorizedReferencingComponents:[],name:aK.processGroup.name,id:aK.processGroup.id};aI[aK.processGroup.id].referencingProcessors.push(aK)}});al.each(aB,function(aJ,aK){if(aI[aK.processGroup.id]){aI[aK.processGroup.id].referencingControllerServices.push(aK);aI[aK.processGroup.id].id=aK.processGroup.id;aI[aK.processGroup.id].name=aK.processGroup.name}else{aI[aK.processGroup.id]={referencingProcessors:[],referencingControllerServices:[],unauthorizedReferencingComponents:[],name:aK.processGroup.name,id:aK.processGroup.id};aI[aK.processGroup.id].referencingControllerServices.push(aK)}});al.each(ay,function(aK,aJ){if(aI[aJ.processGroup.id]){aI[aJ.processGroup.id].unauthorizedReferencingComponents.push(aJ);aI[aJ.processGroup.id].id=aJ.processGroup.id;aI[aJ.processGroup.id].name=aJ.processGroup.name}else{aI[aJ.processGroup.id]={referencingProcessors:[],referencingControllerServices:[],unauthorizedReferencingComponents:[],name:aJ.processGroup.name,id:aJ.processGroup.id};aI[aJ.processGroup.id].unauthorizedReferencingComponents.push(aJ)}});var aE=al("#parameter-referencing-components-container");var aD=al('<ul class="referencing-component-listing clear"></ul>');var aH=[];for(var aF in aI){if(aI.hasOwnProperty(aF)){aH.push(aI[aF])}}if(R.isEmpty(aH)){al('<div class="referencing-component-container"><span class="unset">None</span></div>').appendTo(aE)}else{var aG=aH.sort(function(aK,aJ){if(aK.name<aJ.name){return -1}if(aK.name>aJ.name){return 1}return 0});aG.forEach(function(aJ){var aK=al('<div class="referencing-component-references"></div>');aE.append(aK);var aL=function(aO,aQ){var aS=al('<div class="expansion-button collapsed"></div>');var aR=al('<span class="referencing-component-title"></span>').text(aO.name);var aP=al('<span class="referencing-component-count"></span>').text("("+(aO.referencingProcessors.length+aO.referencingControllerServices.length+aO.unauthorizedReferencingComponents.length)+")");var aM=al("#referencing-components-template").clone();aM.removeAttr("id");aM.removeClass("hidden");var aN=al('<div class="referencing-component-block pointer unselectable"></div>').data("processGroupId",aO.id).on("click",function(){if(aS.hasClass("collapsed")){aN.append(aM);var aV=aN.find(".parameter-context-referencing-processors");R.cleanUpTooltips(aV,"div.referencing-component-state");R.cleanUpTooltips(aV,"div.referencing-component-bulletins");aV.empty();var aU=aN.find(".parameter-context-referencing-controller-services");R.cleanUpTooltips(aU,"div.referencing-component-state");R.cleanUpTooltips(aU,"div.referencing-component-bulletins");aU.empty();var aT=aN.find(".parameter-context-referencing-unauthorized-components").empty();if(aI[al(this).data("processGroupId")].referencingProcessors.length===0){al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aV)}else{aI[al(this).data("processGroupId")].referencingProcessors.sort(am);al.each(aI[al(this).data("processGroupId")].referencingProcessors,function(aW,aX){C(aX,aV)})}if(aI[al(this).data("processGroupId")].referencingControllerServices.length===0){al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aU)}else{aI[al(this).data("processGroupId")].referencingControllerServices.sort(am);al.each(aI[al(this).data("processGroupId")].referencingControllerServices,function(aW,aX){W(aX,aU)})}if(aI[al(this).data("processGroupId")].unauthorizedReferencingComponents.length===0){al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aT)}else{aI[al(this).data("processGroupId")].unauthorizedReferencingComponents.sort(function(aX,aW){if(aX.permissions.canRead===true&&aW.permissions.canRead===true){var aY=aX.component.referenceType===aW.component.referenceType?0:aX.component.referenceType>aW.component.referenceType?-1:1;if(aY===0){aY=aX.component.name===aW.component.name?0:aX.component.name>aW.component.name?1:-1}return aY}else{if(aX.permissions.canRead===false&&aW.permissions.canRead===false){return aX.id>aW.id?1:-1}else{if(aX.permissions.canRead===true){return -1}else{return 1}}}});al.each(aI[al(this).data("processGroupId")].unauthorizedReferencingComponents,function(aX,aW){if(aW.permissions.canRead===true){if(aW.component.referenceType==="PROCESSOR"){C(aW,aT)}else{W(aW,aT)}}else{var aY=al('<li class="referencing-component-container"></li>').appendTo(aT);al('<span class="parameter-context-referencing-component-name link ellipsis"></span>').prop("title",aW.id).text(aW.id).on("click",function(){ac().done(function(){al("#shell-dialog").modal("hide");if(aW.referenceType==="PROCESSOR"){H.showComponent(aW.processGroup.id,aW.id)}else{if(aW.referenceType==="CONTROLLER_SERVICE"){z.showConfiguration(aW.processGroup.id).done(function(){a.enterGroup(aW.processGroup.id);z.selectControllerService(aW.id)})}}})}).appendTo(aY)}})}}else{aN.find(".referencing-components-template").remove()}aw(aS,aQ);af(al("#parameter-referencing-components-container"))}).append(aS).append(aR).append(aP).appendTo(aK);aQ.appendTo(aK);aN.click()};aL(aJ,aD)})}}}).always(function(){aC.removeClass("ajax-loading")});return az.promise()};var am=function(ax,aw){return ax.component.name.localeCompare(aw.component.name)};var ad=function(){var ay=ae();var aB=al("#parameter-table").data("gridInstance");var ax=aB.getData();var aD=aj(ay,ax.getItems());if(aD){var aA={canRead:true,canWrite:true};var aw={permissions:aA};var aC=P.extend({},ay,{id:P.defaultTo(ay.id,an),hidden:false,type:"Parameter",previousValue:null,previousDescription:null,isEditable:true,isModified:true,hasValueChanged:false,isNew:true,isInherited:false,provided:false,parameterContext:aw});R.cleanUpTooltips(al("#parameter-table"),"div.fa-question-circle, div.fa-info");if(P.isNil(ay.id)){var az=P.find(ax.getItems(),{name:aC.name});if(P.isNil(az)){ax.addItem(aC)}else{ax.updateItem(az.id,aC)}}else{ax.updateItem(ay.id,aC)}ax.reSort();var aE=ax.getRowById(an);aB.setActiveCell(aE,aB.getColumnIndex("value"));an++;al("#parameter-dialog").modal("hide")}al("#parameter-context-dialog").modal("refreshButtons")};var ae=function(aE){var aw=al.trim(al("#parameter-name").val());var aB=al("#parameter-value-field").val();var ay=al("#parameter-set-empty-string-field").hasClass("checkbox-checked");var aC=al("#parameter-description-field").val();var az=al("#parameter-dialog").find('input[name="sensitive"]:checked').val()==="sensitive"?true:false;var ax=function(){return true};var aA={name:aw,value:null,description:null,sensitive:az,isEmptyStringSet:ay,previousValue:null,isNew:true};var aD=K(al("#parameter-value-field"),P.isNil(aE)?aA:aE,ay);return{name:aw,value:aD.value,description:aC,sensitive:az,isEmptyStringSet:ay,hasValueChanged:aD.hasChanged,hasDescriptionChanged:aC!==P.get(aE,"description",""),isValueValid:ax}};var aj=function(aB,aA,az){if(aB.name===""){U.showOkDialog({headerText:"Configuration Error",dialogContent:"The name of the parameter must be specified."});return false}var aw=/^[a-zA-Z0-9-_. ]+$/;if(!aw.test(aB.name)){U.showOkDialog({headerText:"Configuration Error",dialogContent:"The name of the parameter appears to have an invalid character or characters. Only alpha-numeric characters (a-z, A-Z, 0-9), hyphens (-), underscores (_), periods (.), and spaces ( ) are accepted."});return false}var ay=P.find(aA,{name:aB.name});if(P.isNil(ay)||(az===true&&!P.isNil(ay))||ay.isInherited===true){return true}else{var ax=P.get(ay,"hidden",false);if(ax&&ay.sensitive!==aB.sensitive){U.showOkDialog({headerText:"Parameter Exists",dialogContent:"A parameter with this name has been marked for deletion. Please apply this change to delete this parameter from the parameter context before recreating it with a different sensitivity."})}else{if(ax&&ay.sensitive===aB.sensitive){aB.id=ay.id;return true}else{U.showOkDialog({headerText:"Parameter Exists",dialogContent:"A parameter with this name already exists."})}}return false}};var K=function(ax,aB,aA){var aw;var az=ax.val();if(!aA&&az===""){az=null}var ay=aB.value!==az;if(R.isDefinedAndNotNull(az)){if(!P.isEmpty(aB)&&aB.sensitive===true&&ax.hasClass("sensitive")&&aB.isNew===false){aw=aB.previousValue;ay=false}else{aw=az;if(!ay&&!P.isEmpty(aB)&&aB.sensitive===true&&aB.isNew===false){ay=true}}}else{if(aA){aw=""}else{aw=null}}return{value:aw,hasChanged:ay}};var ai=function(ax){var aw=ae(ax);var ay=al("#parameter-table").data("gridInstance");var az=ay.getData();var aA=aj(aw,az.getItems(),true);if(aA){var aC=P.extend({},ax,{id:ax.id,hidden:ax.provided===true,type:"Parameter",sensitive:ax.sensitive,name:ax.name,description:aw.description,referencingComponents:ax.referencingComponents,previousValue:ax.value,previousDescription:ax.description,isEditable:ax.isEditable||ax.provided!==true,isEmptyStringSet:aw.isEmptyStringSet,isNew:ax.isNew,hasValueChanged:aw.hasValueChanged,hasDescriptionChanged:aw.hasDescriptionChanged,value:aw.value,isModified:aw.hasValueChanged||aw.hasDescriptionChanged,isInherited:ax.isInherited,provided:ax.provided,parameterContext:ax.parameterContext});R.cleanUpTooltips(al("#parameter-table"),"div.fa-question-circle, div.fa-info");az.updateItem(ax.id,aC);az.reSort();var aB=az.getRowById(ax.id);ay.setActiveCell(aB,ay.getColumnIndex("value"));al("#parameter-dialog").modal("hide")}al("#parameter-context-dialog").modal("refreshButtons")};var o=function(aB){var aA=al("#parameter-context-name").val();var ay=al("#parameter-context-description-field").val();var aC=M();var ax=P.get(aB,"component.description","");var aw=D(aB,aC);if(aw){al("#inherited-parameter-contexts-message").addClass("hidden")}else{al("#inherited-parameter-contexts-message").removeClass("hidden")}if(aB.component.parameterProviderConfiguration){if(aA===P.get(aB,"component.name")&&ay===ax&&aw){return false}}else{var az=au();if(P.isEmpty(az)&&aA===P.get(aB,"component.name")&&ay===P.get(aB,"component.description")&&aw){return false}}return true};var D=function(ay,ax){var az=ay.component.inheritedParameterContexts.map(function(aA){return aA.id});var aw=ax.map(function(aA){return aA.id});return P.isEqual(az,aw)};var aq=function(ax){R.cleanUpTooltips(al("#parameter-table"),"div.fa-question-circle, div.fa-info");var aw=au();var ay=M();if(aw.length===0){ax.component.parameters=[];if(al("#parameter-context-name").val()===P.get(ax,"component.name")&&al("#parameter-context-description-field").val()===P.get(ax,"component.description")&&D(ax,ay)){N();return}}else{ax.component.parameters=aw}ax.component.inheritedParameterContexts=ay;ax.component.name=al("#parameter-context-name").val();ax.component.description=al("#parameter-context-description-field").val();return al.Deferred(function(az){var aC=function(){al("#parameter-context-dialog").modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){az.resolve();N()}}}])};var aE=function(){al("#parameter-context-dialog").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(al("#parameter-context-name").val()!==""&&o(ax)){return false}return true},handler:{click:function(){if(al("#parameter-referencing-components-container").is(":visible")){af(al("#parameter-referencing-components-container"))}aq(ax)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){az.resolve();if(al("#parameter-referencing-components-container").is(":visible")){af(al("#parameter-referencing-components-container"))}N()}}}])};var aA=false;al("#parameter-context-dialog").modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aA=true;if(al("#parameter-referencing-components-container").is(":visible")){af(al("#parameter-referencing-components-container"))}aC()}}}]);var aD;var aB=function(aH,aF,aG){if(R.isDefinedAndNotNull(aD)){at(ax.id,aD)}al("#parameter-context-update-steps").find("div.parameter-context-step.ajax-loading").removeClass("ajax-loading").addClass("ajax-error");if(al("#parameter-referencing-components-container").is(":visible")){af(al("#parameter-referencing-components-container"))}aE()};S(ax).done(function(aF){var aG=function(aM){var aL=aM.request;var aI=R.isDefinedAndNotNull(aL.failureReason);aD=aL.requestId;h(aL.referencingComponents).then(function(){var aN=[];al.each(aw,function(aO,aP){aN.push(aP.parameter.name)});al("#parameter-referencing-components-context").removeClass("unset").attr("title",aN.join(", ")).text(aN.join(", "))});ak(aL.updateSteps,aA,aI);if(aA){at(ax.id,aD)}else{if(aL.complete===true){if(aI){U.showOkDialog({headerText:"Parameter Context Update Error",dialogContent:"Unable to complete parameter context update request: "+R.escapeHtml(aL.failureReason)})}al.each(aL.referencingComponents,function(aN,aP){if(aP.permissions.canRead===true){var aO=aP.component;if(aO.referenceType==="PROCESSOR"&&H.getGroupId()===aO.processGroupId){E.reload(aO.id)}}});if(al("#parameter-contexts-table").is(":visible")){var aH=al("#parameter-contexts-table").data("gridInstance");var aK=aH.getData();al.extend(ax,{revision:aM.parameterContextRevision,component:aM.request.parameterContext});var aJ=aK.getItemById(ax.id);if(R.isDefinedAndNotNull(aJ)){aK.updateItem(ax.id,ax)}}at(ax.id,aD);aC();af(al("#parameter-referencing-components-container"))}else{setTimeout(function(){Y(ax.id,aD).done(function(aN){aG(aN)}).fail(aB)},2000)}}};al("#parameter-table, #add-parameter").hide();al("#parameter-context-tabs").find(".tab")[1].click();al("#parameter-context-tabs").hide();al("#parameter-context-update-status").show();al("#inherited-parameter-contexts-message").addClass("hidden");aG(aF)}).fail(aB)}).promise()};var Y=function(aw,ax){return al.ajax({type:"GET",url:aa.urls.parameterContexts+"/"+encodeURIComponent(aw)+"/update-requests/"+encodeURIComponent(ax),dataType:"json"}).fail(V.handleAjaxError)};var at=function(aw,ax){return al.ajax({type:"DELETE",url:aa.urls.parameterContexts+"/"+encodeURIComponent(aw)+"/update-requests/"+encodeURIComponent(ax)+"?"+al.param({disconnectedNodeAcknowledged:k.isDisconnectionAcknowledged()}),dataType:"json"}).fail(V.handleAjaxError)};var S=function(aw){return al.ajax({type:"POST",data:JSON.stringify(aw),url:aa.urls.parameterContexts+"/"+encodeURIComponent(aw.id)+"/update-requests",dataType:"json",contentType:"application/json"}).fail(V.handleAjaxError)};var ak=function(az,ay,ax){var aw=al("#parameter-context-update-steps").empty();al.each(az,function(aC,aB){var aA=al("<li></li>").text(aB.description).appendTo(aw);al('<div class="parameter-context-step"></div>').addClass(function(){if(R.isDefinedAndNotNull(aB.failureReason)){return"ajax-error"}else{if(aB.complete===true){return"ajax-complete"}else{return ay===true||ax===true?"ajax-error":"ajax-loading"}}}).appendTo(aA);al('<div class="clear"></div>').appendTo(aA)})};var an=0;var ah=0;var e=function(aA,az){if(az.permissions.canRead===false){aA.append('<div class="unset">Unauthorized</div>');return}var aC=az.component.boundProcessGroups;if(R.isEmpty(aC)){aA.append('<div class="unset">No referencing components.</div>');return}var aw=function(aE,aD){if(aE.hasClass("expanded")){aE.removeClass("expanded").addClass("collapsed");aD.hide()}else{aE.removeClass("collapsed").addClass("expanded");aD.show()}};var ay=al('<ul class="referencing-component-listing clear"></ul>');var ax=al('<ul class="referencing-component-listing clear"></ul>');al.each(aC,function(aE,aF){if(aF.permissions.canRead===false){var aD=al('<div class="unset"></div>').text(aF.id);ax.append(aD)}else{var aG=aF.component;var aI=al('<span class="referencing-component-name link"></span>').text(aG.name).on("click",function(){if(R.isDefinedAndNotNull(aG.parentGroupId)){H.showComponent(aG.parentGroupId,aG.id)}else{a.enterGroup(aG.id)}aA.closest(".dialog").modal("hide");al("#shell-close-button").click()});var aH=al("<li></li>").append(aI);ay.append(aH)}});var aB=function(aD,aF){if(aF.is(":empty")){aF.remove();return}var aH=al('<div class="expansion-button expanded"></div>');var aG=al('<span class="referencing-component-title"></span>').text(aD);var aE=al('<span class="referencing-component-count"></span>').text("("+aF.children().length+")");al('<div class="referencing-component-block pointer unselectable"></div>').on("click",function(){aw(aH,aF);af(aA)}).append(aH).append(aG).append(aE).appendTo(aA);aF.appendTo(aA)};aB("Process Groups",ay);aB("Unauthorized",ax)};var ap=function(aA,ax,aB){if(R.isDefinedAndNotNull(aA)){var aw=al("#parameter-table").data("gridInstance");var az=aw.getData();az.beginUpdate();var ay=[];al.each(aA.component.parameters,function(aC,aD){var aE={id:aD.parameter.parameterContext.component.id,permissions:aD.parameter.parameterContext.permissions};var aF={id:an++,hidden:false,type:"Parameter",isNew:false,isModified:false,hasValueChanged:false,name:aD.parameter.name,value:aD.parameter.value,sensitive:aD.parameter.sensitive,description:aD.parameter.description,previousValue:aD.parameter.value,previousDescription:aD.parameter.description,isEditable:P.defaultTo(aB,false)||aD.parameter.provided?false:aD.canWrite,referencingComponents:aD.parameter.referencingComponents,parameterContext:aE,isInherited:(aE.id!==aA.component.id),provided:aD.parameter.provided};ay.push({parameter:aF});az.addItem(aF)});az.endUpdate();az.reSort();if(R.isDefinedAndNotNull(ax)){al.each(ay,function(aC,aD){if(aD.parameter.name===ax){ah=az.getRowById(aD.parameter.id);return false}})}else{ah=0}if(ay.length===0){d()}else{aw.setSelectedRows([ah])}}};var G=function(aw,ay,ax){al.each(ax,function(aC,aB){var az=R.isNull(aw)?false:aB.id===aw.id;var aA=R.isNull(aw)?false:aw.component.inheritedParameterContexts.some(function(aD){return aB.id===aD.id});if(ay){if(aA){al("#parameter-context-selected-read-only").append(al("<li></li>").text(aB.component.name))}}else{if(aA){f(aB,true)}else{if(!az){f(aB,false)}}}});if(!R.isNull(aw)){ar(aw)}q();if(ay){if(al("#parameter-context-selected-read-only").is(":empty")){al("#parameter-context-selected-read-only").append(al('<span class="unset">No value set</span>'))}al("#parameter-context-inheritance-container-read-only").show();al("#parameter-context-inheritance-container").hide()}else{al("#parameter-context-inheritance-container-read-only").hide();al("#parameter-context-inheritance-container").show()}};var d=function(){var ay=al(".parameter-context-referencing-processors");R.cleanUpTooltips(ay,"div.referencing-component-state");R.cleanUpTooltips(ay,"div.referencing-component-bulletins");ay.empty();var ax=al(".parameter-context-referencing-controller-services");R.cleanUpTooltips(ax,"div.referencing-component-state");R.cleanUpTooltips(ax,"div.referencing-component-bulletins");ax.empty();var aw=al(".parameter-context-referencing-unauthorized-components").empty();al("#parameter-referencing-components-container").empty();Z=null;al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(ay);al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(ax);al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aw);al("#parameter-referencing-components-context").addClass("unset").attr("title","None").text("None");af(al("#parameter-referencing-components-container"))};var A=function(){al("#parameter-context-available").empty();al("#parameter-context-selected").empty();al("#parameter-context-selected-read-only").empty();al("#inherited-parameter-contexts-message").addClass("hidden")};var q=function(){var aw=al("#parameter-context-available");aw.children("li").detach().sort(function(aC,aB){var ay=al(aC);var ax=al(aB);if(ay.hasClass("unauthorized")&&ax.hasClass("unauthorized")){return 0}else{if(ay.hasClass("unauthorized")){return 1}else{if(ax.hasClass("unauthorized")){return -1}}}var aA=ay.text();var az=ax.text();return aA.localeCompare(az)}).appendTo(aw)};var ar=function(ax){var ay=ax.component.inheritedParameterContexts;var aw=al("#parameter-context-selected");aw.children("li").detach().sort(function(aE,aD){var aB=al(aE);var az=al(aD);var aC=function(aF){return aB.attr("id")===aF.id};var aA=function(aF){return az.attr("id")===aF.id};return ay.findIndex(aC)-ay.findIndex(aA)}).appendTo(aw)};var f=function(az,ax){var aw=az.id;if(az.permissions.canRead){aw=az.component.name}var ay=al("<li></li>").append(al('<span style="float: left;"></span>').text(aw)).attr("id",az.id).addClass("ui-state-default");if(!az.permissions.canRead){ay.addClass("unauthorized")}else{if(!R.isBlank(az.component.description)){al('<div class="fa fa-question-circle"></div>').appendTo(ay).qtip(al.extend({content:R.escapeHtml(az.component.description)},R.config.tooltipConfig))}if(ax){L(ay)}}ay.appendTo(ax?"#parameter-context-selected":"#parameter-context-available")};var L=function(aw){var ax=al('<div class="draggable-control"><div class="fa fa-remove"></div></div>').on("click",function(){ax.remove();al("#parameter-context-available").append(aw);q();al("#parameter-context-dialog").modal("refreshButtons")}).appendTo(aw)};var w=function(ax,aw){return ax.hidden===false};var X=function(){var ay=al("#parameter-table");var aB=function(aK,aE,aI,aF,aD){var aJ=30;var aG=al("<div></div>");var aH=al("<span/>").addClass("table-cell").text(aI).appendTo(aG);if(aD.type==="required"){aH.addClass("required")}if(!R.isBlank(aD.description)){al('<div class="fa fa-question-circle" alt="Info" style="float: right;"></div>').appendTo(aG);al('<span class="hidden parameter-row"></span>').text(aK).appendTo(aG);aJ=46}aH.width(aF.width-aJ).ellipsis();return aG.html()};var ax=function(aL,aK,aJ,aE,aD){var aF=0;if(aD.sensitive===true&&!P.isNil(aJ)){return'<span class="table-cell sensitive">Sensitive value set</span>'}else{if(aJ===""){return'<span class="table-cell blank">Empty string set</span>'}else{if(P.isNil(aJ)){return'<span class="unset">No value set</span>'}else{var aH;aF=15;if(R.isMultiLine(aJ)){aH='<div class="table-cell value"><div class="ellipsis-white-space-pre multi-line-clamp-ellipsis">'+R.escapeHtml(aJ)+"</div></div>"}else{aH='<div class="table-cell value"><div class="ellipsis-white-space-pre">'+R.escapeHtml(aJ)+"</div></div>"}if(R.hasLeadTrailWhitespace(aJ)){aH+='<div class="fa fa-info" alt="Info" style="float: right;"></div>';aF=30}var aG=al(aH);var aI=aG.find(".ellipsis-white-space-pre");aI.attr("title",aI.text()).width(aE.width-aF);return al("<div />").append(aG).html()}}}};var az=function(aI,aE,aH,aG,aD){var aF="";if(aD.isInherited===true&&aD.parameterContext.permissions.canRead){aF+='<div title="Go To" class="pointer go-to-parameter fa fa-long-arrow-right"></div>'}else{if(aD.isEditable===true){aF+='<div title="Edit" class="edit-parameter pointer fa fa-pencil"></div>';aF+='<div title="Delete" class="delete-parameter pointer fa fa-trash"></div>'}}return aF};var aC=[{id:"name",name:"Name",field:"name",formatter:aB,sortable:true,resizable:true,rerenderOnResize:true},{id:"value",name:"Value",field:"value",formatter:ax,sortable:false,resizable:true},{id:"actions",name:"&nbsp;",resizable:false,rerenderOnResize:true,formatter:az,sortable:false,width:90,maxWidth:90}];var aA=new v.Data.DataView({inlineFilters:false});aA.setFilterArgs({searchString:"",property:"hidden"});aA.setFilter(w);b({columnId:"name",sortAsc:true},aA);var aw=new v.Grid(ay,aA,aC,s);aw.setSelectionModel(new v.RowSelectionModel());aw.registerPlugin(new v.AutoTooltips());aw.setSortColumn("name",true);aw.onSort.subscribe(function(aE,aD){b({columnId:aD.sortCol.id,sortAsc:aD.sortAsc},aA)});aw.onClick.subscribe(function(aH,aJ){var aK=aA.getItem(aJ.row);if(aw.getColumns()[aJ.cell].id==="actions"){var aI=al(aH.target);if(aI.hasClass("delete-parameter")){R.cleanUpTooltips(al("#parameter-table"),"div.fa-question-circle, div.fa-info");if(!aK.isNew){aA.updateItem(aK.id,al.extend(aK,{hidden:true}))}else{aA.deleteItem(aK.id)}var aE=aw.getSelectedRows();if(aE.length===0){aw.setSelectedRows([0])}var aL=aA.getItems();if(aL.length===0){d()}else{var aG=true;al.each(aL,function(aM,aN){if(!aN.hidden){aG=false}});if(aG){d()}}al("#parameter-context-dialog").modal("refreshButtons");aH.stopImmediatePropagation()}else{if(aI.hasClass("edit-parameter")){var aD=function(){I()};var aF=function(){al("#parameter-sensitive-radio-button").prop("checked",false);al("#parameter-not-sensitive-radio-button").prop("checked",true);al("#parameter-name").focus();al("#parameter-name").val(aK.name);al("#parameter-name").prop("disabled",true);al("#parameter-sensitive-radio-button").prop("disabled",true);al("#parameter-not-sensitive-radio-button").prop("disabled",true);if(aK.value===""){if(!aK.sensitive){al("#parameter-set-empty-string-field").removeClass("checkbox-unchecked").addClass("checkbox-checked");al("#parameter-value-field").prop("disabled",true)}}else{al("#parameter-set-empty-string-field").removeClass("checkbox-checked").addClass("checkbox-unchecked")}if(aK.sensitive){al("#parameter-sensitive-radio-button").prop("checked",true);al("#parameter-not-sensitive-radio-button").prop("checked",false);if(!P.isNil(aK.value)){al("#parameter-value-field").addClass("sensitive").val(R.config.sensitiveText).select();al("#parameter-set-empty-string-field").removeClass("checkbox-checked").addClass("checkbox-unchecked")}}else{al("#parameter-sensitive-radio-button").prop("checked",false);al("#parameter-not-sensitive-radio-button").prop("checked",true);al("#parameter-value-field").val(aK.value)}al("#parameter-description-field").val(aK.description);al("#parameter-dialog").modal("refreshButtons")};al("#parameter-set-empty-string-field").off().on("change",function(aN,aM){if(aM.isChecked){al("#parameter-value-field").prop("disabled",true).val("");al("#parameter-dialog").modal("refreshButtons")}else{var aO=aK.sensitive?"":aK.previousValue;al("#parameter-value-field").prop("disabled",false).val(aO);al("#parameter-dialog").modal("refreshButtons")}});al("#parameter-dialog").modal("setHeaderText","Edit Parameter").modal("setOpenHandler",aF).modal("setCloseHandler",aD).modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var aM=ae(aK);if(aM.hasValueChanged){return !aM.isValueValid()}else{return !aM.hasDescriptionChanged}},handler:{click:function(){ai(aK)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){al(this).modal("hide")}}}]).modal("show");aH.stopImmediatePropagation()}else{if(aI.hasClass("go-to-parameter")){if(aK.parameterContext.permissions.canRead===true){N();m();ag.showParameterContext(aK.parameterContext.id,aK.parameterContext.permissions.canWrite===false,aK.name)}}}}}});aw.onSelectedRowsChanged.subscribe(function(aF,aE){if(al.isArray(aE.rows)&&aE.rows.length===1){if(aw.getDataLength()>0){var aD=aE.rows[0];var aG=aw.getDataItem(aD);if(Z===null||Z!==aG.id){h(aG.referencingComponents).then(function(){al("#parameter-referencing-components-context").removeClass("unset").attr("title",aG.name).text(aG.name);af(al("#parameter-referencing-components-container"));Z=aG.id})}}}});aw.onBeforeCellEditorDestroy.subscribe(function(aE,aD){setTimeout(function(){aw.resizeCanvas()},50)});aA.onRowCountChanged.subscribe(function(aE,aD){aw.updateRowCount();aw.render()});aA.onRowsChanged.subscribe(function(aE,aD){aw.invalidateRows(aD.rows);aw.render()});aA.syncGridSelection(aw,true);ay.data("gridInstance",aw).on("mouseenter","div.slick-cell",function(aF){var aD=al(this).find("div.fa-question-circle");if(aD.length){if(aD.data("qtip")){aD.qtip("destroy",true)}var aH=al(this).find("span.parameter-row").text();var aI=aA.getItem(aH);if(R.isDefinedAndNotNull(aI.description)){aD.qtip(al.extend({},R.config.tooltipConfig,{content:aI.description}))}}var aG=al(this).find("div.fa-info");if(aG.length&&!aG.data("qtip")){var aE=R.formatWhitespaceTooltip();aG.qtip(al.extend({},R.config.tooltipConfig,{content:aE}))}})};var l=function(){al("#parameter-context-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"parameter-context-standard-settings-tab-content"},{name:"Parameters",tabContentId:"parameter-context-parameters-tab-content"},{name:"Inheritance",tabContentId:"parameter-context-inheritance-tab-content"}],select:function(){if(al(this).text()==="Parameters"){var aw=al("#parameter-table").data("gridInstance");if(R.isDefinedAndNotNull(aw)){aw.resizeCanvas()}}}});al("#parameter-context-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){m()}}});al("#parameter-dialog").modal();al("#parameter-value-field").on("keydown",function(){var aw=al(this);if(aw.hasClass("sensitive")){aw.removeClass("sensitive");if(aw.val()===R.config.sensitiveText){aw.val("")}}});al("#parameter-set-empty-string-field").on("click",function(){var aw=al("#parameter-value-field");if(aw.hasClass("sensitive")){aw.removeClass("sensitive");if(aw.val()===R.config.sensitiveText){aw.val("")}}});al("#parameter-name").on("keydown",function(ax){var aw=ax.keyCode?ax.keyCode:ax.which;if(aw===al.ui.keyCode.ENTER){ad();ax.stopImmediatePropagation();ax.preventDefault()}});al("#add-parameter").on("click",function(){var ax=function(){R.cleanUpTooltips(al("#parameter-table"),"div.fa-question-circle, div.fa-info");I()};var aw=function(){al("#parameter-sensitive-radio-button").prop("checked",false);al("#parameter-not-sensitive-radio-button").prop("checked",true);al("#parameter-name").focus()};al("#parameter-dialog").modal("setHeaderText","Add Parameter").modal("setOpenHandler",aw).modal("setCloseHandler",ax).modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var ay=ae();if(ay.name!==""){return false}return true},handler:{click:function(){ad()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){al(this).modal("hide")}}}]).modal("show")});al("#parameter-set-empty-string-field").off().on("change",function(ax,aw){if(aw.isChecked){al("#parameter-value-field").prop("disabled",true).val("");al("#parameter-dialog").modal("refreshButtons")}else{al("#parameter-value-field").prop("disabled",false);al("#parameter-dialog").modal("refreshButtons")}});al("#parameter-context-name").on("keyup",function(aw){al("#parameter-context-dialog").modal("refreshButtons")});al("#parameter-context-description-field").on("keyup",function(aw){al("#parameter-context-dialog").modal("refreshButtons")});al("#parameter-name").on("keyup",function(aw){al("#parameter-dialog").modal("refreshButtons")});al("#parameter-value-field").on("keyup",function(aw){al("#parameter-dialog").modal("refreshButtons")});al("#parameter-description-field").on("keyup",function(aw){al("#parameter-dialog").modal("refreshButtons")});al("#parameter-set-empty-string-field").on("change",function(aw){al("#parameter-dialog").modal("refreshButtons")});X()};var ab=function(aw){al("#parameter-dialog").modal("setHeaderText","Add Parameter").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var ay=ae();var ax=al("#parameter-context-updating-status").hasClass("show-status");if(ax||P.isEmpty(ay.name)){return true}return false},handler:{click:aw.onApply}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:aw.onCancel}}]).modal("show");al("#parameter-set-empty-string-field").off().on("change",function(ay,ax){if(ax.isChecked){al("#parameter-value-field").prop("disabled",true).val("");al("#parameter-dialog").modal("refreshButtons")}else{al("#parameter-value-field").prop("disabled",false);al("#parameter-dialog").modal("refreshButtons")}})};var j=function(){return al.ajax({type:"GET",url:"../nifi-api/flow/parameter-contexts",dataType:"json"})};var ao=function(aw){var ax=j();return al.when(ax).done(function(ay){al("#parameter-contexts-last-refreshed").text(ay.currentTime);var aC=[];al.each(ay.parameterContexts,function(aD,aE){aC.push(al.extend({type:"ParameterContext"},aE))});var aA=al("#parameter-contexts-table").data("gridInstance");var aB=aA.getData();aB.setItems(aC);aB.reSort();aA.invalidate();if(R.isDefinedAndNotNull(aw)){var az=null;al.each(aC,function(aE,aD){if(aD.id===aw){az=aB.getRowById(aw);return false}});if(az!==null){aA.setSelectedRows([az])}}}).fail(V.handleAjaxError)};var u=function(aw){g.showContent("#parameter-contexts");ag.resetTableSize()};var n=function(){var aB=function(aJ,aD,aI,aG,aC){var aF="";var aH=aC.permissions.canWrite;var aE=aC.permissions.canRead;if(aE&&aH){aF+='<div title="Edit" class="pointer edit-parameter-context fa fa-pencil"></div>'}if(aE&&aH&&R.canModifyParameterContexts()){aF+='<div title="Remove" class="pointer delete-parameter-context fa fa-trash"></div>'}if(H.isManagedAuthorizer()&&R.canAccessTenants()){aF+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key"></div>'}if(aE&&aC.component.parameterProviderConfiguration){aF+='<div title="Go To Parameter Provider" class="pointer go-to-provider fa fa-long-arrow-right"></div>'}return aF};var az=function(aG,aD,aF,aE,aC){if(!aC.permissions.canRead){return""}return R.escapeHtml(aC.component.description)};var ay=function(aI,aD,aH,aG,aC){var aF="";var aE=aC.permissions.canRead;if(aE){aF+='<div title="View Details" class="pointer view-parameter-context fa fa-info-circle"></div>'}return aF};var aw=[{id:"info",name:"&nbsp;",resizable:false,formatter:ay,sortable:false,width:30,maxWidth:30},{id:"name",name:"Name",sortable:true,resizable:true,formatter:O},{id:"parameterProviderConfiguration",name:"Provider",sortable:true,resizable:true,formatter:p},{id:"description",name:"Description",sortable:true,resizable:true,formatter:az}];aw.push({id:"actions",name:"&nbsp;",resizable:false,formatter:aB,sortable:false,width:90,maxWidth:90});var aA=new v.Data.DataView({inlineFilters:false});aA.setItems([]);F({columnId:"name",sortAsc:true},aA);var ax=new v.Grid("#parameter-contexts-table",aA,aw,y);ax.setSelectionModel(new v.RowSelectionModel());ax.registerPlugin(new v.AutoTooltips());ax.setSortColumn("name",true);ax.onSort.subscribe(function(aD,aC){F({columnId:aC.sortCol.id,sortAsc:aC.sortAsc},aA)});ax.onClick.subscribe(function(aF,aC){var aE=al(aF.target);var aD=aA.getItem(aC.row);if(ax.getColumns()[aC.cell].id==="actions"){if(aE.hasClass("edit-parameter-context")){ag.showParameterContext(aD.id)}else{if(aE.hasClass("delete-parameter-context")){ag.promptToDeleteParameterContext(aD)}else{if(aE.hasClass("edit-access-policies")){J.showParameterContextPolicy(aD);al("#shell-close-button").click()}else{if(aE.hasClass("go-to-provider")){if(aD.component.parameterProviderConfiguration){i.showParameterProvider(aD.component.parameterProviderConfiguration.id);al("#shell-close-button").click()}}}}}}else{if(ax.getColumns()[aC.cell].id==="info"){if(aE.hasClass("view-parameter-context")){ag.showParameterContext(aD.id,true)}}}});aA.onRowCountChanged.subscribe(function(aD,aC){ax.updateRowCount();ax.render()});aA.onRowsChanged.subscribe(function(aD,aC){ax.invalidateRows(aC.rows);ax.render()});aA.syncGridSelection(ax,true);al("#parameter-contexts-table").data("gridInstance",ax).on("mouseenter","div.slick-cell",function(aG){var aF=al(this).find("div.has-errors");if(aF.length&&!aF.data("qtip")){var aC=al(this).find("span.row-id").text();var aE=aA.getItemById(aC);var aD=R.formatUnorderedList(aE.component.validationErrors);if(R.isDefinedAndNotNull(aD)){aF.qtip(al.extend({},R.config.tooltipConfig,{content:aD,position:{target:"mouse",viewport:al("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var c=null;var ag={init:function(aw){i=aw;al("#parameter-contexts-refresh-button").on("click",function(){ao()});al("#new-parameter-context").on("click",function(){d();A();if(!al("#parameter-context-id-setting").hasClass("hidden")){al("#parameter-context-id-setting").addClass("hidden")}al("#parameter-context-dialog").removeClass("read-only");al("#parameter-context-dialog").addClass("edit-mode");al("#parameter-context-dialog").modal("setHeaderText","Add Parameter Context").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(al("#parameter-context-name").val()!==""){return false}return true},handler:{click:function(){ag.addParameterContext()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){al(this).modal("hide")}}}]).modal("show");var ay=al("#parameter-contexts-table").data("gridInstance");var az=ay.getData();var aA=az.getItems();G(null,false,aA);al("#parameter-context-name").focus()});var ax=true;al("#parameter-context-available").sortable({containment:al("#parameter-context-inheritance-tab-content"),cancel:".unauthorized",connectWith:"#parameter-context-selected",placeholder:"available",scroll:true,opacity:0.6,beforeStop:function(ay,az){if(al("#parameter-context-available").find(".ui-sortable-placeholder").length){ax=false}},stop:function(az,aA){const ay=ax;ax=true;return ay}});al("#parameter-context-selected").sortable({containment:al("#parameter-context-inheritance-tab-content"),cancel:".unauthorized",placeholder:"selected",scroll:true,opacity:0.6,receive:function(ay,az){L(az.item)},update:function(ay,az){al("#parameter-context-dialog").modal("refreshButtons")}});al("#parameter-context-available, #parameter-context-selected").disableSelection();al(document).on("dblclick",'#parameter-context-available li:not(".unauthorized")',function(){var ay=al(this).detach().appendTo(al("#parameter-context-selected"));L(ay);al("#parameter-context-dialog").modal("refreshButtons")});l();n();al(window).on("resize",function(ay){if(al("#parameter-referencing-components-container").is(":visible")){af(al("#parameter-referencing-components-container"))}})},addParameterContext:function(ay){var aw={component:{name:al("#parameter-context-name").val(),description:al("#parameter-context-description-field").val(),parameters:au()},revision:B.getRevision({revision:{version:0}})};aw.component.inheritedParameterContexts=M();var ax=al.ajax({type:"POST",url:aa.urls.parameterContexts,data:JSON.stringify(aw),dataType:"json",contentType:"application/json"}).done(function(aB){if(al("#parameter-contexts-table").is(":visible")){var az=al("#parameter-contexts-table").data("gridInstance");var aA=az.getData();aA.addItem(aB);aA.reSort();az.invalidate();var aC=aA.getRowById(aB.id);r.choseRow(az,aC);az.scrollRowIntoView(aC)}if(typeof ay==="function"){ay(aB)}}).fail(V.handleAjaxError);al("#parameter-context-dialog").modal("hide");return ax},resetTableSize:function(){var aw=al("#parameter-contexts-table").data("gridInstance");if(R.isDefinedAndNotNull(aw)){aw.resizeCanvas()}},showParameterContexts:function(aw){al("#new-parameter-context").prop("disabled",!R.canModifyParameterContexts());return ao(aw).done(u)},showParameterContext:function(aA,az,ax){an=0;var aw=al.ajax({type:"GET",url:aa.urls.parameterContexts+"/"+encodeURIComponent(aA),data:{includeInheritedParameters:"true"},dataType:"json"});var ay;if(al("#parameter-contexts-table").is(":visible")){ay=al.Deferred(function(aB){var aC=al("#parameter-contexts-table").data("gridInstance");var aD=aC.getData();aB.resolve({parameterContexts:aD.getItems()})}).promise()}else{ay=j()}aw.done(function(aF){var aE=P.get(aF,"permissions.canWrite",false);if(P.defaultTo(az,false)){aE=false}c=aF;if(aE){al("#parameter-context-dialog").removeClass("read-only");al("#parameter-context-dialog").addClass("edit-mode");al("#parameter-context-name").val(aF.component.name);al("#parameter-context-description-field").val(aF.component.description)}else{al("#parameter-context-dialog").removeClass("edit-mode");al("#parameter-context-dialog").addClass("read-only");al("#parameter-context-name-read-only").prop("title",aF.component.name).text(aF.component.name);al("#parameter-context-description-read-only").text(aF.component.description)}if(al("#parameter-context-id-setting").hasClass("hidden")){al("#parameter-context-id-setting").removeClass("hidden")}al("#parameter-context-id-field").prop("title",aF.id).text(aF.id);if(aF.component.parameterProviderConfiguration){al("#parameter-context-provider-setting").show();var aD=al("#parameter-context-provider-setting").empty();var aH=aF.component.parameterProviderConfiguration.component.parameterGroupName+" from "+aF.component.parameterProviderConfiguration.component.parameterProviderName;al('<div class="setting-name">Provider</div>').appendTo(aD);var aC=al('<div class="setting-field"></div>');var aG=al('<span id="parameter-context-parameter-provider-name" class="parameter-context-parameter-provider-name link ellipsis"></span>').prop("title",aH).text(aH).on("click",function(){ac().done(function(){al("#shell-dialog").modal("hide");i.showParameterProvider(aF.component.parameterProviderConfiguration.id)})});aG.appendTo(aC);aC.appendTo(aD)}var aB=al("#parameter-context-referencing-components");e(aB,aF);ap(aF,ax,az||!aE);ay.done(function(aJ){G(aF,az||!aE,aJ.parameterContexts);var aK=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(al("#parameter-context-name").val()!==""&&o(c)){return false}return true},handler:{click:function(){aq(c)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){al(this).modal("hide")}}}];var aI=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){return false},handler:{click:function(){al(this).modal("hide")}}}];al("#parameter-context-dialog").modal("setHeaderText",aE?"Update Parameter Context":"View Parameter Context").modal("setButtonModel",aE?aK:aI).modal("show");al("#parameter-context-tabs").find("li:eq(1)").click();if(aF.component.parameterProviderConfiguration){al("#add-parameter").hide()}else{if(!al("#parameter-context-provider-setting").hasClass("hidden")){al("#parameter-context-provider-setting").empty().addClass("hidden")}al("#add-parameter").show()}af(al("#parameter-referencing-components-container"));af(aB)}).fail(V.handleAjaxError)}).fail(V.handleAjaxError)},promptToDeleteParameterContext:function(aw){U.showYesNoDialog({headerText:"Delete Parameter Context",dialogContent:"Delete parameter context '"+R.escapeHtml(aw.component.name)+"'?",yesHandler:function(){ag.remove(aw)}})},remove:function(aw){al.ajax({type:"DELETE",url:aa.urls.parameterContexts+"/"+encodeURIComponent(aw.id)+"?"+al.param({disconnectedNodeAcknowledged:k.isDisconnectionAcknowledged(),clientId:aw.revision.clientId,version:aw.revision.version}),dataType:"json"}).done(function(ax){var ay=al("#parameter-contexts-table").data("gridInstance");var az=ay.getData();az.deleteItem(aw.id)}).fail(V.handleAjaxError)},convertPropertyToParameter:function(ay,aw,ax){return al.Deferred(function(az){if(P.isNil(ax)){U.showOkDialog({headerText:"Unable to Convert Property",dialogContent:"There is no parameter context set for the current process group."});az.reject()}var aA=al.ajax({type:"GET",url:aa.urls.parameterContexts+"/"+encodeURIComponent(ax),data:{includeInheritedParameters:"true"},dataType:"json"});aA.done(function(aC){var aB=function(aF){if(aF){al("#parameter-context-updating-status").addClass("show-status");al("#parameter-dialog").modal("refreshButtons")}else{al("#parameter-context-updating-status").removeClass("show-status");al("#parameter-dialog").modal("refreshButtons")}};var aE;var aD;ab({onApply:function(){aB(true);var aH=aC.component.parameters.map(function(aI){return aI.parameter});var aG=ae();var aF=aj(aG,aH);if(!aF){aB(false);return}aC.component.parameters=[{parameter:{name:aG.name,value:aG.value,sensitive:aG.sensitive,description:aG.description}}];aE=null;S(aC).done(function(aI){var aJ=function(aM){var aL=aM.request;var aK=!P.isEmpty(aL.failureReason);aE=aL.requestId;if(aL.complete===true){aB(false);if(aK){U.showOkDialog({headerText:"Parameter Context Update Error",dialogContent:"Unable to complete parameter context update request: "+R.escapeHtml(aL.failureReason)});az.reject()}else{az.resolve(aG)}at(aC.id,aE);al("#parameter-dialog").modal("hide")}else{aD=setTimeout(function(){Y(aC.id,aE).done(function(aN){aJ(aN)}).fail(function(aN){if(!P.isNil(aC.id)&&!P.isNil(aE)){at(aC.id,aE)}az.reject(aN)})},1000)}};aJ(aI)}).fail(function(aI){az.reject(aI)})},onCancel:function(){aB(false);if(!P.isNil(aC.id)&&!P.isNil(aE)){at(aC.id,aE);aE=null;if(!P.isNil(aD)){clearTimeout(aD)}}I();al(this).modal("hide")}});al("#parameter-name").val(ay.displayName);al("#parameter-name").prop("disabled",false);al("#parameter-sensitive-radio-button").prop("disabled",true);al("#parameter-not-sensitive-radio-button").prop("disabled",true);if(ay.value===""){al("#parameter-dialog").find(".nf-checkbox").removeClass("checkbox-unchecked").addClass("checkbox-checked")}else{al("#parameter-dialog").find(".nf-checkbox").removeClass("checkbox-checked").addClass("checkbox-unchecked")}if(R.isSensitiveProperty(aw)){al("#parameter-sensitive-radio-button").prop("checked",true);al("#parameter-not-sensitive-radio-button").prop("checked",false);al("#parameter-value-field").val(null)}else{al("#parameter-sensitive-radio-button").prop("checked",false);al("#parameter-not-sensitive-radio-button").prop("checked",true);al("#parameter-value-field").val(ay.value)}al("#parameter-description-field").val(ay.description);al("#parameter-dialog").modal("refreshButtons")}).fail(function(aB){az.reject(aB)})}).promise()}};return ag}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.CanvasUtils","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.ErrorHandler","nf.Clipboard","nf.ParameterContexts","nf.Snippet","nf.GoTo","nf.ng.Bridge","nf.Shell","nf.ComponentState","nf.FlowVersion","nf.Draggable","nf.Birdseye","nf.Connection","nf.Graph","nf.ProcessGroupConfiguration","nf.ProcessorConfiguration","nf.ProcessorDetails","nf.LabelConfiguration","nf.RemoteProcessGroupConfiguration","nf.RemoteProcessGroupDetails","nf.PortConfiguration","nf.PortDetails","nf.ConnectionConfiguration","nf.ConnectionDetails","nf.PolicyManagement","nf.RemoteProcessGroup","nf.Label","nf.Processor","nf.RemoteProcessGroupPorts","nf.ComponentVersion","nf.QueueListing","nf.StatusHistory"],function(B,G,K,F,k,s,j,f,x,M,L,h,l,E,g,t,v,i,N,o,D,J,e,y,A,I,C,p,m,n,w,c,u,q,d,r,z,H){return(nf.Actions=b(B,G,K,F,k,s,j,f,x,M,L,h,l,E,g,t,v,i,N,o,D,J,e,y,A,I,C,p,m,n,w,c,u,q,d,r,z,H))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Actions=b(require("jquery"),require("d3"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ErrorHandler"),require("nf.Clipboard"),require("nf.ParameterContexts"),require("nf.Snippet"),require("nf.GoTo"),require("nf.ng.Bridge"),require("nf.Shell"),require("nf.ComponentState"),require("nf.FlowVersion"),require("nf.Draggable"),require("nf.Birdseye"),require("nf.Connection"),require("nf.Graph"),require("nf.ProcessGroupConfiguration"),require("nf.ProcessorConfiguration"),require("nf.ProcessorDetails"),require("nf.LabelConfiguration"),require("nf.RemoteProcessGroupConfiguration"),require("nf.RemoteProcessGroupDetails"),require("nf.PortConfiguration"),require("nf.PortDetails"),require("nf.ConnectionConfiguration"),require("nf.ConnectionDetails"),require("nf.PolicyManagement"),require("nf.RemoteProcessGroup"),require("nf.Label"),require("nf.Processor"),require("nf.RemoteProcessGroupPorts"),require("nf.ComponentVersion"),require("nf.QueueListing"),require("nf.StatusHistory")))}else{nf.Actions=b(a.$,a.d3,a.nf.CanvasUtils,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ErrorHandler,a.nf.Clipboard,a.nf.ParameterContexts,a.nf.Snippet,a.nf.GoTo,a.nf.ng.Bridge,a.nf.Shell,a.nf.ComponentState,a.nf.FlowVersion,a.nf.Draggable,a.nf.Birdseye,a.nf.Connection,a.nf.Graph,a.nf.ProcessGroupConfiguration,a.nf.ProcessorConfiguration,a.nf.ProcessorDetails,a.nf.LabelConfiguration,a.nf.RemoteProcessGroupConfiguration,a.nf.RemoteProcessGroupDetails,a.nf.PortConfiguration,a.nf.PortDetails,a.nf.ConnectionConfiguration,a.nf.ConnectionDetails,a.nf.PolicyManagement,a.nf.RemoteProcessGroup,a.nf.Label,a.nf.Processor,a.nf.RemoteProcessGroupPorts,a.nf.ComponentVersion,a.nf.QueueListing,a.nf.StatusHistory)}}}(this,function(F,L,P,K,l,v,k,f,B,R,Q,h,n,J,g,w,y,i,S,q,H,O,c,C,E,N,G,s,o,p,A,a,x,t,b,u,D,M){var I={urls:{api:"../nifi-api",controller:"../nifi-api/controller",parameterContexts:"../nifi-api/parameter-contexts",}};var e=function(){F("#drop-request-status-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){F("#drop-request-status-dialog").modal("setButtonModel",[])}}})};var m=function(U,T){T.disconnectedNodeAcknowledged=v.isDisconnectionAcknowledged();return F.ajax({type:"PUT",url:U,data:JSON.stringify(T),dataType:"json",contentType:"application/json"}).fail(function(X,V,W){l.showOkDialog({headerText:"Update Resource",dialogContent:K.escapeHtml(X.responseText)})})};var j=function(T){F.ajax({type:"GET",url:I.urls.api+"/flow/process-groups/"+encodeURIComponent(T.id),dataType:"json"}).done(function(U){q.set(U.processGroupFlow.flow)})};var d=function(T,U){return U.filter(function(V){return P.getConnectionSourceComponentId(T)===V.id}).size()>0};var r=function(W,Y){var U=W.datum();var V=-1;F.each(Y.get(),function(Z,aa){if(U.id!==aa.id&&aa.zIndex>V){V=aa.zIndex}});if(V>=0){var X=V+1;var T={revision:k.getRevision(U),disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged(),component:{id:U.id,zIndex:X}};return F.ajax({type:"PUT",url:U.uri,data:JSON.stringify(T),dataType:"json",contentType:"application/json"}).done(function(Z){Y.set(Z)}).fail(f.handleAjaxError)}};var z={init:function(){e()},enterGroup:function(T){if(T.size()===1&&P.isProcessGroup(T)){var U=T.datum();P.getComponentByType("ProcessGroup").enterGroup(U.id)}},leaveGroup:function(){P.getComponentByType("ProcessGroup").enterGroup(P.getParentGroupId())},refreshRemoteFlow:function(U){if(U.size()===1&&P.isRemoteProcessGroup(U)){var X=U.datum();var Y=X.component.flowRefreshed;var T=function(Z){X.component.flowRefreshed=Z;if(U.classed("visible")){U.select("text.remote-process-group-last-refresh").text(function(){return Z})}};var W=function(Z){F.ajax({type:"GET",url:X.uri,dataType:"json"}).done(function(aa){var ac=aa.component;if(Y===ac.flowRefreshed){V(Z)}else{a.set(aa);var ab=S.getComponentConnections(ac.id);F.each(ab,function(ae,ad){if(ad.permissions.canRead){S.reload(ad.id)}})}})};var V=function(Z){if(Z<=32){setTimeout(function(){W(Z*2)},Z*1000)}else{T(Y)}};T("Refreshing...");W(1)}},openUri:function(T){if(T.size()===1&&P.isRemoteProcessGroup(T)){var V=T.datum();var U=V.component.targetUri;if(!K.isBlank(U)){window.open(encodeURI(U))}else{l.showOkDialog({headerText:"Remote Process Group",dialogContent:"No target URI defined."})}}},showSource:function(T){if(T.size()===1&&P.isConnection(T)){var V=T.datum();if(V.sourceGroupId===P.getGroupId()){var U=L.select("#id-"+V.sourceId);z.show(U)}else{if(V.sourceType==="REMOTE_OUTPUT_PORT"){var W=L.select("#id-"+V.sourceGroupId);z.show(W)}else{P.showComponent(V.sourceGroupId,V.sourceId)}}}},showDestination:function(V){if(V.size()===1&&P.isConnection(V)){var W=V.datum();if(W.destinationGroupId===P.getGroupId()){var T=L.select("#id-"+W.destinationId);z.show(T)}else{if(W.destinationType==="REMOTE_INPUT_PORT"){var U=L.select("#id-"+W.destinationGroupId);z.show(U)}else{P.showComponent(W.destinationGroupId,W.destinationId)}}}},showDownstream:function(T){if(T.size()===1&&!P.isConnection(T)){if(P.isProcessor(T)){h.showDownstreamFromProcessor(T)}else{if(P.isFunnel(T)){h.showDownstreamFromFunnel(T)}else{if(P.isInputPort(T)){h.showDownstreamFromInputPort(T)}else{if(P.isOutputPort(T)){h.showDownstreamFromOutputPort(T)}else{if(P.isProcessGroup(T)||P.isRemoteProcessGroup(T)){h.showDownstreamFromGroup(T)}}}}}}},showUpstream:function(T){if(T.size()===1&&!P.isConnection(T)){if(P.isProcessor(T)){h.showUpstreamFromProcessor(T)}else{if(P.isFunnel(T)){h.showUpstreamFromFunnel(T)}else{if(P.isInputPort(T)){h.showUpstreamFromInputPort(T)}else{if(P.isOutputPort(T)){h.showUpstreamFromOutputPort(T)}else{if(P.isProcessGroup(T)||P.isRemoteProcessGroup(T)){h.showUpstreamFromGroup(T)}}}}}}},show:function(T){var U=P.getSelection();U.classed("selected",false);T.classed("selected",true);if(T.size()===1){z.center(T)}else{n.injector.get("navigateCtrl").zoomFit()}P.setURLParameters(P.getGroupId(),T);n.digest()},select:function(T){T.classed("selected",true)},selectAll:function(){z.select(L.selectAll("g.component, g.connection"))},center:function(V){if(V.size()===1){var W;if(P.isConnection(V)){var T,aa;var Z=V.datum();if(Z.bends.length>0){var U=Math.min(Math.max(0,Z.labelIndex),Z.bends.length-1);T=Z.bends[U].x;aa=Z.bends[U].y}else{T=(Z.start.x+Z.end.x)/2;aa=(Z.start.y+Z.end.y)/2}W={x:T,y:aa,width:1,height:1}}else{var X=V.datum();var Y=X.position;W={x:Y.x,y:Y.y,width:X.dimensions.width,height:X.dimensions.height}}P.centerBoundingBox(W)}},enable:function(U){if(U.empty()){var T={id:P.getGroupId(),state:"ENABLED"};m(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),T).done(j)}else{var W=P.filterEnable(U);if(!W.empty()){var V=[];W.each(function(aa){var Y=L.select(this);var Z,X;if(P.isProcessGroup(Y)){Z=I.urls.api+"/flow/process-groups/"+encodeURIComponent(aa.id);X={id:aa.id,state:"ENABLED"}}else{Z=aa.uri+"/run-status";X={revision:k.getRevision(aa),state:"STOPPED"}}V.push(m(Z,X).done(function(ab){if(P.isProcessGroup(Y)){P.getComponentByType("ProcessGroup").reload(aa.id)}else{P.getComponentByType(aa.type).set(ab)}}))});if(V.length>0){F.when.apply(window,V).always(function(){n.digest()})}}}},disable:function(V){if(V.empty()){var U={id:P.getGroupId(),state:"DISABLED"};m(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),U).done(j)}else{var T=P.filterDisable(V);if(!T.empty()){var W=[];T.each(function(aa){var Y=L.select(this);var Z,X;if(P.isProcessGroup(Y)){Z=I.urls.api+"/flow/process-groups/"+encodeURIComponent(aa.id);X={id:aa.id,state:"DISABLED"}}else{Z=aa.uri+"/run-status";X={revision:k.getRevision(aa),state:"DISABLED"}}W.push(m(Z,X).done(function(ab){if(P.isProcessGroup(Y)){P.getComponentByType("ProcessGroup").reload(aa.id)}else{P.getComponentByType(aa.type).set(ab)}}))});if(W.length>0){F.when.apply(window,W).always(function(){n.digest()})}}}},openProvenance:function(T){if(T.size()===1){var U=T.datum();J.showPage("provenance?"+F.param({componentId:U.id}))}},replayLastProvenanceEvent:function(V,U){if(V.size()===1){var W=V.datum();var T={componentId:W.id,nodes:U};F.ajax({type:"POST",url:I.urls.api+"/provenance-events/latest/replays",data:JSON.stringify(T),dataType:"json",contentType:"application/json"}).fail(function(Z,X,Y){l.showOkDialog({headerText:"Failed to Replay Event",dialogContent:K.escapeHtml(Z.responseText)})}).done(function(Z){if(K.isDefinedAndNotNull(Z.aggregateSnapshot.failureExplanation)){l.showOkDialog({headerText:"Replay Event Failure",dialogContent:Z.aggregateSnapshot.failureExplanation})}else{if(Z.aggregateSnapshot.eventAvailable!==true){l.showOkDialog({headerText:"No Event Available",dialogContent:"There was no recent event available to be replayed."})}else{if(K.isDefinedAndNotNull(Z.nodeSnapshots)){var ac=0;var ae=0;for(var ab=0;ab<Z.nodeSnapshots.length;ab++){var aa=Z.nodeSnapshots[ab];if(aa.snapshot.eventAvailable){ac++}else{ae++}}var ad;if(ae===0){ad="All nodes successfully replayed the latest event."}else{ad=ac+" nodes successfully replayed the latest event but "+ae+" had no recent event avaialble to be replayed."}l.showOkDialog({headerText:"Events Replayed",dialogContent:ad})}else{l.showOkDialog({headerText:"Event Replayed",dialogContent:"Successfully replayed the latest event."})}}}var X=S.getComponentConnections(W.id);for(var ab=0;ab<X.length;ab++){var Y=X[ab];S.reload(Y.id)}})}},replayLastAllNodes:function(T){this.replayLastProvenanceEvent(T,"ALL")},replayLastPrimaryNode:function(T){this.replayLastProvenanceEvent(T,"PRIMARY")},start:function(V){if(V.empty()){var T={id:P.getGroupId(),state:"RUNNING"};m(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),T).done(j);var X={state:"TRANSMITTING"};m(I.urls.api+"/remote-process-groups/process-group/"+encodeURIComponent(P.getGroupId())+"/run-status",X).done(function(Y){a.set(Y.remoteProcessGroups)})}else{var W=V.filter(function(Y){return P.isRunnable(L.select(this))||P.canStartTransmitting(L.select(this))});if(!W.empty()){var U=[];W.each(function(ac){var Z=L.select(this);var aa,Y;if(P.isProcessGroup(Z)){aa=I.urls.api+"/flow/process-groups/"+encodeURIComponent(ac.id);Y={id:ac.id,state:"RUNNING"}}else{if(P.isRemoteProcessGroup(Z)){aa=ac.uri+"/run-status";Y={revision:k.getRevision(ac),state:"TRANSMITTING"}}else{aa=ac.uri+"/run-status";Y={revision:k.getRevision(ac),state:"RUNNING"}}}if(P.isProcessGroup(Z)){var ab={state:"TRANSMITTING"};var ad=m(I.urls.api+"/remote-process-groups/process-group/"+encodeURIComponent(ac.id)+"/run-status",ab);U.push(ad.done(function(ae){}));U.push(m(aa,Y).done(function(ae){P.getComponentByType("ProcessGroup").reload(ac.id)}))}else{U.push(m(aa,Y).done(function(ae){P.getComponentByType(ac.type).set(ae)}))}});if(U.length>0){F.when.apply(window,U).always(function(){n.digest()})}}}},runOnce:function(T){var U=T.filter(function(W){return P.isRunnable(L.select(this))});if(!U.empty()){var V=[];U.each(function(Z){var X=L.select(this);var Y,W;Y=Z.uri+"/run-status";W={revision:k.getRevision(Z),state:"RUN_ONCE"};V.push(m(Y,W).done(function(aa){P.getComponentByType(Z.type).set(aa)}))});if(V.length>0){F.when.apply(window,V).always(function(){n.digest()})}}},stop:function(V,T){if(V.empty()){var U={id:P.getGroupId(),state:"STOPPED"};m(I.urls.api+"/flow/process-groups/"+encodeURIComponent(P.getGroupId()),U).done(j);var Y={state:"STOPPED"};m(I.urls.api+"/remote-process-groups/process-group/"+encodeURIComponent(P.getGroupId())+"/run-status",Y).done(function(Z){a.set(Z.remoteProcessGroups)})}else{var X=V.filter(function(Z){return P.isStoppable(L.select(this))||P.canStopTransmitting(L.select(this))});if(!X.empty()){var W=[];X.each(function(ae){var aa=L.select(this);var ab,Z;if(P.isProcessGroup(aa)){ab=I.urls.api+"/flow/process-groups/"+encodeURIComponent(ae.id);Z={id:ae.id,state:"STOPPED"}}else{ab=ae.uri+"/run-status";Z={revision:k.getRevision(ae),state:"STOPPED"}}if(P.isProcessGroup(aa)){var ad={state:"STOPPED"};var ac=m(I.urls.api+"/remote-process-groups/process-group/"+encodeURIComponent(ae.id)+"/run-status",ad);W.push(ac.done(function(af){}));W.push(m(ab,Z).done(function(af){P.getComponentByType("ProcessGroup").reload(ae.id)}))}else{W.push(m(ab,Z).done(function(af){P.getComponentByType(ae.type).set(af)}))}});if(W.length>0){F.when.apply(window,W).always(function(){n.digest();if(typeof T=="function"){T()}})}else{if(typeof T=="function"){T()}}}}},enableAllControllerServices:function(W){var V=W.empty()?P.getGroupId():W.datum().id;var U=I.urls.api+"/flow/process-groups/"+encodeURIComponent(V)+"/controller-services";var T={id:V,state:"ENABLED"};if(W.empty()){m(U,T).done(j)}else{m(U,T).done(function(X){P.getComponentByType("ProcessGroup").reload(V)})}},disableAllControllerServices:function(W){var V=W.empty()?P.getGroupId():W.datum().id;var U=I.urls.api+"/flow/process-groups/"+encodeURIComponent(V)+"/controller-services";var T={id:V,state:"DISABLED"};if(W.empty()){m(U,T).done(j)}else{m(U,T).done(function(X){P.getComponentByType("ProcessGroup").reload(V)})}},stopAndConfigure:function(U,T){if(U.size()===1&&P.isProcessor(U)&&P.canModify(U)){z.stop(U,function(){O.showConfiguration(U,T)})}},terminate:function(U,T){if(U.size()===1&&P.isProcessor(U)){var V=U.datum();F.ajax({type:"DELETE",url:V.uri+"/threads",dataType:"json"}).done(function(W){t.set(W);if(typeof T=="function"){T()}}).fail(f.handleAjaxError)}},enableTransmission:function(T){var U=T.filter(function(V){return P.canStartTransmitting(L.select(this))});U.each(function(W){var V={revision:k.getRevision(W),state:"TRANSMITTING"};m(W.uri+"/run-status",V).done(function(X){a.set(X)})})},disableTransmission:function(U){var T=U.filter(function(V){return P.canStopTransmitting(L.select(this))});T.each(function(W){var V={revision:k.getRevision(W),state:"STOPPED"};m(W.uri+"/run-status",V).done(function(X){a.set(X)})})},showConfiguration:function(U,T){if(U.empty()){H.showConfiguration(P.getGroupId())}else{if(U.size()===1){var V=U.datum();if(P.isProcessor(U)){O.showConfiguration(U,T)}else{if(P.isLabel(U)){C.showConfiguration(U)}else{if(P.isProcessGroup(U)){H.showConfiguration(V.id)}else{if(P.isRemoteProcessGroup(U)){E.showConfiguration(U)}else{if(P.isInputPort(U)||P.isOutputPort(U)){G.showConfiguration(U)}else{if(P.isConnection(U)){o.showConfiguration(U)}}}}}}}}},managePolicies:function(T){if(T.size()<=1){A.showComponentPolicy(T)}},showDetails:function(T){if(T.empty()){H.showConfiguration(P.getGroupId())}else{if(T.size()===1){var U=T.datum();if(P.isProcessor(T)){if(!P.isStoppable(T)&&P.canModify(T)){O.showConfiguration(T)}else{c.showDetails(P.getGroupId(),U.id)}}else{if(P.isProcessGroup(T)){H.showConfiguration(U.id)}else{if(P.isRemoteProcessGroup(T)){N.showDetails(T)}else{if(P.isInputPort(T)||P.isOutputPort(T)){s.showDetails(T)}else{if(P.isConnection(T)){p.showDetails(P.getGroupId(),U.id)}}}}}}}},showUsage:function(T){if(T.size()===1&&P.isProcessor(T)){var U=T.datum();J.showPage("../nifi-docs/documentation?"+F.param({select:U.component.type,group:U.component.bundle.group,artifact:U.component.bundle.artifact,version:U.component.bundle.version}))}},showStats:function(T){if(T.size()===1){var U=T.datum();if(P.isProcessor(T)){M.showProcessorChart(P.getGroupId(),U.id)}else{if(P.isProcessGroup(T)){M.showProcessGroupChart(P.getGroupId(),U.id)}else{if(P.isRemoteProcessGroup(T)){M.showRemoteProcessGroupChart(P.getGroupId(),U.id)}else{if(P.isConnection(T)){M.showConnectionChart(P.getGroupId(),U.id)}}}}}},remotePorts:function(T){if(T.size()===1&&P.isRemoteProcessGroup(T)){b.showPorts(T)}},reload:function(){P.reload()},"delete":function(V){if(K.isUndefined(V)||V.empty()){l.showOkDialog({headerText:"Delete Components",dialogContent:"No eligible components are selected. Please select the components to be deleted."})}else{if(V.size()===1){var X=V.datum();var U=k.getRevision(X);F.ajax({type:"DELETE",url:X.uri+"?"+F.param({version:U.version,clientId:U.clientId,disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(Y){P.getComponentByType(X.type).remove(X.id);if(P.isConnection(V)===false){var Z=S.getComponentConnections(X.id);if(Z.length>0){var aa=[];F.each(Z,function(ac,ab){aa.push(ab.id)});S.remove(aa)}}P.setURLParameters();i.refresh();n.digest()}).fail(f.handleAjaxError)}else{var T=P.getGroupId();var W=Q.marshal(V,T);Q.create(W).done(function(Y){Q.remove(Y.snippet.id).done(function(){var aa=new Map();var Z=function(ab,ac){if(!aa.has(ab)){aa.set(ab,[])}aa.get(ab).push(ac)};V.each(function(ac){Z(ac.type,ac.id);if(ac.type!=="Connection"){var ab=S.getComponentConnections(ac.id);if(ab.length>0){F.each(ab,function(ae,ad){Z("Connection",ad.id)})}}});aa.forEach(function(ac,ab){if(ab!=="Connection"){P.getComponentByType(ab).remove(ac)}});if(aa.has("Connection")){S.remove(aa.get("Connection"))}P.setURLParameters();i.refresh();n.digest()}).fail(f.handleAjaxError)}).fail(f.handleAjaxError)}}},emptyQueue:function(T){if(T.size()!==1||!P.isConnection(T)){return}l.showYesNoDialog({headerText:"Empty Queue",dialogContent:"Are you sure you want to empty this queue? All FlowFiles waiting at the time of the request will be removed.",noText:"Cancel",yesText:"Empty",yesHandler:function(){var X=T.datum();var ab=4;var Z=false;var aa=null;var W=null;var V=function(ae){var af=F("#drop-request-percent-complete");af.find("div.progress-label").remove();af.find("md-progress-linear").remove();var ad=F('<div class="progress-label"></div>').text(ae+"%");(n.injector.get("$compile")(F('<md-progress-linear ng-cloak ng-value="'+ae+'" class="md-hue-2" md-mode="determinate" aria-label="Drop request percent complete"></md-progress-linear>'))(n.rootScope)).appendTo(af);af.append(ad)};F("#drop-request-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){Z=true;if(W!==null){clearTimeout(W);U()}}}}]);var U=function(){S.reloadStatus(X.id);if(K.isDefinedAndNotNull(aa)){F.ajax({type:"DELETE",url:aa.uri,dataType:"json"}).done(function(ad){aa=ad.dropRequest;var ag=aa.dropped.split(/ \/ /);var af=F("<div></div>");F('<span class="label"></span>').text(ag[0]).appendTo(af);F("<span></span>").text(" FlowFiles ("+ag[1]+")").appendTo(af);if(aa.percentCompleted<100){var ae=aa.original.split(/ \/ /);F('<span class="label"></span>').text(" out of "+ae[0]).appendTo(af);F("<span></span>").text(" ("+ae[1]+")").appendTo(af)}F("<span></span>").text(" were removed from the queue.").appendTo(af);if(K.isDefinedAndNotNull(aa.failureReason)){F("<br/><br/><span></span>").text(aa.failureReason).appendTo(af)}l.showOkDialog({headerText:"Empty Queue",dialogContent:af})}).always(function(){F("#drop-request-status-dialog").modal("hide")})}else{l.showOkDialog({headerText:"Empty Queue",dialogContent:"No FlowFiles were removed."});F("#drop-request-status-dialog").modal("hide")}};var ac=function(ad){V(aa.percentCompleted);F("#drop-request-status-message").text(aa.state);if(aa.finished===true||Z===true){U()}else{W=setTimeout(function(){W=null;Y(Math.min(ab,ad*2))},ad*1000)}};var Y=function(ad){F.ajax({type:"GET",url:aa.uri,dataType:"json"}).done(function(ae){aa=ae.dropRequest;ac(ad)}).fail(function(ag,ae,af){if(ag.status===403){f.handleAjaxError(ag,ae,af)}else{U()}})};F.ajax({type:"POST",url:"../nifi-api/flowfile-queues/"+encodeURIComponent(X.id)+"/drop-requests",dataType:"json",contentType:"application/json"}).done(function(ad){V(0);F("#drop-request-status-dialog").modal("show");aa=ad.dropRequest;ac(1)}).fail(function(af,ad,ae){if(af.status===403){f.handleAjaxError(af,ad,ae)}else{U()}})}})},emptyAllQueues:function(T){l.showYesNoDialog({headerText:"Empty All Queues",dialogContent:"Are you sure you want to empty all queues in this Process Group? All FlowFiles from all connections waiting at the time of the request will be removed.",noText:"Cancel",yesText:"Empty All",yesHandler:function(){var X;if(T.empty()){X=P.getGroupId()}else{X=T.datum().id}var ab=4;var Z=false;var aa=null;var W=null;var V=function(ae){var af=F("#drop-request-percent-complete");af.find("div.progress-label").remove();af.find("md-progress-linear").remove();var ad=F('<div class="progress-label"></div>').text(ae+"%");(n.injector.get("$compile")(F('<md-progress-linear ng-cloak ng-value="'+ae+'" class="md-hue-2" md-mode="determinate" aria-label="Drop request percent complete"></md-progress-linear>'))(n.rootScope)).appendTo(af);af.append(ad)};F("#drop-request-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){Z=true;if(W!==null){clearTimeout(W);U()}}}}]);var U=function(){P.reload();if(K.isDefinedAndNotNull(aa)){F.ajax({type:"DELETE",url:aa.uri,dataType:"json"}).done(function(ad){aa=ad.dropRequest;var ag=aa.dropped.split(/ \/ /);var af=F("<div></div>");F('<span class="label"></span>').text(ag[0]).appendTo(af);F("<span></span>").text(" FlowFiles ("+ag[1]+")").appendTo(af);if(aa.percentCompleted<100){var ae=aa.original.split(/ \/ /);F('<span class="label"></span>').text(" out of "+ae[0]).appendTo(af);F("<span></span>").text(" ("+ae[1]+")").appendTo(af)}F("<span></span>").text(" were removed from the queues.").appendTo(af);if(K.isDefinedAndNotNull(aa.failureReason)){F("<br/><br/><span></span>").text(aa.failureReason).appendTo(af)}l.showOkDialog({headerText:"Empty All Queues",dialogContent:af})}).always(function(){F("#drop-request-status-dialog").modal("hide")})}else{l.showOkDialog({headerText:"Empty All Queues",dialogContent:"No FlowFiles were removed."});F("#drop-request-status-dialog").modal("hide")}};var ac=function(ad){V(aa.percentCompleted);F("#drop-request-status-message").text(aa.state);if(aa.finished===true||Z===true){U()}else{W=setTimeout(function(){W=null;Y(Math.min(ab,ad*2))},ad*1000)}};var Y=function(ad){F.ajax({type:"GET",url:aa.uri,dataType:"json"}).done(function(ae){aa=ae.dropRequest;ac(ad)}).fail(function(ag,ae,af){if(ag.status===403){f.handleAjaxError(ag,ae,af)}else{U()}})};F.ajax({type:"POST",url:"../nifi-api/process-groups/"+encodeURIComponent(X)+"/empty-all-connections-requests",dataType:"json",contentType:"application/json"}).done(function(ad){V(0);F("#drop-request-status-dialog").modal("show");aa=ad.dropRequest;ac(1)}).fail(function(af,ad,ae){if(af.status===403){f.handleAjaxError(af,ad,ae)}else{U()}})}})},listQueue:function(U){if(U.size()!==1||!P.isConnection(U)){return}var T=U.datum();D.listQueue(T)},viewState:function(U){if(U.size()!==1||!P.isProcessor(U)){return}var T=U.datum();g.showState(T,P.isConfigurable(U))},saveFlowVersion:function(T){if(T.empty()){w.showFlowVersionDialog(P.getGroupId(),"COMMIT")}else{if(T.size()===1){var U=T.datum();if(P.isProcessGroup(T)){w.showFlowVersionDialog(U.id,"COMMIT")}}}},forceSaveFlowVersion:function(T){l.showYesNoDialog({headerText:"Commit",dialogContent:"Committing will ignore available upgrades and commit local changes as the next version. Are you sure you want to proceed?",noText:"Cancel",yesText:"Yes",yesHandler:function(){if(T.empty()){w.showFlowVersionDialog(P.getGroupId(),"FORCE_COMMIT")}else{if(T.size()===1){var U=T.datum();if(P.isProcessGroup(T)){w.showFlowVersionDialog(U.id,"FORCE_COMMIT")}}}}})},revertLocalChanges:function(T){if(T.empty()){w.revertLocalChanges(P.getGroupId())}else{if(T.size()===1){var U=T.datum();w.revertLocalChanges(U.id)}}},showLocalChanges:function(T){if(T.empty()){w.showLocalChanges(P.getGroupId())}else{if(T.size()===1){var U=T.datum();w.showLocalChanges(U.id)}}},changeFlowVersion:function(T){if(T.empty()){w.showChangeFlowVersionDialog(P.getGroupId())}else{if(T.size()===1){var U=T.datum();if(P.isProcessGroup(T)){w.showChangeFlowVersionDialog(U.id)}}}},downloadFlowWithoutExternalServices:function(T){this.downloadFlow(T,false)},downloadFlowWithExternalServices:function(T){this.downloadFlow(T,true)},downloadFlow:function(U,Y){var T=null;if(U.empty()){T=P.getGroupId()}else{if(U.size()===1){var X=U.datum();if(P.isProcessGroup(U)){T=X.id}}}if(T!==null){var W={};var V="../nifi-api/process-groups/"+encodeURIComponent(T)+"/download?includeReferencedServices="+Y;window.open(V)}},stopVersionControl:function(T){if(T.empty()){w.stopVersionControl(P.getGroupId())}else{if(T.size()===1){var U=T.datum();w.stopVersionControl(U.id)}}},openParameterContext:function(T){var U;if(T.empty()){U=P.getParameterContext()}else{if(T.size()===1){if(P.isProcessGroup(T)){var V=T.datum();U=V.parameterContext}}}if(K.isDefinedAndNotNull(U)){R.showParameterContext(U.id)}},changeVersion:function(U){if(U.size()!==1||!P.isProcessor(U)){return}var T=U.datum();u.promptForVersionChange(T)},alignVertical:function(V){var X=new Map();if(P.canModify(V)===false){l.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}var U=null,W=null;V.each(function(Z){if(Z.type!=="Connection"){if(U===null||Z.position.x<U){U=Z.position.x}var Y=Z.position.x+Z.dimensions.width;if(W===null||Y>W){W=Y}}});var T=(U+W)/2;V.each(function(Z){if(Z.type!=="Connection"){var aa={x:T-(Z.position.x+Z.dimensions.width/2),y:0};if(aa.x!==0){var Y=S.getComponentConnections(Z.id);F.each(Y,function(ad,ac){var ae=L.select("#id-"+ac.id);if(!X.has(ac.id)&&P.getConnectionSourceComponentId(ac)===P.getConnectionDestinationComponentId(ac)){var ab=y.updateConnectionPosition(S.get(ac.id),aa);if(ab!==null){X.set(ac.id,ab)}}else{if(!X.has(ac.id)&&ae.classed("selected")&&P.canModify(ae)){if(P.getConnectionSourceComponentId(ac)===Z.id||!d(ac,V)){var ab=y.updateConnectionPosition(S.get(ac.id),aa);if(ab!==null){X.set(ac.id,ab)}}}}});X.set(Z.id,y.updateComponentPosition(Z,aa))}}});y.refreshConnections(X)},alignHorizontal:function(U){var W=new Map();if(P.canModify(U)===false){l.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}var X=null,V=null;U.each(function(Z){if(Z.type!=="Connection"){if(X===null||Z.position.y<X){X=Z.position.y}var Y=Z.position.y+Z.dimensions.height;if(V===null||Y>V){V=Y}}});var T=(X+V)/2;U.each(function(Z){if(Z.type!=="Connection"){var aa={x:0,y:T-(Z.position.y+Z.dimensions.height/2)};if(aa.y!==0){var Y=S.getComponentConnections(Z.id);F.each(Y,function(ad,ac){var ae=L.select("#id-"+ac.id);if(!W.has(ac.id)&&P.getConnectionSourceComponentId(ac)===P.getConnectionDestinationComponentId(ac)){var ab=y.updateConnectionPosition(S.get(ac.id),aa);if(ab!==null){W.set(ac.id,ab)}}else{if(!W.has(ac.id)&&ae.classed("selected")&&P.canModify(ae)){if(P.getConnectionSourceComponentId(ac)===Z.id||!d(ac,U)){var ab=y.updateConnectionPosition(S.get(ac.id),aa);if(ab!==null){W.set(ac.id,ab)}}}}});W.set(Z.id,y.updateComponentPosition(Z,aa))}}});y.refreshConnections(W)},fillColor:function(V){if(P.isColorable(V)){var T=P.isProcessor(V);var U;if(T){U=t.defaultFillColor()}else{U=x.defaultColor()}if(V.size()===1){var W=V.datum();if(K.isDefinedAndNotNull(W.component.style["background-color"])){U=W.component.style["background-color"]}}F("#fill-color").minicolors("value",U);if(T){F("#fill-color-processor-preview").show();F("#fill-color-label-preview").hide()}else{F("#fill-color-processor-preview").hide();F("#fill-color-label-preview").show()}F("#fill-color-dialog").modal("show")}},group:function(){var U=P.getSelection();if(U.empty()){return}var T=P.getOrigin(U);var V={x:T.x,y:T.y};F.when(n.injector.get("groupComponent").promptForGroupName(V,false,false)).done(function(W){var X=L.select("#id-"+W.id);P.moveComponents(U,X)})},moveIntoParent:function(){var T=P.getSelection();if(T.empty()){return}P.moveComponentsToParent(T)},uploadTemplate:function(){F("#upload-template-dialog").modal("show")},template:function(){var T=P.getSelection();if(T.empty()){T=L.selectAll("g.component, g.connection")}if(T.empty()){l.showOkDialog({headerText:"Create Template",dialogContent:"The current selection is not valid to create a template."});return}T=P.trimDanglingEdges(T);if(T.empty()){l.showOkDialog({headerText:"Create Template",dialogContent:"The current selection is not valid to create a template."});return}F("#new-template-dialog").modal("setButtonModel",[{buttonText:"Create",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var V=F("#new-template-name").val();if(K.isBlank(V)){l.showOkDialog({headerText:"Configuration Error",dialogContent:"The name of the template must be specified."});return}F("#new-template-dialog").modal("hide");var X=F("#new-template-description").val();var U=P.getGroupId();var W=Q.marshal(T,U);Q.create(W).done(function(Y){var Z={name:V,description:X,snippetId:Y.snippet.id,disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged()};F.ajax({type:"POST",url:I.urls.api+"/process-groups/"+encodeURIComponent(P.getGroupId())+"/templates",data:JSON.stringify(Z),dataType:"json",contentType:"application/json"}).done(function(){l.showOkDialog({headerText:"Create Template",dialogContent:"Template '"+K.escapeHtml(V)+"' was successfully created."})}).always(function(){F("#new-template-name").val("");F("#new-template-description").val("")}).fail(f.handleAjaxError)}).fail(f.handleAjaxError)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){F("#new-template-name").val("");F("#new-template-description").val("");F("#new-template-dialog").modal("hide")}}}]).modal("show");F("#new-template-name").focus()},copy:function(W){if(W.empty()){return}var U=P.getOrigin(W);var V=P.getSelectionBoundingClientRect(W);var T=P.getGroupId();B.copy({snippet:Q.marshal(W,T),origin:U,dimensions:V})},paste:function(aa,ab){if(K.isDefinedAndNotNull(ab)){var V=P.getCanvasScale();var T=P.getCanvasTranslate();var W=ab.pageX;var U=ab.pageY-P.getCanvasOffset();var Z=(W/V)-(T[0]/V);var Y=(U/V)-(T[1]/V);var X={x:Z,y:Y}}B.paste().done(function(ad){var ac=F.Deferred(function(ae){var af=function(aj,ah,ai){ae.reject(aj.responseText)};var ag=P.getGroupId();Q.create(ad.snippet).done(function(ak){var aj=X;var ai=ad.origin;var al=ad.dimensions;if(!K.isDefinedAndNotNull(aj)){if(P.getGroupId()!==ad.snippet.parentGroupId||!P.isBoundingBoxInViewport(al,false)){var an=P.getCanvasScale();var ah=P.getCenterForBoundingBox(al);var am=P.getCanvasTranslate();aj={x:ah[0]-(am[0]/an),y:ah[1]-(am[1]/an)}}else{ai.x+=25;ai.y+=25;aj=ai}}Q.copy(ak.snippet.id,aj,ag).done(function(ap){var ao=ap.flow;q.add(ao,{selectAll:true});q.updateVisibility();i.refresh()}).fail(function(){P.reload().done(function(){q.updateVisibility();i.refresh()})}).fail(af)}).fail(af)}).promise();ac.fail(function(af){var ae="An error occurred while attempting to copy and paste.";if(F.trim(af)!==""){ae=af}l.showOkDialog({headerText:"Paste Error",dialogContent:K.escapeHtml(ae)})})})},toFront:function(T){if(T.size()!==1){return}if(P.isConnection(T)){r(T,S)}else{if(P.isLabel(T)){r(T,x)}}}};return z}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.Graph","nf.Shell","nf.ng.Bridge","nf.ClusterSummary","nf.ErrorHandler","nf.AuthorizationStorage","nf.Storage","nf.CanvasUtils","nf.Birdseye","nf.ContextMenu","nf.Actions","nf.ProcessGroup","nf.ParameterContexts","nf.ng.D3Helpers"],function(c,s,j,l,d,r,t,i,f,h,e,o,k,m,q,g,n,p){return(nf.Canvas=b(c,s,j,l,d,r,t,i,f,h,e,o,k,m,q,g,n,p))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Canvas=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.Graph"),require("nf.Shell"),require("nf.ng.Bridge"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.AuthorizationStorage"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.Birdseye"),require("nf.ContextMenu"),require("nf.Actions"),require("nf.ProcessGroup"),require("nf.ParameterContexts"),require("nf.ng.D3Helpers")))}else{nf.Canvas=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.Graph,a.nf.Shell,a.nf.ng.Bridge,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.AuthorizationStorage,a.nf.Storage,a.nf.CanvasUtils,a.nf.Birdseye,a.nf.ContextMenu,a.nf.Actions,a.nf.ProcessGroup,a.nf.ParameterContexts,a.nf.ng.D3Helpers)}}}(this,function(z,J,H,k,o,G,n,F,f,c,r,N,g,v,t,w,Q,j){var D=1;var q=[0,0];var d=1.2;var L=8;var s=0.2;var y=0.6;var S="";var b="";var i=false;var C=false;var O="root";var K;var R=null;var l=null;var m=null;var a=false;var I=false;var p=false;var e=null;var h=null;var P=false;var B={urls:{api:"../nifi-api",accessConfig:"../nifi-api/access/config",accessTokenExpiration:"../nifi-api/access/token/expiration",currentUser:"../nifi-api/flow/current-user",controllerBulletins:"../nifi-api/flow/controller/bulletins",kerberos:"../nifi-api/access/kerberos",revision:"../nifi-api/flow/revision",banners:"../nifi-api/flow/banners"}};var E=function(T){if(i){u.reload({transition:true}).done(function(){setTimeout(function(){E(T)},T*1000)})}};var M=function(V){var U=new Date().getTime();var T=u.getGroupId();return z.ajax({type:"GET",url:B.urls.api+"/flow/process-groups/"+encodeURIComponent(T),dataType:"json",data:{uiOnly:true}}).done(function(W){var Y=W.processGroupFlow;u.setGroupId(Y.id);u.setParameterContext(Y.parameterContext);var Z=Y.breadcrumb;if(Z.permissions.canRead){u.setGroupName(Z.breadcrumb.name)}else{u.setGroupName(Z.id)}l=W.permissions;n.injector.get("breadcrumbsCtrl").resetBreadcrumbs();n.digest();n.injector.get("breadcrumbsCtrl").generateBreadcrumbs(Z);n.injector.get("breadcrumbsCtrl").resetScrollPosition();var X=Z;while(X.parentBreadcrumb!=null){X=X.parentBreadcrumb}if(S==""){S=document.title}if(X.permissions.canRead){document.title=X.breadcrumb.name+b}else{document.title=S+b}z("#stats-last-refreshed").text(Y.lastRefreshed);if(H.isDefinedAndNotNull(Y.parentGroupId)){u.setParentGroupId(Y.parentGroupId)}else{u.setParentGroupId(null)}o.expireCaches(U);o.set(Y.flow,z.extend({selectAll:false,overrideRevisionCheck:F.didConnectedStateChange()},V));o.updateVisibility();g.refresh()}).fail(f.handleAjaxError)};var x=function(T,V){var W=u.getGroupId();var X=u.getParameterContext();N.clearEllipsisCache();u.setGroupId(T);var U=M(V);U.fail(function(aa,Y,Z){u.setGroupId(W);u.setParameterContext(X)});return U};var A=function(){return z.ajax({type:"GET",url:B.urls.currentUser,dataType:"json"}).done(function(T){H.setCurrentUser(T)})};var u={CANVAS_OFFSET:0,SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,hideSplash:function(){z("#splash").fadeOut()},stopPolling:function(){i=false},disableRefreshHotKey:function(){C=true},reload:function(T,U){return z.Deferred(function(X){var W;if(H.isDefinedAndNotNull(U)){W=x(U,T)}else{W=M(T)}var Z=n.injector.get("flowStatusCtrl").reloadFlowStatus();var Y=A();var V=z.ajax({type:"GET",url:B.urls.controllerBulletins,dataType:"json"}).done(function(ab){n.injector.get("flowStatusCtrl").updateBulletins(ab)});var aa=F.loadClusterSummary().done(function(ab){var ac=ab.clusterSummary;if(F.didConnectedStateChange()){if(ac.connectedToCluster){k.showConnectedToClusterMessage(function(){r.resetDisconnectionAcknowledgement()})}else{k.showDisconnectedFromClusterMessage(function(){r.acknowledgeDisconnection()})}}n.injector.get("flowStatusCtrl").updateClusterSummary(ac)});z.when(W,Z,Y,V,aa).done(function(ab){var ac=ab[0];n.digest();X.resolve(ac)}).fail(function(ad,ab,ac){X.reject(ad,ab,ac)})}).promise()},initCanvas:function(){var aa=z("#canvas-container");e=J.select("#canvas-container").append("svg").on("contextmenu",function(ab){P=false;N.getSelection().classed("selected",false);N.setURLParameters();v.show(ab);ab.preventDefault()});var T=e.append("defs");j.multiAttr(T.selectAll("marker").data(["normal","ghost","unauthorized","full"]).enter().append("marker"),{id:function(ab){return ab},viewBox:"0 0 6 6",refX:5,refY:3,markerWidth:6,markerHeight:6,orient:"auto",fill:function(ab){if(ab==="ghost"){return"#aaaaaa"}else{if(ab==="unauthorized"){return"#ba554a"}else{if(ab==="full"){return"#ba554a"}else{return"#000000"}}}}}).append("path").attr("d","M2,3 L0,6 L6,3 L0,0 z");var W=j.multiAttr(T.append("filter"),{id:"component-drop-shadow",height:"140%",y:"-20%"});j.multiAttr(W.append("feGaussianBlur"),{"in":"SourceAlpha",stdDeviation:3,result:"blur"});j.multiAttr(W.append("feOffset"),{"in":"blur",dx:0,dy:1,result:"offsetBlur"});j.multiAttr(W.append("feFlood"),{"flood-color":"#000000","flood-opacity":0.4,result:"offsetColor"});j.multiAttr(W.append("feComposite"),{"in":"offsetColor",in2:"offsetBlur",operator:"in",result:"offsetColorBlur"});var Y=W.append("feMerge");Y.append("feMergeNode").attr("in","offsetColorBlur");Y.append("feMergeNode").attr("in","SourceGraphic");var V=j.multiAttr(T.append("filter"),{id:"connection-full-drop-shadow",height:"140%",y:"-20%"});j.multiAttr(V.append("feGaussianBlur"),{"in":"SourceAlpha",stdDeviation:3,result:"blur"});j.multiAttr(V.append("feOffset"),{"in":"blur",dx:0,dy:1,result:"offsetBlur"});j.multiAttr(V.append("feFlood"),{"flood-color":"#ba554a","flood-opacity":1,result:"offsetColor"});j.multiAttr(V.append("feComposite"),{"in":"offsetColor",in2:"offsetBlur",operator:"in",result:"offsetColorBlur"});var Z=V.append("feMerge");Z.append("feMergeNode").attr("in","offsetColorBlur");Z.append("feMergeNode").attr("in","SourceGraphic");h=j.multiAttr(e.append("g"),{transform:"translate("+q+") scale("+D+")","pointer-events":"all",id:"canvas"});e.on("mousedown.selection",function(ac){P=true;if(ac.button!==0){ac.stopImmediatePropagation();return}if(ac.shiftKey){var ab=J.pointer(ac,h.node());h.append("rect").attr("rx",6).attr("ry",6).attr("x",ab[0]).attr("y",ab[1]).attr("class","component-selection").attr("width",0).attr("height",0).attr("stroke-width",function(){return 1/u.View.getScale()}).attr("stroke-dasharray",function(){return 4/u.View.getScale()}).datum(ab);ac.stopImmediatePropagation();ac.preventDefault()}}).on("mousemove.selection",function(ae){if(ae.shiftKey){var ac=J.select("rect.component-selection");if(!ac.empty()){var ad=ac.datum();var ab=J.pointer(ae,h.node());var af={};if(ad[0]<ab[0]){af.x=ad[0];af.width=ab[0]-ad[0]}else{af.x=ab[0];af.width=ad[0]-ab[0]}if(ad[1]<ab[1]){af.y=ad[1];af.height=ab[1]-ad[1]}else{af.y=ab[1];af.height=ad[1]-ab[1]}ac.attr("width",af.width).attr("height",af.height).attr("x",af.x).attr("y",af.y);ae.stopPropagation()}}}).on("mouseup.selection",function(){if(P===false){return}P=false;var ab=J.select("rect.component-selection");if(!ab.empty()){var ac={x:parseInt(ab.attr("x"),10),y:parseInt(ab.attr("y"),10),width:parseInt(ab.attr("width"),10),height:parseInt(ab.attr("height"),10)};J.selectAll("g.component").classed("selected",function(ad){return J.select(this).classed("selected")||ad.position.x>=ac.x&&(ad.position.x+ad.dimensions.width)<=(ac.x+ac.width)&&ad.position.y>=ac.y&&(ad.position.y+ad.dimensions.height)<=(ac.y+ac.height)});J.selectAll("g.connection").classed("selected",function(af){var ae=[af.start].concat(af.bends,[af.end]);var ad=J.extent(ae,function(ah){return ah.x});var ag=J.extent(ae,function(ah){return ah.y});return J.select(this).classed("selected")||ad[0]>=ac.x&&ad[1]<=(ac.x+ac.width)&&ag[0]>=ac.y&&ag[1]<=(ac.y+ac.height)});ab.remove();N.setURLParameters()}n.digest()});var X=function(){var af=z("#banner-footer");var ab=0;if(af.is(":visible")){ab=af.height()}var ad=parseInt(aa.css("top"),10);var ae=z(window).height();var ac=(ae-(ab+ad));aa.css({height:ac+"px",bottom:ab+"px"});j.multiAttr(e,{height:aa.height(),width:z(window).width()});n.injector.get("breadcrumbsCtrl").updateBreadcrumbsCss({bottom:ab+"px"});z("#canvas-body").css({height:ae+"px",width:z(window).width()+"px"})};z("body").on("GoTo:Component",function(ac,ab){N.showComponent(ab.parentGroupId,ab.id)});z("body").on("GoTo:ProcessGroup",function(ac,ab){w.enterGroup(ab.id).done(function(){N.getSelection().classed("selected",false);n.digest()})});z("body").on("GoTo:ParameterContext",function(ac,ab){Q.showParameterContexts(ab.id)});var U=H.throttle(t.reload,1000);z(window).on("resize",function(aj){if(aj.target===window){if(z(".md-menu-backdrop").is(":visible")===true){z(".md-menu-backdrop").click()}X();var ah=z("#shell-dialog");if(ah.is(":visible")){setTimeout(function(al){G.resizeContent(al);if(al.find("#shell-iframe").is(":visible")){G.resizeIframe(al)}},50,ah)}var ab=z(".dialog");for(var ag=0,ai=ab.length;ag<ai;ag++){if(z(ab[ag]).is(":visible")){setTimeout(function(al){al.modal("resize")},50,z(ab[ag]))}}var ak=z('*[class*="slickgrid_"]');for(var af=0,ai=ak.length;af<ai;af++){if(z(ak[af]).is(":visible")){setTimeout(function(am){var al=am.data("gridInstance");var an=al.getEditorLock();if(!an.isActive()){al.resizeCanvas()}},50,z(ak[af]))}}var ad=z(".tab-container");var ac=[];for(var ae=0,ai=ad.length;ae<ai;ae++){if(z(ad[ae]).is(":visible")){ac.push(z("#"+z(ad[ae]).attr("id")+"-content"))}}z.each(ac,function(al,am){H.toggleScrollable(am.get(0))})}}).on("keydown",function(ab){if(z(".dialog").is(":visible")||z("#search-field").is(":focus")){return}var ad=N.getSelection();var af=ab.ctrlKey||ab.metaKey;if(af){if(ab.keyCode===82){if(C===true){location.reload();return}U()}else{if(ab.keyCode===65){t.selectAll();N.setURLParameters();n.digest();ab.preventDefault()}else{if(ab.keyCode===67){if(u.canWrite()&&N.isCopyable(ad)){t.copy(ad)}}else{if(ab.keyCode===86){if(u.canWrite()&&N.isPastable()){t.paste(ad);ab.preventDefault()}}}}}}else{if(ab.keyCode===8||ab.keyCode===46){if(u.canWrite()&&N.areDeletable(ad)){t["delete"](ad)}}else{if(ab.keyCode===27){var ac=z("#context-menu").is(":visible");if(ac){v.hide();return}var ag=z(".cancellable");var ae=ag.length&&ag.toArray().some(function(ah){return z(ah).is(":visible")});if(!ae&&!ac&&N.getParentGroupId()!==null){t.leaveGroup()}}}}});z.ajax({type:"GET",url:B.urls.banners,dataType:"json"}).done(function(ad){if(H.isDefinedAndNotNull(ad.banners)){if(H.isDefinedAndNotNull(ad.banners.headerText)&&ad.banners.headerText!==""){z("#banner-header").addClass("banner-header-background").text(ad.banners.headerText).show();z("#canvas-container").css("top","98px");b=" - "+ad.banners.headerText}if(H.isDefinedAndNotNull(ad.banners.footerText)&&ad.banners.footerText!==""){var ab=z("#banner-footer").text(ad.banners.footerText).show();var ac=function(ae){var af=z("#"+ae);af.css("bottom",parseInt(ab.css("height"),10)+"px")};ac("graph")}}X()}).fail(f.handleAjaxError)},init:function(){var T=z.Deferred(function(U){var V=function(W){var X=H.getSessionExpiration(W);if(X){c.setToken(X)}U.resolve()};if(c.hasToken()){U.resolve()}else{z.ajax({type:"POST",url:B.urls.kerberos,dataType:"text"}).done(function(W){V(W)}).fail(function(){z.ajax({type:"GET",url:B.urls.accessTokenExpiration,dataType:"json"}).done(function(aa){var X=aa.accessTokenExpiration;var W=Date.parse(X.expiration);var Z=W/1000;var Y=Math.round(Z);c.setToken(Y);U.resolve()}).fail(function(){U.reject()})})}}).promise();return z.Deferred(function(U){T.always(function(){A().done(function(V){if(V.anonymous===false){z("#current-user").text(V.identity).show();if(c.hasToken()){z("#logout-link-container").show()}else{z.ajax({type:"GET",url:B.urls.accessConfig,dataType:"json"}).done(function(X){if(X.config.supportsLogin){z("#logout-link-container").show();var W=H.getDefaultExpiration();c.setToken(W)}}).fail(function(){window.location="../nifi/login"})}}else{H.setAnonymousUserLabel()}U.resolve()}).fail(function(X,V,W){if(X.status===401){c.removeToken();window.location="../nifi/login"}else{U.reject(X,V,W)}})})}).promise()},setParameterContext:function(T){K=T},getParameterContext:function(){return K},setGroupId:function(T){O=T},getGroupId:function(){return O},setGroupName:function(T){R=T},getGroupName:function(){return R},setParentGroupId:function(T){m=T},getParentGroupId:function(){return m},setManagedAuthorizer:function(T){a=T},isManagedAuthorizer:function(){return a},setConfigurableAuthorizer:function(T){I=T},isConfigurableAuthorizer:function(){return I},setConfigurableUsersAndGroups:function(T){p=T},isConfigurableUsersAndGroups:function(){return p},canRead:function(){if(l===null){return false}else{return l.canRead===true}},canWrite:function(){if(l===null){return false}else{return l.canWrite===true}},startPolling:function(T){i=true;E(T)},View:(function(){var V;var T=0,W=0,U=D;return{init:function(){var Z;var Y=false;var aa=function(ab){if(H.isDefinedAndNotNull(ab)){if(H.isDefinedAndNotNull(ab.subject)){return ab.subject.source==="birdseye"}else{return false}}else{return false}};var X=function(ab){if(H.isDefinedAndNotNull(ab)){if(aa(ab)){return false}return ab.type==="wheel"||ab.type==="mousewheel"}else{return true}};V=J.zoom().scaleExtent([s,L]).on("start",function(){v.hide()}).on("zoom",function(ab){if(!isNaN(ab.transform.x)){T=ab.transform.x}if(!isNaN(ab.transform.y)){W=ab.transform.y}if(!isNaN(ab.transform.k)){U=ab.transform.k}Y=true;Z=u.View.refresh({persist:false,transition:X(ab.sourceEvent),refreshComponents:false,refreshBirdseye:false})}).on("end",function(ab){if(!aa(ab.sourceEvent)){if(H.isDefinedAndNotNull(Z)){o.updateVisibility();Z.done(function(){g.refresh()});N.persistUserView();Z=null}if(Y===false){N.getSelection().classed("selected",false);N.setURLParameters();n.digest()}}Y=false});e.call(V).on("dblclick.zoom",null)},shouldRenderPerScale:function(){return u.View.getScale()>=y},translate:function(X){V.translateBy(e,X[0],X[1])},scale:function(X){V.scaleBy(e,X)},transform:function(Y,X){V.transform(e,J.zoomIdentity.translate(Y[0],Y[1]).scale(X))},getTranslate:function(){return[T,W]},getScale:function(){return U},zoomIn:function(){u.View.scale(d)},zoomOut:function(){u.View.scale(1/d)},fit:function(){var Z=u.View.getTranslate();var ab=u.View.getScale();var ae;var ad=z("#canvas-container");var aa=ad.width();var ac=ad.height();var ag=J.select("#canvas").node().getBoundingClientRect();var ah=ag.width/ab;var Y=ag.height/ab;var af=ag.left/ab;var X=(ag.top-u.CANVAS_OFFSET)/ab;if(ah>aa||Y>ac){ae=Math.min(aa/ah,ac/Y);ae=Math.min(Math.max(ae,s),L)}else{ae=1;af-=100;X-=50}N.centerBoundingBox({x:af-(Z[0]/ab),y:X-(Z[1]/ab),width:aa/ae,height:ac/ae,scale:ae})},actualSize:function(){var ac=u.View.getTranslate();var ab=u.View.getScale();var Y=N.getSelection();var Z;if(!Y.empty()){var X=Y.node().getBoundingClientRect();Z={x:(X.left/ab)-(ac[0]/ab),y:((X.top-u.CANVAS_OFFSET)/ab)-(ac[1]/ab),width:X.width/ab,height:X.height/ab,scale:1}}else{var ae=z("#canvas-container");var aa=ae.width()/ab;var ad=ae.height()/ab;Z={x:(aa/2)-(ac[0]/ab),y:(ad/2)-(ac[1]/ab),width:1,height:1,scale:1}}N.centerBoundingBox(Z)},refresh:function(X){return z.Deferred(function(Y){var ab=true;var ad=false;var ac=true;var ae=true;if(H.isDefinedAndNotNull(X)){ab=H.isDefinedAndNotNull(X.persist)?X.persist:ab;ad=H.isDefinedAndNotNull(X.transition)?X.transition:ad;ac=H.isDefinedAndNotNull(X.refreshComponents)?X.refreshComponents:ac;ae=H.isDefinedAndNotNull(X.refreshBirdseye)?X.refreshBirdseye:ae}if(ac){o.updateVisibility()}if(ab===true){N.persistUserView()}var Z=u.View.getTranslate();var aa=u.View.getScale();if(ad===true){h.transition().duration(500).attr("transform",function(){return"translate("+Z+") scale("+aa+")"}).on("end",function(){if(ae===true){g.refresh()}Y.resolve()})}else{h.attr("transform",function(){return"translate("+Z+") scale("+aa+")"});if(ae===true){g.refresh()}Y.resolve()}}).promise()}}}())};return u}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.ErrorHandler","nf.Common","nf.Canvas","nf.ContextMenu"],function(f,e,d,c){return(nf.ErrorHandler=b(f,e,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("nf.ErrorHandler"),require("nf.Common"),require("nf.Canvas"),require("nf.ContextMenu")))}else{nf.ErrorHandler=b(a.nf.ErrorHandler,a.nf.Common,a.nf.Canvas,a.nf.ContextMenu)}}}(this,function(e,d,b,a){var c=function(){if($("#message-pane").is(":visible")){d.updateLogoutLink();if($("#splash").is(":visible")){b.hideSplash()}a.hide();b.stopPolling();b.disableRefreshHotKey()}};return{handleAjaxError:function(h,f,g){e.handleAjaxError(h,f,g);c()},handleConfigurationUpdateAjaxError:function(h,f,g){e.handleConfigurationUpdateAjaxError(h,f,g);c()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.UniversalCapture","nf.CustomUi","nf.Verify","nf.CanvasUtils","nf.Processor"],function(f,m,l,d,e,h,n,i,k,g,c,j){return(nf.ControllerService=b(f,m,l,d,e,h,n,i,g,k,c,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ControllerService=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.UniversalCapture"),require("nf.CustomUi"),require("nf.Verify"),require("nf.CanvasUtils"),require("nf.Processor")))}else{nf.ControllerService=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.UniversalCapture,a.nf.CustomUi,a.nf.Verify,a.nf.CanvasUtils,a.nf.Processor)}}}(this,function(F,Z,d,X,k,v,g,c,C,K,ad,u){var R,G,U,ab,L;var Q={edit:"edit",readOnly:"read-only",serviceOnly:"SERVICE_ONLY",serviceAndReferencingComponents:"SERVICE_AND_REFERENCING_COMPONENTS",urls:{api:"../nifi-api"}};var ag=null;var J=function(){var ah=F("#controller-service-configuration").data("controllerServiceDetails");if(F("#controller-service-name").val()!==ah.component.name){return true}if(F("#controller-service-comments").val()!==ah.component.comments){return true}if(F("#controller-service-bulletin-level-combo").combo("getSelectedOption").value!==(ah.component.bulletinLevel+"")){return true}return F("#controller-service-properties").propertytable("isSaveRequired")};var p=function(){var ai=F("#controller-service-properties").propertytable("marshalProperties");var aj={};aj.id=F("#controller-service-id").text();aj.name=F("#controller-service-name").val();aj.bulletinLevel=F("#controller-service-bulletin-level-combo").combo("getSelectedOption").value;aj.comments=F("#controller-service-comments").val();if(F.isEmptyObject(ai)===false){aj.properties=ai}aj.sensitiveDynamicPropertyNames=F("#controller-service-properties").propertytable("getSensitiveDynamicPropertyNames");var ah={};ah.disconnectedNodeAcknowledged=v.isDisconnectionAcknowledged();ah.component=aj;return ah};var b=function(ah){return true};var ae=function(ak,al){var ai=ak.data("gridInstance");var aj=ai.getData();var ah=aj.getItemById(al);if(X.isUndefined(ah)||ah.permissions.canRead===false){return F.Deferred(function(am){am.reject()}).promise()}return F.ajax({type:"GET",url:ah.uri,dataType:"json",data:{uiOnly:true}}).done(function(am){S(ak,am)}).fail(d.handleAjaxError)};var S=function(al,ah){var ai=al.data("gridInstance");var ak=ai.getData();var aj=ak.getItemById(ah.id);ak.updateItem(ah.id,F.extend({type:"ControllerService",bulletins:aj.bulletins},ah))};var h=function(ai,ah){ae(ai,ah.id).done(function(aj){f(ai,aj.component)})};var f=function(ai,ah){F.each(ah.referencingComponents,function(ak,am){if(am.permissions.canRead===false){return}var aj=am.component;if(aj.referenceType==="Processor"){if(ad.getGroupId()===aj.groupId){u.reload(aj.id)}F("div."+aj.id+"-active-threads").text(aj.activeThreadCount);var al=F("div."+aj.id+"-state");if(al.length){n(al,aj)}}else{if(aj.referenceType==="ReportingTask"){G.reload(aj.id);F("div."+aj.id+"-active-threads").text(aj.activeThreadCount);var al=F("div."+aj.id+"-state");if(al.length){n(al,aj)}}else{if(aj.referenceType==="FlowAnalysisRule"){U.reload(aj.id);var al=F("div."+aj.id+"-state");if(al.length){M(al,aj)}}else{if(aj.referenceType==="ParameterProvider"){ab.reload(aj.id);var al=F("div."+aj.id+"-state");if(al.length){V(al,aj)}}else{if(aj.referenceType==="FlowRegistryClient"){L.reloadRegistry(aj.id);var al=F("div."+aj.id+"-state");if(al.length){V(al,aj)}}else{ae(ai,aj.id);var al=F("div."+aj.id+"-state");if(al.length){M(al,aj)}if(aj.referenceCycle===false){f(ai,aj)}}}}}}});Y.reloadReferencedServices(ai,ah)};var aa=function(ah){var ai=ah.get(0).scrollHeight>Math.round(ah.innerHeight())||ah.get(0).scrollWidth>Math.round(ah.innerWidth());if(ah.is(":visible")&&ai){ah.css("border-width","1px")}else{ah.css("border-width","0px")}};var m=function(ak,ai){var al=ai.data("bulletins");if(X.doBulletinsDiffer(al,ak)){ai.data("bulletins",ak);var ah=X.getFormattedBulletins(ak);if(ak.length>0){var aj=X.formatUnorderedList(ah);if(ai.data("qtip")){ai.qtip("option","content.text",aj)}else{ai.addClass("has-bulletins").show().qtip(F.extend({},ad.config.systemTooltipConfig,{content:aj}))}}else{if(ai.data("qtip")){ai.removeClass("has-bulletins").removeData("bulletins").hide().qtip("api").destroy(true)}}}};var n=function(ah,ai){ah.removeClass("disabled stopped running invalid").addClass(function(){var aj=F(this);var al=ai.state.toLowerCase();if(al==="stopped"&&!X.isEmpty(ai.validationErrors)){al="invalid";var ak=X.formatUnorderedList(ai.validationErrors);if(aj.data("qtip")){aj.qtip("option","content.text",ak)}else{aj.qtip(F.extend({},ad.config.systemTooltipConfig,{content:ak}))}}else{if(aj.data("qtip")){aj.qtip("api").destroy(true)}}return al})};var M=function(ai,ah){ai.removeClass("disabled enabled invalid").addClass(function(){var aj=F(this);var al=ah.state==="ENABLED"?"enabled":"disabled";if(al==="disabled"&&!X.isEmpty(ah.validationErrors)){al="invalid";var ak=X.formatUnorderedList(ah.validationErrors);if(aj.data("qtip")){aj.qtip("option","content.text",ak)}else{aj.qtip(F.extend({},ad.config.systemTooltipConfig,{content:ak}))}}else{if(aj.data("qtip")){aj.qtip("api").destroy(true)}}return al})};var V=function(ah,aj){var ai=ah.data("validation-errors");if(!_.isEqual(ai,aj.validationErrors)){ah.data("validation-errors",aj.validationErrors);if(!X.isEmpty(aj.validationErrors)){var ak=X.formatUnorderedList(aj.validationErrors);if(ah.data("qtip")){ah.qtip("option","content.text",ak)}else{ah.show().qtip(F.extend({},ad.config.systemTooltipConfig,{content:ak}))}}else{if(ah.data("qtip")){ah.removeData("validation-errors").qtip("api").destroy(true)}ah.hide()}}};var o=function(ai){var ah=new Map(ai.map(function(aj){return[aj.sourceId,aj]}));ah.forEach(function(aj,ak){F("div."+ak+"-bulletins").each(function(){m(aj,F(this))})})};var P=function(at,au,aj){if(aj.permissions.canRead===false){au.append('<div class="unset">Unauthorized</div>');return}var am=aj.component.referencingComponents;if(X.isEmpty(am)){au.append('<div class="unset">No referencing components.</div>');return}var al=function(aw,av){if(aw.hasClass("expanded")){aw.removeClass("expanded").addClass("collapsed");av.hide()}else{aw.removeClass("collapsed").addClass("expanded");av.show()}};var an=F('<ul class="referencing-component-listing clear"></ul>');var aq=F('<ul class="referencing-component-listing clear"></ul>');var ai=F('<ul class="referencing-component-listing clear"></ul>');var ar=F('<ul class="referencing-component-listing clear"></ul>');var ah=F('<ul class="referencing-component-listing clear"></ul>');var ak=F('<ul class="referencing-component-listing clear"></ul>');var ao=F('<ul class="referencing-component-listing clear"></ul>');F.each(am,function(a5,aK){if(aK.permissions.canRead===false){var aw=F('<div class="unset"></div>').text(aK.id);ao.append(aw)}else{var aA=aK.component;if(aA.referenceType==="Processor"){var aL=F('<span class="referencing-component-name link"></span>').text(aA.name).on("click",function(){ad.showComponent(aA.groupId,aA.id);au.closest(".dialog").modal("hide");F("#shell-close-button").click()});var aQ=F('<div class="referencing-component-state"></div>').addClass(aA.id+"-state");n(aQ,aA);var aR=F('<div class="referencing-component-bulletins"></div>').addClass(aA.id+"-bulletins");if(!X.isEmpty(aK.bulletins)){m(aK.bulletins,aR)}var aF=F('<span class="referencing-component-type"></span>').text(aA.type);var aC=F('<span class="referencing-component-active-thread-count"></span>').addClass(aA.id+"-active-threads");if(X.isDefinedAndNotNull(aA.activeThreadCount)&&aA.activeThreadCount>0){aC.text("("+aA.activeThreadCount+")")}var a2=F("<li></li>").append(aQ).append(aR).append(aL).append(aF).append(aC);an.append(a2)}else{if(aA.referenceType==="ControllerService"){var a1=F('<span class="referencing-component-name link"></span>').text(aA.name).on("click",function(){var a6=at.data("gridInstance");var a7=a6.getData();var a8=a7.getRowById(aA.id);a6.setSelectedRows([a8]);a6.scrollRowIntoView(a8);au.closest(".dialog").modal("hide")});var aN=F('<div class="referencing-component-references hidden"></div>');var aT=F('<div class="service expansion-button collapsed pointer"></div>').on("click",function(){if(aT.hasClass("collapsed")){if(aA.referenceCycle===true){aN.append('<div class="unset">Reference cycle detected.</div>')}else{var a6=at.data("gridInstance");var a7=a6.getData();q(aA.id,a7).done(function(a8){P(at,aN,a8)})}}else{aN.empty()}al(aT,aN);aa(au)});var aM=F('<div class="referencing-component-state"></div>').addClass(aA.id+"-state");M(aM,aA);var a4=F('<div class="referencing-component-bulletins"></div>').addClass(aA.id+"-bulletins");if(!X.isEmpty(aK.bulletins)){m(aK.bulletins,a4)}var aU=F('<span class="referencing-component-type"></span>').text(aA.type);var aD=F("<li></li>").append(aT).append(aM).append(a4).append(a1).append(aU).append(aN);aq.append(aD)}else{if(aA.referenceType==="ReportingTask"){var aI=F('<span class="referencing-component-name link"></span>').text(aA.name).on("click",function(){var a8=F("#reporting-tasks-table").data("gridInstance");var a6=a8.getData();var a7=a6.getRowById(aA.id);a8.setSelectedRows([a7]);a8.scrollRowIntoView(a7);F("#settings-tabs").find("li:nth-child(3)").click();au.closest(".dialog").modal("hide")});var aE=F('<div class="referencing-component-state"></div>').addClass(aA.id+"-state");n(aE,aA);var a3=F('<div class="referencing-component-bulletins"></div>').addClass(aA.id+"-bulletins");if(!X.isEmpty(aK.bulletins)){m(aK.bulletins,a3)}var az=F('<span class="referencing-component-type"></span>').text(X.substringAfterLast(aA.type,"."));var aW=F('<span class="referencing-component-active-thread-count"></span>').addClass(aA.id+"-active-threads");if(X.isDefinedAndNotNull(aA.activeThreadCount)&&aA.activeThreadCount>0){aW.text("("+aA.activeThreadCount+")")}var aY=F("<li></li>").append(aE).append(a3).append(aI).append(az).append(aW);ai.append(aY)}else{if(aA.referenceType==="FlowAnalysisRule"){var aV=F('<span class="referencing-component-name link"></span>').text(aA.name).on("click",function(){var a6=F("#flow-analysis-rules-table").data("gridInstance");var a7=a6.getData();var a8=a7.getRowById(aA.id);a6.setSelectedRows([a8]);a6.scrollRowIntoView(a8);F("#settings-tabs").find("li:nth-child(4)").click();au.closest(".dialog").modal("hide")});var aB=F('<div class="referencing-component-state"></div>').addClass(aA.id+"-state");M(aB,aA);var aP=F('<span class="referencing-component-type"></span>').text(X.substringAfterLast(aA.type,"."));var av=F("<li></li>").append(aB).append(aV).append(aP);ar.append(av)}else{if(aA.referenceType==="ParameterProvider"){var aH=F('<span class="referencing-component-name link"></span>').text(aA.name).on("click",function(){var a6=F("#parameter-providers-table").data("gridInstance");var a7=a6.getData();var a8=a7.getRowById(aA.id);a6.setSelectedRows([a8]);a6.scrollRowIntoView(a8);au.closest(".dialog").modal("hide");F("#settings-tabs").find("li:nth-child(6)").click();a6.resizeCanvas()});var aJ=F('<div class="referencing-component-state invalid"></div>').addClass(aA.id+"-state");if(X.isEmpty(aA.validationErrors)){aJ.hide()}else{V(aJ,aA)}var ax=F('<div class="referencing-component-bulletins"></div>').addClass(aA.id+"-bulletins");if(!X.isEmpty(aK.bulletins)){m(aK.bulletins,ax)}var a0=F('<span class="referencing-component-type"></span>').text(aA.type);var aG=F("<li></li>").append(aJ).append(ax).append(aH).append(a0);ak.append(aG)}else{if(aA.referenceType==="FlowRegistryClient"){var aZ=F('<span class="referencing-component-name link"></span>').text(aA.name).on("click",function(){var a6=F("#registries-table").data("gridInstance");var a7=a6.getData();var a8=a7.getRowById(aA.id);a6.setSelectedRows([a8]);a6.scrollRowIntoView(a8);F("#settings-tabs").find("li:nth-child(5)").click();au.closest(".dialog").modal("hide")});var aX=F('<div class="referencing-component-state invalid"></div>').addClass(aA.id+"-state");if(X.isEmpty(aA.validationErrors)){aX.hide()}else{V(aX,aA)}var aS=F('<span class="referencing-component-type"></span>').text(X.substringAfterLast(aA.type,"."));var aO=F('<span class="referencing-component-active-thread-count"></span>').addClass(aA.id+"-active-threads");if(X.isDefinedAndNotNull(aA.activeThreadCount)&&aA.activeThreadCount>0){aO.text("("+aA.activeThreadCount+")")}var ay=F("<li></li>").append(aX).append(aZ).append(aS).append(aO);ah.append(ay)}}}}}}}});var ap=function(av,ax){if(ax.is(":empty")){ax.remove();return}var az=F('<div class="expansion-button expanded"></div>');var ay=F('<span class="referencing-component-title"></span>').text(av);var aw=F('<span class="referencing-component-count"></span>').text("("+ax.children().length+")");F('<div class="referencing-component-block pointer unselectable"></div>').on("click",function(){al(az,ax);aa(au)}).append(az).append(ay).append(aw).appendTo(au);ax.appendTo(au)};ap("Processors",an);ap("Reporting Tasks",ai);ap("Flow Analysis Rules",ar);ap("Registry Clients",ah);ap("Controller Services",aq);ap("Parameter Providers",ak);ap("Unauthorized",ao);F("div.referencing-component-bulletins.has-bulletins").show()};var e=function(am,ai,ak,al){var ah={revision:g.getRevision(ai),disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged(),state:ak?"ENABLED":"DISABLED",uiOnly:true};var aj=F.ajax({type:"PUT",url:ai.uri+"/run-status",data:JSON.stringify(ah),dataType:"json",contentType:"application/json"}).done(function(an){S(am,an)}).fail(d.handleAjaxError);return F.Deferred(function(an){aj.done(function(){if(ai.permissions.canRead===false){an.resolve();return}var ao=w(ai,function(ar,aq){if(F.isArray(aq)){if(ak){m(aq,F("#enable-controller-service-bulletins"))}else{m(aq,F("#disable-controller-service-bulletins"))}}var ap=ar.status.runStatus;if(ak){return ap==="ENABLING"||ap==="ENABLED"}else{return ap==="DISABLED"}},function(ap){return ad.queryBulletins([ai.id])},al);ao.done(function(){an.resolve()}).fail(function(){an.reject()})}).fail(function(){an.reject()})}).promise()};var s=function(ah){var ai=new Set();ai.add(ah.id);var aj=function(ak){F.each(ak,function(al,an){var am=an.component;if(am.referenceType==="ControllerService"){ai.add(am.id);if(am.referenceCycle===false){aj(am.referencingComponents)}}})};aj(ah.referencingComponents);return ai};var a=function(ai,ah,aj){F.each(ai,function(ak,am){var al=am.component;if(aj){if(al.referenceType==="ControllerService"){ah[am.id]=g.getRevision(am)}}else{if(al.referenceType==="Processor"||al.referenceType==="ReportingTask"||al.referenceType==="FlowAnalysisRule"){ah[am.id]=g.getRevision(am)}}a(al.referencingComponents,ah,aj)})};var H=function(am,ah,aj,al){var an={};a(ah.component.referencingComponents,an,false);var ak={id:ah.id,state:aj?"RUNNING":"STOPPED",referencingComponentRevisions:an,disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged(),uiOnly:true};var ai=F.ajax({type:"PUT",url:ah.uri+"/references",data:JSON.stringify(ak),dataType:"json",contentType:"application/json"}).fail(d.handleAjaxError);return F.Deferred(function(ao){ai.done(function(ap){ah.component.referencingComponents=ap.controllerServiceReferencingComponents;if(aj){ao.resolve()}else{var aq=s(ah.component);var ar=am.data("gridInstance");var au=ar.getData();var at=[];aq.forEach(function(av){q(av,au).done(function(aw){at.push(y(aw,al))})});F.when.apply(window,at).done(function(){ao.resolve()}).fail(function(){ao.reject()})}}).fail(function(){ao.reject()})}).promise()};var q=function(ai,aj){var ah=aj.getItemById(ai);if(X.isDefinedAndNotNull(ah)){return F.Deferred(function(ak){ak.resolve(ah)})}else{return F.ajax({type:"GET",url:"../nifi-api/controller-services/"+encodeURIComponent(ai),dataType:"json",data:{uiOnly:true}}).fail(d.handleAjaxError)}};var w=function(ah,ak,aj,al){var ai=ah.component;return F.Deferred(function(am){var ap=2;var ao=function(){var ar=ap;ap=Math.min(ap*2,4);return ar*1000};var aq=function(){var at=aj(ai);var ar=F.ajax({type:"GET",url:ah.uri,dataType:"json",data:{uiOnly:true}});F.when(at,ar).done(function(au,av){var aw=av[0];an(aw,au.bulletinBoard.bulletins)}).fail(function(aw,au,av){am.reject();d.handleAjaxError(aw,au,av)})};var an=function(at,ar){if(ak(at,ar)){am.resolve()}else{if(typeof al==="function"&&al()){setTimeout(aq,ao())}else{am.reject()}}};aj(ai).done(function(ar){an(ah,ar.bulletinBoard.bulletins)}).fail(function(au,ar,at){am.reject();d.handleAjaxError(au,ar,at)})}).promise()};var y=function(ah,ai){return w(ah,function(am,al){var aj=am.component.referencingComponents;var ak=false;F.each(aj,function(an,aq){var ap=aq.component;if(ap.referenceType==="Processor"||ap.referenceType==="ReportingTask"){if(ap.state==="RUNNING"||ap.activeThreadCount>0){ak=true}F("div."+ap.id+"-active-threads").text(ap.activeThreadCount);var ao=F("div."+ap.id+"-state");n(ao,ap)}});o(al);return ak===false},function(aj){var al=[];var ak=aj.referencingComponents;F.each(ak,function(am,ao){var an=ao.component;if(an.referenceType==="Processor"||an.referenceType==="ReportingTask"||an.referenceType==="ParameterProvider"||an.referenceType==="FlowRegistryClient"){al.push(an.id)}});return ad.queryBulletins(al)},ai)};var af=function(ah,ai){return w(ah,function(am,al){var aj=am.component.referencingComponents;var ak=false;F.each(aj,function(an,aq){var ao=aq.component;if(ao.referenceType==="ControllerService"){if(ao.state!=="ENABLING"&&ao.state!=="ENABLED"){ak=true}var ap=F("div."+ao.id+"-state");M(ap,ao)}});o(al);return ak===false},function(aj){var al=[];var ak=aj.referencingComponents;F.each(ak,function(am,ao){var an=ao.component;if(an.referenceType==="ControllerService"){al.push(an.id)}});return ad.queryBulletins(al)},ai)};var O=function(ah,ai){return w(ah,function(al,ak){var aj=al.component.referencingComponents;var am=false;F.each(aj,function(an,aq){var ao=aq.component;if(ao.referenceType==="ControllerService"){if(ao.state!=="DISABLED"){am=true}var ap=F("div."+ao.id+"-state");M(ap,ao)}});o(ak);return am===false},function(aj){var al=[];var ak=aj.referencingComponents;F.each(ak,function(am,ao){var an=ao.component;if(an.referenceType==="ControllerService"){al.push(an.id)}});return ad.queryBulletins(al)},ai)};var t=function(am,ah,aj,al){var an={};a(ah.component.referencingComponents,an,true);var ak={id:ah.id,state:aj?"ENABLED":"DISABLED",referencingComponentRevisions:an,disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged(),uiOnly:true};var ai=F.ajax({type:"PUT",url:ah.uri+"/references",data:JSON.stringify(ak),dataType:"json",contentType:"application/json"}).fail(d.handleAjaxError);return F.Deferred(function(ao){ai.done(function(ap){ah.component.referencingComponents=ap.controllerServiceReferencingComponents;var aq=s(ah.component);var ar=am.data("gridInstance");var au=ar.getData();var at=[];aq.forEach(function(av){q(av,au).done(function(aw){if(aj){at.push(af(aw,al))}else{at.push(O(aw,al))}})});F.when.apply(window,at).done(function(){ao.resolve()}).fail(function(){ao.reject()})}).fail(function(){ao.reject()})}).promise()};var B=function(ak,ai){F("#disable-controller-service-id").text(ai.id);F("#disable-controller-service-name").text(X.getComponentName(ai));var ah=F("#disable-controller-service-referencing-components");P(ak,ah,ai);var aj=[{buttonText:"Disable",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){I(ak)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:W}}];F("#disable-controller-service-dialog").modal("setButtonModel",aj).modal("show");ad.queryBulletins([ai.id]).done(function(al){m(al.bulletinBoard.bulletins,F("#disable-controller-service-bulletins"))});aa(ah)};var E=function(ak,ai){F("#enable-controller-service-id").text(ai.id);F("#enable-controller-service-name").text(X.getComponentName(ai));var ah=F("#enable-controller-service-referencing-components");P(ak,ah,ai);var aj=[{buttonText:"Enable",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){i(ak)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:W}}];F("#enable-controller-service-dialog").modal("setButtonModel",aj).modal("show");ad.queryBulletins([ai.id]).done(function(al){m(al.bulletinBoard.bulletins,F("#enable-controller-service-bulletins"))});aa(ah)};var W=function(){F(this).modal("hide")};var I=function(aq){var ak=F("#disable-controller-service-dialog");var aj=false;ak.modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aj=true;ak.modal("setButtonModel",[]);F("#disable-controller-service-dialog div.controller-service-canceling").show()}}}]);F("#disable-controller-service-scope-container").hide();F("#disable-controller-service-progress-container").show();var ap=F("#disable-controller-service-id").text();var ah=aq.data("gridInstance");var al=ah.getData();var ai=al.getItemById(ap);var am=ai.component;var ar=function(){return aj===false};var ao=function(){F("#disable-controller-service-dialog div.controller-service-canceling").hide();ak.modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:W}}])};if(D(ai)){ao();k.showOkDialog({headerText:"Controller Service",dialogContent:ai.permissions.canRead===false?"Unable to disable due to a lack of read permission to see referencing components.":"Unable to disable due to unauthorized referencing components."});return}F("#disable-progress-label").text("Steps to disable "+X.getComponentName(ai));var an=F("#disable-referencing-schedulable").addClass("ajax-loading");F.Deferred(function(at){var au=H(aq,ai,false,ar);au.done(function(){an.removeClass("ajax-loading").addClass("ajax-complete");var av=F("#disable-referencing-services").addClass("ajax-loading");var aw=t(aq,ai,false,ar);aw.done(function(){av.removeClass("ajax-loading").addClass("ajax-complete");var ax=F("#disable-controller-service").addClass("ajax-loading");e(aq,ai,false,ar).done(function(){at.resolve();ax.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){at.reject();ax.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){at.reject();av.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){at.reject();an.removeClass("ajax-loading").addClass("ajax-error")})}).always(function(){if(ai.permissions.canRead===true){h(aq,am)}ao();if(aj===true&&F("#nf-ok-dialog").not(":visible")){k.showOkDialog({headerText:"Controller Service",dialogContent:"The request to disable has been canceled. Parts of this request may have already completed. Please verify the state of this service and all referencing components."})}})};var D=function(ah){if(ah.permissions.canRead===false||(ah.permissions.canWrite===false&&ah.operatePermissions.canWrite===false)){return true}var aj=false;var ai=ah.component.referencingComponents;F.each(ai,function(ak,al){if(D(al)){aj=true;return false}});return aj};var i=function(aq){var ah=F("#enable-controller-service-dialog");var ak=false;var ap=F("#enable-controller-service-id").text();var ai=aq.data("gridInstance");var al=ai.getData();var aj=al.getItemById(ap);var am=aj.component;var at=F("#enable-controller-service-scope").combo("getSelectedOption").value;if(at===Q.serviceOnly){F("#enable-controller-service-progress li.referencing-component").hide()}ah.modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ak=true;ah.modal("setButtonModel",[]);F("#enable-controller-service-dialog div.controller-service-canceling").show()}}}]);F("#enable-controller-service-scope-container").hide();F("#enable-controller-service-progress-container").show();var ar=function(){return ak===false};var ao=function(){F("#enable-controller-service-dialog div.controller-service-canceling").hide();ah.modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:W}}])};if(at===Q.serviceAndReferencingComponents&&D(aj)){ao();k.showOkDialog({headerText:"Controller Service",dialogContent:aj.permissions.canRead===false?"Unable to enable due to a lack of read permission to see referencing components.":"Unable to enable due to unauthorized referencing components."});return}F("#enable-progress-label").text("Steps to enable "+X.getComponentName(aj));var an=F("#enable-controller-service").addClass("ajax-loading");F.Deferred(function(au){var av=e(aq,aj,true,ar);if(at===Q.serviceAndReferencingComponents){av.done(function(){an.removeClass("ajax-loading").addClass("ajax-complete");var aw=F("#enable-referencing-services").addClass("ajax-loading");var ax=t(aq,aj,true,ar);ax.done(function(){aw.removeClass("ajax-loading").addClass("ajax-complete");var ay=F("#enable-referencing-schedulable").addClass("ajax-loading");H(aq,aj,true,ar).done(function(){au.resolve();ay.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){au.reject();ay.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){au.reject();aw.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){au.reject();an.removeClass("ajax-loading").addClass("ajax-error")})}else{av.done(function(){au.resolve();an.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){au.reject();an.removeClass("ajax-loading").addClass("ajax-error")})}}).always(function(){if(aj.permissions.canRead===true){h(aq,am)}ao();if(ak===true&&F("#nf-ok-dialog").not(":visible")){k.showOkDialog({headerText:"Controller Service",dialogContent:"The request to enable has been canceled. Parts of this request may have already completed. Please verify the state of this service and all referencing components."})}})};var N=function(aj,ai){var ah=F("#controller-service-configuration").data("controllerServiceDetails");return F.ajax({type:"GET",url:ah.uri+"/descriptors",data:{propertyName:aj,sensitive:ai},dataType:"json"}).fail(d.handleAjaxError)};var A=function(ah,ai){return F.Deferred(function(ak){if(X.isDefinedAndNotNull(ai)){var al;if(ai===ad.getGroupId()){al=ad.getParameterContext()}else{var aj=ad.getComponentByType("ProcessGroup").get(ai);al=aj.parameterContext}if(X.isDefinedAndNotNull(al)){F.ajax({type:"GET",url:"../nifi-api/parameter-contexts/"+encodeURIComponent(al.id),data:{includeInheritedParameters:"true"},dataType:"json"}).done(function(am){ak.resolve(am.component.parameters.map(function(an){return an.parameter}).filter(function(an){return an.sensitive===ah}))}).fail(function(){ak.resolve([])})}else{ak.resolve([])}}else{ak.resolve([])}}).promise()};var T=function(ah){return F.Deferred(function(ai){F("#controller-service-properties").propertytable("saveRow");if(J()){k.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){ai.resolve()},yesHandler:function(){var aj=F("#controller-service-configuration").data("controllerServiceDetails");z(ah,aj).done(function(){ai.resolve()}).fail(function(){ai.reject()})}})}else{ai.resolve()}}).promise()};var j=function(ai){if(_.isNil(ai)){return null}var aj;if(ai===ad.getGroupId()){aj=ad.getParameterContext()}else{var ah=ad.getComponentByType("ProcessGroup").get(ai);aj=ah.parameterContext}return aj};var z=function(aj,ah){var ak=p();if(b(ak)){ak.revision=g.getRevision(ah);var ai=[];F.each(r(ah.component),function(am,ao){var al=!X.isUndefined(ak.component.properties)&&!X.isUndefined(ak.component.properties[ao.name]);var an=X.isDefinedAndNotNull(ah.component.properties[ao.name]);if(al&&an){ai.push(ah.component.properties[ao.name])}});return F.ajax({type:"PUT",data:JSON.stringify(ak),url:ah.uri,dataType:"json",contentType:"application/json"}).done(function(al){S(aj,al);F.each(ai,function(am,an){ae(aj,an)})}).fail(d.handleConfigurationUpdateAjaxError)}else{return F.Deferred(function(al){al.reject()}).promise()}};var r=function(ai){var ah=[];F.each(ai.descriptors,function(aj,ak){if(X.isDefinedAndNotNull(ak.identifiesControllerService)){ah.push(ak)}});return ah};var x=function(ai){var ah=[];F.each(r(ai),function(aj,ak){var al=ai.properties[ak.name];if(X.isDefinedAndNotNull(al)&&F.trim(al).length>0){ah.push(al)}});return ah};var l=function(aj,ak){ag=ak;var ah=F("#controller-service-properties-verification-results");if(ah.is(":visible")===false){F("#controller-service-properties").css("bottom","40%").propertytable("resetTableSize");ah.show()}var ai=F("#controller-service-properties-verification-results-listing");if(ai.get(0).scrollHeight>Math.round(ai.innerHeight())){ai.css("border-width","1px")}};var ac;var Y={init:function(al,ak,aj,ai,ah){R=al;G=ak;U=aj;ab=ai;L=ah;F("#controller-service-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"controller-service-standard-settings-tab-content"},{name:"Properties",tabContentId:"controller-service-properties-tab-content"},{name:"Comments",tabContentId:"controller-service-comments-tab-content"}],select:function(){c.removeAllPropertyDetailDialogs();if(F(this).text()==="Properties"){F("#controller-service-properties").propertytable("resetTableSize")}F("#controller-service-properties").propertytable("saveRow");var am=F("#controller-service-referencing-components");aa(am)}});F("#controller-service-configuration").modal({headerText:"Configure Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var am=F("#controller-service-referencing-components");X.cleanUpTooltips(am,"div.referencing-component-state");X.cleanUpTooltips(am,"div.referencing-component-bulletins");am.css("border-width","0").empty();F("#controller-service-properties").propertytable("cancelEdit");F("#controller-service-properties").propertytable("clear");X.clearField("read-only-controller-service-comments");F("#controller-service-compatible-apis").empty();F("#controller-service-configuration").removeData("controllerServiceDetails");F("#controller-service-properties-verification-results").hide();F("#controller-service-properties-verification-results-listing").css("border-width","0").empty();F("#controller-service-properties").css("bottom","0");ag=null},open:function(){X.toggleScrollable(F("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});F("#disable-controller-service-dialog").modal({headerText:"Disable Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var an=F(this);F("#disable-controller-service-scope-container").show();F("#disable-controller-service-progress-container").hide();F("#disable-controller-service-id").text("");F("#disable-controller-service-name").text("");F("#disable-controller-service-bulletins").removeClass("has-bulletins").removeData("bulletins").hide();X.cleanUpTooltips(F("#disable-controller-service-service-container"),"#disable-controller-service-bulletins");F("div.disable-referencing-components").removeClass("ajax-loading ajax-complete ajax-error");var am=F("#disable-controller-service-referencing-components");X.cleanUpTooltips(am,"div.referencing-component-state");X.cleanUpTooltips(am,"div.referencing-component-bulletins");am.css("border-width","0").empty()}}});F("#controller-service-bulletin-level-combo").combo({options:[{text:"DEBUG",value:"DEBUG"},{text:"INFO",value:"INFO"},{text:"WARN",value:"WARN"},{text:"ERROR",value:"ERROR"},{text:"NONE",value:"NONE"}]});F("#enable-controller-service-scope").combo({options:[{text:"Service only",value:Q.serviceOnly,description:"Enable only this controller service"},{text:"Service and referencing components",value:Q.serviceAndReferencingComponents,description:"Enable this controller service and enable/start all referencing components"}]});F("#enable-controller-service-dialog").modal({headerText:"Enable Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var an=F(this);F("#enable-controller-service-scope-container").show();F("#enable-controller-service-progress-container").hide();F("#enable-controller-service-progress li.referencing-component").show();F("#enable-controller-service-id").text("");F("#enable-controller-service-name").text("");F("#enable-controller-service-bulletins").removeClass("has-bulletins").removeData("bulletins").hide();X.cleanUpTooltips(F("#enable-controller-service-service-container"),"#enable-controller-service-bulletins");F("div.enable-referencing-components").removeClass("ajax-loading ajax-complete ajax-error");var am=F("#enable-controller-service-referencing-components");X.cleanUpTooltips(am,"div.referencing-component-state");X.cleanUpTooltips(am,"div.referencing-component-bulletins");am.css("border-width","0").empty()}}})},showConfiguration:function(al,ai){if(X.isUndefined(ac)){ac=al}var aj=F("#controller-service-configuration");aj.find(".dialog-header .dialog-header-text").text("Configure Controller Service");if(aj.data("mode")!==Q.edit||ac!==al){F("#controller-service-configuration .controller-service-read-only").hide();F("#controller-service-configuration .controller-service-editable").show();var ak=null;if(X.isDefinedAndNotNull(ai.parentGroupId)){ak=A}F("#controller-service-properties").propertytable("destroy").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-controller-service-property-container",descriptorDeferred:N,parameterDeferred:ak,controllerServiceCreatedDeferred:function(ao){var an;var ap=ao.component;if(X.isDefinedAndNotNull(ap.parentGroupId)){an=Q.urls.api+"/flow/process-groups/"+encodeURIComponent(ap.parentGroupId)+"/controller-services"}else{an=Q.urls.api+"/flow/controller/controller-services"}return R.loadControllerServices(an,al)},goToServiceDeferred:function(){return T(al)},getParameterContext:function(an){return j(an)}});aj.data("mode",Q.edit)}ac=al;var am=F.ajax({type:"GET",url:ai.uri,dataType:"json",data:{uiOnly:true}});var ah=F.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(ai.id),dataType:"json"});F.when(am,ah).done(function(at,ar){ai=at[0];var ao=ai.component;var au=ar[0].componentHistory;aj.data("controllerServiceDetails",ai);X.populateField("controller-service-id",ao.id);X.populateField("controller-service-type",X.formatType(ao));F("#controller-service-configuration").modal("setSubtitle",X.formatType(ao));X.populateField("controller-service-bundle",X.formatBundle(ao.bundle));F("#controller-service-name").val(ao.name);F("#controller-service-comments").val(ao.comments);F("#controller-service-bulletin-level-combo").combo("setSelectedOption",{value:ao.bulletinLevel});if(!X.isEmpty(ao.controllerServiceApis)){var an=X.getFormattedServiceApis(ao.controllerServiceApis);var aq=X.formatUnorderedList(an);F("#controller-service-compatible-apis").append(aq)}else{F("#controller-service-compatible-apis").append('<span class="unset">None</span>')}var ap=F("#controller-service-referencing-components");P(al,ap,ai);var av=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){F("#controller-service-properties").propertytable("saveRow");z(al,ai).done(function(aw){f(al,aw.component);aj.modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aj.modal("hide")}}}];if(X.isDefinedAndNotNull(ao.customUiUrl)&&ao.customUiUrl!==""){av.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var aw=function(){aj.modal("hide");F("#shell-close-button").click();C.showCustomUi(ai,ao.customUiUrl,true).done(function(){h(al,ao);L.showSettings()})};F("#controller-service-properties").propertytable("saveRow");if(J()){k.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:aw,yesHandler:function(){z(al,ai).done(function(){aw()})}})}else{aw()}}}})}aj.modal("setButtonModel",av);F("#controller-service-properties").propertytable("setGroupId",ao.parentGroupId).propertytable("setSupportsSensitiveDynamicProperties",ao.supportsSensitiveDynamicProperties).propertytable("loadProperties",ao.properties,ao.descriptors,au.propertyHistory).propertytable("setPropertyVerificationCallback",function(aw){K.verify(ao.id,ai.uri,aw,ag,l,F("#controller-service-properties-verification-results-listing"))});aj.modal("show");aa(ap);F("#controller-service-properties").propertytable("resetTableSize")}).fail(d.handleAjaxError)},showDetails:function(ak,ai){var aj=F("#controller-service-configuration");aj.find(".dialog-header .dialog-header-text").text("Controller Service Details");if(aj.data("mode")!==Q.readOnly){F("#controller-service-configuration .controller-service-read-only").show();F("#controller-service-configuration .controller-service-editable").hide();F("#controller-service-properties").propertytable("destroy").propertytable({supportsGoTo:true,readOnly:true,getParameterContext:function(am){return j(am)}});aj.data("mode",Q.readOnly)}var al=F.ajax({type:"GET",url:ai.uri,dataType:"json",data:{uiOnly:true}});var ah=F.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(ai.id),dataType:"json"});F.when(al,ah).done(function(ar,aq){ai=ar[0];var an=ai.component;var at=aq[0].componentHistory;aj.data("controllerServiceDetails",ai);X.populateField("controller-service-id",an.id);X.populateField("controller-service-type",X.formatType(an));X.populateField("controller-service-bundle",X.formatBundle(an.bundle));X.populateField("read-only-controller-service-bulletin-level",an.bulletinLevel);X.populateField("read-only-controller-service-name",an.name);X.populateField("read-only-controller-service-comments",an.comments);F("#controller-service-configuration").modal("setSubtitle",X.formatType(an));if(!X.isEmpty(an.controllerServiceApis)){var am=X.getFormattedServiceApis(an.controllerServiceApis);var ap=X.formatUnorderedList(am);F("#controller-service-compatible-apis").append(ap)}else{F("#controller-service-compatible-apis").append('<span class="unset">None</span>')}var ao=F("#controller-service-referencing-components");P(ak,ao,ai);var au=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){aj.modal("hide")}}}];if(X.isDefinedAndNotNull(C)&&X.isDefinedAndNotNull(an.customUiUrl)&&an.customUiUrl!==""){au.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aj.modal("hide");F("#shell-close-button").click();C.showCustomUi(ai,an.customUiUrl,false).done(function(){L.showSettings()})}}})}aj.modal("setButtonModel",au);F("#controller-service-properties").propertytable("setGroupId",an.parentGroupId).propertytable("setSupportsSensitiveDynamicProperties",an.supportsSensitiveDynamicProperties).propertytable("loadProperties",an.properties,an.descriptors,at.propertyHistory);aj.modal("show");aa(ao);F("#controller-service-properties").propertytable("resetTableSize")})},enable:function(ai,ah){E(ai,ah)},disable:function(ai,ah){B(ai,ah)},reloadReferencedServices:function(ai,ah){F.each(x(ah),function(aj,ak){ae(ai,ak)})},promptToDeleteController:function(ai,ah){k.showYesNoDialog({headerText:"Delete Controller Service",dialogContent:"Delete controller service '"+X.escapeHtml(ah.component.name)+"'?",yesHandler:function(){Y.remove(ai,ah)}})},remove:function(aj,ah){var ai=g.getRevision(ah);F.ajax({type:"DELETE",url:ah.uri+"?"+F.param({version:ai.version,clientId:ai.clientId,disconnectedNodeAcknowledged:v.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(ak){var al=aj.data("gridInstance");var am=al.getData();am.deleteItem(ah.id);if(ah.permissions.canRead){f(aj,ah.component)}}).fail(d.handleAjaxError)}};return Y}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","Slick","nf.Client","nf.Shell","nf.ProcessGroupConfiguration","nf.CanvasUtils","nf.ErrorHandler","nf.FilteredDialogCommon","nf.Dialog","nf.Storage","nf.Common","nf.ControllerService","nf.ProcessGroup","nf.PolicyManagement","nf.ComponentState","nf.ComponentVersion","nf.ng.Bridge"],function(g,r,o,t,q,l,n,i,f,m,h,k,d,j,p,c,e,s){return(nf.ControllerServices=b(g,r,o,t,q,l,n,i,f,m,h,k,d,j,p,c,e,s))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ControllerServices=b(require("jquery"),require("d3"),require("Slick"),require("nf.Client"),require("nf.Shell"),require("nf.ProcessGroupConfiguration"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.Dialog"),require("nf.Storage"),require("nf.Common"),require("nf.ControllerService"),require("nf.ProcessGroup"),require("nf.PolicyManagement"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.ng.Bridge")))}else{nf.ControllerServices=b(a.$,a.d3,a.Slick,a.nf.Client,a.nf.Shell,a.nf.ProcessGroupConfiguration,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.Dialog,a.nf.Storage,a.nf.Common,a.nf.ControllerService,a.nf.ProcessGroup,a.nf.PolicyManagement,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.ng.Bridge)}}}(this,function(x,H,a,f,F,A,K,b,J,i,p,G,I,u,s,c,q,m){var h=null;var j=false;var B={urls:{api:"../nifi-api",controllerServiceTypes:"../nifi-api/flow/controller-service-types"}};var w={autosizeColsMode:a.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var k=function(N){return N.restricted===false||G.canAccessComponentRestrictions(N.explicitRestrictions)};var e=function(){return x("#controller-service-type-filter").val()};var y=function(){var N=x("#controller-service-types-table").data("gridInstance");if(G.isDefinedAndNotNull(N)){var O=N.getData();O.setFilterArgs({searchString:e()});O.refresh();x("#new-controller-service-dialog").modal("refreshButtons");if(O.getLength()>0){J.choseFirstRow(N);N.scrollRowToTop(0)}}};var z=function(){x("#controller-service-type-description").attr("title","").text("");x("#controller-service-type-name").attr("title","").text("");x("#controller-service-type-bundle").attr("title","").text("");x("#selected-controller-service-name").text("");x("#selected-controller-service-type").text("").removeData("bundle");x("#controller-service-description-container").hide()};var t=function(){z();var N=x("#controller-service-types-table").data("gridInstance");N.resetActiveCell()};var E=function(V,Q){var T=M(V,Q);var P=true;if(T){var U=x("#controller-service-tag-cloud").tagcloud("getSelectedTags");var S=U.length>0;if(S){P=n(U,V.tags)}}var R=true;if(T&&P){var N=x("#controller-service-bundle-group-combo").combo("getSelectedOption");if(G.isDefinedAndNotNull(N)&&N.value!==""){R=(V.bundle.group===N.value)}}var O=T&&P&&R;if(O===false&&x("#selected-controller-service-type").text()===V.type){t()}return O};var M=function(P,O){if(O.searchString===""){return true}try{var S=new RegExp(O.searchString,"i")}catch(R){return false}var Q=P.label.search(S)>=0;var N=P.tags.search(S)>=0;return Q||N};var n=function(P,N){var O=[];x.each(P,function(S,T){O.push(T)});var Q=N.toLowerCase();var R=true;x.each(O,function(S,T){if(Q.indexOf(T)===-1){R=false;return false}});return R};var D=function(N,Q){var P=x("#selected-controller-service-type").text();var O=x("#selected-controller-service-type").data("bundle");if(P===""){i.showOkDialog({headerText:"Controller Service",dialogContent:"The type of controller service to create must be selected."})}else{o(N,Q,P,O)}};var o=function(O,R,Q,S){var N={revision:f.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:p.isDisconnectionAcknowledged(),component:{type:Q,bundle:S}};var P=x.ajax({type:"POST",url:O,data:JSON.stringify(N),dataType:"json",contentType:"application/json"}).done(function(T){var U=R.data("gridInstance");var W=U.getData();W.addItem(x.extend({type:"ControllerService",bulletins:[]},T));W.reSort();U.invalidate();var V=W.getRowById(T.id);J.choseRow(U,V);U.scrollRowIntoView(V)}).fail(b.handleAjaxError);x("#new-controller-service-dialog").modal("hide");return P};var l=function(){var P=[{id:"type",name:"Type",field:"label",formatter:G.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:G.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:G.genericValueFormatter}];var O=new a.Data.DataView({inlineFilters:false});O.setItems([]);O.setFilterArgs({searchString:e()});O.setFilter(E);G.sortType({columnId:"type",sortAsc:true},O);var N=new a.Grid("#controller-service-types-table",O,P,w);N.setSelectionModel(new a.RowSelectionModel());N.registerPlugin(new a.AutoTooltips());N.setSortColumn("type",true);N.onSort.subscribe(function(S,R){G.sortType({columnId:R.sortCol.field,sortAsc:R.sortAsc},O)});N.onSelectedRowsChanged.subscribe(function(W,T){if(x.isArray(T.rows)&&T.rows.length===1){var R=T.rows[0];var V=N.getDataItem(R);if(G.isDefinedAndNotNull(V)){x("#controller-service-description-container").show();if(G.isBlank(V.description)){x("#controller-service-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{x("#controller-service-type-description").width(x("#controller-service-description-container").innerWidth()-1).html(V.description).ellipsis()}var S=G.formatBundle(V.bundle);var U=G.formatType(V);x("#controller-service-type-name").text(U).attr("title",U);x("#controller-service-type-bundle").text(S).attr("title",S);x("#selected-controller-service-name").text(V.label);x("#selected-controller-service-type").text(V.type).data("bundle",V.bundle);x("#new-controller-service-dialog").modal("refreshButtons")}}});N.onViewportChanged.subscribe(function(S,R){G.cleanUpTooltips(x("#controller-service-types-table"),"div.view-usage-restriction");G.cleanUpTooltips(x("#controller-service-types-table"),"div.controller-service-apis")});O.onRowCountChanged.subscribe(function(S,R){N.updateRowCount();N.render();x("#displayed-controller-service-types").text(R.current)});O.onRowsChanged.subscribe(function(S,R){N.invalidateRows(R.rows);N.render()});O.syncGridSelection(N,true);x("#controller-service-types-table").data("gridInstance",N).on("mouseenter","div.slick-cell",function(Y){var Z=x(this).find("div.view-usage-restriction");if(Z.length&&!Z.data("qtip")){var V=x(this).find("span.row-id").text();var aa=O.getItemById(V);if(aa.restricted===true){var X=x("<div></div>");if(G.isBlank(aa.usageRestriction)){X.append(x('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{X.append(x('<p style="margin-bottom: 3px;"></p>').text(aa.usageRestriction+" Requires the following permissions:"))}var T=[];if(G.isDefinedAndNotNull(aa.explicitRestrictions)){x.each(aa.explicitRestrictions,function(ab,ad){var ac=ad.requiredPermission;T.push("'"+ac.label+"' - "+G.escapeHtml(ad.explanation))})}else{T.push("Access to restricted components regardless of restrictions.")}X.append(G.formatUnorderedList(T));Z.qtip(x.extend({},G.config.tooltipConfig,{content:X,position:{container:x("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}var R=x(this).find("div.controller-service-apis");if(R.length&&!R.data("qtip")){var V=x(this).find("span.row-id").text();var aa=O.getItemById(V);if(!G.isEmpty(aa.controllerServiceApis)){var U=G.getFormattedServiceApis(aa.controllerServiceApis);var S=G.formatUnorderedList(U);var W=x('<div style="padding: 4px;"><p>Supports Controller Services</p><br/></div>').append(S);R.qtip(x.extend({},G.config.tooltipConfig,{content:W,position:{container:x("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var Q=G.getPolicyTypeListing("restricted-components");x.ajax({type:"GET",url:B.urls.controllerServiceTypes,dataType:"json"}).done(function(S){var X=0;var U=[];var R=new Set();var W=new Map();var V=new Map();O.beginUpdate();x.each(S.controllerServiceTypes,function(Y,Z){if(Z.restricted===true){if(G.isDefinedAndNotNull(Z.explicitRestrictions)){x.each(Z.explicitRestrictions,function(aa,ac){var ab=ac.requiredPermission;if(!V.has(ab.id)){V.set(ab.id,ab.label)}if(!W.has(ab.id)){W.set(ab.id,[])}W.get(ab.id).push({type:G.formatType(Z),bundle:G.formatBundle(Z.bundle),explanation:ac.explanation})})}else{if(!V.has(Q.value)){V.set(Q.value,Q.text)}if(!W.has(Q.value)){W.set(Q.value,[])}W.get(Q.value).push({type:G.formatType(Z),bundle:G.formatBundle(Z.bundle),explanation:Z.usageRestriction})}}R.add(Z.bundle.group);O.addItem({id:X+++"",label:G.substringAfterLast(Z.type,"."),type:Z.type,bundle:Z.bundle,controllerServiceApis:Z.controllerServiceApis,description:G.escapeHtml(Z.description),restricted:Z.restricted,usageRestriction:G.escapeHtml(Z.usageRestriction),explicitRestrictions:Z.explicitRestrictions,tags:Z.tags.join(", ")});x.each(Z.tags,function(ab,aa){U.push(aa.toLowerCase())})});O.endUpdate();O.reSort();N.invalidate();K.addComponentRestrictions(W,V);x("#total-controller-service-types, #displayed-controller-service-types").text(S.controllerServiceTypes.length);x("#controller-service-tag-cloud").tagcloud({tags:U,select:y,remove:y});var T=[{text:"all groups",value:""}];R.forEach(function(Y){T.push({text:Y,value:Y})});x("#controller-service-bundle-group-combo").combo({options:T,select:y})}).fail(b.handleAjaxError);x("#new-controller-service-dialog").modal({headerText:"Add Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){z();x("#controller-service-type-filter").val("");x("#controller-service-tag-cloud").tagcloud("clearSelectedTags");x("#controller-service-bundle-group-combo").combo("setSelectedOption",{value:""});y();var R=x("#controller-service-types-table").data("gridInstance");R.setSelectedRows([]);R.resetActiveCell()},resize:function(){x("#controller-service-type-description").width(x("#controller-service-description-container").innerWidth()-1).text(x("#controller-service-type-description").attr("title")).ellipsis()}}})};var r=function(R,O,Q,P,N){if(!N.permissions.canRead){return'<span class="blank">'+G.escapeHtml(N.id)+"</span>"}return G.escapeHtml(N.component.name)};var g=function(V,U,S,P,O){if(G.isDefinedAndNotNull(O.parentGroupId)){var T=K.getSelection();if(T.empty()===false){var R=T.datum();if(R.id===O.parentGroupId){if(R.permissions.canRead){return G.escapeHtml(R.component.name)}else{return G.escapeHtml(R.id)}}}var N=m.injector.get("breadcrumbsCtrl").getBreadcrumbs();var Q=O.parentGroupId;x.each(N,function(W,X){if(X.id===O.parentGroupId){Q=X.label;return false}});return G.escapeHtml(Q)}else{return"Controller"}};var v=function(N){var O=function(P){var S=K.getSelection();if(S.empty()===false){var R=S.datum();if(R.id===P){return R.permissions.canWrite}}var Q=m.injector.get("breadcrumbsCtrl").getBreadcrumbs();var T=false;x.each(Q,function(U,V){if(V.id===P){T=V.permissions.canWrite;return false}});return T};if(G.isDefinedAndNotNull(N.parentGroupId)){return O(N.parentGroupId)}else{return G.canModifyController()}};var L=function(N,P){var O=function(X,W){if(X.permissions.canRead&&W.permissions.canRead){if(N.columnId==="moreDetails"){var T=0;if(!G.isEmpty(X.bulletins)){T=X.bulletins.length}var Q=0;if(!G.isEmpty(W.bulletins)){Q=W.bulletins.length}return T-Q}else{if(N.columnId==="type"){var U=G.isDefinedAndNotNull(X.component[N.columnId])?G.substringAfterLast(X.component[N.columnId],"."):"";var S=G.isDefinedAndNotNull(W.component[N.columnId])?G.substringAfterLast(W.component[N.columnId],"."):"";return U===S?0:U>S?1:-1}else{if(N.columnId==="state"){var V;if(X.status.validationStatus==="VALIDATING"){V="Validating"}else{if(X.status.validationStatus==="INVALID"){V="Invalid"}else{V=G.isDefinedAndNotNull(X.component[N.columnId])?X.component[N.columnId]:""}}var Z;if(W.status.validationStatus==="VALIDATING"){Z="Validating"}else{if(W.status.validationStatus==="INVALID"){Z="Invalid"}else{Z=G.isDefinedAndNotNull(W.component[N.columnId])?W.component[N.columnId]:""}}return V===Z?0:V>Z?1:-1}else{var R=G.isDefinedAndNotNull(X.component[N.columnId])?X.component[N.columnId]:"";var Y=G.isDefinedAndNotNull(W.component[N.columnId])?W.component[N.columnId]:"";return R===Y?0:R>Y?1:-1}}}}else{if(!X.permissions.canRead&&!W.permissions.canRead){return 0}if(X.permissions.canRead){return 1}else{return -1}}};P.sort(O,N.sortAsc)};var C=function(T,N){var S=function(ad,ab,Y,W,V){if(!V.permissions.canRead){return""}var ac='<div title="View Documentation" class="pointer controller-service-usage fa fa-book"></div>';var Z=!G.isBlank(V.component.comments);var aa=!G.isEmpty(V.component.validationErrors);var X=!G.isEmpty(V.bulletins);if(Z){ac+='<div class="pointer has-comments fa fa-comment"></div>'}if(aa){ac+='<div class="pointer has-errors fa fa-warning"></div>'}if(X){ac+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(Z||aa||X){ac+='<span class="hidden row-id">'+G.escapeHtml(V.id)+"</span>"}return ac};var O=function(ac,W,ab,X,V){var aa="",Y="";if(V.status.validationStatus==="VALIDATING"){aa="validating fa fa-spin fa-circle-notch";Y="Validating"}else{if(V.status.validationStatus==="INVALID"){aa="invalid fa fa-warning";Y="Invalid"}else{if(V.status.runStatus==="DISABLED"){aa='disabled icon icon-enable-false"';Y="Disabled"}else{if(V.status.runStatus==="DISABLING"){aa='disabled icon icon-enable-false"';Y="Disabling"}else{if(V.status.runStatus==="ENABLED"){aa="enabled fa fa-flash";Y="Enabled"}else{if(V.status.runStatus==="ENABLING"){aa="enabled fa fa-flash";Y="Enabling"}}}}}}var Z='<div layout="row"><div class="'+aa+'"></div>';return Z+'<div class="status-text">'+Y+"</div></div>"};var R=function(af,ac,Z,Y,V){var ad="";var X=V.permissions.canRead;var W=V.permissions.canWrite;var ab=W||(V.operatePermissions&&V.operatePermissions.canWrite);var ae=false;if(G.isDefinedAndNotNull(V.parentGroupId)){if(V.parentGroupId===x("#process-group-id").text()){ae=true}}else{ae=true}if(ae===true){var aa=V.status.runStatus==="DISABLED";if(X){if(W&&aa){ad+='<div class="pointer edit-controller-service fa fa-gear" title="Configure"></div>'}else{ad+='<div class="pointer view-controller-service fa fa-gear" title="View Configuration"></div>'}}if(ab){if(V.status.runStatus==="ENABLED"||V.status.runStatus==="ENABLING"){ad+='<div class="pointer disable-controller-service icon icon-enable-false" title="Disable"></div>'}else{if(aa&&V.status.validationStatus==="VALID"){ad+='<div class="pointer enable-controller-service fa fa-flash" title="Enable"></div>'}}}if(aa&&X&&W&&V.component.multipleVersionsAvailable===true){ad+='<div title="Change Version" class="pointer change-version-controller-service fa fa-exchange"></div>'}if(aa&&X&&W&&v(V)){ad+='<div class="pointer delete-controller-service fa fa-trash" title="Remove"></div>'}if(X&&W&&V.component.persistsState===true){ad+='<div title="View State" class="pointer view-state-controller-service fa fa-tasks"></div>'}}else{ad+='<div class="pointer go-to-controller-service fa fa-long-arrow-right" title="Go To"></div>'}if(K.isManagedAuthorizer()&&G.canAccessTenants()){ad+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key"></div>'}return ad};var Q=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:S,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",formatter:r,sortable:true,resizable:true},{id:"type",name:"Type",formatter:G.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:G.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"State",formatter:O,sortable:true,resizeable:true},{id:"parentGroupId",name:"Scope",formatter:g,sortable:true,resizeable:true}];Q.push({id:"actions",name:"&nbsp;",resizable:false,formatter:R,sortable:false,width:115,maxWidth:115});var U=new a.Data.DataView({inlineFilters:false});U.setItems([]);L({columnId:"name",sortAsc:true},U);var P=new a.Grid(T,U,Q,w);P.setSelectionModel(new a.RowSelectionModel());P.registerPlugin(new a.AutoTooltips());P.setSortColumn("name",true);P.onSort.subscribe(function(W,V){L({columnId:V.sortCol.id,sortAsc:V.sortAsc},U)});P.onClick.subscribe(function(Y,W){var X=x(Y.target);var V=U.getItem(W.row);if(P.getColumns()[W.cell].id==="actions"){if(X.hasClass("edit-controller-service")){I.showConfiguration(T,V)}else{if(X.hasClass("view-controller-service")){I.showDetails(T,V)}else{if(X.hasClass("enable-controller-service")){I.enable(T,V)}else{if(X.hasClass("disable-controller-service")){I.disable(T,V)}else{if(X.hasClass("delete-controller-service")){I.promptToDeleteController(T,V)}else{if(X.hasClass("view-state-controller-service")){c.showState(V,V.component.state==="DISABLED")}else{if(X.hasClass("change-version-controller-service")){q.promptForVersionChange(V)}else{if(X.hasClass("edit-access-policies")){s.showControllerServicePolicy(V);x("#shell-close-button").click()}else{if(X.hasClass("go-to-controller-service")){u.enterGroup(V.parentGroupId).done(function(){x.Deferred(function(Z){if(x("#process-group-configuration").is(":visible")){A.loadConfiguration(V.parentGroupId).done(function(){Z.resolve()})}else{A.showConfiguration(V.parentGroupId).done(function(){Z.resolve()})}}).done(function(){A.selectControllerService(V.id)})})}}}}}}}}}}else{if(P.getColumns()[W.cell].id==="moreDetails"){if(X.hasClass("controller-service-usage")){x("#shell-close-button").click();F.showPage("../nifi-docs/documentation?"+x.param({select:V.component.type,group:V.component.bundle.group,artifact:V.component.bundle.artifact,version:V.component.bundle.version})).done(function(){if(G.isDefinedAndNotNull(V.parentGroupId)){var Z;var aa=u.get(V.parentGroupId);if(G.isDefinedAndNotNull(aa)){Z=aa.id}else{Z=K.getGroupId()}A.showConfiguration(Z)}else{N()}})}}}});U.onRowCountChanged.subscribe(function(W,V){P.updateRowCount();P.render()});U.onRowsChanged.subscribe(function(W,V){P.invalidateRows(V.rows);P.render()});U.syncGridSelection(P,true);T.data("gridInstance",P).on("mouseenter","div.slick-cell",function(Z){var ac=x(this).find("div.has-comments");if(ac.length&&!ac.data("qtip")){var ad=x(this).find("span.row-id").text();var W=U.getItemById(ad);var X=G.escapeHtml(W.component.comments);var ae=G.formatNewLines(X);if(G.isDefinedAndNotNull(ae)){ac.qtip(x.extend({},G.config.tooltipConfig,{content:ae,position:{target:"mouse",viewport:x("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var V=x(this).find("div.has-errors");if(V.length&&!V.data("qtip")){var ad=x(this).find("span.row-id").text();var W=U.getItemById(ad);var ae=G.formatUnorderedList(W.component.validationErrors);if(G.isDefinedAndNotNull(ae)){V.qtip(x.extend({},G.config.tooltipConfig,{content:ae,position:{target:"mouse",viewport:x("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var ab=x(this).find("div.has-bulletins");if(ab.length&&!ab.data("qtip")){var aa=x(this).find("span.row-id").text();var W=U.getItemById(aa);var Y=G.getFormattedBulletins(W.bulletins);var ae=G.formatUnorderedList(Y);if(G.isDefinedAndNotNull(ae)){ab.qtip(x.extend({},G.config.tooltipConfig,{content:ae,position:{target:"mouse",viewport:x("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var d=function(N,O){return x.ajax({type:"GET",url:N,dataType:"json",data:{uiOnly:true}}).done(function(P){var Q=[];x.each(P.controllerServices,function(U,T){Q.push(x.extend({type:"ControllerService",bulletins:[]},T))});G.cleanUpTooltips(O,"div.has-comments");G.cleanUpTooltips(O,"div.has-errors");G.cleanUpTooltips(O,"div.has-bulletins");var R=O.data("gridInstance");var S=R.getData();S.setItems(Q);S.reSort();R.invalidate();R.render()})};return{init:function(O,N){if(!j){l();j=true}C(O,N)},promptNewControllerService:function(O,R){var P=x("#controller-service-types-table").data("gridInstance");var N=P.getData();var Q=[x.ui.keyCode.UP,x.ui.keyCode.PAGE_UP,x.ui.keyCode.DOWN,x.ui.keyCode.PAGE_DOWN];x("#controller-service-type-filter").off("keyup").on("keyup",function(V){var U=V.keyCode?V.keyCode:V.which;if(x.inArray(U,Q)!==-1){return}if(U===x.ui.keyCode.ENTER){var S=P.getSelectedRows();if(S.length>0){var T=P.getDataItem(S[0]);if(k(T)){D(O,R)}}}else{y()}});J.addKeydownListener("#controller-service-type-filter",P,N);x("#new-controller-service-dialog").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var S=P.getSelectedRows();if(S.length>0){var T=P.getDataItem(S[0]);return k(T)===false}else{return N.getLength()===0}},handler:{click:function(){D(O,R)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){x(this).modal("hide")}}}]).modal("show");if(h!==null){P.onDblClick.unsubscribe(h)}h=function(U,S){var T=P.getDataItem(S.row);if(k(T)){o(O,R,T.type,T.bundle)}};P.onDblClick.subscribe(h);P.resizeCanvas();if(N.getLength()>0){J.choseFirstRow(P)}x("#controller-service-type-filter").focus()},resetTableSize:function(O){var N=O.data("gridInstance");if(G.isDefinedAndNotNull(N)){N.resizeCanvas()}},loadControllerServices:function(N,O){return d(N,O)},setBulletins:function(R,O){var Q=R.data("gridInstance");var S=Q.getData();S.beginUpdate();if(!G.isEmpty(O)){var P=new Map(O.map(function(T){return[T.sourceId,T]}));P.forEach(function(T,V){var U=S.getItemById(V);if(G.isDefinedAndNotNull(U)){S.updateItem(V,x.extend(U,{bulletins:T}))}})}else{var N=S.getItems();x.each(N,function(U,T){S.updateItem(T.id,x.extend(T,{bulletins:[]}))})}S.endUpdate()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.ControllerService","nf.ControllerServices","nf.UniversalCapture","nf.CustomUi","nf.Verify"],function(f,k,d,e,h,m,l,c,i,j,g){return(nf.ReportingTask=b(f,k,d,e,h,m,l,c,i,j,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ReportingTask=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ControllerService"),require("nf.ControllerServices"),require("nf.UniversalCapture"),require("nf.CustomUi"),require("nf.Verify")))}else{nf.ReportingTask=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ControllerService,a.nf.ControllerServices,a.nf.UniversalCapture,a.nf.CustomUi,a.nf.Verify)}}}(this,function(f,h,j,n,g,y,a,c,q,d,t){var v;var w={edit:"edit",readOnly:"read-only",urls:{api:"../nifi-api"}};var p=null;var i=w.urls.api+"/flow/controller/controller-services";var b=function(){return f("#controller-services-table")};var z=function(){var B=f("#reporting-task-configuration").data("reportingTaskDetails");if(f("#reporting-task-name").val()!==B.component.name){return true}if(f("#reporting-task-comments").val()!==B.component.comments){return true}if(f("#reporting-task-enabled").hasClass("checkbox-checked")&&B.component.state==="DISABLED"){return true}else{if(f("#reporting-task-enabled").hasClass("checkbox-unchecked")&&(B.component.state==="RUNNING"||B.component.state==="STOPPED")){return true}}var C=f("#reporting-task-scheduling-strategy-combo").combo("getSelectedOption").value;if(C!==(B.component.schedulingStrategy+"")){return true}var A;if(C==="CRON_DRIVEN"){A=f("#reporting-task-cron-driven-scheduling-period")}else{A=f("#reporting-task-timer-driven-scheduling-period")}if(j.isDefinedAndNotNull(A)&&A.val()!==(B.component.schedulingPeriod+"")){return true}return f("#reporting-task-properties").propertytable("isSaveRequired")};var k=function(){var B=f("#reporting-task-properties").propertytable("marshalProperties");var E=f("#reporting-task-scheduling-strategy-combo").combo("getSelectedOption").value;var A;if(E==="CRON_DRIVEN"){A=f("#reporting-task-cron-driven-scheduling-period")}else{A=f("#reporting-task-timer-driven-scheduling-period")}var D={};D.id=f("#reporting-task-id").text();D.name=f("#reporting-task-name").val();D.schedulingStrategy=E;D.schedulingPeriod=A.val();D.comments=f("#reporting-task-comments").val();if(f("#reporting-task-enabled").hasClass("checkbox-unchecked")){D.state="DISABLED"}else{if(f("#reporting-task-enabled").hasClass("checkbox-checked")){D.state="STOPPED"}}if(f.isEmptyObject(B)===false){D.properties=B}D.sensitiveDynamicPropertyNames=f("#reporting-task-properties").propertytable("getSensitiveDynamicPropertyNames");var C={};C.component=D;return C};var u=function(A){var C=[];var B=A.component;if(j.isBlank(B.schedulingPeriod)){C.push("Run schedule must be specified")}if(C.length>0){n.showOkDialog({dialogContent:j.formatUnorderedList(C),headerText:"Reporting Task"});return false}else{return true}};var s=function(B){var D=f("#reporting-tasks-table").data("gridInstance");var A=D.getData();var C=A.getItemById(B.id);A.updateItem(B.id,f.extend({type:"ReportingTask",bulletins:C.bulletins},B))};var e=function(C,B){var A={revision:y.getRevision(C),disconnectedNodeAcknowledged:g.isDisconnectionAcknowledged(),state:B===true?"RUNNING":"STOPPED"};return f.ajax({type:"PUT",url:C.uri+"/run-status",data:JSON.stringify(A),dataType:"json",contentType:"application/json"}).done(function(D){s(D);if(j.isDefinedAndNotNull(D.component)){a.reloadReferencedServices(b(),D.component)}}).fail(h.handleAjaxError)};var o=function(){return f.Deferred(function(A){f("#reporting-task-properties").propertytable("saveRow");if(z()){n.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){A.resolve()},yesHandler:function(){var B=f("#reporting-task-configuration").data("reportingTaskDetails");m(B).done(function(){A.resolve()}).fail(function(){A.reject()})}})}else{A.resolve()}}).promise()};var m=function(B){var A=k();if(u(A)){A.revision=y.getRevision(B);A.disconnectedNodeAcknowledged=g.isDisconnectionAcknowledged();return f.ajax({type:"PUT",data:JSON.stringify(A),url:B.uri,dataType:"json",contentType:"application/json"}).done(function(C){s(C)}).fail(h.handleConfigurationUpdateAjaxError)}else{return f.Deferred(function(C){C.reject()}).promise()}};var r=function(B,A){var C=f("#reporting-task-configuration").data("reportingTaskDetails");return f.ajax({type:"GET",url:C.uri+"/descriptors",data:{propertyName:B,sensitive:A},dataType:"json"}).fail(h.handleAjaxError)};var l=function(C,D){p=D;var A=f("#reporting-task-properties-verification-results");if(A.is(":visible")===false){f("#reporting-task-properties").css("bottom","40%").propertytable("resetTableSize");A.show()}var B=f("#reporting-task-properties-verification-results-listing");if(B.get(0).scrollHeight>Math.round(B.innerHeight())){B.css("border-width","1px")}};var x={init:function(A){v=A;f("#reporting-task-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"reporting-task-standard-settings-tab-content"},{name:"Properties",tabContentId:"reporting-task-properties-tab-content"},{name:"Comments",tabContentId:"reporting-task-comments-tab-content"}],select:function(){q.removeAllPropertyDetailDialogs();if(f(this).text()==="Properties"){f("#reporting-task-properties").propertytable("resetTableSize")}f("#reporting-task-properties").propertytable("saveRow")}});f("#reporting-task-configuration").data("mode",w.edit).modal({scrollableContentStyle:"scrollable",headerText:"Configure Reporting Task",handler:{close:function(){f("#reporting-task-properties").propertytable("cancelEdit");f("#reporting-task-properties").propertytable("clear");j.clearField("read-only-reporting-task-comments");f("#reporting-task-configuration").removeData("reportingTaskDetails");f("#reporting-task-properties-verification-results").hide();f("#reporting-task-properties-verification-results-listing").css("border-width","0").empty();f("#reporting-task-properties").css("bottom","0");p=null},open:function(){j.toggleScrollable(f("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});f("#reporting-task-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-reporting-task-property-container",descriptorDeferred:r,controllerServiceCreatedDeferred:function(B){return c.loadControllerServices(i,f("#controller-services-table"))},goToServiceDeferred:o})},showConfiguration:function(B){var C=f("#reporting-task-configuration");C.find(".dialog-header .dialog-header-text").text("Configure Reporting Task");if(C.data("mode")===w.readOnly){f("#reporting-task-configuration .reporting-task-read-only").hide();f("#reporting-task-configuration .reporting-task-editable").show();f("#reporting-task-properties").propertytable("destroy").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-reporting-task-property-container",descriptorDeferred:r,controllerServiceCreatedDeferred:function(E){return c.loadControllerServices(i,f("#controller-services-table"))},goToServiceDeferred:o});C.data("mode",w.edit)}var D=f.ajax({type:"GET",url:B.uri,dataType:"json"});var A=f.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(B.id),dataType:"json"});f.when(D,A).done(function(G,L){B=G[0];var M=B.component;var F=L[0].componentHistory;f("#reporting-task-configuration").data("reportingTaskDetails",B);var J="checkbox-checked";if(M.state==="DISABLED"){J="checkbox-unchecked"}j.populateField("reporting-task-id",M.id);j.populateField("reporting-task-type",j.formatType(M));f("#reporting-task-configuration").modal("setSubtitle",j.formatType(M));j.populateField("reporting-task-bundle",j.formatBundle(M.bundle));f("#reporting-task-name").val(M.name);f("#reporting-task-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(J);f("#reporting-task-comments").val(M.comments);var H=M.defaultSchedulingPeriod;var E=f("#reporting-task-cron-driven-scheduling-period").val(H.CRON_DRIVEN);var I=f("#reporting-task-timer-driven-scheduling-period").val(H.TIMER_DRIVEN);if(M.schedulingStrategy==="CRON_DRIVEN"){E.val(M.schedulingPeriod)}else{I.val(M.schedulingPeriod)}f("#reporting-task-scheduling-strategy-combo").combo({options:[{text:"Timer driven",value:"TIMER_DRIVEN",description:"Reporting task will be scheduled to run on an interval defined by the run schedule."},{text:"CRON driven",value:"CRON_DRIVEN",description:"Reporting task will be scheduled to run on at specific times based on the specified CRON string."}],selectedOption:{value:M.schedulingStrategy},select:function(N){if(N.value==="CRON_DRIVEN"){I.hide();E.show()}else{I.show();E.hide()}}});var K=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f("#reporting-task-properties").propertytable("saveRow");m(B).done(function(N){a.reloadReferencedServices(b(),N.component);f("#reporting-task-configuration").modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#reporting-task-configuration").modal("hide")}}}];if(j.isDefinedAndNotNull(M.customUiUrl)&&M.customUiUrl!==""){K.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var N=function(){f("#reporting-task-configuration").modal("hide");f("#shell-close-button").click();d.showCustomUi(B,M.customUiUrl,true).done(function(){x.reload(B.id).done(function(O){a.reloadReferencedServices(b(),O.reportingTask)});v.showSettings()})};f("#reporting-task-properties").propertytable("saveRow");if(z()){n.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:N,yesHandler:function(){m(B).done(function(){N()})}})}else{N()}}}})}f("#reporting-task-configuration").modal("setButtonModel",K);f("#reporting-task-properties").propertytable("setGroupId",null).propertytable("setSupportsSensitiveDynamicProperties",M.supportsSensitiveDynamicProperties).propertytable("loadProperties",M.properties,M.descriptors,F.propertyHistory).propertytable("setPropertyVerificationCallback",function(N){t.verify(M.id,B.uri,N,p,l,f("#reporting-task-properties-verification-results-listing"))});f("#reporting-task-configuration").modal("show");f("#reporting-task-properties").propertytable("resetTableSize")}).fail(h.handleAjaxError)},showDetails:function(B){var C=f("#reporting-task-configuration");C.find(".dialog-header .dialog-header-text").text("Reporting Task Details");if(C.data("mode")===w.edit){f("#reporting-task-configuration .reporting-task-read-only").show();f("#reporting-task-configuration .reporting-task-editable").hide();f("#reporting-task-properties").propertytable("destroy").propertytable({supportsGoTo:true,readOnly:true});C.data("mode",w.readOnly)}var D=f.ajax({type:"GET",url:B.uri,dataType:"json"});var A=f.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(B.id),dataType:"json"});f.when(D,A).done(function(E,F){B=E[0];var J=B.component;var G=F[0].componentHistory;j.populateField("reporting-task-id",J.id);j.populateField("reporting-task-type",j.substringAfterLast(J.type,"."));j.populateField("reporting-task-bundle",j.formatBundle(J.bundle));j.populateField("read-only-reporting-task-name",J.name);j.populateField("read-only-reporting-task-comments",J.comments);var I=J.schedulingStrategy;if(I==="CRON_DRIVEN"){I="CRON driven"}else{I="Timer driven"}j.populateField("read-only-reporting-task-scheduling-strategy",I);j.populateField("read-only-reporting-task-scheduling-period",J.schedulingPeriod);var H=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){C.modal("hide")}}}];if(j.isDefinedAndNotNull(d)&&j.isDefinedAndNotNull(J.customUiUrl)&&J.customUiUrl!==""){H.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){C.modal("hide");f("#shell-close-button").click();d.showCustomUi(B,J.customUiUrl,false).done(function(){v.showSettings()})}}})}C.modal("setButtonModel",H).modal("show");f("#reporting-task-properties").propertytable("setGroupId",null).propertytable("setSupportsSensitiveDynamicProperties",J.supportsSensitiveDynamicProperties).propertytable("loadProperties",J.properties,J.descriptors,G.propertyHistory);C.modal("show");f("#reporting-task-properties").propertytable("resetTableSize")})},start:function(A){e(A,true)},stop:function(A){e(A,false)},reload:function(D){var C=f("#reporting-tasks-table").data("gridInstance");var A=C.getData();var B=A.getItemById(D);return f.ajax({type:"GET",url:B.uri,dataType:"json"}).done(function(E){s(E)}).fail(h.handleAjaxError)},promptToDeleteReportingTask:function(A){n.showYesNoDialog({headerText:"Delete Reporting Task",dialogContent:"Delete reporting task '"+j.escapeHtml(A.component.name)+"'?",yesHandler:function(){x.remove(A)}})},remove:function(B){var A=y.getRevision(B);f.ajax({type:"DELETE",url:B.uri+"?"+f.param({version:A.version,clientId:A.clientId,disconnectedNodeAcknowledged:g.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(D){var E=f("#reporting-tasks-table").data("gridInstance");var C=E.getData();C.deleteItem(B.id)}).fail(h.handleAjaxError)}};return x}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Storage","nf.Client","nf.ControllerService","nf.ControllerServices","nf.UniversalCapture","nf.CustomUi","nf.Verify"],function(f,k,d,e,h,m,l,c,i,j,g){return(nf.FlowAnalysisRule=b(f,k,d,e,h,m,l,c,i,j,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.FlowAnalysisRule=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ControllerService"),require("nf.ControllerServices"),require("nf.UniversalCapture"),require("nf.CustomUi"),require("nf.Verify")))}else{nf.FlowAnalysisRule=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ControllerService,a.nf.ControllerServices,a.nf.UniversalCapture,a.nf.CustomUi,a.nf.Verify)}}}(this,function(g,i,l,p,h,y,c,e,s,f,t){var w;var x={edit:"edit",readOnly:"read-only",urls:{api:"../nifi-api"}};var r=null;var k=x.urls.api+"/flow/controller/controller-services";var d=function(){return g("#controller-services-table")};var z=function(){var B=g("#flow-analysis-rule-configuration").data("flowAnalysisRuleDetails");if(g("#flow-analysis-rule-name").val()!==B.component.name){return true}if(g("#flow-analysis-rule-comments").val()!==B.component.comments){return true}var A=g("#flow-analysis-rule-enforcement-policy-combo").combo("getSelectedOption").value;if(A!==(B.component.enforcementPolicy+"")){return true}return g("#flow-analysis-rule-properties").propertytable("isSaveRequired")};var m=function(){var B=g("#flow-analysis-rule-properties").propertytable("marshalProperties");var A=g("#flow-analysis-rule-enforcement-policy-combo").combo("getSelectedOption").value;var D={};D.id=g("#flow-analysis-rule-id").text();D.name=g("#flow-analysis-rule-name").val();D.comments=g("#flow-analysis-rule-comments").val();D.enforcementPolicy=A;if(g.isEmptyObject(B)===false){D.properties=B}D.sensitiveDynamicPropertyNames=g("#flow-analysis-rule-properties").propertytable("getSensitiveDynamicPropertyNames");var C={};C.component=D;return C};var v=function(B){var C=[];var A=B.component;if(C.length>0){p.showOkDialog({dialogContent:l.formatUnorderedList(C),headerText:"Flow Analysis Rule"});return false}else{return true}};var o=function(C){var A=g("#flow-analysis-rules-table").data("gridInstance");var B=A.getData();var D=B.getItemById(C.id);B.updateItem(C.id,g.extend({type:"FlowAnalysisRule",bulletins:D.bulletins},C))};var b=function(C,B){var A={revision:y.getRevision(C),disconnectedNodeAcknowledged:h.isDisconnectionAcknowledged(),state:B===true?"ENABLED":"DISABLED"};return g.ajax({type:"PUT",url:C.uri+"/run-status",data:JSON.stringify(A),dataType:"json",contentType:"application/json"}).done(function(D){o(D);if(l.isDefinedAndNotNull(D.component)){c.reloadReferencedServices(d(),D.component)}}).fail(i.handleAjaxError)};var q=function(){return g.Deferred(function(A){g("#flow-analysis-rule-properties").propertytable("saveRow");if(z()){p.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){A.resolve()},yesHandler:function(){var B=g("#flow-analysis-rule-configuration").data("flowAnalysisRuleDetails");j(B).done(function(){A.resolve()}).fail(function(){A.reject()})}})}else{A.resolve()}}).promise()};var j=function(B){var A=m();if(v(A)){A.revision=y.getRevision(B);A.disconnectedNodeAcknowledged=h.isDisconnectionAcknowledged();return g.ajax({type:"PUT",data:JSON.stringify(A),url:B.uri,dataType:"json",contentType:"application/json"}).done(function(C){o(C)}).fail(i.handleConfigurationUpdateAjaxError)}else{return g.Deferred(function(C){C.reject()}).promise()}};var u=function(B,A){var C=g("#flow-analysis-rule-configuration").data("flowAnalysisRuleDetails");return g.ajax({type:"GET",url:C.uri+"/descriptors",data:{propertyName:B,sensitive:A},dataType:"json"}).fail(i.handleAjaxError)};var n=function(C,D){r=D;var A=g("#flow-analysis-rule-properties-verification-results");if(A.is(":visible")===false){g("#flow-analysis-rule-properties").css("bottom","40%").propertytable("resetTableSize");A.show()}var B=g("#flow-analysis-rule-properties-verification-results-listing");if(B.get(0).scrollHeight>Math.round(B.innerHeight())){B.css("border-width","1px")}};var a={init:function(A){w=A;g("#flow-analysis-rule-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"flow-analysis-rule-standard-settings-tab-content"},{name:"Properties",tabContentId:"flow-analysis-rule-properties-tab-content"},{name:"Comments",tabContentId:"flow-analysis-rule-comments-tab-content"}],select:function(){s.removeAllPropertyDetailDialogs();if(g(this).text()==="Properties"){g("#flow-analysis-rule-properties").propertytable("resetTableSize")}g("#flow-analysis-rule-properties").propertytable("saveRow")}});g("#flow-analysis-rule-configuration").data("mode",x.edit).modal({scrollableContentStyle:"scrollable",headerText:"Configure Flow Analysis Rule",handler:{close:function(){g("#flow-analysis-rule-properties").propertytable("cancelEdit");g("#flow-analysis-rule-properties").propertytable("clear");l.clearField("read-only-flow-analysis-rule-comments");g("#flow-analysis-rule-configuration").removeData("flowAnalysisRuleDetails");g("#flow-analysis-rule-properties-verification-results").hide();g("#flow-analysis-rule-properties-verification-results-listing").css("border-width","0").empty();g("#flow-analysis-rule-properties").css("bottom","0");r=null},open:function(){l.toggleScrollable(g("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});g("#flow-analysis-rule-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-flow-analysis-rule-property-container",descriptorDeferred:u,controllerServiceCreatedDeferred:function(B){return e.loadControllerServices(k,g("#controller-services-table"))},goToServiceDeferred:q})},showConfiguration:function(B){var C=g("#flow-analysis-rule-configuration");C.find(".dialog-header .dialog-header-text").text("Configure Flow Analysis Rule");if(C.data("mode")===x.readOnly){g("#flow-analysis-rule-configuration .flow-analysis-rule-read-only").hide();g("#flow-analysis-rule-configuration .flow-analysis-rule-editable").show();g("#flow-analysis-rule-properties").propertytable("destroy").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-flow-analysis-rule-property-container",descriptorDeferred:u,controllerServiceCreatedDeferred:function(E){return e.loadControllerServices(k,g("#controller-services-table"))},goToServiceDeferred:q});C.data("mode",x.edit)}var D=g.ajax({type:"GET",url:B.uri,dataType:"json"});var A=g.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(B.id),dataType:"json"});g.when(D,A).done(function(E,G){B=E[0];var H=B.component;var F=G[0].componentHistory;g("#flow-analysis-rule-configuration").data("flowAnalysisRuleDetails",B);l.populateField("flow-analysis-rule-id",H.id);l.populateField("flow-analysis-rule-type",l.formatType(H));l.populateField("flow-analysis-rule-bundle",l.formatBundle(H.bundle));g("#flow-analysis-rule-name").val(H.name);g("#flow-analysis-rule-comments").val(H.comments);g("#flow-analysis-rule-enforcement-policy-combo").combo({options:[{text:"Enforce",value:"ENFORCE",description:"Treat violations of this rule as errors the correction of which is mandatory."}],selectedOption:{value:H.enforcementPolicy}});var I=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){g("#flow-analysis-rule-properties").propertytable("saveRow");j(B).done(function(J){c.reloadReferencedServices(d(),J.component);g("#flow-analysis-rule-configuration").modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#flow-analysis-rule-configuration").modal("hide")}}}];if(l.isDefinedAndNotNull(H.customUiUrl)&&H.customUiUrl!==""){I.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var J=function(){g("#flow-analysis-rule-configuration").modal("hide");g("#shell-close-button").click();f.showCustomUi(B,H.customUiUrl,true).done(function(){a.reload(B.id).done(function(K){c.reloadReferencedServices(d(),K.flowAnalysisRule)});w.showSettings()})};g("#flow-analysis-rule-properties").propertytable("saveRow");if(z()){p.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:J,yesHandler:function(){j(B).done(function(){J()})}})}else{J()}}}})}g("#flow-analysis-rule-configuration").modal("setButtonModel",I);g("#flow-analysis-rule-properties").propertytable("setGroupId",null).propertytable("setSupportsSensitiveDynamicProperties",H.supportsSensitiveDynamicProperties).propertytable("loadProperties",H.properties,H.descriptors,F.propertyHistory).propertytable("setPropertyVerificationCallback",function(J){t.verify(H.id,B.uri,J,r,n,g("#flow-analysis-rule-properties-verification-results-listing"))});g("#flow-analysis-rule-configuration").modal("show");g("#flow-analysis-rule-properties").propertytable("resetTableSize")}).fail(i.handleAjaxError)},showDetails:function(B){var C=g("#flow-analysis-rule-configuration");C.find(".dialog-header .dialog-header-text").text("Flow Analysis Rule Details");if(C.data("mode")===x.edit){g("#flow-analysis-rule-configuration .flow-analysis-rule-read-only").show();g("#flow-analysis-rule-configuration .flow-analysis-rule-editable").hide();g("#flow-analysis-rule-properties").propertytable("destroy").propertytable({supportsGoTo:true,readOnly:true});C.data("mode",x.readOnly)}var D=g.ajax({type:"GET",url:B.uri,dataType:"json"});var A=g.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(B.id),dataType:"json"});g.when(D,A).done(function(F,H){B=F[0];var I=B.component;var G=H[0].componentHistory;l.populateField("flow-analysis-rule-id",I.id);l.populateField("flow-analysis-rule-type",l.substringAfterLast(I.type,"."));l.populateField("flow-analysis-rule-bundle",l.formatBundle(I.bundle));l.populateField("read-only-flow-analysis-rule-name",I.name);l.populateField("read-only-flow-analysis-rule-comments",I.comments);var E=I.enforcementPolicy;if(E==="ENFORCE"){E="Enforce"}else{E="Warn"}l.populateField("read-only-flow-analysis-rule-enforcement-policy",E);var J=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){C.modal("hide")}}}];if(l.isDefinedAndNotNull(f)&&l.isDefinedAndNotNull(I.customUiUrl)&&I.customUiUrl!==""){J.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){C.modal("hide");g("#shell-close-button").click();f.showCustomUi(B,I.customUiUrl,false).done(function(){w.showSettings()})}}})}C.modal("setButtonModel",J).modal("show");g("#flow-analysis-rule-properties").propertytable("setGroupId",null).propertytable("loadProperties",I.properties,I.descriptors,G.propertyHistory);C.modal("show");g("#flow-analysis-rule-properties").propertytable("resetTableSize")})},enable:function(A){b(A,true)},disable:function(A){b(A,false)},reload:function(D){var A=g("#flow-analysis-rules-table").data("gridInstance");var B=A.getData();var C=B.getItemById(D);return g.ajax({type:"GET",url:C.uri,dataType:"json"}).done(function(E){o(E)}).fail(i.handleAjaxError)},promptToDeleteFlowAnalysisRule:function(A){p.showYesNoDialog({headerText:"Delete Flow Analysis Rule",dialogContent:"Delete flow analysis rule '"+l.escapeHtml(A.component.name)+"'?",yesHandler:function(){a.remove(A)}})},remove:function(B){var A=y.getRevision(B);g.ajax({type:"DELETE",url:B.uri+"?"+g.param({version:A.version,clientId:A.clientId,disconnectedNodeAcknowledged:h.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(D){var C=g("#flow-analysis-rules-table").data("gridInstance");var E=C.getData();E.deleteItem(B.id)}).fail(i.handleAjaxError)}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.ErrorHandler","nf.Common","nf.CanvasUtils","nf.Dialog","nf.Storage","nf.Client","nf.ControllerService","nf.ControllerServices","nf.UniversalCapture","nf.CustomUi","nf.Verify","nf.Processor","nf.ProcessGroup","nf.ParameterContexts","nf.ProcessGroupConfiguration","lodash"],function(f,q,h,j,p,m,g,t,c,d,o,e,r,l,i,n,k,s){return(nf.ParameterProvider=b(f,q,h,j,p,m,g,t,c,d,o,e,r,l,i,n,k,s))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ParameterProvider=b(require("jquery"),require("Slick"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ControllerService"),require("nf.ControllerServices"),require("nf.UniversalCapture"),require("nf.CustomUi"),require("nf.Verify"),require("nf.Processor"),require("nf.ProcessGroup"),require("nf.ParameterContexts"),require("nf.ProcessGroupConfiguration"),require("lodash")))}else{nf.ParameterProvider=b(a.$,a.Slick,a.nf.ErrorHandler,a.nf.Common,a.nf.CanvasUtils,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ControllerService,a.nf.ControllerServices,a.nf.UniversalCapture,a.nf.CustomUi,a.nf.Verify,a.nf.Processor,a.nf.ProcessGroup,a.nf.ParameterContexts,a.nf.ProcessGroupConfiguration,a._)}}}(this,function(al,v,T,N,I,S,n,B,M,G,F,V,g,H,a,af,A,L){var aq;var ai;var Z={edit:"edit",readOnly:"read-only",urls:{parameterProviders:"../nifi-api/parameter-providers",api:"../nifi-api"}};var X=Z.urls.api+"/flow/controller/controller-services";var au="SENSITIVE";var p="NON_SENSITIVE";var s={autosizeColsMode:v.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,editable:false,enableAddRow:false,autoEdit:false,multiSelect:false,rowHeight:24};var Q={autosizeColsMode:v.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,editable:false,enableAddRow:false,autoEdit:false,multiSelect:false,rowHeight:24,asyncEditorLoading:false};var x=null;var ah=function(){return al("#controller-services-table")};var ar=function(){var aw=al("#parameter-provider-configuration").data("parameterProviderDetails");if(al("#parameter-provider-name").val()!==aw.component.name){return true}if(al("#parameter-provider-comments").val()!==aw.component.comments){return true}return al("#parameter-provider-properties").propertytable("isSaveRequired")};var u=function(){var ax=al("#parameter-provider-properties").propertytable("marshalProperties");var ay={};ay.id=al("#parameter-provider-id").text();ay.name=al("#parameter-provider-name").val();ay.comments=al("#parameter-provider-comments").val();if(al.isEmptyObject(ax)===false){ay.properties=ax}var aw={};aw.component=ay;return aw};var Y=function(){var aw=[];var ax=al("#parameter-groups-table");var ay=ax.data("gridInstance");var az=ay.getData();al.each(az.getItems(),function(aA,aB){if(aB.isParameterContext||aB.createNewParameterContext){var aC={groupName:aB.name,parameterContextName:aB.parameterContextName,"synchronized":true,parameterSensitivities:aB.parameterSensitivities};aw.push(aC)}});return aw};var i=function(aB,aA,ax){var aC=aB.component;if(aC.name===""){S.showOkDialog({headerText:"Configuration Error",dialogContent:"The name of the Parameter Provider must be specified."});return false}var az=/^[a-zA-Z0-9-_. ]+$/;if(!az.test(aC.name)){S.showOkDialog({headerText:"Configuration Error",dialogContent:"The name of the Parameter Provider appears to have an invalid character or characters. Only alpha-numeric characters (a-z, A-Z, 0-9), hyphens (-), underscores (_), periods (.), and spaces ( ) are accepted."});return false}var ay;var aw;if(N.isUndefinedOrNull(ay)&&ax.component.name!==aB.component.name){al.each(aA,function(aD,aE){if(N.isUndefinedOrNull(aw)){aw=L.find(aE,{name:aC.name});if(aw){ay=aw}}})}if(L.isNil(ay)){return true}else{S.showOkDialog({headerText:"Parameter Provider Exists",dialogContent:"A Parameter Provider with this name already exists."})}return false};var b=function(ay){var az=al("#parameter-providers-table").data("gridInstance");var ax=az.getData();var aw=ax.getItemById(ay.id);ax.updateItem(ay.id,al.extend({type:"ParameterProvider",bulletins:aw.bulletins},ay))};var E=function(){return al.Deferred(function(aw){al("#parameter-provider-properties").propertytable("saveRow");if(ar()){S.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){aw.resolve()},yesHandler:function(){var ax=al("#parameter-provider-configuration").data("parameterProviderDetails");r(ax).done(function(){aw.resolve()}).fail(function(){aw.reject()})}})}else{aw.resolve()}}).promise()};var r=function(aw){var aA=aw;var ay=u();var ax=al("#parameter-providers-table").data("gridInstance");var az=ax.getData();if(i(ay,az.getItems(),aA)){ay.revision=B.getRevision(aw);ay.disconnectedNodeAcknowledged=n.isDisconnectionAcknowledged();return al.ajax({type:"PUT",data:JSON.stringify(ay),url:aw.uri,dataType:"json",contentType:"application/json"}).done(function(aB){b(aB)}).fail(T.handleConfigurationUpdateAjaxError)}else{return al.Deferred(function(aB){aB.reject()}).promise()}};var ao=function(ax,aw){var ay=al("#parameter-provider-configuration").data("parameterProviderDetails");return al.ajax({type:"GET",url:ay.uri+"/descriptors",data:{propertyName:ax,sensitive:aw},dataType:"json"}).fail(T.handleAjaxError)};var q=function(ay,az){x=az;var aw=al("#parameter-provider-properties-verification-results");if(aw.is(":visible")===false){al("#parameter-provider-properties").css("bottom","40%").propertytable("resetTableSize");aw.show()}var ax=al("#parameter-provider-properties-verification-results-listing");if(ax.get(0).scrollHeight>Math.round(ax.innerHeight())){ax.css("border-width","1px")}};var o=function(ax){var az=ax;var ay=al("#fetch-parameters-dialog");N.cleanUpTooltips(al("#parameter-table"),"div.fa-question-circle, div.fa-info");var aw=Y();az.component.parameterGroupConfigurations=aw;return al.Deferred(function(aA){var aD=function(){ay.modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){aA.resolve();ap("#fetch-parameters-dialog")}}}])};var aF=function(){ay.modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){o(az).done(function(){k.reload(ax.id)})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aA.resolve();at("#fetch-parameters-dialog")}}}])};var aB=false;ay.modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aB=true;aD()}}}]);var aE;var aC=function(aI,aG,aH){if(N.isDefinedAndNotNull(aE)){av(az.id,aE)}al("#fetch-parameters-update-steps").find("div.fetch-parameters-step.ajax-loading").removeClass("ajax-loading").addClass("ajax-error");if(al("#affected-referencing-components-container").is(":visible")){ae(al("#affected-referencing-components-container"))}aF()};R(az).done(function(aG){var aH=function(aN){var aM=aN.request;var aK=N.isDefinedAndNotNull(aM.failureReason);aE=aM.requestId;ad(aM.referencingComponents);aj(aM.updateSteps,aB,aK);if(aB){av(az.id,aE)}else{al("#fetch-parameters-update-status-container").show();if(aM.complete===true){if(aK){S.showOkDialog({headerText:"Apply Parameter Provider Error",dialogContent:"Unable to complete parameter provider update request: "+N.escapeHtml(aM.failureReason)})}al.each(aM.referencingComponents,function(aP,aR){if(aR.permissions.canRead===true){var aQ=aR.component;if(aQ.referenceType==="PROCESSOR"&&I.getGroupId()===aQ.processGroupId){H.reload(aQ.id)}}});if(al("#fetch-parameters-table").is(":visible")){var aO=al("#fetch-parameters-table").data("gridInstance");var aJ=aO.getData();al.extend(az,{revision:aN.parameterContextRevision,component:aN.request.parameterProvider});var aL=aJ.getItemById(az.id);if(N.isDefinedAndNotNull(aL)){aJ.updateItem(az.id,az)}}av(az.id,aE);aD();if(al("#affected-referencing-components-container").is(":visible")){ae(al("#affected-referencing-components-container"))}}else{setTimeout(function(){W(az.id,aE).done(function(aP){aH(aP)}).fail(aC)},2000)}}};var aI=[];al.each(aG.request.parameterProvider.parameterGroupConfigurations,function(aJ,aK){aI.push(aK.groupName)});al("#apply-groups-list").removeClass("unset").attr("title",aI.join(", ")).text(aI.join(", "));al("#fetch-parameters-usage-container").hide();al("#apply-groups-container").show();al("#parameters-container").hide();al("#fetch-parameters-update-status").show();aH(aG)}).fail(aC)}).promise()};var at=function(aw){S.showYesNoDialog({headerText:"Fetch Parameters",dialogContent:"Are you sure you want to cancel?",noText:"Cancel",yesText:"Yes",yesHandler:function(){ap(aw)}})};var h=function(aw,ax){ab(aw).done(function(az){var aF=L.cloneDeep(az);j=az;al("#fetch-parameters-id").text(aF.id);al("#fetch-parameters-name").text(N.getComponentName(aF));al('<div class="parameter-contexts-to-create"><span class="unset">None</span></div>').appendTo(al("#parameter-contexts-to-create-container"));var aE=al("#parameter-contexts-to-update-container").empty();if(!aF.component.referencingParameterContexts){al('<div class="parameter-contexts-to-update"><span class="unset">None</span></div>').appendTo(aE)}else{var ay=[];al.each(aF.component.referencingParameterContexts,function(aH,aG){ay.push(aG.component.name)});ay.sort();aE.removeClass("unset").attr("title",ay.join(", ")).text(ay.join(", "))}e(aF);var aA=ag(az);al("#fetch-parameters-permissions-parameter-contexts-message").addClass("hidden");al("#fetch-parameters-permissions-affected-components-message").addClass("hidden");al("#fetch-parameters-missing-context-name-message").addClass("hidden");al("#fetch-parameters-usage-container").show();al("#parameters-container").show();var aC=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){return c(aF,aA)},handler:{click:function(){o(aF).done(function(){k.reload(aw.id)})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){if(!c(aF,aA)){return at("#fetch-parameters-dialog")}ap("#fetch-parameters-dialog")}}}];if(ax.supportsStatusBar){var aB=N.getFormattedBulletins(aF.bulletins);var aD=N.formatUnorderedList(aB);if(aF.bulletins.length!==0){al("#fetch-parameters-status-bar").statusbar("observe",{provider:aD})}}al("#fetch-parameters-affected-referencing-components-container").hide();al("#fetch-parameters-referencing-components-container").show();al("#fetch-parameters-dialog").modal("setButtonModel",aC).modal("show");if(al("#fetched-parameters-listing-container").is(":visible")){ae(al("#fetched-parameters-listing-container"))}})};var c=function(ax,aD){var aM=function(aN){return aN.permissions.canRead&&aN.permissions.canWrite};if(ax.component.referencingParameterContexts){var aF=ax.component.referencingParameterContexts.every(aM);if(aF){al("#fetch-parameters-permissions-parameter-contexts-message").addClass("hidden")}else{al("#fetch-parameters-permissions-parameter-contexts-message").removeClass("hidden");return true}}if(ax.component.affectedComponents){var aL=ax.component.affectedComponents.every(aM);if(aL){al("#fetch-parameters-permissions-affected-components-message").addClass("hidden")}else{al("#fetch-parameters-permissions-affected-components-message").removeClass("hidden");return true}}var aC=al("#parameter-groups-table").data("gridInstance").getData();var az=aC.getItems();var ay=[];al.each(az,function(aN,aO){if(aO.createNewParameterContext){ay.push(aO.parameterContextName)}});var aH=function(aN){return N.isBlank(aN)};if(!L.isEmpty(ay)){var aK=ay.some(aH);if(aK){al("#fetch-parameters-missing-context-name-message").removeClass("hidden");return true}else{al("#fetch-parameters-missing-context-name-message").addClass("hidden")}}else{al("#fetch-parameters-missing-context-name-message").addClass("hidden")}for(var aE=0;aE<aD.length;aE++){var aI=az[aE];if(N.isDefinedAndNotNull(aI)){if(aI.isParameterContext&&N.isUndefinedOrNull(aI.createNewParameterContext)){var aB=aD[aE];var aG={};for(var aA in aB.parameterSensitivities){aG[aA]=aB.parameterSensitivities[aA]?aB.parameterSensitivities[aA]:au}if(!L.isEqual(aG,aI.parameterSensitivities)){return false}}}}if(ax.component.parameterStatus){var aw=function(aN){return aN.status!=="UNCHANGED"};var aJ=ax.component.parameterStatus.some(aw);if(aJ){return false}}return L.isEmpty(ay)};var e=function(aw){if(N.isDefinedAndNotNull(aw)){var aA=0;var ay=al("#parameter-groups-table").data("gridInstance");var az=ay.getData();az.beginUpdate();var ax=[];al.each(aw.component.parameterGroupConfigurations,function(aD,aE){var aG=aw.component.referencingParameterContexts?t(aw.component.referencingParameterContexts,aE.parameterContextName):false;var aB;if(aG){aB=aG.permissions.canWrite}else{aB=true}var aC;if(aw.component.affectedComponents){aC=(aw.component.affectedComponents).every(function(aH){return aH.permissions.canRead&&aH.permissions.canWrite})}else{aC=true}var aF={id:aA++,hidden:false,isParameterContext:aG?true:false,name:aE.groupName,parameterContextName:aE.parameterContextName,parameterSensitivities:aE.parameterSensitivities,referencingParameterContexts:aE.referencingParameterContexts?aE.referencingParameterContexts:null,enableParametersCheckboxes:aB&&aC,parameterStatus:aw.component.parameterStatus};ax.push({group:aF});az.addItem(aF)});az.endUpdate();az.reSort();if(!L.isEmpty(aw.component.parameterStatus)){al.each(aw.component.parameterStatus,function(aC,aB){if(aB.status!=="UNCHANGED"){var aD=az.getItems().find(function(aE){return aE.parameterContextName===aB.parameter.parameter.parameterContext.component.name});if(N.isDefinedAndNotNull(aD)){O(aD.parameterSensitivities,aD,true)}al("#fetch-parameters-dialog").modal("refreshButtons")}})}ay.setSelectedRows([0])}};var t=function(ay,ax){var aw=null;al.each(ay,function(aA,az){if(az.component.name.includes(ax)){aw=az}});return aw};var O=function(aA,aC,aH){if(N.isDefinedAndNotNull(aA)){var aK=al("#selectable-parameters-table").data("gridInstance");var aB=aK.getData();var az=al("#parameter-groups-table").data("gridInstance").getData();var aI=az.getItem([aC.id]);aK.setSelectedRows([]);aB.setItems([]);aB.beginUpdate();var aD=function(aN,aO){var aM=false;al.each(aN.component.parameterStatus,function(aQ,aP){if(aP.parameter.parameter.name===aO){if(aP.status==="CHANGED"){aM=true}}});return aM};var aw=function(aM,aN){return N.isDefinedAndNotNull(aM.find(function(aO){return aO.parameter.parameter.name===aN}))?aM.find(function(aO){return aO.parameter.parameter.name===aN}):[]};var aJ=function(aN,aO){var aM=aw(aN,aO);return !L.isEmpty(aM)&&aM.status};var ax=function(aN,aO){var aM=aw(aN,aO);return !L.isEmpty(aM)&&!L.isEmpty(aM.parameter.parameter.referencingComponents)};var aG=0;var aF=0;var aL=0;for(var ay in aA){var aE={id:aG++,groupId:aC.id,name:ay,sensitivity:aA[ay]?aA[ay]:au,isAffectedParameter:j.component.affectedComponents?aD(j,ay):false,isReferencingParameter:!L.isEmpty(aC.parameterStatus)?ax(aC.parameterStatus,ay):false,parameterStatus:!L.isEmpty(aC.parameterStatus)?aw(aC.parameterStatus,ay):[],status:!L.isEmpty(aC.parameterStatus)?aJ(aC.parameterStatus,ay):null};aL++;if(aE.isReferencingParameter===true){aF++}aB.addItem(aE);if(aH){aI.parameterSensitivities[ay]=aA[ay]?aA[ay]:au;az.updateItem(aC.id,aI)}}if(!L.isEmpty(aC.parameterStatus)){al.each(aC.parameterStatus,function(aN,aM){if(aI.name===aM.parameter.parameter.parameterContext.component.name&&(aM.status==="REMOVED"||aM.status==="MISSING_BUT_REFERENCED")){var aO={id:aG++,groupId:aC.id,name:aM.parameter.parameter.name,sensitivity:p,parameterStatus:aM,isReferencingParameter:aM.status==="MISSING_BUT_REFERENCED",status:aM.status};aB.addItem(aO);aL++}})}aB.endUpdate();aB.reSort();aK.setSelectedRows([0]);ac()}};var ad=function(ax){var aw=function(aE,aD){if(aE.hasClass("expanded")){aE.removeClass("expanded").addClass("collapsed");aD.hide()}else{aE.removeClass("collapsed").addClass("expanded");aD.show()}};al("#fetch-parameters-referencing-components-container").hide();al("#affected-referencing-components-container").show();ae(al("#affected-referencing-components-container"));al("#fetch-parameters-affected-referencing-components-container").show();var aA=[];var aB=[];var ay=[];var aC=al("#fetch-parameters-affected-referencing-components-container .referencing-components-loading");var az=al.Deferred(function(aD){aC.addClass("ajax-loading");aD.resolve()});az.then(function(){f()}).then(function(){var aE=al("#affected-referencing-components-container").empty();if(N.isUndefined(ax)){al('<div class="referencing-component-container"><span class="unset">Pending Apply</span></div>').appendTo(aE)}else{al.each(ax,function(aJ,aK){if(aK.permissions.canRead===true&&aK.permissions.canWrite===true){if(aK.component.referenceType==="PROCESSOR"){aA.push(aK)}else{aB.push(aK)}}else{ay.push(aK)}});var aI={};al.each(aA,function(aJ,aK){if(aI[aK.processGroup.id]){aI[aK.processGroup.id].referencingProcessors.push(aK);aI[aK.processGroup.id].id=aK.processGroup.id;aI[aK.processGroup.id].name=aK.processGroup.name}else{aI[aK.processGroup.id]={referencingProcessors:[],referencingControllerServices:[],unauthorizedReferencingComponents:[],name:aK.processGroup.name,id:aK.processGroup.id};aI[aK.processGroup.id].referencingProcessors.push(aK)}});al.each(aB,function(aJ,aK){if(aI[aK.processGroup.id]){aI[aK.processGroup.id].referencingControllerServices.push(aK);aI[aK.processGroup.id].id=aK.processGroup.id;aI[aK.processGroup.id].name=aK.processGroup.name}else{aI[aK.processGroup.id]={referencingProcessors:[],referencingControllerServices:[],unauthorizedReferencingComponents:[],name:aK.processGroup.name,id:aK.processGroup.id};aI[aK.processGroup.id].referencingControllerServices.push(aK)}});al.each(ay,function(aK,aJ){if(aI[aJ.processGroup.id]){aI[aJ.processGroup.id].unauthorizedReferencingComponents.push(aJ);aI[aJ.processGroup.id].id=aJ.processGroup.id;aI[aJ.processGroup.id].name=aJ.processGroup.name}else{aI[aJ.processGroup.id]={referencingProcessors:[],referencingControllerServices:[],unauthorizedReferencingComponents:[],name:aJ.processGroup.name,id:aJ.processGroup.id};aI[aJ.processGroup.id].unauthorizedReferencingComponents.push(aJ)}});var aE=al("#affected-referencing-components-container");var aD=al('<ul class="referencing-component-listing clear"></ul>');var aH=[];for(var aF in aI){if(aI.hasOwnProperty(aF)){aH.push(aI[aF])}}if(N.isEmpty(aH)){al('<div class="referencing-component-container"><span class="unset">None</span></div>').appendTo(aE)}else{var aG=aH.sort(function(aK,aJ){if(aK.name<aJ.name){return -1}if(aK.name>aJ.name){return 1}return 0});aG.forEach(function(aJ){var aK=al('<div class="referencing-component-references"></div>');aE.append(aK);var aL=function(aO,aQ){var aS=al('<div class="expansion-button collapsed"></div>');var aR=al('<span class="referencing-component-title"></span>').text(aO.name);var aP=al('<span class="referencing-component-count"></span>').text("("+(aO.referencingProcessors.length+aO.referencingControllerServices.length+aO.unauthorizedReferencingComponents.length)+")");var aM=al("#affected-referencing-components-template").clone();aM.removeAttr("id");aM.removeClass("hidden");var aN=al('<div class="referencing-component-block pointer unselectable"></div>').data("processGroupId",aO.id).on("click",function(){if(aS.hasClass("collapsed")){aN.append(aM);var aV=aN.find(".fetch-parameters-referencing-processors");N.cleanUpTooltips(aV,"div.referencing-component-state");N.cleanUpTooltips(aV,"div.referencing-component-bulletins");aV.empty();var aU=aN.find(".fetch-parameters-referencing-controller-services");N.cleanUpTooltips(aU,"div.referencing-component-state");N.cleanUpTooltips(aU,"div.referencing-component-bulletins");aU.empty();var aT=aN.find(".fetch-parameters-referencing-unauthorized-components").empty();if(aI[al(this).data("processGroupId")].referencingProcessors.length===0){al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aV)}else{aI[al(this).data("processGroupId")].referencingProcessors.sort(an);al.each(aI[al(this).data("processGroupId")].referencingProcessors,function(aW,aX){D(aX,aV)})}if(aI[al(this).data("processGroupId")].referencingControllerServices.length===0){al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aU)}else{aI[al(this).data("processGroupId")].referencingControllerServices.sort(an);al.each(aI[al(this).data("processGroupId")].referencingControllerServices,function(aW,aX){U(aX,aU)})}if(aI[al(this).data("processGroupId")].unauthorizedReferencingComponents.length===0){al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aT)}else{aI[al(this).data("processGroupId")].unauthorizedReferencingComponents.sort(function(aX,aW){if(aX.permissions.canRead===true&&aW.permissions.canRead===true){var aY=aX.component.referenceType===aW.component.referenceType?0:aX.component.referenceType>aW.component.referenceType?-1:1;if(aY===0){aY=aX.component.name===aW.component.name?0:aX.component.name>aW.component.name?1:-1}return aY}else{if(aX.permissions.canRead===false&&aW.permissions.canRead===false){return aX.id>aW.id?1:-1}else{if(aX.permissions.canRead===true){return -1}else{return 1}}}});al.each(aI[al(this).data("processGroupId")].unauthorizedReferencingComponents,function(aX,aW){if(aW.permissions.canRead===true){if(aW.component.referenceType==="PROCESSOR"){D(aW,aT)}else{U(aW,aT)}}else{var aY=al('<li class="referencing-component-container"></li>').appendTo(aT);al('<span class="fetch-parameters-referencing-component-name link ellipsis"></span>').prop("title",aW.id).text(aW.id).on("click",function(){al("#shell-dialog").modal("hide");if(aW.referenceType==="PROCESSOR"){I.showComponent(aW.processGroup.id,aW.id)}else{if(aW.referenceType==="CONTROLLER_SERVICE"){A.showConfiguration(aW.processGroup.id).done(function(){a.enterGroup(aW.processGroup.id);A.selectControllerService(aW.id)})}}}).appendTo(aY)}})}}else{aN.find(".affected-referencing-components-template").remove()}aw(aS,aQ);ae(al("#affected-referencing-components-container"))}).append(aS).append(aR).append(aP).appendTo(aK);aQ.appendTo(aK);aN.click()};aL(aJ,aD)})}}}).always(function(){aC.removeClass("ajax-loading")});return az.promise()};var P=function(az,ax){az.empty();var aC=ax;if(N.isEmpty(aC.referencingParameterContexts)){az.append('<div class="unset">No referencing components.</div>');return}var aw=function(aE,aD){if(aE.hasClass("expanded")){aE.removeClass("expanded").addClass("collapsed");aD.hide()}else{aE.removeClass("collapsed").addClass("expanded");aD.show()}};var aB=al('<ul class="referencing-component-listing clear"></ul>');var ay=al('<ul class="referencing-component-listing clear"></ul>');al.each(aC.referencingParameterContexts,function(aE,aI){if(aI.permissions.canRead===false){var aD=al('<div class="unset"></div>').text(aI.id);ay.append(aD)}else{var aH=aI.component;var aG=al('<span class="referencing-component-name link"></span>').text(aH.name).on("click",function(){af.showParameterContexts(aH.id);az.closest(".dialog").modal("hide");al("#shell-close-button").click()});var aF=al("<li></li>").append(aG);aB.append(aF)}});var aA=function(aD,aF){if(aF.is(":empty")){aF.remove();return}var aH=al('<div class="expansion-button expanded"></div>');var aG=al('<span class="referencing-component-title"></span>').text(aD);var aE=al('<span class="referencing-component-count"></span>').text("("+aF.children().length+")");al('<div class="referencing-component-block pointer unselectable"></div>').on("click",function(){aw(aH,aF);ae(az)}).append(aH).append(aG).append(aE).appendTo(az);aF.appendTo(az)};aA("Parameter Contexts",aB);aA("Unauthorized",ay)};var ac=function(){var ax=al("#parameter-contexts-to-create-container").empty();var aw=[];var ay=al("#parameter-groups-table").data("gridInstance");var az=ay.getData();al.each(az.getItems(),function(aA,aB){if(aB.createNewParameterContext){aw.push(aB.parameterContextName)}});if(aw.length===0){al('<div class="parameter-contexts-to-create"><span class="unset">None</span></div>').appendTo(ax)}else{aw.sort();ax.removeClass("unset").attr("title",aw.join(", ")).text(aw.join(", "))}};var ag=function(ax){var aw=[];al.each(ax.component.parameterGroupConfigurations,function(aB,aC){var aE=ax.component.referencingParameterContexts?t(ax.component.referencingParameterContexts,aC.parameterContextName):false;var ay;if(aE){ay=aE.permissions.canWrite}else{ay=true}var az;if(ax.component.affectedComponents){az=(ax.component.affectedComponents).every(function(aF){return aF.permissions.canRead&&aF.permissions.canWrite})}else{az=true}var aA=0;var aD={id:aA++,hidden:false,isParameterContext:aE?true:false,name:aC.groupName,parameterContextName:aC.parameterContextName,parameterSensitivities:aC.parameterSensitivities,referencingParameterContexts:aC.referencingParameterContexts?aC.referencingParameterContexts:null,enableParametersCheckboxes:ay&&az,parameterStatus:ax.component.parameterStatus};aw.push(aD)});return aw};var aa=function(){return al.Deferred(function(aw){if(al("#fetch-parameters-update-status").is(":visible")){close();aw.resolve()}else{var ax=Y();if(al.isEmptyObject(ax)){close();aw.resolve()}else{S.showYesNoDialog({headerText:"Fetch Parameters",dialogContent:"Save changes before leaving parameters configuration?",noHandler:function(){close();aw.resolve()},yesHandler:function(){o(j).done(function(){aw.resolve()}).fail(function(){aw.reject()})}})}}}).promise()};var ae=function(aw){var ax=aw.get(0).scrollHeight>Math.round(aw.innerHeight())||aw.get(0).scrollWidth>Math.round(aw.innerWidth());if(aw.is(":visible")&&ax){aw.css("border-width","1px")}else{aw.css("border-width","0px")}};var C=function(aw){if(aw.permissions.canRead===false||(aw.permissions.canWrite===false&&aw.operatePermissions.canWrite===false)){return true}var ay=false;var ax=aw.component.referencingComponents;al.each(ax,function(az,aA){if(C(aA)){ay=true;return false}});return ay};var ap=function(aw){al(aw).modal("hide")};var W=function(aw,ax){return al.ajax({type:"GET",url:Z.urls.parameterProviders+"/"+encodeURIComponent(aw)+"/apply-parameters-requests/"+encodeURIComponent(ax),dataType:"json"}).fail(T.handleAjaxError)};var av=function(aw,ax){return al.ajax({type:"DELETE",url:Z.urls.parameterProviders+"/"+encodeURIComponent(aw)+"/apply-parameters-requests/"+encodeURIComponent(ax)+"?"+al.param({disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged()}),dataType:"json"}).fail(T.handleAjaxError)};var R=function(ax){var aw={id:ax.id,revision:B.getRevision(ax),disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged(),parameterGroupConfigurations:ax.component.parameterGroupConfigurations};return al.ajax({type:"POST",data:JSON.stringify(aw),url:Z.urls.parameterProviders+"/"+encodeURIComponent(aw.id)+"/apply-parameters-requests",dataType:"json",contentType:"application/json"}).fail(T.handleAjaxError)};var ab=function(aw){return al.ajax({type:"POST",data:JSON.stringify(aw),url:Z.urls.parameterProviders+"/"+encodeURIComponent(aw.id)+"/parameters/fetch-requests?"+al.param({disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged()}),dataType:"json",contentType:"application/json"}).fail(T.handleAjaxError)};var aj=function(az,ay,ax){var aw=al("#fetch-parameters-update-steps").empty();al.each(az,function(aC,aB){var aA=al("<li></li>").text(aB.description).appendTo(aw);al('<div class="fetch-parameters-step"></div>').addClass(function(){if(N.isDefinedAndNotNull(aB.failureReason)){return"ajax-error"}else{if(aB.complete===true){return"ajax-complete"}else{return ay===true||ax===true?"ajax-error":"ajax-loading"}}}).appendTo(aA);al('<div class="clear"></div>').appendTo(aA)})};var J=function(aG){var aC=aG;var aB=aC.isParameterContext;var ay=aC.createNewParameterContext;al("#fetched-parameters-listing").empty();var aH=al("#parameter-groups-table").data("gridInstance");var ax=aH.getData();if(aB){O(aC.parameterSensitivities,aC,false);al("#parameters-container").show();al("#selectable-parameters-container").show();al("#fetched-parameters-container").hide()}else{al("#selectable-parameters-container").hide();al("#fetched-parameters-container").show()}if(Object.keys(aC.parameterSensitivities).length!==0){al("#create-parameter-context-checkbox-container").show();var aJ=al("#create-parameter-context-checkbox-container").empty();var aE;if(aB){aE=al('<div id="create-parameter-context-container" class="string-check-container setting" style="display:block;"></div>');al('<div class="setting"><div class="setting-name">Parameter Context Name</div><div class="setting-field"><div id="referencing-parameter-context-name">'+N.escapeHtml(aG.parameterContextName)+"</div></div>").appendTo(aE)}else{var aD=al('<div id="checkbox-container"></div>');if(ay){al('<div id="create-parameter-context-field" class="nf-checkbox checkbox-checked"></div>').appendTo(aD);O(aC.parameterSensitivities,aC,false);al("#parameters-container").show();al("#selectable-parameters-container").show();al("#fetched-parameters-container").hide()}else{al('<div id="create-parameter-context-field" class="nf-checkbox checkbox-unchecked"></div>').appendTo(aD);al("#selectable-parameters-container").hide();al("#fetched-parameters-container").show()}al('<div id="create-parameter-context-label" class="nf-checkbox-label ellipsis" title="create-parameter-context" style="text-overflow: ellipsis;">Create Parameter Context</div></div>').appendTo(aD);var aA=al('<div class="setting"></div>');al(aD).appendTo(aA);al(aA).appendTo(aJ);if(ay){aE=al('<div id="create-parameter-context-container" class="string-check-container setting" style="display:block;"></div>')}else{aE=al('<div id="create-parameter-context-container" class="string-check-container setting" style="display:none;"></div>')}al('<div class="setting"><div class="setting-name">Parameter Context Name</div><div class="setting-field required"><input id="create-parameter-context-input" type="text" name="parameter-context-name"/></div></div>').appendTo(aE)}aE.appendTo(aJ);var aw=aC.parameterContextName;al("#create-parameter-context-input").val(aw)}else{al("#create-parameter-context-checkbox-container").hide()}var az=al("#fetched-parameters-listing").empty();var aI=aC.parameterSensitivities;var aF=Object.keys(aI);if(aF.length>0){al.each(aF,function(aL,aM){var aK=al("<li></li>").text(aM);al('<div class="clear"></div>').appendTo(aK);aK.appendTo(az)})}else{al('<div><span class="unset">None</span></div>').appendTo(az)}ae(al("#fetched-parameters-listing-container"));ax.beginUpdate();al("#create-parameter-context-input").on("blur",function(){aC.parameterContextName=al("#create-parameter-context-input").val();ax.updateItem(aC.id,aC);ac();al("#fetch-parameters-dialog").modal("refreshButtons")});al("#create-parameter-context-field").off().on("change",function(aL,aK){if(aK.isChecked){aC.createNewParameterContext=true;O(aC.parameterSensitivities,aC,false);al("#fetched-parameters-container").hide();al("#create-parameter-context-container").show();al("#selectable-parameters-container").show();al("#fetch-parameters-dialog").modal("refreshButtons")}else{aC.createNewParameterContext=false;O(aC.parameterSensitivities,aC,false);al("#create-parameter-context-container").hide();al("#selectable-parameters-container").hide();al("#fetched-parameters-container").show();al("#fetch-parameters-dialog").modal("refreshButtons")}ax.updateItem(aC.id,aC)});ax.endUpdate();ax.reSort()};var w=function(){al("#fetch-parameters-affected-referencing-components-container").hide();al("#fetch-parameters-referencing-components-container").show();al("#fetch-parameters-permissions-parameter-contexts-message").addClass("hidden");al("#fetch-parameters-permissions-affected-components-message").addClass("hidden");al("#create-parameter-context-input").val("");var aw=al("#selectable-parameters-table .slick-column-name input");aw.removeAttr("checked");var az=al("#parameter-groups-table").data("gridInstance");var aA=az.getData();az.setSelectedRows([]);aA.setItems([]);var ax=al("#selectable-parameters-table").data("gridInstance");var ay=ax.getData();ax.setSelectedRows([]);ay.setItems([]);f();am=null;ak=null};var am=null;var ak=null;var d=function(aw,ay){var ax=function(aB,az){if(aB.isInherited===false&&az.isInherited===true){return -1}if(aB.isInherited===true&&az.isInherited===false){return 1}if(aw.columnId==="name"){var aA=L.get(aB,"["+aw.columnId+"]","");var aC=L.get(az,"["+aw.columnId+"]","");return aA===aC?0:aA>aC?1:-1}};ay.sort(ax,aw.sortAsc)};var an=function(ax,aw){return ax.component.name.localeCompare(aw.component.name)};var y=function(ax,aw){return ax.hidden===false};var z=function(az,aw){var ax=N.getFormattedBulletins(az);var ay=N.formatUnorderedList(ax);aw.addClass("has-bulletins").show().qtip(al.extend({},I.config.systemTooltipConfig,{content:ay}))};var l=function(ax){var aw=function(aE,aD){if(aE.hasClass("expanded")){aE.removeClass("expanded").addClass("collapsed");aD.hide()}else{aE.removeClass("collapsed").addClass("expanded");aD.show()}};var aA=[];var aB=[];var ay=[];var aC=al("#fetch-parameters-referencing-components-container .referencing-components-loading");var az=al.Deferred(function(aD){aC.addClass("ajax-loading");aD.resolve()});az.then(function(){f()}).then(function(){var aG=al("#fetch-parameter-referencing-components-container").empty();if(L.isEmpty(ax)){al('<div class="referencing-component-container"><span class="unset">None</span></div>').appendTo(aG)}else{al.each(ax.parameter.parameter.referencingComponents,function(aJ,aK){if(aK.permissions.canRead===true&&aK.permissions.canWrite===true){if(aK.component.referenceType==="PROCESSOR"){aA.push(aK)}else{aB.push(aK)}}else{ay.push(aK)}});var aI={};al.each(aA,function(aJ,aK){if(aI[aK.processGroup.id]){aI[aK.processGroup.id].referencingProcessors.push(aK);aI[aK.processGroup.id].id=aK.processGroup.id;aI[aK.processGroup.id].name=aK.processGroup.name}else{aI[aK.processGroup.id]={referencingProcessors:[],referencingControllerServices:[],unauthorizedReferencingComponents:[],name:aK.processGroup.name,id:aK.processGroup.id};aI[aK.processGroup.id].referencingProcessors.push(aK)}});al.each(aB,function(aJ,aK){if(aI[aK.processGroup.id]){aI[aK.processGroup.id].referencingControllerServices.push(aK);aI[aK.processGroup.id].id=aK.processGroup.id;aI[aK.processGroup.id].name=aK.processGroup.name}else{aI[aK.processGroup.id]={referencingProcessors:[],referencingControllerServices:[],unauthorizedReferencingComponents:[],name:aK.processGroup.name,id:aK.processGroup.id};aI[aK.processGroup.id].referencingControllerServices.push(aK)}});al.each(ay,function(aK,aJ){if(aI[aJ.processGroup.id]){aI[aJ.processGroup.id].unauthorizedReferencingComponents.push(aJ);aI[aJ.processGroup.id].id=aJ.processGroup.id;aI[aJ.processGroup.id].name=aJ.processGroup.name}else{aI[aJ.processGroup.id]={referencingProcessors:[],referencingControllerServices:[],unauthorizedReferencingComponents:[],name:aJ.processGroup.name,id:aJ.processGroup.id};aI[aJ.processGroup.id].unauthorizedReferencingComponents.push(aJ)}});var aG=al("#fetch-parameter-referencing-components-container");var aD=al('<ul class="referencing-component-listing clear"></ul>');var aH=[];for(var aE in aI){if(aI.hasOwnProperty(aE)){aH.push(aI[aE])}}if(N.isEmpty(aH)){al('<div class="referencing-component-container"><span class="unset">None</span></div>').appendTo(aG)}else{var aF=aH.sort(function(aK,aJ){if(aK.name<aJ.name){return -1}if(aK.name>aJ.name){return 1}return 0});aF.forEach(function(aJ){var aK=al('<div class="referencing-component-references"></div>');aG.append(aK);var aL=function(aO,aQ){var aS=al('<div class="expansion-button collapsed"></div>');var aR=al('<span class="referencing-component-title"></span>').text(aO.name);var aP=al('<span class="referencing-component-count"></span>').text("("+(aO.referencingProcessors.length+aO.referencingControllerServices.length+aO.unauthorizedReferencingComponents.length)+")");var aM=al("#fetch-parameters-referencing-components-template").clone();aM.removeAttr("id");aM.removeClass("hidden");var aN=al('<div class="referencing-component-block pointer unselectable"></div>').data("processGroupId",aO.id).on("click",function(){if(aS.hasClass("collapsed")){aN.append(aM);var aV=aN.find(".fetch-parameters-referencing-processors");N.cleanUpTooltips(aV,"div.referencing-component-state");N.cleanUpTooltips(aV,"div.referencing-component-bulletins");aV.empty();var aU=aN.find(".fetch-parameters-referencing-controller-services");N.cleanUpTooltips(aU,"div.referencing-component-state");N.cleanUpTooltips(aU,"div.referencing-component-bulletins");aU.empty();var aT=aN.find(".fetch-parameters-referencing-unauthorized-components").empty();if(aI[al(this).data("processGroupId")].referencingProcessors.length===0){al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aV)}else{aI[al(this).data("processGroupId")].referencingProcessors.sort(an);al.each(aI[al(this).data("processGroupId")].referencingProcessors,function(aW,aX){D(aX,aV)})}if(aI[al(this).data("processGroupId")].referencingControllerServices.length===0){al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aU)}else{aI[al(this).data("processGroupId")].referencingControllerServices.sort(an);al.each(aI[al(this).data("processGroupId")].referencingControllerServices,function(aW,aX){U(aX,aU)})}if(aI[al(this).data("processGroupId")].unauthorizedReferencingComponents.length===0){al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aT)}else{aI[al(this).data("processGroupId")].unauthorizedReferencingComponents.sort(function(aX,aW){if(aX.permissions.canRead===true&&aW.permissions.canRead===true){var aY=aX.component.referenceType===aW.component.referenceType?0:aX.component.referenceType>aW.component.referenceType?-1:1;if(aY===0){aY=aX.component.name===aW.component.name?0:aX.component.name>aW.component.name?1:-1}return aY}else{if(aX.permissions.canRead===false&&aW.permissions.canRead===false){return aX.id>aW.id?1:-1}else{if(aX.permissions.canRead===true){return -1}else{return 1}}}});al.each(aI[al(this).data("processGroupId")].unauthorizedReferencingComponents,function(aX,aW){if(aW.permissions.canRead===true){if(aW.component.referenceType==="PROCESSOR"){D(aW,aT)}else{U(aW,aT)}}else{var aY=al('<li class="referencing-component-container"></li>').appendTo(aT);al('<span class="fetch-parameter-referencing-component-name link ellipsis"></span>').prop("title",aW.id).text(aW.id).on("click",function(){aa().done(function(){al("#shell-dialog").modal("hide");if(aW.referenceType==="PROCESSOR"){I.showComponent(aW.processGroup.id,aW.id)}else{if(aW.referenceType==="CONTROLLER_SERVICE"){A.showConfiguration(aW.processGroup.id).done(function(){a.enterGroup(aW.processGroup.id);A.selectControllerService(aW.id)})}}})}).appendTo(aY)}})}}else{aN.find(".fetch-parameters-referencing-components-template").remove()}aw(aS,aQ);ae(al("#fetch-parameter-referencing-components-container"))}).append(aS).append(aR).append(aP).appendTo(aK);aQ.appendTo(aK);aN.click()};aL(aJ,aD)})}}}).always(function(){aC.removeClass("ajax-loading")});return az.promise()};var D=function(aA,ax){var aw=al('<li class="referencing-component-container"></li>').appendTo(ax);var az=aA.component;al('<div class="referencing-component-state"></div>').addClass(function(){if(N.isDefinedAndNotNull(az.state)){var aB=al(this);var aD=az.state.toLowerCase();if(aD==="stopped"&&!N.isEmpty(az.validationErrors)){aD="invalid";var aC=N.formatUnorderedList(az.validationErrors);aB.qtip(al.extend({},I.config.systemTooltipConfig,{content:aC}))}return aD}else{return""}}).appendTo(aw);al('<span class="parameter-provider-referencing-component-name link ellipsis"></span>').prop("title",az.name).text(az.name).on("click",function(){al("#shell-dialog").modal("hide");I.showComponent(aA.processGroup.id,az.id);al("#fetch-parameters-dialog").modal("hide")}).appendTo(aw);var ay=al('<div class="referencing-component-bulletins"></div>').addClass(az.id+"-referencing-bulletins");ay.appendTo(aw);if(!N.isEmpty(aA.bulletins)){z(aA.bulletins,ay)}al('<span class="referencing-component-active-thread-count"></span>').text(function(){if(N.isDefinedAndNotNull(az.activeThreadCount)&&az.activeThreadCount>0){return"("+az.activeThreadCount+")"}else{return""}}).appendTo(aw)};var U=function(az,aw){var aA=al('<li class="referencing-component-container"></li>').appendTo(aw);var ax=az.component;al('<div class="referencing-component-state"></div>').addClass(function(){if(N.isDefinedAndNotNull(ax.state)){var aB=al(this);var aD=ax.state==="ENABLED"?"enabled":"disabled";if(aD==="disabled"&&!N.isEmpty(ax.validationErrors)){aD="invalid";var aC=N.formatUnorderedList(ax.validationErrors);aB.qtip(al.extend({},I.config.systemTooltipConfig,{content:aC}))}return aD}else{return""}}).appendTo(aA);var ay=al('<div class="referencing-component-bulletins"></div>').addClass(ax.id+"-referencing-bulletins").appendTo(aA);if(!N.isEmpty(az.bulletins)){z(az.bulletins,ay)}al('<span class="parameter-provider-referencing-component-name link ellipsis"></span>').prop("title",ax.name).text(ax.name).on("click",function(){al("#shell-dialog").modal("hide");a.enterGroup(ax.processGroupId);A.showConfiguration(ax.processGroupId).done(function(){A.selectControllerService(ax.id);al("#fetch-parameters-dialog").modal("hide")})}).appendTo(aA)};var K=function(){var aD=al("#selectable-parameters-table");var aC=function(aN,aM,aL,aJ,aG){var aK=10;var aF=al("<div></div>");var aI=al("<span/>").addClass("table-cell").text(aL).appendTo(aF);if(aG.type==="required"){aI.addClass("required")}if(aG.isAffectedParameter||(N.isDefinedAndNotNull(aG.parameterStatus.status)&&aG.parameterStatus.status!=="UNCHANGED")){aK+=30;var aH=N.escapeHtml(aG.parameterStatus.status.toLowerCase());al('<div class="fa fa-asterisk '+aH+'" alt="Info" style="float: right;"></div>').appendTo(aF)}if(aG.isReferencingParameter){aK+=30;al('<div class="fa fa-hashtag" alt="Info" style="float: right;"></div>').appendTo(aF)}aI.width(aJ.width-aK).ellipsis();return aF.html()};var ay=function(aJ,aG,aI,aH,aF){if(aF){if(aF.status==="REMOVED"||aF.status==="MISSING_BUT_REFERENCED"){return'<div class="disabled nf-checkbox checkbox-unchecked"></div>'}if(L.isEmpty(aF.parameterStatus)||L.isEmpty(aF.parameterStatus.parameter.parameter.referencingComponents)){if(aF.sensitivity===au){return'<div class="checked-input-enabled nf-checkbox checkbox-checked"></div>'}else{return'<div class="unchecked-input-enabled nf-checkbox checkbox-unchecked"></div>'}}if(!L.isEmpty(aF.parameterStatus.parameter.parameter.referencingComponents)){if(aF.sensitivity===au){return'<div class="disabled nf-checkbox checkbox-checked"></div>'}else{return'<div class="disabled nf-checkbox checkbox-unchecked"></div>'}}al("#fetch-parameters-dialog").modal("refreshButtons")}return null};var ax=[];var aw={id:"name",name:"Parameter Name",field:"name",formatter:aC,sortable:true,resizable:false,rerenderOnResize:true,width:280,minWidth:280,editor:v.Editors.Text};var aA={id:"selector",field:"sel",width:30,resizable:false,sortable:false,cssClass:"slick-cell-checkbox slick-cell-checkboxsel",hideSelectAllCheckbox:false,formatter:ay};ax.push(aA);ax.push(aw);var az=new v.Data.DataView({inlineFilters:false});d({columnId:"name",sortAsc:true},az);var aE=new v.Grid(aD,az,ax,Q);aE.setSelectionModel(new v.RowSelectionModel());aE.registerPlugin(new v.AutoTooltips());aE.setSortColumn("name",true);aE.onSort.subscribe(function(aG,aF){N.cleanUpTooltips(al("#selectable-parameters-table"),"div.fa-asterisk");N.cleanUpTooltips(al("#selectable-parameters-table"),"div.fa-hashtag");d({columnId:aF.sortCol.id,sortAsc:aF.sortAsc},az)});aE.onClick.subscribe(function(aL,aG){var aK=al(aL.target);var aI=az.getItem(aG.row);var aF=false;if(aE.getColumns()[aG.cell].id==="selector"){if(aK.hasClass("unchecked-input-enabled")){aF=true;aI.sensitivity=au;az.updateItem(aI.id,aI)}else{if(aK.hasClass("checked-input-enabled")){aF=true;aI.sensitivity=p;az.updateItem(aI.id,aI)}}if(aF){var aJ=al("#parameter-groups-table").data("gridInstance");var aM=aJ.getData();var aH=aM.getItem([aI.groupId]);aH.parameterSensitivities[aI.name]=aI.sensitivity;aM.updateItem(aI.groupId,aH);al("#fetch-parameters-dialog").modal("refreshButtons")}}});aE.onSelectedRowsChanged.subscribe(function(aH,aG){if(al.isArray(aG.rows)&&aG.rows.length===1){if(aE.getDataLength()>0){var aF=aG.rows[0];var aI=aE.getDataItem(aF);if(ak===null||ak!==aI.id){if(al("#selectable-parameters-table").is(":visible")){l(aI.parameterStatus).then(function(){ae(al("#fetch-parameter-referencing-components-container"));ak=aI.id})}}}}al("#fetch-parameters-dialog").modal("refreshButtons")});az.onRowCountChanged.subscribe(function(aL,aG){var aH=aG.dataView.getItems();if(!L.isEmpty(aH)){var aK=al("#parameter-groups-table").data("gridInstance");var aM=aK.getData();var aF=aH[0].groupId;var aJ=aM.getItem([aF]);if(!aJ.isParameterContext){var aI={};al.each(aH,function(aN,aO){aI[aO.name]=aO.sensitivity});aJ.parameterSensitivities=aI;aM.updateItems(aF,aJ)}}aE.updateRowCount();aE.render()});az.onRowsChanged.subscribe(function(aG,aF){aE.invalidateRows(aF.rows);aE.render()});az.syncGridSelection(aE,true);aD.data("gridInstance",aE).on("mouseenter","div.slick-cell",function(aI){var aH=al(this).find("div.fa-asterisk");if(aH.length&&!aH.data("qtip")){var aG="";if(aH.hasClass("new")){aG=N.escapeHtml("Newly discovered parameter.")}else{if(aH.hasClass("changed")){aG=N.escapeHtml("Value has changed.")}else{if(aH.hasClass("removed")){aG=N.escapeHtml("Parameter has been removed from its source. Apply to remove from the synced parameter context.")}else{if(aH.hasClass("missing_but_referenced")){aG=N.escapeHtml("Parameter has been removed from its source and is still being referenced in a component. To remove the parameter from the parameter context, first un-reference the parameter, then re-fetch and apply.")}}}}aH.qtip(al.extend({},N.config.tooltipConfig,{content:aG}))}var aF=al(this).find("div.fa-hashtag");if(aF.length&&!aF.data("qtip")){var aJ=N.escapeHtml("This parameter is currently referenced by a property. The sensitivity cannot be changed.");aF.qtip(al.extend({},N.config.tooltipConfig,{content:aJ}))}});var aB=function(aH){var aF=aH==="select"?au:p;var aL=[];al.each(az.getItems(),function(aM,aN){if(!aN.isReferencingParameter){aL.push(aN)}});if(!L.isEmpty(aL)){var aJ=al("#parameter-groups-table").data("gridInstance");var aK=aJ.getData();var aG=aJ.getSelectedRows();var aI=aK.getItem(aG);aK.beginUpdate();al.each(aL,function(aN,aO){var aM=al.extend(aO,{sensitivity:aF});az.updateItem(aO.id,aM);aI.parameterSensitivities[aO.name]=aF});aK.endUpdate();al("#fetch-parameters-dialog").modal("refreshButtons")}};al("#select-all-fetched-parameters").on("click",function(){aB("select")});al("#deselect-all-fetched-parameters").on("click",function(){aB("deselect")})};var m=function(){var az=al("#parameter-groups-table");var ax=function(aI,aC,aG,aD,aB){var aH=30;var aE=al("<div></div>");var aF=al("<span/>").addClass("table-cell").text(aG).appendTo(aE);if(aB.type==="required"){aF.addClass("required")}if(aB.isParameterContext||aB.createNewParameterContext){al('<div class="fa fa-star" alt="Info" style="float: right;"></div>').appendTo(aE)}aF.width(aD.width-aH).ellipsis();return aE.html()};var aw=[{id:"name",name:"Parameter Group Name",field:"name",formatter:ax,sortable:true,resizable:true,rerenderOnResize:true,width:327,minWidth:327,maxWidth:327}];var aA=new v.Data.DataView({inlineFilters:false});aA.setFilterArgs({searchString:"",property:"hidden"});aA.setFilter(y);d({columnId:"name",sortAsc:true},aA);var ay=new v.Grid(az,aA,aw,s);ay.setSelectionModel(new v.RowSelectionModel());ay.registerPlugin(new v.AutoTooltips());ay.setSortColumn("name",true);ay.onSort.subscribe(function(aC,aB){N.cleanUpTooltips(al("#parameter-groups-table"),"div.fa-star");d({columnId:aB.sortCol.id,sortAsc:aB.sortAsc},aA)});ay.onSelectedRowsChanged.subscribe(function(aG,aB){N.cleanUpTooltips(al("#selectable-parameters-table"),"div.fa-asterisk");N.cleanUpTooltips(al("#selectable-parameters-table"),"div.fa-hashtag");if(al.isArray(aB.rows)&&aB.rows.length===1){if(ay.getDataLength()>0){var aE=aB.rows[0];var aF=ay.getDataItem(aE);if(am===null||am!==aF.id){J(aF);am=aF.id;var aC=al("#selectable-parameters-table").data("gridInstance");var aD=aC.getSelectedRows()[0];var aH=aC.getData().getItem(aD);if(aH&&aF.isParameterContext){l(aH.parameterStatus).then(function(){ae(al("#fetch-parameter-referencing-components-container"))})}else{l({}).then(function(){ae(al("#fetch-parameter-referencing-components-container"))})}}}}});ay.onBeforeCellEditorDestroy.subscribe(function(aC,aB){setTimeout(function(){ay.resizeCanvas()},50)});aA.onRowCountChanged.subscribe(function(aC,aB){ay.updateRowCount();ay.render()});aA.onRowsChanged.subscribe(function(aC,aB){ay.invalidateRows(aB.rows);ay.render()});aA.syncGridSelection(ay,true);az.data("gridInstance",ay).on("mouseenter","div.slick-cell",function(aD){var aB=al(this).find("div.fa-star");if(aB.length&&!aB.data("qtip")){var aC=N.escapeHtml("Synced to a parameter context.");aB.qtip(al.extend({},N.config.tooltipConfig,{content:aC}))}})};var f=function(){var ax=al("#fetch-parameter-referencing-components-container .referencing-component-references");ax.empty();var aw=al("#fetch-parameter-referencing-components-container");var aA=al(".fetch-parameters-referencing-processors");N.cleanUpTooltips(aA,"div.referencing-component-state");N.cleanUpTooltips(aA,"div.referencing-component-bulletins");aA.empty();var az=al(".fetch-parameters-referencing-controller-services");N.cleanUpTooltips(az,"div.referencing-component-state");N.cleanUpTooltips(az,"div.referencing-component-bulletins");az.empty();var ay=al(".fetch-parameters-referencing-unauthorized-components").empty();al("#affected-referencing-components-container").empty();am=null;ak=null;al('<div class="referencing-component-container"><span class="unset">None</span></div>').appendTo(aw);al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(aA);al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(az);al('<li class="referencing-component-container"><span class="unset">None</span></li>').appendTo(ay)};var j=null;var k={init:function(aw){aq=aw.nfSettings;ai=aw.statusBarOptions;al("#parameter-provider-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"parameter-provider-standard-settings-tab-content"},{name:"Properties",tabContentId:"parameter-provider-properties-tab-content"},{name:"Comments",tabContentId:"parameter-provider-comments-tab-content"}],select:function(){F.removeAllPropertyDetailDialogs();if(al(this).text()==="Properties"){al("#parameter-provider-properties").propertytable("resetTableSize")}al("#parameter-provider-properties").propertytable("saveRow")}});al("#parameter-provider-configuration").data("mode",Z.edit).modal({scrollableContentStyle:"scrollable",headerText:"Configure Parameter Provider",handler:{close:function(){al("#parameter-provider-properties").propertytable("cancelEdit");al("#parameter-provider-properties").propertytable("clear");N.clearField("read-only-parameter-provider-comments");al("#parameter-provider-configuration").removeData("parameterProviderDetails");al("#parameter-provider-properties-verification-results").hide();al("#parameter-provider-properties-verification-results-listing").css("border-width","0").empty();al("#parameter-provider-properties").css("bottom","0");al("#parameter-provider-properties-verification-results").hide();al("#parameter-provider-properties-verification-results-listing").css("border-width","0").empty();al("#parameter-provider-properties").css("bottom","0");x=null},open:function(){N.toggleScrollable(al("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});if(ai){al("#fetch-parameters-status-bar").statusbar("provider")}al("#parameter-provider-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-parameter-provider-property-container",descriptorDeferred:ao,controllerServiceCreatedDeferred:function(ax){return G.loadControllerServices(X,al("#controller-services-table"))},goToServiceDeferred:E});al("#fetch-parameters-dialog").modal({headerText:"Fetch Parameters",scrollableContentStyle:"scrollable",handler:{close:function(){al("#fetch-parameters-update-status-container").hide();al("#apply-groups-container").hide();al("#fetch-parameters-id").text("");al("#fetch-parameters-name").text("");al("#fetched-parameters-listing").empty();al("#fetch-parameters-update-steps").empty();al("#parameter-contexts-to-create-container").empty();N.cleanUpTooltips(al("#parameter-groups-table"),"div.fa-star");N.cleanUpTooltips(al("#selectable-parameters-table"),"div.fa-asterisk");N.cleanUpTooltips(al("#selectable-parameters-table"),"div.fa-hashtag");al("div.parameter-contexts-to-update").removeClass("ajax-loading ajax-complete ajax-error");if(ai){al("#fetch-parameters-status-bar").statusbar("disconnect")}w()}}});m();K();al(window).on("resize",function(ax){if(al("#affected-referencing-components-container").is(":visible")){ae(al("#affected-referencing-components-container"))}if(al("#fetch-parameter-referencing-components-container").is(":visible")){ae(al("#fetch-parameter-referencing-components-container"))}})},showConfiguration:function(ax){var ay=al("#parameter-provider-configuration");ay.find(".dialog-header .dialog-header-text").text("Configure Parameter Provider");if(ay.data("mode")===Z.readOnly){al("#parameter-provider-configuration .parameter-provider-read-only").hide();al("#parameter-provider-configuration .parameter-provider-editable").show();al("#parameter-provider-properties").propertytable("destroy").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-parameter-provider-property-container",descriptorDeferred:ao,controllerServiceCreatedDeferred:function(aA){return G.loadControllerServices(X,al("#controller-services-table"))},goToServiceDeferred:E});ay.data("mode",Z.edit)}var az=al.ajax({type:"GET",url:ax.uri,dataType:"json"});var aw=al.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(ax.id),dataType:"json"});al.when(az,aw).done(function(aC,aB){ax=aC[0];j=ax;var aE=ax.component;var aA=aB[0].componentHistory;al("#parameter-provider-configuration").data("parameterProviderDetails",ax);N.populateField("parameter-provider-id",aE.id);N.populateField("parameter-provider-type",N.formatType(aE));al("#parameter-provider-configuration").modal("setSubtitle",N.formatType(aE));N.populateField("parameter-provider-bundle",N.formatBundle(aE.bundle));al("#parameter-provider-name").val(aE.name);al("#parameter-provider-comments").val(aE.comments);P(al("#parameter-provider-referencing-components"),aE);var aD=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){al("#parameter-provider-properties").propertytable("saveRow");r(ax).done(function(aF){M.reloadReferencedServices(ah(),aF.component);ap("#parameter-provider-configuration")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ap("#parameter-provider-configuration")}}}];if(N.isDefinedAndNotNull(aE.customUiUrl)&&aE.customUiUrl!==""){aD.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var aF=function(){ap("#parameter-provider-configuration");al("#shell-close-button").click();V.showCustomUi(ax,aE.customUiUrl,true).done(function(){k.reload(ax.id).done(function(aG){M.reloadReferencedServices(ah(),aG.parameterProvider)});aq.showSettings()})};al("#parameter-provider-properties").propertytable("saveRow");if(ar()){S.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:aF,yesHandler:function(){r(ax).done(function(){aF()})}})}else{aF()}}}})}al("#parameter-provider-configuration").modal("setButtonModel",aD);al("#parameter-provider-properties").propertytable("setGroupId",null).propertytable("loadProperties",aE.properties,aE.descriptors,aA.propertyHistory).propertytable("setPropertyVerificationCallback",function(aF){g.verify(aE.id,ax.uri,aF,x,q,al("#parameter-provider-properties-verification-results-listing"))});al("#parameter-provider-configuration").modal("show");al("#parameter-provider-properties").propertytable("resetTableSize")}).fail(T.handleAjaxError)},showDetails:function(ax){var ay=al("#parameter-provider-configuration");ay.find(".dialog-header .dialog-header-text").text("Parameter Provider Details");if(ay.data("mode")===Z.edit){al("#parameter-provider-configuration .parameter-provider-read-only").show();al("#parameter-provider-configuration .parameter-provider-editable").hide();al("#parameter-provider-properties").propertytable("destroy").propertytable({supportsGoTo:true,readOnly:true});ay.data("mode",Z.readOnly)}var az=al.ajax({type:"GET",url:ax.uri,dataType:"json"});var aw=al.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(ax.id),dataType:"json"});al.when(az,aw).done(function(aC,aB){ax=aC[0];var aE=ax.component;var aA=aB[0].componentHistory;N.populateField("parameter-provider-id",aE.id);N.populateField("parameter-provider-type",N.substringAfterLast(aE.type,"."));N.populateField("parameter-provider-bundle",N.formatBundle(aE.bundle));N.populateField("read-only-parameter-provider-name",aE.name);N.populateField("read-only-parameter-provider-comments",aE.comments);P(al("#parameter-provider-referencing-components"),aE);var aD=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){ap("#parameter-provider-configuration")}}}];if(N.isDefinedAndNotNull(V)&&N.isDefinedAndNotNull(aE.customUiUrl)&&aE.customUiUrl!==""){aD.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ap("#parameter-provider-configuration");al("#shell-close-button").click();V.showCustomUi(ax,aE.customUiUrl,false).done(function(){aq.showSettings()})}}})}ay.modal("setButtonModel",aD).modal("show");al("#parameter-provider-properties").propertytable("setGroupId",null).propertytable("loadProperties",aE.properties,aE.descriptors,aA.propertyHistory);ay.modal("show");al("#parameter-provider-properties").propertytable("resetTableSize")})},showFetchDialog:function(aw){h(aw,ai)},reload:function(az){var ay=al("#parameter-providers-table").data("gridInstance");var aw=ay.getData();var ax=aw.getItemById(az);return al.ajax({type:"GET",url:ax.uri,dataType:"json"}).done(function(aA){b(aA)}).fail(T.handleAjaxError)},promptToDeleteParameterProvider:function(aw){S.showYesNoDialog({headerText:"Delete Parameter Provider",dialogContent:"Delete parameter provider '"+N.escapeHtml(aw.component.name)+"'?",yesHandler:function(){k.remove(aw)}})},remove:function(aw){var ax=B.getRevision(aw);al.ajax({type:"DELETE",url:aw.uri+"?"+al.param({version:ax.version,clientId:ax.clientId,disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(az){var aA=al("#parameter-providers-table").data("gridInstance");var ay=aA.getData();ay.deleteItem(aw.id)}).fail(T.handleAjaxError)},showParameterProvider:function(aw){aq.showSettings().done(function(){var ay=al("#parameter-providers-table").data("gridInstance");var ax=ay.getData();var az=ax.getRowById(aw);ay.setSelectedRows([az]);ay.scrollRowIntoView(az);al("#settings-tabs").find("li:eq(4)").click();aq.resetTableSize()})}};return k}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","d3","nf.Client","nf.Dialog","nf.Storage","nf.Common","nf.CanvasUtils","nf.ControllerServices","nf.ErrorHandler","nf.FilteredDialogCommon","nf.ReportingTask","nf.FlowAnalysisRule","nf.Shell","nf.ComponentState","nf.ComponentVersion","nf.PolicyManagement","nf.ParameterProvider"],function(h,o,r,t,m,i,l,n,e,k,g,s,d,q,c,f,p,j){return(nf.Settings=b(h,o,r,t,m,i,l,n,e,k,g,s,d,q,c,f,p,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Settings=b(require("jquery"),require("Slick"),require("d3"),require("nf.Client"),require("nf.Dialog"),require("nf.Storage"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ControllerServices"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.ReportingTask"),require("nf.FlowAnalysisRule"),require("nf.Shell"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.PolicyManagement"),require("nf.ParameterProvider")))}else{nf.Settings=b(a.$,a.Slick,a.d3,a.nf.Client,a.nf.Dialog,a.nf.Storage,a.nf.Common,a.nf.CanvasUtils,a.nf.ControllerServices,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.ReportingTask,a.nf.FlowAnalysisRule,a.nf.Shell,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.PolicyManagement,a.nf.ParameterProvider)}}}(this,function(aq,z,Q,E,Y,s,R,K,G,Z,w,ab,at,o,aB,V,L,r){var ac={urls:{api:"../nifi-api",controllerConfig:"../nifi-api/controller/config",reportingTaskTypes:"../nifi-api/flow/reporting-task-types",createReportingTask:"../nifi-api/controller/reporting-tasks",reportingTasks:"../nifi-api/flow/reporting-tasks",flowAnalysisRuleTypes:"../nifi-api/flow/flow-analysis-rule-types",createFlowAnalysisRule:"../nifi-api/controller/flow-analysis-rules",flowAnalysisRules:"../nifi-api/controller/flow-analysis-rules",registries:"../nifi-api/controller/registry-clients",createParameterProvider:"../nifi-api/controller/parameter-providers",parameterProviderTypes:"../nifi-api/flow/parameter-provider-types",parameterProviders:"../nifi-api/flow/parameter-providers",registryTypes:"../nifi-api/controller/registry-types",currentUser:"../nifi-api/flow/current-user"}};var p={autosizeColsMode:z.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var ak=function(){return aq("#controller-services-table")};var aA=function(aD){var aC=[];if(R.isDefinedAndNotNull(aD.maxTimerDrivenThreadCount)&&!aq.isNumeric(aD.maxTimerDrivenThreadCount)){aC.push("Maximum Timer Driven Thread Count must be an integer value")}if(aC.length>0){Y.showOkDialog({dialogContent:R.formatUnorderedList(aC),headerText:"Configuration Error"});return false}else{return true}};var N=function(aC){var aE=u();if(aA(aE)){var aD={revision:E.getRevision({revision:{version:aC}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:aE};aq.ajax({type:"PUT",url:ac.urls.controllerConfig,data:JSON.stringify(aD),dataType:"json",contentType:"application/json"}).done(function(aF){Y.showOkDialog({headerText:"Settings",dialogContent:"Settings successfully applied."});aq("#settings-save").off("click").on("click",function(){N(aF.revision.version)})}).fail(Z.handleConfigurationUpdateAjaxError)}};var j=function(){};var u=function(){var aC={};aC.maxTimerDrivenThreadCount=aq("#maximum-timer-driven-thread-count-field").val();return aC};var M=function(aE,aD){if(aD.searchString===""){return true}try{var aH=new RegExp(aD.searchString,"i")}catch(aG){return false}var aF=aE.label.search(aH)>=0;var aC=aE.tags.search(aH)>=0;return aF||aC};var B=function(aE,aC){var aD=[];aq.each(aE,function(aH,aI){aD.push(aI)});var aF=aC.toLowerCase();var aG=true;aq.each(aD,function(aH,aI){if(aF.indexOf(aI)===-1){aG=false;return false}});return aG};var i=function(aC){return aC.restricted===false||R.canAccessComponentRestrictions(aC.explicitRestrictions)};var P=function(aG,aD,aF,aE,aC){if(!aC.permissions.canRead){return'<span class="blank">'+R.escapeHtml(aC.id)+"</span>"}return R.escapeHtml(aC.component.name)};var I=function(aC,aE){var aD=function(aM,aL){if(aM.permissions.canRead&&aL.permissions.canRead){if(aC.columnId==="moreDetails"){var aI=0;if(!R.isEmpty(aM.bulletins)){aI=aM.bulletins.length}var aF=0;if(!R.isEmpty(aL.bulletins)){aF=aL.bulletins.length}return aI-aF}else{if(aC.columnId==="type"){var aJ=R.isDefinedAndNotNull(aM.component[aC.columnId])?R.substringAfterLast(aM.component[aC.columnId],"."):"";var aH=R.isDefinedAndNotNull(aL.component[aC.columnId])?R.substringAfterLast(aL.component[aC.columnId],"."):"";return aJ===aH?0:aJ>aH?1:-1}else{if(aC.columnId==="state"){var aK;if(aM.component.validationStatus==="VALIDATING"){aK="Validating"}else{if(aM.component.validationStatus==="INVALID"){aK="Invalid"}else{aK=R.isDefinedAndNotNull(aM.component[aC.columnId])?aM.component[aC.columnId]:""}}var aO;if(aL.component.validationStatus==="VALIDATING"){aO="Validating"}else{if(aL.component.validationStatus==="INVALID"){aO="Invalid"}else{aO=R.isDefinedAndNotNull(aL.component[aC.columnId])?aL.component[aC.columnId]:""}}return aK===aO?0:aK>aO?1:-1}else{var aG=R.isDefinedAndNotNull(aM.component[aC.columnId])?aM.component[aC.columnId]:"";var aN=R.isDefinedAndNotNull(aL.component[aC.columnId])?aL.component[aC.columnId]:"";return aG===aN?0:aG>aN?1:-1}}}}else{if(!aM.permissions.canRead&&!aL.permissions.canRead){return 0}if(aM.permissions.canRead){return 1}else{return -1}}};aE.sort(aD,aC.sortAsc)};var c=function(){return aq("#reporting-task-type-filter").val()};var y=function(){return aq("#parameter-provider-type-filter").val()};var d=function(){var aD=aq("#reporting-task-types-table").data("gridInstance");if(R.isDefinedAndNotNull(aD)){var aC=aD.getData();aC.setFilterArgs({searchString:c()});aC.refresh();aq("#new-reporting-task-dialog").modal("refreshButtons");if(aC.getLength()>0){w.choseFirstRow(aD)}}};var k=function(){var aD=aq("#parameter-provider-types-table").data("gridInstance");if(R.isDefinedAndNotNull(aD)){var aC=aD.getData();aC.setFilterArgs({searchString:y()});aC.refresh();aq("#new-parameter-provider-dialog").modal("refreshButtons");if(aC.getLength()>0){w.choseFirstRow(aD)}}};var ax=function(){aq("#reporting-task-type-description").attr("title","").text("");aq("#reporting-task-type-name").attr("title","").text("");aq("#reporting-task-type-bundle").attr("title","").text("");aq("#selected-reporting-task-name").text("");aq("#selected-reporting-task-type").text("").removeData("bundle");aq("#reporting-task-description-container").hide()};var q=function(){aq("#parameter-provider-type-description").attr("title","").text("");aq("#parameter-provider-type-name").attr("title","").text("");aq("#parameter-provider-type-bundle").attr("title","").text("");aq("#selected-parameter-provider-name").text("");aq("#selected-parameter-provider-type").text("").removeData("bundle");aq("#parameter-provider-description-container").hide()};var t=function(){ax();var aC=aq("#reporting-task-types-table").data("gridInstance");aC.resetActiveCell()};var ap=function(){q();var aC=aq("#parameter-provider-types-table").data("gridInstance");aC.resetActiveCell()};var af=function(aK,aF){var aI=M(aK,aF);var aE=true;if(aI){var aJ=aq("#reporting-task-tag-cloud").tagcloud("getSelectedTags");var aH=aJ.length>0;if(aH){aE=B(aJ,aK.tags)}}var aG=true;if(aI&&aE){var aC=aq("#reporting-task-bundle-group-combo").combo("getSelectedOption");if(R.isDefinedAndNotNull(aC)&&aC.value!==""){aG=(aK.bundle.group===aC.value)}}var aD=aI&&aE&&aG;if(aD===false&&aq("#selected-reporting-task-type").text()===aK.type){t()}return aD};var az=function(aK,aF){var aI=M(aK,aF);var aE=true;if(aI){var aJ=aq("#parameter-provider-tag-cloud").tagcloud("getSelectedTags");var aH=aJ.length>0;if(aH){aE=B(aJ,aK.tags)}}var aG=true;if(aI&&aE){var aC=aq("#parameter-provider-bundle-group-combo").combo("getSelectedOption");if(R.isDefinedAndNotNull(aC)&&aC.value!==""){aG=(aK.bundle.group===aC.value)}}var aD=aI&&aE&&aG;if(aD===false&&aq("#selected-parameter-provider-type").text()===aK.type){ap()}return aD};var l=function(){var aD=aq("#selected-reporting-task-type").text();var aC=aq("#selected-reporting-task-type").data("bundle");if(aD===""){Y.showOkDialog({headerText:"Settings",dialogContent:"The type of reporting task to create must be selected."})}else{al(aD,aC)}};var ad=function(){var aC=aq("#selected-parameter-provider-type").text();var aD=aq("#selected-selected-parameter-type").data("bundle");if(aC===""){Y.showOkDialog({headerText:"Settings",dialogContent:"The type of parameter provider to create must be selected."})}else{X(aC,aD)}};var al=function(aC,aE){var aF={revision:E.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{type:aC,bundle:aE}};var aD=aq.ajax({type:"POST",url:ac.urls.createReportingTask,data:JSON.stringify(aF),dataType:"json",contentType:"application/json"}).done(function(aH){var aJ=aq("#reporting-tasks-table").data("gridInstance");var aG=aJ.getData();aG.addItem(aq.extend({type:"ReportingTask",bulletins:[]},aH));aG.reSort();aJ.invalidate();var aI=aG.getRowById(aH.id);w.choseRow(aJ,aI);aJ.scrollRowIntoView(aI)}).fail(Z.handleAjaxError);aq("#new-reporting-task-dialog").modal("hide");return aD};var H=function(){aq.ajax({type:"GET",url:ac.urls.currentUser,dataType:"json"}).done(function(aC){R.setCurrentUser(aC)})};var am=function(){var aC=aq("#new-registry-type-combo").combo("getSelectedOption");var aD={revision:E.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{name:aq("#new-registry-name").val(),description:aq("#new-registry-description").val(),type:aC.value}};var aE=aq.ajax({type:"POST",url:ac.urls.registries,data:JSON.stringify(aD),dataType:"json",contentType:"application/json"}).done(function(aI){var aF=aq("#registries-table").data("gridInstance");var aG=aF.getData();aG.addItem(aq.extend({type:"Registry"},aI));aG.reSort();aF.invalidate();var aH=aG.getRowById(aI.id);w.choseRow(aF,aH);aF.scrollRowIntoView(aH);H();aq("#registry-configuration-dialog").modal("hide");aq("#new-registry-client-dialog").modal("hide")}).fail(Z.handleConfigurationUpdateAjaxError);return aE};var X=function(aF,aC){var aD={revision:E.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{type:aF,bundle:aC}};var aE=aq.ajax({type:"POST",url:ac.urls.createParameterProvider,data:JSON.stringify(aD),dataType:"json",contentType:"application/json"}).done(function(aH){var aI=aq("#parameter-providers-table").data("gridInstance");var aG=aI.getData();aG.addItem(aq.extend({type:"ParameterProvider",bulletins:[]},aH));aG.reSort();aI.invalidate();var aJ=aG.getRowById(aH.id);w.choseRow(aI,aJ);aI.scrollRowIntoView(aJ)}).fail(Z.handleAjaxError);aq("#new-parameter-provider-dialog").modal("hide");return aE};var v=function(aH){var aE=aq("#registries-table").data("gridInstance");var aF=aE.getData();var aD=aq("#registry-properties").propertytable("marshalProperties");var aI=aF.getItemById(aH);var aG={revision:E.getRevision(aI),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{id:aH,name:aq("#registry-name-config").val(),description:aq("#registry-description-config").val()}};if(aq.isEmptyObject(aD)===false){aG.component["properties"]=aD}var aC=aq.ajax({type:"PUT",url:aI.uri,data:JSON.stringify(aG),dataType:"json",contentType:"application/json"}).done(function(aJ){aF.updateItem(aJ.id,aq.extend({type:"Registry"},aJ));aq("#registry-configuration-dialog").modal("hide")}).fail(Z.handleConfigurationUpdateAjaxError);return aC};var S=function(){var aD=[{id:"type",name:"Type",field:"label",formatter:R.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:R.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:R.genericValueFormatter}];var aC=new z.Data.DataView({inlineFilters:false});aC.setItems([]);aC.setFilterArgs({searchString:c()});aC.setFilter(af);R.sortType({columnId:"type",sortAsc:true},aC);var aG=new z.Grid("#reporting-task-types-table",aC,aD,p);aG.setSelectionModel(new z.RowSelectionModel());aG.registerPlugin(new z.AutoTooltips());aG.setSortColumn("type",true);aG.onSort.subscribe(function(aI,aH){R.sortType({columnId:aH.sortCol.field,sortAsc:aH.sortAsc},aC)});aG.onSelectedRowsChanged.subscribe(function(aM,aJ){if(aq.isArray(aJ.rows)&&aJ.rows.length===1){var aL=aJ.rows[0];var aH=aG.getDataItem(aL);if(R.isDefinedAndNotNull(aH)){aq("#reporting-task-description-container").show();if(R.isBlank(aH.description)){aq("#reporting-task-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{aq("#reporting-task-type-description").width(aq("#reporting-task-description-container").innerWidth()-1).html(aH.description).ellipsis()}var aI=R.formatBundle(aH.bundle);var aK=R.formatType(aH);aq("#reporting-task-type-name").text(aK).attr("title",aK);aq("#reporting-task-type-bundle").text(aI).attr("title",aI);aq("#selected-reporting-task-name").text(aH.label);aq("#selected-reporting-task-type").text(aH.type).data("bundle",aH.bundle);aq("#new-reporting-task-dialog").modal("refreshButtons")}}});aG.onDblClick.subscribe(function(aJ,aI){var aH=aG.getDataItem(aI.row);if(i(aH)){al(aH.type,aH.bundle)}});aG.onViewportChanged.subscribe(function(aI,aH){R.cleanUpTooltips(aq("#reporting-task-types-table"),"div.view-usage-restriction")});aC.onRowCountChanged.subscribe(function(aI,aH){aG.updateRowCount();aG.render();aq("#displayed-reporting-task-types").text(aH.current)});aC.onRowsChanged.subscribe(function(aI,aH){aG.invalidateRows(aH.rows);aG.render()});aC.syncGridSelection(aG,true);aq("#reporting-task-types-table").data("gridInstance",aG).on("mouseenter","div.slick-cell",function(aK){var aL=aq(this).find("div.view-usage-restriction");if(aL.length&&!aL.data("qtip")){var aJ=aq(this).find("span.row-id").text();var aI=aC.getItemById(aJ);if(aI.restricted===true){var aM=aq("<div></div>");if(R.isBlank(aI.usageRestriction)){aM.append(aq('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{aM.append(aq('<p style="margin-bottom: 3px;"></p>').text(aI.usageRestriction+" Requires the following permissions:"))}var aH=[];if(R.isDefinedAndNotNull(aI.explicitRestrictions)){aq.each(aI.explicitRestrictions,function(aN,aP){var aO=aP.requiredPermission;aH.push("'"+aO.label+"' - "+R.escapeHtml(aP.explanation))})}else{aH.push("Access to restricted components regardless of restrictions.")}aM.append(R.formatUnorderedList(aH));aL.qtip(aq.extend({},R.config.tooltipConfig,{content:aM,position:{container:aq("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var aF=R.getPolicyTypeListing("restricted-components");aq.ajax({type:"GET",url:ac.urls.reportingTaskTypes,dataType:"json"}).done(function(aI){var aN=0;var aK=[];var aH=new Set();var aM=new Map();var aL=new Map();aC.beginUpdate();aq.each(aI.reportingTaskTypes,function(aO,aP){if(aP.restricted===true){if(R.isDefinedAndNotNull(aP.explicitRestrictions)){aq.each(aP.explicitRestrictions,function(aQ,aS){var aR=aS.requiredPermission;if(!aL.has(aR.id)){aL.set(aR.id,aR.label)}if(!aM.has(aR.id)){aM.set(aR.id,[])}aM.get(aR.id).push({type:R.formatType(aP),bundle:R.formatBundle(aP.bundle),explanation:R.escapeHtml(aS.explanation)})})}else{if(!aL.has(aF.value)){aL.set(aF.value,aF.text)}if(!aM.has(aF.value)){aM.set(aF.value,[])}aM.get(aF.value).push({type:R.formatType(aP),bundle:R.formatBundle(aP.bundle),explanation:R.escapeHtml(aP.usageRestriction)})}}aH.add(aP.bundle.group);aC.addItem({id:aN+++"",label:R.substringAfterLast(aP.type,"."),type:aP.type,bundle:aP.bundle,description:R.escapeHtml(aP.description),restricted:aP.restricted,usageRestriction:R.escapeHtml(aP.usageRestriction),explicitRestrictions:aP.explicitRestrictions,tags:aP.tags.join(", ")});aq.each(aP.tags,function(aR,aQ){aK.push(aQ.toLowerCase())})});aC.endUpdate();aC.reSort();aG.invalidate();K.addComponentRestrictions(aM,aL);aq("#total-reporting-task-types, #displayed-reporting-task-types").text(aI.reportingTaskTypes.length);aq("#reporting-task-tag-cloud").tagcloud({tags:aK,select:d,remove:d});var aJ=[{text:"all groups",value:""}];aH.forEach(function(aO){aJ.push({text:aO,value:aO})});aq("#reporting-task-bundle-group-combo").combo({options:aJ,select:d})}).fail(Z.handleAjaxError);var aE=[aq.ui.keyCode.UP,aq.ui.keyCode.PAGE_UP,aq.ui.keyCode.DOWN,aq.ui.keyCode.PAGE_DOWN];aq("#reporting-task-type-filter").off("keyup").on("keyup",function(aK){var aJ=aK.keyCode?aK.keyCode:aK.which;if(aq.inArray(aJ,aE)!==-1){return}if(aJ===aq.ui.keyCode.ENTER){var aH=aG.getSelectedRows();if(aH.length>0){var aI=aG.getDataItem(aH[0]);if(i(aI)){l()}}}else{d()}});w.addKeydownListener("#reporting-task-type-filter",aG,aG.getData());aq("#new-reporting-task-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Reporting Task",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var aH=aG.getSelectedRows();if(aH.length>0){var aI=aG.getDataItem(aH[0]);return i(aI)===false}else{return aG.getData().getLength()===0}},handler:{click:function(){l()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aq(this).modal("hide")}}}],handler:{close:function(){ax();aq("#reporting-task-type-filter").val("");aq("#reporting-task-tag-cloud").tagcloud("clearSelectedTags");aq("#reporting-task-bundle-group-combo").combo("setSelectedOption",{value:""});d();var aH=aq("#reporting-task-types-table").data("gridInstance");aH.setSelectedRows([]);aH.resetActiveCell()},resize:function(){aq("#reporting-task-type-description").width(aq("#reporting-task-description-container").innerWidth()-1).text(aq("#reporting-task-type-description").attr("title")).ellipsis()}}})};var U=function(){var aF=[{id:"type",name:"Type",field:"label",formatter:R.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:R.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:R.genericValueFormatter}];var aC=new z.Data.DataView({inlineFilters:false});aC.setItems([]);aC.setFilterArgs({searchString:y()});aC.setFilter(az);R.sortType({columnId:"type",sortAsc:true},aC);var aG=new z.Grid("#parameter-provider-types-table",aC,aF,p);aG.setSelectionModel(new z.RowSelectionModel());aG.registerPlugin(new z.AutoTooltips());aG.setSortColumn("type",true);aG.onSort.subscribe(function(aI,aH){R.sortType({columnId:aH.sortCol.field,sortAsc:aH.sortAsc},aC)});aG.onSelectedRowsChanged.subscribe(function(aK,aI){if(aq.isArray(aI.rows)&&aI.rows.length===1){var aM=aI.rows[0];var aL=aG.getDataItem(aM);if(R.isDefinedAndNotNull(aL)){aq("#parameter-provider-description-container").show();if(R.isBlank(aL.description)){aq("#parameter-provider-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{aq("#parameter-provider-type-description").width(aq("#parameter-provider-description-container").innerWidth()-1).html(aL.description).ellipsis()}var aH=R.formatBundle(aL.bundle);var aJ=R.formatType(aL);aq("#parameter-provider-type-name").text(aJ).attr("title",aJ);aq("#parameter-provider-type-bundle").text(aH).attr("title",aH);aq("#selected-parameter-provider-name").text(aL.label);aq("#selected-parameter-provider-type").text(aL.type).data("bundle",aL.bundle);aq("#new-parameter-provider-dialog").modal("refreshButtons")}}});aG.onDblClick.subscribe(function(aI,aH){var aJ=aG.getDataItem(aH.row);if(i(aJ)){X(aJ.type,aJ.bundle)}});aG.onViewportChanged.subscribe(function(aI,aH){R.cleanUpTooltips(aq("#parameter-provider-types-table"),"div.view-usage-restriction")});aC.onRowCountChanged.subscribe(function(aI,aH){aG.updateRowCount();aG.render();aq("#displayed-parameter-provider-types").text(aH.current)});aC.onRowsChanged.subscribe(function(aI,aH){aG.invalidateRows(aH.rows);aG.render()});aC.syncGridSelection(aG,true);aq("#parameter-provider-types-table").data("gridInstance",aG).on("mouseenter","div.slick-cell",function(aK){var aL=aq(this).find("div.view-usage-restriction");if(aL.length&&!aL.data("qtip")){var aJ=aq(this).find("span.row-id").text();var aI=aC.getItemById(aJ);if(aI.restricted===true){var aM=aq("<div></div>");if(R.isBlank(aI.usageRestriction)){aM.append(aq('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{aM.append(aq('<p style="margin-bottom: 3px;"></p>').text(aI.usageRestriction+" Requires the following permissions:"))}var aH=[];if(R.isDefinedAndNotNull(aI.explicitRestrictions)){aq.each(aI.explicitRestrictions,function(aN,aP){var aO=aP.requiredPermission;aH.push("'"+aO.label+"' - "+R.escapeHtml(aP.explanation))})}else{aH.push("Access to restricted components regardless of restrictions.")}aM.append(R.formatUnorderedList(aH));aL.qtip(aq.extend({},R.config.tooltipConfig,{content:aM,position:{container:aq("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var aE=R.getPolicyTypeListing("restricted-components");aq.ajax({type:"GET",url:ac.urls.parameterProviderTypes,dataType:"json"}).done(function(aI){var aN=0;var aK=[];var aH=new Set();var aM=new Map();var aL=new Map();aC.beginUpdate();aq.each(aI.parameterProviderTypes,function(aO,aP){if(aP.restricted===true){if(R.isDefinedAndNotNull(aP.explicitRestrictions)){aq.each(aP.explicitRestrictions,function(aQ,aS){var aR=aS.requiredPermission;if(!aL.has(aR.id)){aL.set(aR.id,aR.label)}if(!aM.has(aR.id)){aM.set(aR.id,[])}aM.get(aR.id).push({type:R.formatType(aP),bundle:R.formatBundle(aP.bundle),explanation:R.escapeHtml(aS.explanation)})})}else{if(!aL.has(aE.value)){aL.set(aE.value,aE.text)}if(!aM.has(aE.value)){aM.set(aE.value,[])}aM.get(aE.value).push({type:R.formatType(aP),bundle:R.formatBundle(aP.bundle),explanation:R.escapeHtml(aP.usageRestriction)})}}aH.add(aP.bundle.group);aC.addItem({id:aN+++"",label:R.substringAfterLast(aP.type,"."),type:aP.type,bundle:aP.bundle,description:R.escapeHtml(aP.description),restricted:aP.restricted,usageRestriction:R.escapeHtml(aP.usageRestriction),explicitRestrictions:aP.explicitRestrictions,tags:aP.tags.join(", ")});aq.each(aP.tags,function(aR,aQ){aK.push(aQ.toLowerCase())})});aC.endUpdate();aC.reSort();aG.invalidate();K.addComponentRestrictions(aM,aL);aq("#total-parameter-provider-types, #displayed-parameter-provider-types").text(aI.parameterProviderTypes.length);aq("#parameter-provider-tag-cloud").tagcloud({tags:aK,select:k,remove:k});var aJ=[{text:"all groups",value:""}];aH.forEach(function(aO){aJ.push({text:aO,value:aO})});aq("#parameter-provider-bundle-group-combo").combo({options:aJ,select:k})}).fail(Z.handleAjaxError);var aD=[aq.ui.keyCode.UP,aq.ui.keyCode.PAGE_UP,aq.ui.keyCode.DOWN,aq.ui.keyCode.PAGE_DOWN];aq("#parameter-provider-type-filter").off("keyup").on("keyup",function(aK){var aJ=aK.keyCode?aK.keyCode:aK.which;if(aq.inArray(aJ,aD)!==-1){return}if(aJ===aq.ui.keyCode.ENTER){var aH=aG.getSelectedRows();if(aH.length>0){var aI=aG.getDataItem(aH[0]);if(i(aI)){ad()}}}else{k()}});w.addKeydownListener("#parameter-provider-type-filter",aG,aG.getData());aq("#new-parameter-provider-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Parameter Provider",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var aH=aG.getSelectedRows();if(aH.length>0){var aI=aG.getDataItem(aH[0]);return i(aI)===false}else{return aG.getData().getLength()===0}},handler:{click:function(){ad()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aq(this).modal("hide")}}}],handler:{close:function(){q();aq("#parameter-provider-type-filter").val("");aq("#parameter-provider-tag-cloud").tagcloud("clearSelectedTags");aq("#parameter-provider-bundle-group-combo").combo("setSelectedOption",{value:""});k();var aH=aq("#parameter-provider-types-table").data("gridInstance");aH.setSelectedRows([]);aH.resetActiveCell()},resize:function(){aq("#parameter-provider-type-description").width(aq("#parameter-provider-description-container").innerWidth()-1).text(aq("#parameter-provider-type-description").attr("title")).ellipsis()}}})};var an=function(){S();var aG=function(aQ,aO,aL,aJ,aI){if(!aI.permissions.canRead){return""}var aP='<div title="View Details" class="pointer view-reporting-task fa fa-info-circle"></div>';aP+='<div title="View Documentation" class="pointer reporting-task-usage fa fa-book"></div>';var aM=!R.isBlank(aI.component.comments);var aN=!R.isEmpty(aI.component.validationErrors);var aK=!R.isEmpty(aI.bulletins);if(aM){aP+='<div class="pointer has-comments fa fa-comment"></div>'}if(aN){aP+='<div class="pointer has-errors fa fa-warning" ></div>'}if(aK){aP+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(aM||aN||aK){aP+='<span class="hidden row-id">'+R.escapeHtml(aI.component.id)+"</span>"}return aP};var aH=function(aQ,aP,aO,aK,aI){var aM="",aN="";if(aI.status.validationStatus==="VALIDATING"){aM="validating fa fa-spin fa-circle-notch";aN="Validating"}else{if(aI.status.validationStatus==="INVALID"){aM="invalid fa fa-warning";aN="Invalid"}else{if(aI.status.runStatus==="STOPPED"){aN="Stopped";aM="fa fa-stop stopped"}else{if(aI.status.runStatus==="RUNNING"){aN="Running";aM="fa fa-play running"}else{aN="Disabled";aM="icon icon-enable-false disabled"}}}}var aL="";if(R.isDefinedAndNotNull(aI.status.activeThreadCount)&&aI.status.activeThreadCount>0){aL="("+aI.status.activeThreadCount+")"}var aJ='<div layout="row"><div class="'+aM+'"></div>';return aJ+'<div class="status-text">'+R.escapeHtml(aN)+'</div><div style="float: left; margin-left: 4px;">'+R.escapeHtml(aL)+"</div></div>"};var aF=function(aR,aP,aN,aM,aI){var aQ="";var aJ=aI.permissions.canWrite;var aL=aI.permissions.canRead;var aO=aI.operatePermissions.canWrite||aJ;var aK=aI.status.runStatus==="STOPPED";if(aI.status.runStatus==="RUNNING"){if(aO){aQ+='<div title="Stop" class="pointer stop-reporting-task fa fa-stop"></div>'}}else{if(aK||aI.status.runStatus==="DISABLED"){if(aL&&aJ){aQ+='<div title="Edit" class="pointer edit-reporting-task fa fa-pencil"></div>'}if(aO&&aI.status.runStatus==="STOPPED"&&aI.status.validationStatus==="VALID"){aQ+='<div title="Start" class="pointer start-reporting-task fa fa-play"></div>'}if(aL&&aJ&&aI.component.multipleVersionsAvailable===true){aQ+='<div title="Change Version" class="pointer change-version-reporting-task fa fa-exchange"></div>'}if(aL&&aJ&&R.canModifyController()){aQ+='<div title="Remove" class="pointer delete-reporting-task fa fa-trash"></div>'}}}if(aL&&aJ&&aI.component.persistsState===true){aQ+='<div title="View State" class="pointer view-state-reporting-task fa fa-tasks"></div>'}if(K.isManagedAuthorizer()&&R.canAccessTenants()){aQ+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key"></div>'}return aQ};var aC=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:aG,sortable:true,width:100,maxWidth:100,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",sortable:true,resizable:true,formatter:P},{id:"type",name:"Type",formatter:R.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:R.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"Run Status",sortable:true,resizeable:true,formatter:aH}];aC.push({id:"actions",name:"&nbsp;",resizable:false,formatter:aF,sortable:false,width:115,maxWidth:115});var aE=new z.Data.DataView({inlineFilters:false});aE.setItems([]);I({columnId:"name",sortAsc:true},aE);var aD=new z.Grid("#reporting-tasks-table",aE,aC,p);aD.setSelectionModel(new z.RowSelectionModel());aD.registerPlugin(new z.AutoTooltips());aD.setSortColumn("name",true);aD.onSort.subscribe(function(aJ,aI){I({columnId:aI.sortCol.id,sortAsc:aI.sortAsc},aE)});aD.onClick.subscribe(function(aM,aJ){var aL=aq(aM.target);var aK=aE.getItem(aJ.row);if(aD.getColumns()[aJ.cell].id==="actions"){if(aL.hasClass("edit-reporting-task")){ab.showConfiguration(aK)}else{if(aL.hasClass("start-reporting-task")){ab.start(aK)}else{if(aL.hasClass("stop-reporting-task")){ab.stop(aK)}else{if(aL.hasClass("delete-reporting-task")){ab.promptToDeleteReportingTask(aK)}else{if(aL.hasClass("view-state-reporting-task")){var aI=aK.status.runStatus==="STOPPED"&&aK.status.activeThreadCount===0;aB.showState(aK,aI)}else{if(aL.hasClass("change-version-reporting-task")){V.promptForVersionChange(aK)}else{if(aL.hasClass("edit-access-policies")){L.showReportingTaskPolicy(aK);aq("#shell-close-button").click()}}}}}}}}else{if(aD.getColumns()[aJ.cell].id==="moreDetails"){if(aL.hasClass("view-reporting-task")){ab.showDetails(aK)}else{if(aL.hasClass("reporting-task-usage")){aq("#shell-close-button").click();o.showPage("../nifi-docs/documentation?"+aq.param({select:aK.component.type,group:aK.component.bundle.group,artifact:aK.component.bundle.artifact,version:aK.component.bundle.version})).done(function(){au.showSettings()})}}}}});aE.onRowCountChanged.subscribe(function(aJ,aI){aD.updateRowCount();aD.render()});aE.onRowsChanged.subscribe(function(aJ,aI){aD.invalidateRows(aI.rows);aD.render()});aE.syncGridSelection(aD,true);aq("#reporting-tasks-table").data("gridInstance",aD).on("mouseenter","div.slick-cell",function(aM){var aP=aq(this).find("div.has-comments");if(aP.length&&!aP.data("qtip")){var aN=aq(this).find("span.row-id").text();var aJ=aE.getItemById(aN);var aK=R.escapeHtml(aJ.component.comments);var aQ=R.formatNewLines(aK);if(R.isDefinedAndNotNull(aQ)){aP.qtip(aq.extend({},R.config.tooltipConfig,{content:aQ,position:{target:"mouse",viewport:aq("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var aI=aq(this).find("div.has-errors");if(aI.length&&!aI.data("qtip")){var aN=aq(this).find("span.row-id").text();var aJ=aE.getItemById(aN);var aQ=R.formatUnorderedList(aJ.component.validationErrors);if(R.isDefinedAndNotNull(aQ)){aI.qtip(aq.extend({},R.config.tooltipConfig,{content:aQ,position:{target:"mouse",viewport:aq("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var aO=aq(this).find("div.has-bulletins");if(aO.length&&!aO.data("qtip")){var aN=aq(this).find("span.row-id").text();var aJ=aE.getItemById(aN);var aL=R.getFormattedBulletins(aJ.bulletins);var aQ=R.formatUnorderedList(aL);if(R.isDefinedAndNotNull(aQ)){aO.qtip(aq.extend({},R.config.tooltipConfig,{content:aQ,position:{target:"mouse",viewport:aq("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var C=function(){return aq("#flow-analysis-rule-type-filter").val()};var aj=function(){var aC=aq("#flow-analysis-rule-types-table").data("gridInstance");if(R.isDefinedAndNotNull(aC)){var aD=aC.getData();aD.setFilterArgs({searchString:C()});aD.refresh();aq("#new-flow-analysis-rule-dialog").modal("refreshButtons");if(aD.getLength()>0){w.choseFirstRow(aC)}}};var aa=function(){aq("#flow-analysis-rule-type-description").attr("title","").text("");aq("#flow-analysis-rule-type-name").attr("title","").text("");aq("#flow-analysis-rule-type-bundle").attr("title","").text("");aq("#selected-flow-analysis-rule-name").text("");aq("#selected-flow-analysis-rule-type").text("").removeData("bundle");aq("#flow-analysis-rule-description-container").hide()};var ah=function(){aa();var aC=aq("#flow-analysis-rule-types-table").data("gridInstance");aC.resetActiveCell()};var ay=function(aK,aF){var aI=M(aK,aF);var aE=true;if(aI){var aJ=aq("#flow-analysis-rule-tag-cloud").tagcloud("getSelectedTags");var aH=aJ.length>0;if(aH){aE=B(aJ,aK.tags)}}var aG=true;if(aI&&aE){var aC=aq("#flow-analysis-rule-bundle-group-combo").combo("getSelectedOption");if(R.isDefinedAndNotNull(aC)&&aC.value!==""){aG=(aK.bundle.group===aC.value)}}var aD=aI&&aE&&aG;if(aD===false&&aq("#selected-flow-analysis-rule-type").text()===aK.type){ah()}return aD};var m=function(){var aD=aq("#selected-flow-analysis-rule-type").text();var aC=aq("#selected-flow-analysis-rule-type").data("bundle");if(aD===""){Y.showOkDialog({headerText:"Settings",dialogContent:"The type of flow analysis rule to create must be selected."})}else{ae(aD,aC)}};var ae=function(aD,aE){var aF={revision:E.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged(),component:{type:aD,bundle:aE}};var aC=aq.ajax({type:"POST",url:ac.urls.createFlowAnalysisRule,data:JSON.stringify(aF),dataType:"json",contentType:"application/json"}).done(function(aI){var aG=aq("#flow-analysis-rules-table").data("gridInstance");var aH=aG.getData();aH.addItem(aq.extend({type:"FlowAnalysisRule",bulletins:[]},aI));aH.reSort();aG.invalidate();var aJ=aH.getRowById(aI.id);w.choseRow(aG,aJ);aG.scrollRowIntoView(aJ)}).fail(Z.handleAjaxError);aq("#new-flow-analysis-rule-dialog").modal("hide");return aC};var ao=function(){var aE=[{id:"type",name:"Type",field:"label",formatter:R.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:R.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:R.genericValueFormatter}];var aD=new z.Data.DataView({inlineFilters:false});aD.setItems([]);aD.setFilterArgs({searchString:C()});aD.setFilter(ay);R.sortType({columnId:"type",sortAsc:true},aD);var aC=new z.Grid("#flow-analysis-rule-types-table",aD,aE,p);aC.setSelectionModel(new z.RowSelectionModel());aC.registerPlugin(new z.AutoTooltips());aC.setSortColumn("type",true);aC.onSort.subscribe(function(aI,aH){R.sortType({columnId:aH.sortCol.field,sortAsc:aH.sortAsc},aD)});aC.onSelectedRowsChanged.subscribe(function(aM,aK){if(aq.isArray(aK.rows)&&aK.rows.length===1){var aH=aK.rows[0];var aJ=aC.getDataItem(aH);if(R.isDefinedAndNotNull(aJ)){aq("#flow-analysis-rule-description-container").show();if(R.isBlank(aJ.description)){aq("#flow-analysis-rule-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{aq("#flow-analysis-rule-type-description").width(aq("#flow-analysis-rule-description-container").innerWidth()-1).html(aJ.description).ellipsis()}var aI=R.formatBundle(aJ.bundle);var aL=R.formatType(aJ);aq("#flow-analysis-rule-type-name").text(aL).attr("title",aL);aq("#flow-analysis-rule-type-bundle").text(aI).attr("title",aI);aq("#selected-flow-analysis-rule-name").text(aJ.label);aq("#selected-flow-analysis-rule-type").text(aJ.type).data("bundle",aJ.bundle);aq("#new-flow-analysis-rule-dialog").modal("refreshButtons")}}});aC.onDblClick.subscribe(function(aJ,aI){var aH=aC.getDataItem(aI.row);if(i(aH)){ae(aH.type,aH.bundle)}});aC.onViewportChanged.subscribe(function(aI,aH){R.cleanUpTooltips(aq("#flow-analysis-rule-types-table"),"div.view-usage-restriction")});aD.onRowCountChanged.subscribe(function(aI,aH){aC.updateRowCount();aC.render();aq("#displayed-flow-analysis-rule-types").text(aH.current)});aD.onRowsChanged.subscribe(function(aI,aH){aC.invalidateRows(aH.rows);aC.render()});aD.syncGridSelection(aC,true);aq("#flow-analysis-rule-types-table").data("gridInstance",aC).on("mouseenter","div.slick-cell",function(aK){var aL=aq(this).find("div.view-usage-restriction");if(aL.length&&!aL.data("qtip")){var aJ=aq(this).find("span.row-id").text();var aI=aD.getItemById(aJ);if(aI.restricted===true){var aM=aq("<div></div>");if(R.isBlank(aI.usageRestriction)){aM.append(aq('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{aM.append(aq('<p style="margin-bottom: 3px;"></p>').text(aI.usageRestriction+" Requires the following permissions:"))}var aH=[];if(R.isDefinedAndNotNull(aI.explicitRestrictions)){aq.each(aI.explicitRestrictions,function(aN,aP){var aO=aP.requiredPermission;aH.push("'"+aO.label+"' - "+R.escapeHtml(aP.explanation))})}else{aH.push("Access to restricted components regardless of restrictions.")}aM.append(R.formatUnorderedList(aH));aL.qtip(aq.extend({},R.config.tooltipConfig,{content:aM,position:{container:aq("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var aG=R.getPolicyTypeListing("restricted-components");aq.ajax({type:"GET",url:ac.urls.flowAnalysisRuleTypes,dataType:"json"}).done(function(aI){var aN=0;var aK=[];var aH=new Set();var aM=new Map();var aL=new Map();aD.beginUpdate();aq.each(aI.flowAnalysisRuleTypes,function(aO,aP){if(aP.restricted===true){if(R.isDefinedAndNotNull(aP.explicitRestrictions)){aq.each(aP.explicitRestrictions,function(aQ,aS){var aR=aS.requiredPermission;if(!aL.has(aR.id)){aL.set(aR.id,aR.label)}if(!aM.has(aR.id)){aM.set(aR.id,[])}aM.get(aR.id).push({type:R.formatType(aP),bundle:R.formatBundle(aP.bundle),explanation:R.escapeHtml(aS.explanation)})})}else{if(!aL.has(aG.value)){aL.set(aG.value,aG.text)}if(!aM.has(aG.value)){aM.set(aG.value,[])}aM.get(aG.value).push({type:R.formatType(aP),bundle:R.formatBundle(aP.bundle),explanation:R.escapeHtml(aP.usageRestriction)})}}aH.add(aP.bundle.group);aD.addItem({id:aN++,label:R.substringAfterLast(aP.type,"."),type:aP.type,bundle:aP.bundle,description:R.escapeHtml(aP.description),restricted:aP.restricted,usageRestriction:R.escapeHtml(aP.usageRestriction),explicitRestrictions:aP.explicitRestrictions,tags:aP.tags.join(", ")});aq.each(aP.tags,function(aR,aQ){aK.push(aQ.toLowerCase())})});aD.endUpdate();aD.reSort();aC.invalidate();K.addComponentRestrictions(aM,aL);aq("#total-flow-analysis-rule-types, #displayed-flow-analysis-rule-types").text(aI.flowAnalysisRuleTypes.length);aq("#flow-analysis-rule-tag-cloud").tagcloud({tags:aK,select:aj,remove:aj});var aJ=[{text:"all groups",value:""}];aH.forEach(function(aO){aJ.push({text:aO,value:aO})});aq("#flow-analysis-rule-bundle-group-combo").combo({options:aJ,select:aj})}).fail(Z.handleAjaxError);var aF=[aq.ui.keyCode.UP,aq.ui.keyCode.PAGE_UP,aq.ui.keyCode.DOWN,aq.ui.keyCode.PAGE_DOWN];aq("#flow-analysis-rule-type-filter").off("keyup").on("keyup",function(aK){var aJ=aK.keyCode?aK.keyCode:aK.which;if(aq.inArray(aJ,aF)!==-1){return}if(aJ===aq.ui.keyCode.ENTER){var aH=aC.getSelectedRows();if(aH.length>0){var aI=aC.getDataItem(aH[0]);if(i(aI)){m()}}}else{aj()}});w.addKeydownListener("#flow-analysis-rule-type-filter",aC,aC.getData());aq("#new-flow-analysis-rule-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Flow Analysis Rule",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var aH=aC.getSelectedRows();if(aH.length>0){var aI=aC.getDataItem(aH[0]);return i(aI)===false}else{return aC.getData().getLength()===0}},handler:{click:function(){m()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aq(this).modal("hide")}}}],handler:{close:function(){aa();aq("#flow-analysis-rule-type-filter").val("");aq("#flow-analysis-rule-tag-cloud").tagcloud("clearSelectedTags");aq("#flow-analysis-rule-bundle-group-combo").combo("setSelectedOption",{value:""});aj();var aH=aq("#flow-analysis-rule-types-table").data("gridInstance");aH.setSelectedRows([]);aH.resetActiveCell()},resize:function(){aq("#flow-analysis-rule-type-description").width(aq("#flow-analysis-rule-description-container").innerWidth()-1).text(aq("#flow-analysis-rule-type-description").attr("title")).ellipsis()}}})};var ar=function(){ao();var aE=function(aO,aJ,aN,aL,aI){if(!aI.permissions.canRead){return""}var aK='<div title="View Details" class="pointer view-flow-analysis-rule fa fa-info-circle"></div>';aK+='<div title="View Documentation" class="pointer flow-analysis-rule-usage fa fa-book"></div>';var aM=!R.isEmpty(aI.component.validationErrors);if(aM){aK+='<div class="pointer has-errors fa fa-warning" ></div>';aK+='<span class="hidden row-id">'+R.escapeHtml(aI.component.id)+"</span>"}return aK};var aH=function(aP,aJ,aO,aK,aI){var aN="",aL="";if(aI.status.validationStatus==="VALIDATING"){aN="validating fa fa-spin fa-circle-notch";aL="Validating"}else{if(aI.status.validationStatus==="INVALID"){aN="invalid fa fa-warning";aL="Invalid"}else{if(aI.status.runStatus==="DISABLED"){aN='disabled icon icon-enable-false"';aL="Disabled"}else{if(aI.status.runStatus==="ENABLED"){aN="enabled fa fa-flash";aL="Enabled"}}}}var aM='<div layout="row"><div class="'+aN+'"></div>';return aM+'<div class="status-text">'+aL+"</div></div>"};var aG=function(aR,aP,aM,aL,aI){var aQ="";var aJ=aI.permissions.canWrite;var aK=aI.permissions.canRead;var aO=aJ||(aI.operatePermissions&&aI.operatePermissions.canWrite);var aN=aI.status.runStatus==="DISABLED";if(aK){if(aJ&&aN){aQ+='<div class="pointer edit-flow-analysis-rule fa fa-gear" title="Configure"></div>'}else{aQ+='<div class="pointer view-flow-analysis-rule fa fa-gear" title="View Configuration"></div>'}}if(aO){if(aI.status.runStatus==="ENABLED"){aQ+='<div class="pointer disable-flow-analysis-rule icon icon-enable-false" title="Disable"></div>'}else{if(aN&&aI.status.validationStatus==="VALID"){aQ+='<div class="pointer enable-flow-analysis-rule fa fa-flash" title="Enable"></div>'}}}if(aN&&aK&&aJ&&aI.component.multipleVersionsAvailable===true){aQ+='<div title="Change Version" class="pointer change-version-flow-analysis-rule fa fa-exchange"></div>'}if(aN&&aK&&aJ&&R.canModifyController()){aQ+='<div title="Remove" class="pointer delete-flow-analysis-rule fa fa-trash"></div>'}if(aK&&aJ&&aI.component.persistsState===true){aQ+='<div title="View State" class="pointer view-state-flow-analysis-rule fa fa-tasks"></div>'}return aQ};var aD=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:aE,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",sortable:true,resizable:true,formatter:P},{id:"type",name:"Type",formatter:R.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:R.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"Status",sortable:true,resizeable:true,formatter:aH}];aD.push({id:"actions",name:"&nbsp;",resizable:false,formatter:aG,sortable:false,width:115,maxWidth:115});var aF=new z.Data.DataView({inlineFilters:false});aF.setItems([]);I({columnId:"name",sortAsc:true},aF);var aC=new z.Grid("#flow-analysis-rules-table",aF,aD,p);aC.setSelectionModel(new z.RowSelectionModel());aC.registerPlugin(new z.AutoTooltips());aC.setSortColumn("name",true);aC.onSort.subscribe(function(aJ,aI){I({columnId:aI.sortCol.id,sortAsc:aI.sortAsc},aF)});aC.onClick.subscribe(function(aM,aJ){var aL=aq(aM.target);var aK=aF.getItem(aJ.row);if(aC.getColumns()[aJ.cell].id==="actions"){if(aL.hasClass("edit-flow-analysis-rule")){at.showConfiguration(aK)}else{if(aL.hasClass("view-flow-analysis-rule")){at.showDetails(aK)}else{if(aL.hasClass("enable-flow-analysis-rule")){at.enable(aK)}else{if(aL.hasClass("disable-flow-analysis-rule")){at.disable(aK)}else{if(aL.hasClass("delete-flow-analysis-rule")){at.promptToDeleteFlowAnalysisRule(aK)}else{if(aL.hasClass("view-state-flow-analysis-rule")){var aI=aK.status.runStatus==="DISABLED";aB.showState(aK,aI)}else{if(aL.hasClass("change-version-flow-analysis-rule")){V.promptForVersionChange(aK)}else{if(aL.hasClass("edit-access-policies")){L.showFlowAnalysisRulePolicy(aK);aq("#shell-close-button").click()}}}}}}}}}else{if(aC.getColumns()[aJ.cell].id==="moreDetails"){if(aL.hasClass("view-flow-analysis-rule")){at.showDetails(aK)}else{if(aL.hasClass("flow-analysis-rule-usage")){aq("#shell-close-button").click();o.showPage("../nifi-docs/documentation?"+aq.param({select:aK.component.type,group:aK.component.bundle.group,artifact:aK.component.bundle.artifact,version:aK.component.bundle.version})).done(function(){au.showSettings()})}}}}});aF.onRowCountChanged.subscribe(function(aJ,aI){aC.updateRowCount();aC.render()});aF.onRowsChanged.subscribe(function(aJ,aI){aC.invalidateRows(aI.rows);aC.render()});aF.syncGridSelection(aC,true);aq("#flow-analysis-rules-table").data("gridInstance",aC).on("mouseenter","div.slick-cell",function(aM){var aL=aq(this).find("div.has-errors");if(aL.length&&!aL.data("qtip")){var aI=aq(this).find("span.row-id").text();var aJ=aF.getItemById(aI);var aK=R.formatUnorderedList(aJ.component.validationErrors);if(R.isDefinedAndNotNull(aK)){aL.qtip(aq.extend({},R.config.tooltipConfig,{content:aK,position:{target:"mouse",viewport:aq("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var g=function(){aq("#new-registry-client-dialog").modal({headerText:"Add Registry Client",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){am()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aq(this).modal("hide")}}}]})};var J=function(){var aF=function(aM,aJ,aL,aK,aI){if(!aI.permissions.canRead){return'<span class="blank">'+R.escapeHtml(aI.id)+"</span>"}return R.escapeHtml(aI.component.description)};var aD=function(aN,aJ,aM,aL,aI){var aK="";if(R.canModifyController()){aK+='<div title="Edit" class="pointer edit-registry fa fa-pencil"></div>';aK+='<div title="Remove" class="pointer remove-registry fa fa-trash"></div>'}return aK};var aH=function(aP,aJ,aO,aL,aI){if(!aI.permissions.canRead){return""}var aK="";var aM=!R.isEmpty(aI.component.validationErrors);var aN=!R.isEmpty(aI.bulletins);if(aM){aK+='<div class="pointer has-errors fa fa-warning"></div>'}if(aN){aK+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(aM||aN){aK+='<span class="hidden row-id">'+R.escapeHtml(aI.id)+"</span>"}return aK};var aG=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:aH,sortable:true,width:90,maxWidth:90},{id:"name",name:"Name",field:"name",formatter:P,sortable:true,resizable:true},{id:"description",name:"Description",field:"description",formatter:aF,sortable:true,resizable:true},{id:"type",name:"Type",field:"type",formatter:R.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",field:"bundle",formatter:R.instanceBundleFormatter,sortable:true,resizable:true}];aG.push({id:"actions",name:"&nbsp;",resizable:false,formatter:aD,sortable:false,width:90,maxWidth:90});var aE=new z.Data.DataView({inlineFilters:false});aE.setItems([]);I({columnId:"name",sortAsc:true},aE);var aC=new z.Grid("#registries-table",aE,aG,p);aC.setSelectionModel(new z.RowSelectionModel());aC.registerPlugin(new z.AutoTooltips());aC.setSortColumn("name",true);aC.onSort.subscribe(function(aJ,aI){I({columnId:aI.sortCol.id,sortAsc:aI.sortAsc},aE)});aq("#registries-table").data("gridInstance",aC).on("mouseenter","div.slick-cell",function(aL){var aJ=aq(this).find("div.has-errors");if(aJ.length&&!aJ.data("qtip")){var aK=aq(this).find("span.row-id").text();var aM=aE.getItemById(aK);var aI=R.formatUnorderedList(aM.component.validationErrors);if(R.isDefinedAndNotNull(aI)){aJ.qtip(aq.extend({},R.config.tooltipConfig,{content:aI,position:{target:"mouse",viewport:aq("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}});aC.onClick.subscribe(function(aK,aI){var aJ=aq(aK.target);var aL=aE.getItem(aI.row);if(aC.getColumns()[aI.cell].id==="actions"){if(aJ.hasClass("edit-registry")){D(aL)}else{if(aJ.hasClass("remove-registry")){ag(aL)}}}else{if(aC.getColumns()[aI.cell].id==="moreDetails"){}}});aE.onRowCountChanged.subscribe(function(aJ,aI){aC.updateRowCount();aC.render()});aE.onRowsChanged.subscribe(function(aJ,aI){aC.invalidateRows(aI.rows);aC.render()});aE.syncGridSelection(aC,true);aq("#registries-table").data("gridInstance",aC)};var h=function(){U();var aD=function(aO,aI,aN,aK,aH){if(!aH.permissions.canRead){return""}var aJ='<div title="View Details" class="pointer view-parameter-provider fa fa-info-circle"></div>';aJ+='<div title="View Documentation" class="pointer parameter-provider-usage fa fa-book"></div>';var aL=!R.isEmpty(aH.component.validationErrors);var aM=!R.isEmpty(aH.bulletins);if(aL){aJ+='<div class="pointer has-errors fa fa-warning" ></div>'}if(aM){aJ+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(aL||aM){aJ+='<span class="hidden row-id">'+R.escapeHtml(aH.component.id)+"</span>"}return aJ};var aF=function(aQ,aO,aM,aL,aH){var aP="";var aI=aH.permissions.canWrite;var aJ=aH.permissions.canRead;var aN=aJ?!R.isEmpty(aH.component.validationErrors):null;var aK=true;if(aJ&&aH.component.referencingParameterContexts){(aH.component.referencingParameterContexts).every(function(aR){return aK=aR.permissions.canRead})}if(aJ&&aI){aP+='<div title="Edit" class="pointer edit-parameter-provider fa fa-pencil"></div>';if(aK&&!aN){aP+='<div title="Fetch Parameters" class="pointer fetch-parameter-provider fa fa-arrow-circle-down"></div>'}}if(aJ&&aI&&R.canModifyController()){aP+='<div title="Remove" class="pointer delete-parameter-provider fa fa-trash"></div>'}if(K.isManagedAuthorizer()&&R.canAccessTenants()){aP+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key"></div>'}return aP};var aC=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:aD,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",sortable:true,resizable:true,formatter:P},{id:"type",name:"Type",formatter:R.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:R.instanceBundleFormatter,sortable:true,resizable:true}];aC.push({id:"actions",name:"&nbsp;",resizable:false,formatter:aF,sortable:false,width:115,maxWidth:115});var aG=new z.Data.DataView({inlineFilters:false});aG.setItems([]);I({columnId:"name",sortAsc:true},aG);var aE=new z.Grid("#parameter-providers-table",aG,aC,p);aE.setSelectionModel(new z.RowSelectionModel());aE.registerPlugin(new z.AutoTooltips());aE.setSortColumn("name",true);aE.onSort.subscribe(function(aI,aH){I({columnId:aH.sortCol.id,sortAsc:aH.sortAsc},aG)});aE.onClick.subscribe(function(aK,aI){var aJ=aq(aK.target);var aH=aG.getItem(aI.row);if(aE.getColumns()[aI.cell].id==="actions"){if(aJ.hasClass("edit-parameter-provider")){r.showConfiguration(aH)}else{if(aJ.hasClass("fetch-parameter-provider")){r.showFetchDialog(aH)}else{if(aJ.hasClass("delete-parameter-provider")){r.promptToDeleteParameterProvider(aH)}else{if(aJ.hasClass("edit-access-policies")){L.showParameterProviderPolicy(aH);aq("#shell-close-button").click()}}}}}else{if(aE.getColumns()[aI.cell].id==="moreDetails"){if(aJ.hasClass("view-parameter-provider")){r.showDetails(aH)}else{if(aJ.hasClass("parameter-provider-usage")){aq("#shell-close-button").click();o.showPage("../nifi-docs/documentation?"+aq.param({select:aH.component.type,group:aH.component.bundle.group,artifact:aH.component.bundle.artifact,version:aH.component.bundle.version})).done(function(){au.showSettings()})}}}}});aG.onRowCountChanged.subscribe(function(aI,aH){aE.updateRowCount();aE.render()});aG.onRowsChanged.subscribe(function(aI,aH){aE.invalidateRows(aH.rows);aE.render()});aG.syncGridSelection(aE,true);aq("#parameter-providers-table").data("gridInstance",aE).on("mouseenter","div.slick-cell",function(aO){var aM=aq(this).find("div.has-errors");if(aM.length&&!aM.data("qtip")){var aI=aq(this).find("span.row-id").text();var aL=aG.getItemById(aI);var aK=R.formatUnorderedList(aL.component.validationErrors);if(R.isDefinedAndNotNull(aK)){aM.qtip(aq.extend({},R.config.tooltipConfig,{content:aK,position:{target:"mouse",viewport:aq("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var aJ=aq(this).find("div.has-bulletins");if(aJ.length&&!aJ.data("qtip")){var aI=aq(this).find("span.row-id").text();var aH=aG.getItemById(aI);var aN=R.getFormattedBulletins(aH.bulletins);var aK=R.formatUnorderedList(aN);if(R.isDefinedAndNotNull(aK)){aJ.qtip(aq.extend({},R.config.tooltipConfig,{content:aK,position:{target:"mouse",viewport:aq("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var D=function(aC){f(aC.id).done(function(aD){var aE=aD.component.properties;var aF=aD.component.descriptors;aq("#registry-id-config").text(aD.id);aq("#registry-name-config").val(aD.component.name);aq("#registry-type-config").text(aD.component.type);aq("#registry-description-config").val(aD.component.description);aq("#registry-configuration-dialog").modal("setHeaderText","Edit Registry Client").modal("setButtonModel",[{buttonText:"Update",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){v(aD.id)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){aq(this).modal("hide")}}}]).modal("show");aq("#registry-properties").propertytable("clear");aq("#registry-properties").propertytable("loadProperties",aE,aF);aq("#registry-configuration-dialog").data("registryDetails",aD)})};var ag=function(aC){Y.showYesNoDialog({headerText:"Delete Registry",dialogContent:"Delete registry '"+R.escapeHtml(aC.component.name)+"'?",yesHandler:function(){e(aC)}})};var e=function(aD){var aC=E.getRevision(aD);aq.ajax({type:"DELETE",url:aD.uri+"?"+aq.param({version:aC.version,clientId:aC.clientId,disconnectedNodeAcknowledged:s.isDisconnectionAcknowledged()}),dataType:"json"}).done(function(aF){var aE=aq("#registries-table").data("gridInstance");var aG=aE.getData();aG.deleteItem(aD.id);H()}).fail(Z.handleAjaxError)};var ai=function(){var aC=function(){aq("#read-only-maximum-timer-driven-thread-count-field").addClass("unset").text("Unauthorized")};var aH=function(aL){if(aL){aq("#general-settings div.editable").show();aq("#general-settings div.read-only").hide();aq("#settings-save").show()}else{aq("#general-settings div.editable").hide();aq("#general-settings div.read-only").show();aq("#settings-save").hide()}};var aG=aq.Deferred(function(aL){aq.ajax({type:"GET",url:ac.urls.controllerConfig,dataType:"json"}).done(function(aM){if(aM.permissions.canWrite){aq("#maximum-timer-driven-thread-count-field").removeClass("unset").val(aM.component.maxTimerDrivenThreadCount);aH(true);aq("#settings-save").off("click").on("click",function(){N(aM.revision.version)})}else{if(aM.permissions.canRead){aq("#read-only-maximum-timer-driven-thread-count-field").removeClass("unset").text(aM.component.maxTimerDrivenThreadCount)}else{aC()}aH(false)}aL.resolve()}).fail(function(aO,aM,aN){if(aO.status===403){aC();aH(false);aL.resolve()}else{aL.reject(aO,aM,aN)}})}).promise();var aE=ac.urls.api+"/flow/controller/controller-services";var aJ=G.loadControllerServices(aE,ak());var aI=x();var aK=T();var aF=A();var aD=b();return aq.when(aG,aJ,aI,aI,aF,aD).done(function(aN,aM){var aL=aM[0];aq("#settings-last-refreshed").text(aL.currentTime)}).fail(Z.handleAjaxError)};var x=function(){return aq.ajax({type:"GET",url:ac.urls.reportingTasks,dataType:"json"}).done(function(aC){var aG=[];aq.each(aC.reportingTasks,function(aI,aH){aG.push(aq.extend({type:"ReportingTask",bulletins:[]},aH))});var aE=aq("#reporting-tasks-table");R.cleanUpTooltips(aE,"div.has-comments");R.cleanUpTooltips(aE,"div.has-errors");R.cleanUpTooltips(aE,"div.has-bulletins");var aD=aE.data("gridInstance");var aF=aD.getData();aF.setItems(aG);aF.reSort();aD.invalidate()})};var T=function(){return aq.ajax({type:"GET",url:ac.urls.flowAnalysisRules,dataType:"json"}).done(function(aD){var aG=[];aq.each(aD.flowAnalysisRules,function(aI,aH){aG.push(aq.extend({type:"FlowAnalysisRule",bulletins:[]},aH))});var aF=aq("#flow-analysis-rules-table");R.cleanUpTooltips(aF,"div.has-errors");R.cleanUpTooltips(aF,"div.has-bulletins");var aC=aF.data("gridInstance");var aE=aC.getData();aE.setItems(aG);aE.reSort();aC.invalidate()})};var A=function(){return aq.ajax({type:"GET",url:ac.urls.registries,dataType:"json"}).done(function(aC){var aD=[];aq.each(aC.registries,function(aG,aH){aD.push(aq.extend({type:"Registry"},aH))});var aE=aq("#registries-table").data("gridInstance");var aF=aE.getData();aF.setItems(aD);aF.reSort();aE.invalidate()})};var b=function(){return aq.ajax({type:"GET",url:ac.urls.parameterProviders,dataType:"json"}).done(function(aC){var aF=[];aq.each(aC.parameterProviders,function(aH,aI){aF.push(aq.extend({type:"ParameterProvider",bulletins:[]},aI))});var aE=aq("#parameter-providers-table");R.cleanUpTooltips(aE,"div.has-errors");R.cleanUpTooltips(aE,"div.has-bulletins");var aD=aE.data("gridInstance");var aG=aD.getData();aG.setItems(aF);aG.reSort();aD.invalidate()})};var n=function(){return aq.ajax({type:"GET",url:ac.urls.registryTypes,dataType:"json"}).done(function(aC){var aD=[];aC.flowRegistryClientTypes.forEach(function(aE){aD.push({text:R.substringAfterLast(aE.type,".")+" ("+aE.bundle.version+")",value:aE.type,description:aE.description||""})});aq("#new-registry-type-combo").combo({options:aD})})};var aw=function(){var aC=aq("#registry-configuration-dialog").data("registryDetails");if(aq("#registry-name-config").val()!==aC.component.name){return true}if(aq("#registry-description-config").val()!==aC.component.description){return true}return aq("#registry-properties").propertytable("isSaveRequired")};var F=function(){return aq.Deferred(function(aC){aq("#registry-properties").propertytable("saveRow");if(aw()){Y.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){aC.resolve()},yesHandler:function(){var aD=aq("#registry-configuration-dialog").data("registryDetails");v(aD.id).done(function(){aC.resolve()}).fail(function(){aC.reject()})}})}else{aC.resolve()}}).promise()};var O=function(aD,aC){var aE=aq("#registry-configuration-dialog").data("registryDetails");return aq.ajax({type:"GET",url:aE.uri+"/descriptors",data:{propertyName:aD,sensitive:aC},dataType:"json"}).fail(Z.handleAjaxError)};var av=function(aC){o.showContent("#settings").done(function(){W()});aq("#settings-tabs").find(aC?'[name="'+aC+'"]':".selected-tab").click();au.resetTableSize()};var W=function(){aq("#settings-save").mouseout()};var a=function(aE){var aC=aq("#registries-table").data("gridInstance");var aD=aC.getData();aD.updateItem(aE.id,aq.extend({type:"Registry"},aE))};var f=function(aF){var aC=aq("#registries-table").data("gridInstance");var aD=aC.getData();var aE=aD.getItemById(aF);return aq.ajax({type:"GET",url:aE.uri,dataType:"json"}).done(function(aG){a(aG)}).fail(Z.handleAjaxError)};var au={init:function(){aq("#settings-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-settings-tab-content"},{name:"Management Controller Services",tabContentId:"controller-services-tab-content"},{name:"Reporting Tasks",tabContentId:"reporting-tasks-tab-content"},{name:"Flow Analysis Rules",tabContentId:"flow-analysis-rules-tab-content"},{name:"Registry Clients",tabContentId:"registries-tab-content"},{name:"Parameter Providers",tabContentId:"parameter-providers-tab-content"}],select:function(){var aC=aq(this).text();if(aC==="General"){aq("#controller-cs-availability").hide();aq("#new-service-or-task").hide();aq("#settings-save").show()}else{var aD=false;if(R.isDefinedAndNotNull(R.currentUser)){aD=R.currentUser.controllerPermissions.canWrite===true}if(aD){aq("#new-service-or-task").show();aq("div.controller-settings-table").css("top","32px");aq("#new-service-or-task").attr("title",function(){if(aC==="Management Controller Services"){aq("#settings-save").hide();return"Create a new controller level controller service"}else{if(aC==="Reporting Tasks"){aq("#settings-save").hide();return"Create a new reporting task"}else{if(aC==="Flow Analysis Rules"){aq("#settings-save").hide();return"Create a Flow Analysis Rule"}else{if(aC==="Registry Clients"){aq("#settings-save").hide();return"Register a new registry client"}else{if(aC==="Parameter Providers"){aq("#settings-save").hide();return"Add a new parameter provider"}}}}}})}else{aq("#new-service-or-task").hide();aq("div.controller-settings-table").css("top","0")}if(aC==="Management Controller Services"){aq("#controller-cs-availability").show()}else{if(aC==="Reporting Tasks"||aC==="Flow Analysis Rules"||aC==="Registry Clients"||aC==="Parameter Providers"){aq("#controller-cs-availability").hide()}}au.resetTableSize()}}});aq("#settings-refresh-button").click(function(){ai()});aq("#new-service-or-task").on("click",function(){var aG=aq("#settings-tabs li.selected-tab").text();if(aG==="Management Controller Services"){var aF=ac.urls.api+"/controller/controller-services";G.promptNewControllerService(aF,ak())}else{if(aG==="Reporting Tasks"){aq("#new-reporting-task-dialog").modal("show");var aI=aq("#reporting-task-types-table").data("gridInstance");if(R.isDefinedAndNotNull(aI)){var aD=aI.getData();aI.resizeCanvas();if(aD.getLength()>0){w.choseFirstRow(aI)}}aq("#reporting-task-type-filter").focus()}else{if(aG==="Flow Analysis Rules"){aq("#new-flow-analysis-rule-dialog").modal("show");var aC=aq("#flow-analysis-rule-types-table").data("gridInstance");if(R.isDefinedAndNotNull(aC)){var aH=aC.getData();aC.resizeCanvas();if(aH.getLength()>0){w.choseFirstRow(aC)}}aq("#flow-analysis-rule-type-filter").focus()}else{if(aG==="Registry Clients"){aq("#new-registry-name").val("");aq("#new-registry-description").val("");n().done(function(){aq("#new-registry-client-dialog").modal("show");aq("#new-registry-name").focus()})}else{if(aG==="Parameter Providers"){aq("#new-parameter-provider-dialog").modal("show");var aJ=aq("#parameter-provider-types-table").data("gridInstance");if(R.isDefinedAndNotNull(aJ)){var aE=aJ.getData();aJ.resizeCanvas();if(aE.getLength()>0){w.choseFirstRow(aJ)}}aq("#parameter-provider-type-filter").focus()}}}}}});aq("#registry-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-registry-property-container",descriptorDeferred:O,controllerServiceCreatedDeferred:function(aD){var aC=ac.urls.api+"/flow/controller/controller-services";return G.loadControllerServices(aC,aq("#controller-services-table"))},goToServiceDeferred:F});aq("#registry-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"registry-configuration-settings-tab-content"},{name:"Properties",tabContentId:"registry-configuration-properties-tab-content"}],select:function(){var aC=aq(this).text();if(aC==="Properties"){aq("#registry-properties").propertytable("resetTableSize")}}});aq("#registry-configuration-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){aq("#registry-id-config").text("");aq("#registry-name-config").val("");aq("#registry-type-config").val("");aq("#registry-description-config").val("")}}});j();G.init(ak(),au.showSettings);an();ar();J();g();h()},reloadRegistry:function(aC){return f(aC)},resetTableSize:function(){G.resetTableSize(ak());var aF=aq("#reporting-tasks-table").data("gridInstance");if(R.isDefinedAndNotNull(aF)){aF.resizeCanvas()}var aC=aq("#flow-analysis-rules-table").data("gridInstance");if(R.isDefinedAndNotNull(aC)){aC.resizeCanvas()}var aE=aq("#parameter-providers-table").data("gridInstance");if(R.isDefinedAndNotNull(aE)){aE.resizeCanvas()}var aD=aq("#registries-table").data("gridInstance");if(R.isDefinedAndNotNull(aD)){aD.resizeCanvas()}},showSettings:function(aC){return ai().done(function(){av(aC)})},loadSettings:function(){return ai()},selectControllerService:function(aC){var aD=ak().data("gridInstance");var aE=aD.getData();var aF=aE.getRowById(aC);w.choseRow(aD,aF);aD.scrollRowIntoView(aF);aq("#settings-tabs").find("li:eq(1)").click()},selectReportingTask:function(aC){var aF=aq("#reporting-tasks-table").data("gridInstance");var aD=aF.getData();var aE=aD.getRowById(aC);w.choseRow(aF,aE);aF.scrollRowIntoView(aE);aq("#settings-tabs").find("li:eq(2)").click()},selectFlowAnalysisRule:function(aF){var aC=aq("#flow-analysis-rules-table").data("gridInstance");var aD=aC.getData();var aE=aD.getRowById(aF);w.choseRow(aC,aE);aC.scrollRowIntoView(aE);aq("#settings-tabs").find("li:eq(3)").click()},setBulletins:function(aE,aC){if(aq("#controller-services-table").data("gridInstance")){G.setBulletins(ak(),aE)}var aD=aq("#reporting-tasks-table").data("gridInstance");var aG=aD.getData();aG.beginUpdate();if(!R.isEmpty(aC)){var aH=new Map(aC.map(function(aI){return[aI.sourceId,aI]}));aH.forEach(function(aI,aJ){var aK=aG.getItemById(aJ);if(R.isDefinedAndNotNull(aK)){aG.updateItem(aJ,aq.extend(aK,{bulletins:aI}))}})}else{var aF=aG.getItems();aq.each(aF,function(aI,aJ){aG.updateItem(aJ.id,aq.extend(aJ,{bulletins:[]}))})}aG.endUpdate()}};return au}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.ng.BreadcrumbsCtrl=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.BreadcrumbsCtrl=b(require("jquery"),require("nf.Common")))}else{nf.ng.BreadcrumbsCtrl=b(a.$,a.nf.Common)}}}(this,function(a,b){return function(e){function d(){this.breadcrumbs=[]}d.prototype={constructor:d,register:function(){if(e.breadcrumbsCtrl===undefined){e.register("breadcrumbsCtrl",c)}},generateBreadcrumbs:function(g){var f=g.id;if(g.permissions.canRead){f=g.breadcrumb.name}this.breadcrumbs.unshift(a.extend({label:f},g));if(b.isDefinedAndNotNull(g.parentBreadcrumb)){this.generateBreadcrumbs(g.parentBreadcrumb)}},updateVersionControlInformation:function(f,g){a.each(this.breadcrumbs,function(h,i){if(i.id===f){i.breadcrumb.versionControlInformation=g;return false}})},resetBreadcrumbs:function(){this.breadcrumbs=[]},isTracking:function(f){return b.isDefinedAndNotNull(f.versionedFlowState)},getVersionControlClass:function(g){if(b.isDefinedAndNotNull(g.versionedFlowState)){var f=g.versionedFlowState;if(f==="SYNC_FAILURE"){return"breadcrumb-version-control-gray fa fa-question"}else{if(f==="LOCALLY_MODIFIED_AND_STALE"){return"breadcrumb-version-control-red fa fa-exclamation-circle"}else{if(f==="STALE"){return"breadcrumb-version-control-red fa fa-arrow-circle-up"}else{if(f==="LOCALLY_MODIFIED"){return"breadcrumb-version-control-gray fa fa-asterisk"}else{return"breadcrumb-version-control-green fa fa-check"}}}}}else{return""}},getVersionControlTooltip:function(f){if(b.isDefinedAndNotNull(f.versionedFlowState)&&f.permissions.canRead){return b.getVersionControlTooltip(f.breadcrumb.versionControlInformation)}else{return"This Process Group is not under version control."}},getBreadcrumbs:function(){return this.breadcrumbs},updateBreadcrumbsCss:function(f){a("#breadcrumbs").css(f)},resetScrollPosition:function(){var l=a("#data-flow-title-container");var i=l.position();var m=l.outerWidth();var k=i.left+m;var j=a("#breadcrumbs-right-border").width();var g=a("#data-flow-title-viewport");var h=g.width();var f=h-j;if(k>f){l.css("left",(i.left-(k-f))+"px")}else{l.css("left","10px")}},registerMouseWheelEvent:function(f){f.on("DOMMouseScroll mousewheel",function(s,l){if(b.isUndefinedOrNull(s.originalEvent)){return}var m=a("#data-flow-title-container");var g=m.position();var q=m.outerWidth();var j=g.left+q;var n=a("#breadcrumbs-right-border").width();var k=a("#data-flow-title-viewport");var i=k.width();var h=i-n;if(q>i){var p=false;var r=0;if(b.isDefinedAndNotNull(s.originalEvent.wheelDelta)){r=s.originalEvent.wheelDelta}else{if(b.isDefinedAndNotNull(s.originalEvent.detail)){r=-s.originalEvent.detail}}if(r>0&&j>h){var o=-25;p=true}else{if(r<0&&(g.left-n)<0){o=25;if(g.left+o>n){o=n-g.left}p=true}}if(p){m.css("left",(g.left+o)+"px")}}})}};var c=new d();c.register();return c}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.AuthorizationStorage","nf.Shell","nf.ErrorHandler"],function(e,f,d,c,g){return(nf.ng.Canvas.HeaderCtrl=b(e,f,d,c,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.HeaderCtrl=b(require("jquery"),require("nf.Common"),require("nf.AuthorizationStorage"),require("nf.Shell"),require("nf.ErrorHandler")))}else{nf.ng.Canvas.HeaderCtrl=b(a.$,a.nf.Common,a.nf.AuthorizationStorage,a.nf.Shell,a.nf.ErrorHandler)}}}(this,function(c,d,b,a,e){return function(k,m,f,i){var j=640;var h={urls:{accessConfig:"../nifi-api/access/config"}};function l(p,n,o){this.toolboxCtrl=p;this.globalMenuCtrl=n;this.flowStatusCtrl=o;this.loginCtrl={init:function(){var q=this;if(c("#current-user").text()!==d.ANONYMOUS_USER_TEXT||location.protocol==="http:"){c("#login-link-container").css("display","none")}if(location.protocol==="http:"){c("#current-user-container").css("display","none")}var r=c.ajax({type:"GET",url:h.urls.accessConfig,dataType:"json"});c.when(r).done(function(s){q.supportsLogin=s.config.supportsLogin}).fail(e.handleAjaxError)},supportsLogin:undefined,shell:{launch:function(){a.showPage("login",false)}}};this.logoutCtrl={logout:function(){c.ajax({type:"DELETE",url:"../nifi-api/access/logout",}).done(function(){b.removeToken();window.location="../nifi/logout"}).fail(e.handleAjaxError)}}}l.prototype={constructor:l,register:function(){if(k.headerCtrl===undefined){k.register("headerCtrl",g)}},init:function(){this.toolboxCtrl.init();this.globalMenuCtrl.init();this.flowStatusCtrl.init();this.loginCtrl.init()}};var g=new l(m,f,i);g.register();return g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.CanvasUtils","nf.ContextMenu"],function(d,c){return(nf.ng.Canvas.ToolboxCtrl=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.ToolboxCtrl=b(require("nf.CanvasUtils"),require("nf.ContextMenu")))}else{nf.ng.Canvas.ToolboxCtrl=b(a.nf.CanvasUtils,a.nf.ContextMenu)}}}(this,function(b,a){return function(m,f,j,c,k,l,h,e,i){function g(v,p,s,n,t,u,q,o,r){this.processorComponent=v;this.inputPortComponent=p;this.outputPortComponent=s;this.groupComponent=n;this.remoteGroupComponent=t;this.funnelComponent=u;this.templateComponent=q;this.registryImportComponent=o;this.labelComponent=r;this.config={type:{processor:"Processor",inputPort:"Input Port",outputPort:"Output Port",processGroup:"Process Group",remoteProcessGroup:"Remote Process Group",connection:"Connection",funnel:"Funnel",template:"Template",importFromRegistry:"Import from Registry",label:"Label"},urls:{api:"../nifi-api",controller:"../nifi-api/controller",processorTypes:"../nifi-api/flow/processor-types"}}}g.prototype={constructor:g,init:function(){m.modal.init();f.modal.init();j.modal.init();c.modal.init();k.modal.init();h.modal.init()},draggableComponentConfig:function(n){n.getElement().hover(function(){n.getElement().removeClass(n.icon).addClass(n.hoverIcon)},function(){n.getElement().removeClass(n.hoverIcon).addClass(n.icon)});return{zIndex:1011,revert:true,revertDuration:0,cancel:false,containment:"body",cursor:"-webkit-grabbing",start:function(p,o){a.hide()},stop:function(s,r){var u=b.getCanvasTranslate();var t=b.getCanvasScale();var q=s.originalEvent.pageX;var p=s.originalEvent.pageY-b.getCanvasOffset();if(q>=0&&p>=0){var o=(q/t)-(u[0]/t);var v=(p/t)-(u[1]/t);n.dropHandler.apply(n,[{x:o,y:v}])}},helper:n.dragIcon}}};var d=new g(m,f,j,c,k,l,h,e,i);return d}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Dialog","nf.CanvasUtils","nf.ContextMenu","nf.ClusterSummary","nf.ErrorHandler","nf.Settings","nf.ParameterContexts","nf.ProcessGroup","nf.ProcessGroupConfiguration"],function(i,e,h,f,l,k,j,g,m,c,d){return(nf.ng.Canvas.FlowStatusCtrl=b(i,e,h,f,l,k,j,g,m,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.FlowStatusCtrl=b(require("jquery"),require("nf.Common"),require("nf.Dialog"),require("nf.CanvasUtils"),require("nf.ContextMenu"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Settings"),require("nf.ParameterContexts"),require("nf.ProcessGroup"),require("nf.ProcessGroupConfiguration")))}else{nf.ng.Canvas.FlowStatusCtrl=b(a.$,a.nf.Common,a.nf.Dialog,a.nf.CanvasUtils,a.nf.ContextMenu,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Settings,a.nf.ParameterContexts,a.nf.ProcessGroup,a.nf.ProcessGroupConfiguration)}}}(this,function(g,c,f,d,j,i,h,e,k,a,b){return function(o){var l={search:"Search",urls:{search:"../nifi-api/flow/search-results",status:"../nifi-api/flow/status"}};function n(){this.connectedNodesCount="-";this.clusterConnectionWarning=false;this.activeThreadCount="-";this.terminatedThreadCount="-";this.threadCounts="-";this.totalQueued="-";this.controllerTransmittingCount="-";this.controllerNotTransmittingCount="-";this.controllerRunningCount="-";this.controllerStoppedCount="-";this.controllerInvalidCount="-";this.controllerDisabledCount="-";this.controllerUpToDateCount="-";this.controllerLocallyModifiedCount="-";this.controllerStaleCount="-";this.controllerLocallyModifiedAndStaleCount="-";this.controllerSyncFailureCount="-";this.statsLastRefreshed="-";this.search={getInputElement:function(){return g("#search-field")},getButtonElement:function(){return g("#search-button")},getSearchContainerElement:function(){return g("#search-container")},init:function(){var p=this;g.widget("nf.searchAutocomplete",g.ui.autocomplete,{reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-header, .search-no-matches)")},_resizeMenu:function(){var q=this.menu.element;q.width(400)},_normalize:function(r){var q=[];q.push(r);return q},_renderMenu:function(s,r){var q=this;var t=r[0];if(!c.isEmpty(t.processorResults)){s.append('<li class="search-header"><div class="search-result-icon icon icon-processor"></div>Processors</li>');g.each(t.processorResults,function(v,u){q._renderItem(s,g.extend({},u,{type:"processor"}))})}if(!c.isEmpty(t.processGroupResults)){s.append('<li class="search-header"><div class="search-result-icon icon icon-group"></div>Process Groups</li>');g.each(t.processGroupResults,function(v,u){q._renderItem(s,g.extend({},u,{type:"process group"}))})}if(!c.isEmpty(t.remoteProcessGroupResults)){s.append('<li class="search-header"><div class="search-result-icon icon icon-group-remote"></div>Remote Process Groups</li>');g.each(t.remoteProcessGroupResults,function(u,v){q._renderItem(s,g.extend({},v,{type:"remote process group"}))})}if(!c.isEmpty(t.connectionResults)){s.append('<li class="search-header"><div class="search-result-icon icon icon-connect"></div>Connections</li>');g.each(t.connectionResults,function(v,u){q._renderItem(s,g.extend({},u,{type:"connection"}))})}if(!c.isEmpty(t.inputPortResults)){s.append('<li class="search-header"><div class="search-result-icon icon icon-port-in"></div>Input Ports</li>');g.each(t.inputPortResults,function(u,v){q._renderItem(s,g.extend({},v,{type:"input port"}))})}if(!c.isEmpty(t.outputPortResults)){s.append('<li class="search-header"><div class="search-result-icon icon icon-port-out"></div>Output Ports</li>');g.each(t.outputPortResults,function(u,v){q._renderItem(s,g.extend({},v,{type:"output port"}))})}if(!c.isEmpty(t.funnelResults)){s.append('<li class="search-header"><div class="search-result-icon icon icon-funnel"></div>Funnels</li>');g.each(t.funnelResults,function(v,u){q._renderItem(s,g.extend({},u,{type:"funnel"}))})}if(!c.isEmpty(t.labelResults)){s.append('<li class="search-header"><div class="search-result-icon icon icon-label"></div>Labels</li>');g.each(t.labelResults,function(u,v){q._renderItem(s,g.extend({},v,{type:"label"}))})}if(!c.isEmpty(t.controllerServiceNodeResults)){s.append('<li class="search-header"><div class="search-result-icon icon"></div>Controller Services</li>');g.each(t.controllerServiceNodeResults,function(u,v){q._renderItem(s,g.extend({},v,{type:"controller service"}))})}if(!c.isEmpty(t.parameterProviderNodeResults)){s.append('<li class="search-header"><div class="search-result-icon icon"></div>Parameter Providers</li>');g.each(t.parameterProviderNodeResults,function(v,u){q._renderItem(s,g.extend({},u,{type:"parameter provider"}))})}if(!c.isEmpty(t.parameterContextResults)){s.append('<li class="search-header"><div class="search-result-icon icon"></div>Parameter Contexts</li>');g.each(t.parameterContextResults,function(u,v){q._renderItem(s,g.extend({},v,{type:"parameter context"}))})}if(!c.isEmpty(t.parameterResults)){s.append('<li class="search-header"><div class="search-result-icon icon"></div>Parameters</li>');g.each(t.parameterResults,function(v,u){q._renderItem(s,g.extend({},u,{type:"parameter"}))})}if(s.children().length===0){s.append('<li class="unset search-no-matches">No results matched the search terms</li>')}},_renderItem:function(u,s){var z=g('<div class="search-match-header"></div>').text(s.name);var t=g("<a></a>").append(z);if(s.type!=="parameter context"&&s.type!=="parameter"){var x=g('<div class="search-match-header"></div>').append(document.createTextNode("Parent: "));var v="-";if(c.isDefinedAndNotNull(s.parentGroup)){v=s.parentGroup.name?s.parentGroup.name:s.parentGroup.id}x=x.append(g("<span></span>").text(v));var w=g('<div class="search-match-header"></div>').append(document.createTextNode("Versioned: "));var r="-";if(c.isDefinedAndNotNull(s.versionedGroup)){r=s.versionedGroup.name?s.versionedGroup.name:s.versionedGroup.id}w=w.append(g("<span></span>").text(r));t.append(x).append(w)}else{if(s.type==="parameter"){var q=g('<div class="search-match-header"></div>').append(document.createTextNode("Parameter Context: "));var y="-";if(c.isDefinedAndNotNull(s.parentGroup)){y=s.parentGroup.name?s.parentGroup.name:s.parentGroup.id}q=q.append(g("<span></span>").text(y));t.append(q)}}g.each(s.matches,function(B,A){t.append(g('<div class="search-match"></div>').text(A))});return g("<li></li>").data("ui-autocomplete-item",s).append(t).appendTo(u)}});this.getInputElement().searchAutocomplete({delay:1000,appendTo:"#search-flow-results",position:{my:"right top",at:"right bottom",offset:"1 1"},source:function(r,q){g.ajax({type:"GET",data:{q:r.term,a:d.getGroupId()},dataType:"json",url:l.urls.search}).done(function(s){q(s.searchResultsDTO)})},select:function(s,t){var r=t.item;switch(r.type){case"parameter context":k.showParameterContexts(r.id);break;case"parameter":var q=r.parentGroup;k.showParameterContext(q.id,null,r.name);break;case"controller service":var u=r.parentGroup;a.enterGroup(u.id).done(function(){b.showConfiguration(u.id).done(function(){b.selectControllerService(r.id)})});break;default:var u=r.parentGroup;d.showComponent(u.id,r.id);break}p.getInputElement().val("").blur();return false},open:function(q,r){var s=g(this);g('<div class="search-glass-pane"></div>').one("click",function(){}).appendTo("body")},close:function(q,r){g(this).searchAutocomplete("reset");p.getInputElement().val("");g("div.search-glass-pane").remove()}});p.toggleSearchField()},toggleSearchField:function(){var s=this;j.hide();var p=s.getInputElement().is(":visible");var t="none";var r="search-container-opened";var q="search-container-closed";if(!p){s.getButtonElement().css("background-color","#FFFFFF");t="inline-block";r="search-container-closed";q="search-container-opened"}else{s.getInputElement().css("display",t)}this.getSearchContainerElement().switchClass(r,q,500,function(){s.getInputElement().css("display",t);if(!p){s.getButtonElement().css("background-color","#FFFFFF");s.getInputElement().focus()}else{s.getButtonElement().css("background-color","#E3E8EB")}})}};this.bulletins={update:function(p){var r=g("#bulletin-button");var t=r.data("bulletins");if(c.doBulletinsDiffer(t,p.bulletins)){r.data("bulletins",p.bulletins);var s=c.getFormattedBulletins(p.bulletins);if(s.length===0){if(r.data("qtip")){r.removeClass("has-bulletins").qtip("api").destroy(true)}}else{var q=c.formatUnorderedList(s);if(r.data("qtip")){r.qtip("option","content.text",q)}else{r.addClass("has-bulletins").qtip(g.extend({},d.config.systemTooltipConfig,{content:q,position:{at:"bottom left",my:"top right",adjust:{x:4}}}))}}}e.setBulletins(p.controllerServiceBulletins,p.reportingTaskBulletins)}}}n.prototype={constructor:n,init:function(){this.search.init()},reloadFlowStatus:function(){var p=this;return g.ajax({type:"GET",url:l.urls.status,dataType:"json"}).done(function(q){if(c.isDefinedAndNotNull(q.controllerStatus)){p.update(q.controllerStatus)}}).fail(h.handleAjaxError)},updateClusterSummary:function(q){if(q.connectedToCluster){var p=q.connectedNodes.split(" / ");if(p.length===2&&p[0]!==p[1]){this.clusterConnectionWarning=true}else{this.clusterConnectionWarning=false}this.connectedNodesCount=q.connectedNodes}else{this.connectedNodesCount="Disconnected"}},hasTerminatedThreads:function(){if(Number.isInteger(this.terminatedThreadCount)){return this.terminatedThreadCount>0}else{return false}},getExtraThreadStyles:function(){if(Number.isInteger(this.terminatedThreadCount)&&this.terminatedThreadCount>0){return"warning"}else{if(this.activeThreadCount===0){return"zero"}}return""},getExtraClusterStyles:function(){if(this.connectedNodesCount==="Disconnected"||this.clusterConnectionWarning===true){return"warning"}return""},update:function(p){this.activeThreadCount=p.activeThreadCount;this.terminatedThreadCount=p.terminatedThreadCount;if(this.hasTerminatedThreads()){this.threadCounts=this.activeThreadCount+" ("+this.terminatedThreadCount+")"}else{this.threadCounts=this.activeThreadCount}this.totalQueued=p.queued;if(this.totalQueued.indexOf("0 / 0")>=0){g("#flow-status-container").find(".fa-list").addClass("zero")}else{g("#flow-status-container").find(".fa-list").removeClass("zero")}this.controllerTransmittingCount=c.isDefinedAndNotNull(p.activeRemotePortCount)?p.activeRemotePortCount:"-";if(this.controllerTransmittingCount>0){g("#flow-status-container").find(".fa-bullseye").removeClass("zero").addClass("transmitting")}else{g("#flow-status-container").find(".fa-bullseye").removeClass("transmitting").addClass("zero")}this.controllerNotTransmittingCount=c.isDefinedAndNotNull(p.inactiveRemotePortCount)?p.inactiveRemotePortCount:"-";if(this.controllerNotTransmittingCount>0){g("#flow-status-container").find(".icon-transmit-false").removeClass("zero").addClass("not-transmitting")}else{g("#flow-status-container").find(".icon-transmit-false").removeClass("not-transmitting").addClass("zero")}this.controllerRunningCount=c.isDefinedAndNotNull(p.runningCount)?p.runningCount:"-";if(this.controllerRunningCount>0){g("#flow-status-container").find(".fa-play").removeClass("zero").addClass("running")}else{g("#flow-status-container").find(".fa-play").removeClass("running").addClass("zero")}this.controllerStoppedCount=c.isDefinedAndNotNull(p.stoppedCount)?p.stoppedCount:"-";if(this.controllerStoppedCount>0){g("#flow-status-container").find(".fa-stop").removeClass("zero").addClass("stopped")}else{g("#flow-status-container").find(".fa-stop").removeClass("stopped").addClass("zero")}this.controllerInvalidCount=c.isDefinedAndNotNull(p.invalidCount)?p.invalidCount:"-";if(this.controllerInvalidCount>0){g("#flow-status-container").find(".fa-warning").removeClass("zero").addClass("invalid")}else{g("#flow-status-container").find(".fa-warning").removeClass("invalid").addClass("zero")}this.controllerDisabledCount=c.isDefinedAndNotNull(p.disabledCount)?p.disabledCount:"-";if(this.controllerDisabledCount>0){g("#flow-status-container").find(".icon-enable-false").removeClass("zero").addClass("disabled")}else{g("#flow-status-container").find(".icon-enable-false").removeClass("disabled").addClass("zero")}this.controllerUpToDateCount=c.isDefinedAndNotNull(p.upToDateCount)?p.upToDateCount:"-";if(this.controllerUpToDateCount>0){g("#flow-status-container").find(".fa-check").removeClass("zero").addClass("up-to-date")}else{g("#flow-status-container").find(".fa-check").removeClass("up-to-date").addClass("zero")}this.controllerLocallyModifiedCount=c.isDefinedAndNotNull(p.locallyModifiedCount)?p.locallyModifiedCount:"-";if(this.controllerLocallyModifiedCount>0){g("#flow-status-container").find(".fa-asterisk").removeClass("zero").addClass("locally-modified")}else{g("#flow-status-container").find(".fa-asterisk").removeClass("locally-modified").addClass("zero")}this.controllerStaleCount=c.isDefinedAndNotNull(p.staleCount)?p.staleCount:"-";if(this.controllerStaleCount>0){g("#flow-status-container").find(".fa-arrow-circle-up").removeClass("zero").addClass("stale")}else{g("#flow-status-container").find(".fa-arrow-circle-up").removeClass("stale").addClass("zero")}this.controllerLocallyModifiedAndStaleCount=c.isDefinedAndNotNull(p.locallyModifiedAndStaleCount)?p.locallyModifiedAndStaleCount:"-";if(this.controllerLocallyModifiedAndStaleCount>0){g("#flow-status-container").find(".fa-exclamation-circle").removeClass("zero").addClass("locally-modified-and-stale")}else{g("#flow-status-container").find(".fa-exclamation-circle").removeClass("locally-modified-and-stale").addClass("zero")}this.controllerSyncFailureCount=c.isDefinedAndNotNull(p.syncFailureCount)?p.syncFailureCount:"-";if(this.controllerSyncFailureCount>0){g("#flow-status-container").find(".fa-question").removeClass("zero").addClass("sync-failure")}else{g("#flow-status-container").find(".fa-question").removeClass("sync-failure").addClass("zero")}},updateBulletins:function(p){this.bulletins.update(p)}};var m=new n();return m}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.QueueListing","nf.Shell","nf.ParameterContexts","nf.PolicyManagement","nf.ClusterSummary","nf.StatusHistory","nf.ErrorHandler","nf.Settings","nf.CanvasUtils"],function(g,f,m,c,l,j,i,k,h,e,d){return(nf.ng.Canvas.GlobalMenuCtrl=b(g,f,m,c,j,i,k,h,e,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.GlobalMenuCtrl=b(require("jquery"),require("nf.Common"),require("nf.QueueListing"),require("nf.Shell"),require("nf.ParameterContexts"),require("nf.PolicyManagement"),require("nf.ClusterSummary"),require("nf.StatusHistory"),require("nf.ErrorHandler"),require("nf.Settings"),require("nf.CanvasUtils")))}else{nf.ng.Canvas.GlobalMenuCtrl=b(a.$,a.nf.Common,a.nf.QueueListing,a.nf.Shell,a.nf.ParameterContexts,a.nf.PolicyManagement,a.nf.ClusterSummary,a.nf.StatusHistory,a.nf.ErrorHandler,a.nf.Settings,a.nf.CanvasUtils)}}}(this,function(e,d,k,a,j,h,g,i,f,c,b){return function(o){var m={urls:{helpDocument:"../nifi-docs/documentation",controllerAbout:"../nifi-api/flow/about"}};function n(p){this.summary={shell:{launch:function(){a.showPage("summary")}}};this.counters={shell:{launch:function(){if(d.canAccessCounters()){a.showPage("counters")}}}};this.bulletinBoard={shell:{launch:function(){a.showPage("bulletin-board")}}};this.dataProvenance={shell:{launch:function(){if(d.canAccessProvenance()){a.showPage("provenance")}}}};this.controllerSettings={shell:{launch:function(){c.showSettings()}}};this.parameterContexts={shell:{launch:function(){j.showParameterContexts()}}};this.cluster={visible:function(){return g.isConnectedToCluster()},shell:{launch:function(){if(d.canAccessController()){a.showPage("cluster")}}}};this.flowConfigHistory={shell:{launch:function(){a.showPage("history")}}};this.nodeStatusHistory={shell:{launch:function(){i.showNodeChart()}}};this.users={shell:{launch:function(){if(d.canAccessTenants()){a.showPage("users")}}}};this.policies={shell:{launch:function(){if(d.canModifyPolicies()&&d.canAccessTenants()){h.showGlobalPolicies()}}}};this.templates={shell:{launch:function(){a.showPage("templates?"+e.param({groupId:b.getGroupId()}))}}};this.help={shell:{launch:function(){a.showPage(m.urls.helpDocument)}}};this.about={init:function(){e.ajax({type:"GET",url:m.urls.controllerAbout,dataType:"json"}).done(function(s){var q=s.about;document.title=q.title;e("#nf-version").text(q.version);var r=false;if(q.buildTag&&q.buildTag!=="HEAD"){e("#nf-about-build-tag").text(q.buildTag);e("#nf-version-detail-tag").show();r=true}if(q.buildRevision){e("#nf-about-build-revision").text(q.buildRevision);e("#nf-about-build-branch").text(q.buildBranch);e("#nf-version-detail-commit").show();r=true}if(q.buildTimestamp){e("#nf-about-build-timestamp").text(q.buildTimestamp);e("#nf-version-detail-timestamp").show();r=true}if(r){e("#nf-version-detail").show()}if(!d.isBlank(q.contentViewerUrl)){e("#nifi-content-viewer-url").text(q.contentViewerUrl);k.initFlowFileDetailsDialog()}}).fail(f.handleAjaxError);this.modal.init()},modal:{getElement:function(){return e("#nf-about")},init:function(){var q=this;var r=function(){var s=e(this);var t=e("#nf-about-pic-container").height()+e(".dialog-header").height()+10;s.find(".dialog-content").css("top",t)};this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"About Apache NiFi",handler:{resize:r},buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){q.hide()}}}]})},update:function(r,q){this.getElement().modal(r,q)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}}n.prototype={constructor:n,init:function(){this.about.init()}};var l=new n();return l}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Actions","nf.Birdseye","nf.Storage","nf.CanvasUtils","nf.ProcessGroupConfiguration"],function(h,d,g,e,f,c){return(nf.ng.Canvas.GraphControlsCtrl=b(h,d,g,e,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.GraphControlsCtrl=b(require("jquery"),require("nf.Actions"),require("nf.Birdseye"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.ProcessGroupConfiguration")))}else{nf.ng.Canvas.GraphControlsCtrl=b(a.$,a.nf.Actions,a.nf.Birdseye,a.nf.Storage,a.nf.CanvasUtils,a.nf.ProcessGroupConfiguration)}}}(this,function(f,b,e,c,d,a){return function(m,i,l){var k=function(n){if(f("div.graph-control-content").is(":visible")===false){f("#graph-controls div.graph-control-docked").hide();f("#graph-controls div.graph-control-header-container").show();f(".graph-control").removeClass("docked")}n.children("div.graph-control-content").show();n.find("div.graph-control-expansion").removeClass("fa-plus-square-o").addClass("fa-minus-square-o");if(n.attr("id")==="navigation-control"){e.updateBirdseyeVisibility(true)}var o=c.getItem("graph-control-visibility");if(o===null){o={}}var p=n.attr("id");o[p]=true;c.setItem("graph-control-visibility",o)};var j=function(n){n.children("div.graph-control-content").hide();n.find("div.graph-control-expansion").removeClass("fa-minus-square-o").addClass("fa-plus-square-o");if(f("div.graph-control-content").is(":visible")===false){f("#graph-controls div.graph-control-header-container").hide();f("#graph-controls div.graph-control-docked").show();f(".graph-control").addClass("docked")}if(n.attr("id")==="navigation-control"){e.updateBirdseyeVisibility(false)}var o=c.getItem("graph-control-visibility");if(o===null){o={}}var p=n.attr("id");o[p]=false;c.setItem("graph-control-visibility",o)};function h(n,o){this.navigateCtrl=n;this.operateCtrl=o}h.prototype={constructor:h,register:function(){if(m.graphControlsCtrl===undefined){m.register("graphControlsCtrl",g)}},init:function(){this.operateCtrl.init();var n=c.getItem("graph-control-visibility");if(n!==null){f.each(n,function(q,o){var p=f("#"+q);if(p){if(o){k(p)}else{j(p)}}})}else{k(f("#navigation-control"));k(f("#operation-control"))}},undock:function(n){k(f(n.target).parent())},expand:function(n){var o=f(n.target);if(o.find(".fa-plus-square-o").length>0||o.hasClass("fa-plus-square-o")||o.parent().children().find(".fa-plus-square-o").length>0){k(o.closest("div.graph-control"))}else{j(o.closest("div.graph-control"))}},getContextIcon:function(){var n=d.getSelection();if(n.empty()){if(d.getParentGroupId()===null){return"icon-drop"}else{return"icon-group"}}else{if(n.size()===1){if(d.isProcessor(n)){return"icon-processor"}else{if(d.isProcessGroup(n)){return"icon-group"}else{if(d.isInputPort(n)){return"icon-port-in"}else{if(d.isOutputPort(n)){return"icon-port-out"}else{if(d.isRemoteProcessGroup(n)){return"icon-group-remote"}else{if(d.isFunnel(n)){return"icon-funnel"}else{if(d.isLabel(n)){return"icon-label"}else{if(d.isConnection(n)){return"icon-connect"}}}}}}}}}else{return"icon-drop"}}},hide:function(){var n=d.getSelection();if(n.size()>1){return"invisible"}else{return""}},getContextName:function(){var o=d.getSelection();var n=d.canReadCurrentGroup();if(o.empty()){if(n){return d.getGroupName()}else{return d.getGroupId()}}else{if(o.size()===1){var p=o.datum();if(p.permissions.canRead){if(d.isLabel(o)){if(f.trim(p.component.label)!==""){return p.component.label}else{return""}}else{if(d.isConnection(o)){return d.formatConnectionName(p.component)}else{return p.component.name}}}else{return p.id}}else{return"Multiple components selected"}}},getContextType:function(){var n=d.getSelection();if(n.empty()){return"Process Group"}else{if(n.size()===1){if(d.isProcessor(n)){return"Processor"}else{if(d.isProcessGroup(n)){return"Process Group"}else{if(d.isInputPort(n)){return"Input Port"}else{if(d.isOutputPort(n)){return"Output Port"}else{if(d.isRemoteProcessGroup(n)){return"Remote Process Group"}else{if(d.isFunnel(n)){return"Funnel"}else{if(d.isLabel(n)){return"Label"}else{if(d.isConnection(n)){return"Connection"}}}}}}}}}else{return"Multiple selected"}}},getContextId:function(){var n=d.getSelection();if(n.empty()){return d.getGroupId()}else{if(n.size()===1){var o=n.datum();return o.id}else{return"Multiple selected"}}},canConfigureOrOpenDetails:function(){var n=d.getSelection();if(n.empty()){return true}return d.isConfigurable(n)||d.hasDetails(n)},openConfigureOrDetailsView:function(){var n=d.getSelection();if(d.isConfigurable(n)){b.showConfiguration(n)}else{if(d.hasDetails(n)){b.showDetails(n)}}}};var g=new h(i,l);g.register();return g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.CanvasUtils","nf.ContextMenu"],function(d,c){return(nf.ng.Canvas.NavigateCtrl=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.NavigateCtrl=b(require("nf.CanvasUtils"),require("nf.ContextMenu")))}else{nf.ng.Canvas.NavigateCtrl=b(a.nf.CanvasUtils,a.nf.ContextMenu)}}}(this,function(b,a){return function(e){function d(){this.zoomIn=function(){e(function(){b.zoomInCanvas()},0)};this.zoomOut=function(){e(function(){b.zoomOutCanvas()},0)};this.zoomFit=function(){e(function(){b.fitCanvas()},0)};this.zoomActualSize=function(){e(function(){b.actualSizeCanvas()},0)};this.leaveGroup=function(){e(function(){b.executeAction("leaveGroup")},0)};this.isNotRootGroup=function(){return b.getParentGroupId()!==null}}d.prototype={constructor:d};var c=new d();return c}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Dialog","nf.Storage","nf.Birdseye","nf.CanvasUtils","nf.Common","nf.Client","nf.Processor"],function(g,j,f,h,c,e,d,k,i){return(nf.ng.Canvas.OperateCtrl=b(g,j,f,h,c,e,d,k,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.OperateCtrl=b(require("jquery"),require("d3"),require("nf.Dialog"),require("nf.Storage"),require("nf.Birdseye"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Client"),require("nf.Processor")))}else{nf.ng.Canvas.OperateCtrl=b(a.$,a.d3,a.nf.Dialog,a.nf.Storage,a.nf.Birdseye,a.nf.CanvasUtils,a.nf.Common,a.nf.Client,a.nf.Processor)}}}(this,function(e,h,d,f,a,c,b,i,g){return function(){var k=function(){var m=e("#fill-color-value").val();if(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(m)){e("#fill-color").minicolors("value",m)}};function j(){this.template={modal:{getElement:function(){return e("#new-template-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Create Template"})},update:function(n,m){this.getElement().modal(n,m)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}};this.templateUpload={modal:{getElement:function(){return e("#upload-template-dialog")},init:function(){var m=e("#template-upload-form").ajaxForm({url:"../nifi-api/process-groups/",dataType:"xml",beforeSubmit:function(p,n,o){p.push({name:"disconnectedNodeAcknowledged",value:f.isDisconnectionAcknowledged()});o.url+=(encodeURIComponent(c.getGroupId())+"/templates/upload")},success:function(n,q,r,p){if(n.documentElement.tagName==="templateEntity"){d.showOkDialog({headerText:"Success",dialogContent:"Template successfully imported."})}else{var q="Unable to import template. Please check the log for errors.";if(n.documentElement.tagName==="errorResponse"){var o=n.documentElement.getAttribute("statusText");if(!b.isBlank(o)){q=o}}d.showOkDialog({headerText:"Unable to Upload",dialogContent:b.escapeHtml(q)})}},error:function(p,o,n){d.showOkDialog({headerText:"Unable to Upload",dialogContent:b.escapeHtml(p.responseText)})}});this.getElement().modal({headerText:"Upload Template",buttons:[{buttonText:"Upload",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var n=e("#selected-template-name").text();if(b.isBlank(n)){e("#upload-template-status").text("No template selected. Please browse to select a template.")}else{m.submit();e("#upload-template-dialog").modal("hide")}}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#upload-template-dialog").modal("hide")}}}],handler:{close:function(){e("#selected-template-name").text("");e("#upload-template-status").text("");m.resetForm()}}});e("#template-file-field-button").on("click",function(n){e("#template-file-field").click()});e("#template-file-field").on("change",function(o){var n=e(this).val();if(!b.isBlank(n)){n=n.replace(/^.*[\\\/]/,"")}e("#selected-template-name").text(n);e("#upload-template-status").text("")})},update:function(n,m){this.getElement().modal(n,m)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}};this.fillcolor={modal:{getElement:function(){return e("#fill-color-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Change Color",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var m=c.getSelection();m.each(function(r){var p=h.select(this);var q=p.datum();var o=e("#fill-color").minicolors("value");if(o!==q.component.style["background-color"]){var n={revision:i.getRevision(q),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{id:q.id,style:{"background-color":o}}};e.ajax({type:"PUT",url:q.uri,data:JSON.stringify(n),dataType:"json",contentType:"application/json"}).done(function(s){c.getComponentByType(q.type).set(s)}).fail(function(u,s,t){if(u.status===400||u.status===404||u.status===409){d.showOkDialog({headerText:"Error",dialogContent:b.escapeHtml(u.responseText)})}}).always(function(){a.refresh()})}});e("#fill-color-dialog").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#fill-color-dialog").modal("hide")}}}],handler:{close:function(){e("#fill-color-value").val("");e("#fill-color").minicolors("value","")}}})},update:function(n,m){this.getElement().modal(n,m)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")},minicolors:{getElement:function(){return e("#fill-color")},init:function(){this.getElement().minicolors({inline:true,change:function(n,m){e("#fill-color-value").val(n);if(n.toLowerCase()==="#ffffff"){e("#fill-color-processor-preview-icon").css({color:g.defaultIconColor(),"background-color":n})}else{e("#fill-color-processor-preview-icon").css({color:b.determineContrastColor(b.substringAfterLast(n,"#")),"background-color":n})}var o=n;if(o.toLowerCase()==="#ffffff"){o="rgba(0,0,0,0.25)"}e("#fill-color-processor-preview").css({"border-color":o});e("#fill-color-label-preview").css({background:n});e("#fill-color-label-preview-value").css("color",b.determineContrastColor(b.substringAfterLast(n,"#")))}});e("#fill-color-value").on("blur",k).on("keyup",function(n){var m=n.keyCode?n.keyCode:n.which;if(m===e.ui.keyCode.ENTER){k()}})}}}}}j.prototype={constructor:j,init:function(){this.template.modal.init();this.templateUpload.modal.init();this.fillcolor.modal.init();this.fillcolor.modal.minicolors.init()}};var l=new j();return l}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.FilteredDialogCommon","nf.Dialog","nf.Common"],function(h,e,m,c,i,j,f,l,k,g,d){return(nf.ng.ProcessorComponent=b(h,e,m,c,i,j,f,l,k,g,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.ProcessorComponent=b(require("jquery"),require("Slick"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.FilteredDialogCommon"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.ProcessorComponent=b(a.$,a.Slick,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.FilteredDialogCommon,a.nf.Dialog,a.nf.Common)}}}(this,function(f,c,k,a,g,h,d,j,i,e,b){return function(n){var q=function(){var w=f("#processor-types-table").data("gridInstance");if(b.isDefinedAndNotNull(w)){var x=w.getData();x.setFilterArgs({searchString:u()});x.refresh();f("#new-processor-dialog").modal("refreshButtons");if(x.getLength()>0){i.choseFirstRow(w);w.scrollRowToTop(0)}}};var s=function(y,x){if(x.searchString===""){return true}try{var B=new RegExp(x.searchString,"i")}catch(A){return false}var z=y.label.search(B)>=0;var w=y.tags.search(B)>=0;return z||w};var l=function(F,A){var D=s(F,A);var z=true;if(D){var E=f("#processor-tag-cloud").tagcloud("getSelectedTags");var C=E.length>0;if(C){z=m(E,F.tags)}}var B=true;if(D&&z){var w=f("#processor-bundle-group-combo").combo("getSelectedOption");if(b.isDefinedAndNotNull(w)&&w.value!==""){B=(F.bundle.group===w.value)}}var x=D&&z&&B;if(x===false&&f("#selected-processor-type").text()===F.type){f("#processor-type-description").attr("title","").text("");f("#processor-type-name").attr("title","").text("");f("#processor-type-bundle").attr("title","").text("");f("#selected-processor-name").text("");f("#selected-processor-type").text("").removeData("bundle");var y=f("#processor-types-table").data("gridInstance");y.resetActiveCell()}return x};var m=function(y,w){var x=[];f.each(y,function(B,C){x.push(C)});var z=w.toLowerCase();var A=true;f.each(x,function(B,C){if(z.indexOf(C)===-1){A=false;return false}});return A};var u=function(){return f("#processor-type-filter").val()};var o=function(){f("#processor-tag-cloud").tagcloud("clearSelectedTags");f("#processor-bundle-group-combo").combo("setSelectedOption",{value:""});f("#processor-type-filter").val("");q();f("#processor-type-description").attr("title","").text("");f("#processor-type-name").attr("title","").text("");f("#processor-type-bundle").attr("title","").text("");f("#selected-processor-name").text("");f("#selected-processor-type").text("").removeData("bundle");var w=f("#processor-types-table").data("gridInstance");w.setSelectedRows([]);w.resetActiveCell()};var r=function(x,A,w,y){var z={revision:k.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:g.isDisconnectionAcknowledged(),component:{type:A,bundle:w,name:x,position:{x:y.x,y:y.y}}};f.ajax({type:"POST",url:n.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/processors",data:JSON.stringify(z),dataType:"json",contentType:"application/json"}).done(function(B){h.add({processors:[B]},{selectAll:true});h.updateVisibility();a.refresh()}).fail(j.handleAjaxError)};var p=function(w){return w.restricted===false||b.canAccessComponentRestrictions(w.explicitRestrictions)};function v(){this.icon="icon icon-processor";this.hoverIcon="icon icon-processor-add";this.modal={filter:{init:function(){var x=[{id:"type",name:"Type",field:"label",formatter:b.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:b.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:b.genericValueFormatter}];var A={autosizeColsMode:c.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var y=new c.Data.DataView({inlineFilters:false});y.setItems([]);y.setFilterArgs({searchString:u()});y.setFilter(l);b.sortType({columnId:"type",sortAsc:true},y);var w=new c.Grid("#processor-types-table",y,x,A);w.setSelectionModel(new c.RowSelectionModel());w.registerPlugin(new c.AutoTooltips());w.setSortColumn("type",true);w.onSort.subscribe(function(C,B){b.sortType({columnId:B.sortCol.field,sortAsc:B.sortAsc},y)});w.onSelectedRowsChanged.subscribe(function(F,D){if(f.isArray(D.rows)&&D.rows.length===1){var B=D.rows[0];var G=w.getDataItem(B);if(b.isDefinedAndNotNull(G)){if(b.isBlank(G.description)){f("#processor-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{f("#processor-type-description").width(f("#processor-description-container").innerWidth()-1).html(G.description).ellipsis()}var C=b.formatBundle(G.bundle);var E=b.formatType(G);f("#processor-type-name").text(E).attr("title",E);f("#processor-type-bundle").text(C).attr("title",C);f("#selected-processor-name").text(G.label);f("#selected-processor-type").text(G.type).data("bundle",G.bundle);f("#new-processor-dialog").modal("refreshButtons")}}});w.onViewportChanged.subscribe(function(C,B){b.cleanUpTooltips(f("#processor-types-table"),"div.view-usage-restriction")});y.onRowCountChanged.subscribe(function(C,B){w.updateRowCount();w.render();f("#displayed-processor-types").text(B.current)});y.onRowsChanged.subscribe(function(C,B){w.invalidateRows(B.rows);w.render()});y.syncGridSelection(w,false);f("#processor-types-table").data("gridInstance",w).on("mouseenter","div.slick-cell",function(E){var F=f(this).find("div.view-usage-restriction");if(F.length&&!F.data("qtip")){var D=f(this).find("span.row-id").text();var C=y.getItemById(D);if(C.restricted===true){var G=f("<div></div>");if(b.isBlank(C.usageRestriction)){G.append(f('<p style="margin-bottom: 3px;"></p>').text("Requires the following permissions:"))}else{G.append(f('<p style="margin-bottom: 3px;"></p>').text(C.usageRestriction+" Requires the following permissions:"))}var B=[];if(b.isDefinedAndNotNull(C.explicitRestrictions)){f.each(C.explicitRestrictions,function(H,J){var I=J.requiredPermission;B.push("'"+I.label+"' - "+b.escapeHtml(J.explanation))})}else{B.push("Access to restricted components regardless of restrictions.")}G.append(b.formatUnorderedList(B));F.qtip(f.extend({},b.config.tooltipConfig,{content:G,position:{container:f("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});var z=b.getPolicyTypeListing("restricted-components");f.ajax({type:"GET",url:n.headerCtrl.toolboxCtrl.config.urls.processorTypes,dataType:"json"}).done(function(C){var E=[];var B=new Set();var G=new Map();var F=new Map();y.beginUpdate();f.each(C.processorTypes,function(H,J){var I=J.type;if(J.restricted===true){if(b.isDefinedAndNotNull(J.explicitRestrictions)){f.each(J.explicitRestrictions,function(K,M){var L=M.requiredPermission;if(!F.has(L.id)){F.set(L.id,L.label)}if(!G.has(L.id)){G.set(L.id,[])}G.get(L.id).push({type:b.formatType(J),bundle:b.formatBundle(J.bundle),explanation:b.escapeHtml(M.explanation)})})}else{if(!F.has(z.value)){F.set(z.value,z.text)}if(!G.has(z.value)){G.set(z.value,[])}G.get(z.value).push({type:b.formatType(J),bundle:b.formatBundle(J.bundle),explanation:b.escapeHtml(J.usageRestriction)})}}B.add(J.bundle.group);y.addItem({id:H+"",label:b.substringAfterLast(I,"."),type:I,bundle:J.bundle,description:b.escapeHtml(J.description),restricted:J.restricted,usageRestriction:b.escapeHtml(J.usageRestriction),explicitRestrictions:J.explicitRestrictions,tags:J.tags.join(", ")});f.each(J.tags,function(L,K){E.push(K.toLowerCase())})});y.endUpdate();y.reSort();w.invalidate();d.addComponentRestrictions(G,F);f("#total-processor-types, #displayed-processor-types").text(C.processorTypes.length);f("#processor-tag-cloud").tagcloud({tags:E,select:q,remove:q});var D=[{text:"all groups",value:""}];B.forEach(function(H){D.push({text:H,value:H})});f("#processor-bundle-group-combo").combo({options:D,select:q})}).fail(j.handleAjaxError)}},getElement:function(){return f("#new-processor-dialog")},init:function(){this.filter.init();this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Processor",handler:{resize:function(){f("#processor-type-description").width(f("#processor-description-container").innerWidth()-1).text(f("#processor-type-description").attr("title")).ellipsis()}}})},update:function(x,w){this.getElement().modal(x,w)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}v.prototype={constructor:v,getElement:function(){return f("#processor-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(w){this.promptForProcessorType(w)},dragIcon:function(w){return f('<div class="icon icon-processor-add"></div>')},promptForProcessorType:function(C){var w=this;var A=function(){var E=f("#selected-processor-name").text();var F=f("#selected-processor-type").text();var D=f("#selected-processor-type").data("bundle");if(E===""||F===""){e.showOkDialog({headerText:"Add Processor",dialogContent:"The type of processor to create must be selected."})}else{r(E,F,D,C)}w.modal.hide()};var z=f("#processor-types-table").data("gridInstance");var x=z.getData();var y=function(E,D){var F=z.getDataItem(D.row);if(p(F)){f("#selected-processor-name").text(F.label);f("#selected-processor-type").text(F.type).data("bundle",F.bundle);A()}};z.onDblClick.subscribe(y);this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var D=z.getSelectedRows();if(D.length>0){var E=z.getDataItem(D[0]);return p(E)===false}else{return x.getLength()===0}},handler:{click:A}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#new-processor-dialog").modal("hide")}}}]);this.modal.update("setCloseHandler",function(){z.onDblClick.unsubscribe(y);o()});this.modal.show();var B=[f.ui.keyCode.UP,f.ui.keyCode.PAGE_UP,f.ui.keyCode.DOWN,f.ui.keyCode.PAGE_DOWN];f("#processor-type-filter").off("keyup").on("keyup",function(G){var F=G.keyCode?G.keyCode:G.which;if(f.inArray(F,B)!==-1){return}if(F===f.ui.keyCode.ENTER){var D=z.getSelectedRows();if(D.length>0){var E=z.getDataItem(D[0]);if(p(E)){A()}}}else{q()}});i.addKeydownListener("#processor-type-filter",z,x);z.resizeCanvas();if(x.getLength()>0){i.choseFirstRow(z)}f("#processor-type-filter").focus()}};var t=new v();return t}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Common"],function(i,e,g,d,c,f,j,h){return(nf.ng.InputPortComponent=b(i,e,g,d,c,f,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.InputPortComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog")))}else{nf.ng.InputPortComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog)}}}(this,function(g,c,e,b,a,d,h,f){return function(l){var k=function(p,m,o){var n={revision:c.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:b.isDisconnectionAcknowledged(),component:{name:p,allowRemoteAccess:m,position:{x:o.x,y:o.y}}};g.ajax({type:"POST",url:l.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/input-ports",data:JSON.stringify(n),dataType:"json",contentType:"application/json"}).done(function(q){a.add({inputPorts:[q]},{selectAll:true});j.modal.hide();a.updateVisibility();e.refresh()}).fail(h.handleConfigurationUpdateAjaxError)};function i(){this.icon="icon icon-port-in";this.hoverIcon="icon icon-port-in-add";this.modal={getElement:function(){return g("#new-port-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Input Port",handler:{close:function(){g("#new-port-name").val("")}}})},update:function(n,m){this.getElement().modal(n,m)},show:function(){g("#new-port-dialog > .dialog-header > .dialog-header-text").text("Add Input Port");var n={text:"Local connections",value:"false",description:"Receive FlowFiles from components in parent process groups"};var m={text:"Remote connections (site-to-site)",value:"true",description:"Receive FlowFiles from remote process group (site-to-site)"};g("#port-allow-remote-access-label").text("Receive from");g("#port-allow-remote-access-info").attr("title","Specify where FlowFiles are received from.");if(d.getParentGroupId()===null){g("#port-allow-remote-access-setting").hide()}else{g("#port-allow-remote-access-setting").show()}g("#port-allow-remote-access").combo({options:[n,m]});this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}i.prototype={constructor:i,getElement:function(){return g("#port-in-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(m){this.promptForInputPortName(m)},dragIcon:function(m){return g('<div class="icon icon-port-in-add"></div>')},promptForInputPortName:function(o){var n=this;var m=function(){var q=g("#new-port-name").val();var p=g("#port-allow-remote-access").combo("getSelectedOption").value;k(q,p,o)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:m}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){n.modal.hide()}}}]);g("#new-port-type").text("Input");this.modal.show();g("#new-port-name").focus().off("keyup").on("keyup",function(q){var p=q.keyCode?q.keyCode:q.which;if(p===g.ui.keyCode.ENTER){m()}})}};var j=new i();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Common"],function(i,e,g,d,c,f,j,h){return(nf.ng.OutputPortComponent=b(i,e,g,d,c,f,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.OutputPortComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog")))}else{nf.ng.OutputPortComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog)}}}(this,function(g,c,e,b,a,d,h,f){return function(l){var j=function(p,m,o){var n={revision:c.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:b.isDisconnectionAcknowledged(),component:{name:p,allowRemoteAccess:m,position:{x:o.x,y:o.y}}};g.ajax({type:"POST",url:l.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/output-ports",data:JSON.stringify(n),dataType:"json",contentType:"application/json"}).done(function(q){a.add({outputPorts:[q]},{selectAll:true});k.modal.hide();a.updateVisibility();e.refresh()}).fail(h.handleConfigurationUpdateAjaxError)};function i(){this.icon="icon icon-port-out";this.hoverIcon="icon icon-port-out-add";this.modal={getElement:function(){return g("#new-port-dialog")},init:function(){},update:function(n,m){this.getElement().modal(n,m)},show:function(){g("#new-port-dialog > .dialog-header > .dialog-header-text").text("Add Output Port");var n={text:"Local connections",value:"false",description:"Send FlowFiles to components in parent process groups."};var m={text:"Remote connections (site-to-site)",value:"true",description:"Send FlowFiles to remote process group (site-to-site)."};g("#port-allow-remote-access-label").text("Send to");g("#port-allow-remote-access-info").attr("title","Specify where FlowFiles are sent.");if(d.getParentGroupId()===null){g("#port-allow-remote-access-setting").hide()}else{g("#port-allow-remote-access-setting").show()}g("#port-allow-remote-access").combo({options:[n,m]});this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}i.prototype={constructor:i,getElement:function(){return g("#port-out-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(m){this.promptForOutputPortName(m)},dragIcon:function(m){return g('<div class="icon icon-port-out-add"></div>')},promptForOutputPortName:function(n){var o=this;var m=function(){var q=g("#new-port-name").val();var p=g("#port-allow-remote-access").combo("getSelectedOption").value;j(q,p,n)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:m}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){o.modal.hide()}}}]);g("#new-port-type").text("Output");this.modal.show();g("#new-port-name").focus().off("keyup").on("keyup",function(q){var p=q.keyCode?q.keyCode:q.which;if(p===g.ui.keyCode.ENTER){m()}})}};var k=new i();return k}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.FlowVersion","nf.Common","nf.Dialog"],function(g,l,c,h,i,e,j,k,d,f){return(nf.ng.GroupComponent=b(g,l,c,h,i,e,j,k,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.GroupComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.FlowVersion"),require("nf.Common"),require("nf.Dialog")))}else{nf.ng.GroupComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.FlowVersion,a.nf.Common,a.nf.Dialog)}}}(this,function(e,j,a,f,g,c,h,i,b,d){return function(o){var k=e("#upload-file-field-button");var q=e("#file-cancel-button");var s=e("#submit-file-container");var t={text:"No parameter context",value:null};var r=function(y,x,v){var w={revision:j.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{name:y,position:{x:x.x,y:x.y}}};if(nf.Common.isDefinedAndNotNull(v)){w.component.parameterContext={id:v}}return e.ajax({type:"POST",url:o.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/process-groups",data:JSON.stringify(w),dataType:"json",contentType:"application/json"}).done(function(z){g.add({processGroups:[z]},{selectAll:true});g.updateVisibility();a.refresh()}).fail(h.handleConfigurationUpdateAjaxError)};var p=function(v){return v.replace(/^.*[\\\/]/,"")};var n=function(v){return v.replace(/^.*[\\\/]/,"").replace(/\..*/,"")};var u=function(){return new e.Deferred(function(v){e.ajax({type:"GET",url:"../nifi-api/flow/parameter-contexts",dataType:"json"}).done(function(w){var x=t;var y=[t];var A=nf.CanvasUtils.getParameterContext();var z=b.sortParameterContextsAlphabeticallyBasedOnAuthorization(w.parameterContexts);z.forEach(function(C){if(C.permissions.canRead){var B={text:C.component.name,value:C.id,description:C.component.description};if(b.isDefinedAndNotNull(A)&&A.id===C.id){x=B}y.push(B)}});e("#new-pg-parameter-context-combo").combo({selectedOption:{value:x.value},options:y});v.resolve()}).fail(function(y,w,x){v.reject(y,w,x)}).fail(h.handleAjaxError)}).promise()};function m(){this.icon="icon icon-group";this.hoverIcon="icon icon-group-add";this.modal={fileToBeUploaded:null,fileForm:null,getElement:function(){return e("#new-process-group-dialog")},init:function(){var w=this;var y=e("#selected-file-name");var x=e("#upload-file-field");var A=e("#new-process-group-name");var z=e("#new-process-group-dialog");function v(){A.val("");y.text("");x.val("");w.fileToBeUploaded=null;e("#parameters-from-uploaded-flow").hide();e("#new-pg-parameter-context-combo").show()}w.fileForm=e("#file-upload-form").ajaxForm({url:"../nifi-api/process-groups/",dataType:"json",beforeSubmit:function(B,C){C.url+=(encodeURIComponent(c.getGroupId())+"/process-groups/upload")}});this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Process Group",handler:{close:function(){v();z.removeData("pt");w.fileForm.resetForm()}}});A.on("input",function(){z.modal("refreshButtons")});k.on("click",function(B){x.click()});x.on("change",function(D){k.hide();w.fileToBeUploaded=D.target;var B;var C;if(!b.isBlank(e(this).val())){B=p(e(this).val());C=n(e(this).val())}y.text(B);if(y.val){s.show()}if(!A.val()){A.val(C);z.modal("refreshButtons")}e("#parameters-from-uploaded-flow").show();e("#new-pg-parameter-context-combo").hide();q.show()});q.on("click",function(){v();s.hide();q.hide();k.show();z.modal("refreshButtons")})},update:function(w,v){this.getElement().modal(w,v)},show:function(){this.getElement().modal("show")},storePt:function(v){e("#new-process-group-dialog").data("pt",v)},hide:function(){this.getElement().modal("hide")}}}m.prototype={constructor:m,getElement:function(){return e("#group-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(v){this.promptForGroupName(v,true,true)},dragIcon:function(v){return e('<div class="icon icon-group-add"></div>')},promptForGroupName:function(z,A,w){var v=this;var y=this;var x=j.getRevision({revision:{version:0}});return e.Deferred(function(B){var C=function(){var E=e("#new-process-group-name").val();var D=e("#new-pg-parameter-context-combo").combo("getSelectedOption").value;if(b.isBlank(E)){d.showOkDialog({headerText:"Configuration Error",dialogContent:"The name of the process group must be specified."});B.reject()}else{if(!b.isUndefinedOrNull(v.modal.fileToBeUploaded)){v.fileForm=e("#file-upload-form").ajaxForm({url:"../nifi-api/process-groups/",dataType:"json",beforeSubmit:function(H,F,G){H.push({name:"disconnectedNodeAcknowledged",value:f.isDisconnectionAcknowledged()},{name:"groupName",value:E},{name:"positionX",value:z.x},{name:"positionY",value:z.y},{name:"clientId",value:x.clientId});G.url+=(encodeURIComponent(c.getGroupId())+"/process-groups/upload")},success:function(F,I,J,H){if(!b.isUndefinedOrNull(F.component)){g.add({processGroups:[F]},{selectAll:true});g.updateVisibility();a.refresh()}else{var I="Unable to import process group. Please check the log for errors.";var G=F.documentElement.getAttribute("statusText");if(!b.isBlank(G)){I=G}d.showOkDialog({headerText:"Unable to Upload",dialogContent:b.escapeHtml(J.responseText)})}},error:function(H,G,F){d.showOkDialog({headerText:"Unable to Upload",dialogContent:b.escapeHtml(H.responseText)})}});v.modal.fileForm.submit()}else{r(E,z,D).done(function(F){B.resolve(F.component)}).fail(function(){B.reject()})}y.modal.hide()}};u().done(function(){var D=[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){if(b.isBlank(e("#new-process-group-name").val())){return true}else{return false}},handler:{click:C}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){B.reject();y.modal.hide()}}}];if(A===true&&b.canVersionFlows()){D.push({buttonText:"Import from Registry",clazz:"fa fa-cloud-download button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){i.showImportFlowDialog(z)}}})}y.modal.update("setButtonModel",D);s.hide();q.hide();if(w===true){k.show()}else{k.hide()}y.modal.storePt(z);y.modal.show();e("#new-process-group-name").focus().off("keyup").on("keyup",function(F){var E=F.keyCode?F.keyCode:F.which;if(E===e.ui.keyCode.ENTER){C()}})})}).promise()}};var l=new m();return l}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Common"],function(g,k,c,h,i,e,j,f,d){return(nf.ng.RemoteProcessGroupComponent=b(g,k,c,h,i,e,j,f,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.RemoteProcessGroupComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.RemoteProcessGroupComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(e,i,a,f,g,c,h,d,b){return function(m){var l=function(o){var n={revision:i.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged(),component:{targetUris:e("#new-remote-process-group-uris").val(),position:{x:o.x,y:o.y},communicationsTimeout:e("#new-remote-process-group-timeout").val(),yieldDuration:e("#new-remote-process-group-yield-duration").val(),transportProtocol:e("#new-remote-process-group-transport-protocol-combo").combo("getSelectedOption").value,localNetworkInterface:e("#new-remote-process-group-local-network-interface").val(),proxyHost:e("#new-remote-process-group-proxy-host").val(),proxyPort:e("#new-remote-process-group-proxy-port").val(),proxyUser:e("#new-remote-process-group-proxy-user").val(),proxyPassword:e("#new-remote-process-group-proxy-password").val()}};e.ajax({type:"POST",url:m.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/remote-process-groups",data:JSON.stringify(n),dataType:"json",contentType:"application/json"}).done(function(p){g.add({remoteProcessGroups:[p]},{selectAll:true});e("#new-remote-process-group-dialog").modal("hide");g.updateVisibility();a.refresh()}).fail(h.handleConfigurationUpdateAjaxError)};function k(){this.icon="icon icon-group-remote";this.hoverIcon="icon icon-group-remote-add";this.modal={getElement:function(){return e("#new-remote-process-group-dialog")},init:function(){var n="30 sec";var o="10 sec";this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Remote Process Group",handler:{close:function(){e("#new-remote-process-group-uris").val("");e("#new-remote-process-group-timeout").val(n);e("#new-remote-process-group-yield-duration").val(o);e("#new-remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:"RAW"});e("#new-remote-process-group-local-network-interface").val("");e("#new-remote-process-group-proxy-host").val("");e("#new-remote-process-group-proxy-port").val("");e("#new-remote-process-group-proxy-user").val("");e("#new-remote-process-group-proxy-password").val("")}}});e("#new-remote-process-group-timeout").val(n);e("#new-remote-process-group-yield-duration").val(o);e("#new-remote-process-group-transport-protocol-combo").combo({options:[{text:"RAW",value:"RAW"},{text:"HTTP",value:"HTTP"}]})},update:function(o,n){this.getElement().modal(o,n)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}k.prototype={constructor:k,getElement:function(){return e("#group-remote-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(n){this.promptForRemoteProcessGroupUri(n)},dragIcon:function(n){return e('<div class="icon icon-group-remote-add"></div>')},promptForRemoteProcessGroupUri:function(p){var n=this;var o=function(){l(p)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:o}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){n.modal.hide()}}}]);this.modal.show();e("#new-remote-process-group-uris").focus().off("keyup").on("keyup",function(r){var q=r.keyCode?r.keyCode:r.which;if(q===e.ui.keyCode.ENTER){o()}})}};var j=new k();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(h,e,g,d,c,f,i){return(nf.ng.FunnelComponent=b(h,e,g,d,c,f,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.FunnelComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.FunnelComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(f,c,e,b,a,d,g){return function(i){function h(){this.icon="icon icon-funnel";this.hoverIcon="icon icon-funnel-add"}h.prototype={constructor:h,getElement:function(){return f("#funnel-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(k){this.createFunnel(k)},dragIcon:function(k){return f('<div class="icon icon-funnel-add"></div>')},createFunnel:function(l){var k={revision:c.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:b.isDisconnectionAcknowledged(),component:{position:{x:l.x,y:l.y}}};f.ajax({type:"POST",url:i.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/funnels",data:JSON.stringify(k),dataType:"json",contentType:"application/json"}).done(function(m){a.add({funnels:[m]},{selectAll:true});a.updateVisibility();e.refresh()}).fail(g.handleAjaxError)}};var j=new h();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Common"],function(g,k,c,h,i,e,j,f,d){return(nf.ng.TemplateComponent=b(g,k,c,h,i,e,j,f,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.TemplateComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.TemplateComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(e,i,a,f,g,c,h,d,b){return function(l){var k=function(o,p){var n={templateId:o,originX:p.x,originY:p.y,disconnectedNodeAcknowledged:f.isDisconnectionAcknowledged()};e.ajax({type:"POST",url:l.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/template-instance",data:JSON.stringify(n),dataType:"json",contentType:"application/json"}).done(function(q){g.add(q.flow,{selectAll:true});g.updateVisibility();a.refresh()}).fail(h.handleAjaxError)};function j(){this.icon="icon icon-template";this.hoverIcon="icon icon-template-add";this.modal={getElement:function(){return e("#instantiate-template-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Template"})},update:function(o,n){this.getElement().modal(o,n)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}j.prototype={constructor:j,getElement:function(){return e("#template-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(n){this.promptForTemplate(n)},dragIcon:function(n){return e('<div class="icon icon-template-add"></div>')},promptForTemplate:function(n){var o=this;e.ajax({type:"GET",url:l.headerCtrl.toolboxCtrl.config.urls.api+"/flow/templates",dataType:"json"}).done(function(p){var r=p.templates;if(b.isDefinedAndNotNull(r)&&r.length>0){r=r.sort(function(t,s){var v=b.parseDateTime(t.template.timestamp);var u=b.parseDateTime(s.template.timestamp);return u.getTime()-v.getTime()});var q=[];e.each(r,function(s,t){if(t.permissions.canRead===true){q.push({text:t.template.name,value:t.id,description:b.escapeHtml(t.template.description)})}});e("#available-templates").combo({maxHeight:300,options:q});o.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var t=e("#available-templates").combo("getSelectedOption");var s=t.value;o.modal.hide();k(s,n)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){o.modal.hide()}}}]);o.modal.show()}else{d.showOkDialog({headerText:"Instantiate Template",dialogContent:"No templates have been loaded into this NiFi."})}}).fail(h.handleAjaxError)}};var m=new j();return m}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.FlowVersion","nf.Settings","nf.Dialog","nf.Common"],function(e,c,d,f){return(nf.ng.RegistryImportComponent=b(e,c,nfSettings,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.RegistryImportComponent=b(require("jquery"),require("nf.FlowVersion","nf.Settings","nf.Dialog","nf.Common")))}else{nf.ng.RegistryImportComponent=b(a.$,a.nf.FlowVersion,a.nf.Settings,a.nf.Dialog,a.nf.Common)}}}(this,function(d,b,a,c,e){return function(){function f(){this.icon="icon icon-import-from-registry";this.hoverIcon="icon icon-import-from-registry-add"}f.prototype={constructor:f,getElement:function(){return d("#registry-import-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(h){if(e.canVersionFlows()){b.showImportFlowDialog(h)}else{c.showYesNoDialog({headerText:"No Registry Client available",dialogContent:"In order to import flows from a Registry a Registry Client must be configured in Controller Settings.",noText:"Cancel",yesText:"Configure",yesHandler:function(){a.showSettings("Registry Clients")}})}},dragIcon:function(h){return d('<div class="icon icon-import-from-registry-add"></div>')}};var g=new f();return g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Storage","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Label"],function(h,e,g,d,c,f,i,j){return(nf.ng.LabelComponent=b(h,e,g,d,c,f,i,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.LabelComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Storage"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Label")))}else{nf.ng.LabelComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Storage,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Label)}}}(this,function(f,c,e,b,a,d,g,h){return function(k){function j(){this.icon="icon icon-label";this.hoverIcon="icon icon-label-add"}j.prototype={constructor:j,getElement:function(){return f("#label-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(l){this.createLabel(l)},dragIcon:function(l){return f('<div class="icon icon-label-add"></div>')},createLabel:function(m){var l={revision:c.getRevision({revision:{version:0}}),disconnectedNodeAcknowledged:b.isDisconnectionAcknowledged(),component:{width:h.config.width,height:h.config.height,position:{x:m.x,y:m.y}}};f.ajax({type:"POST",url:k.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/labels",data:JSON.stringify(l),dataType:"json",contentType:"application/json"}).done(function(n){a.add({labels:[n]},{selectAll:true});a.updateVisibility();e.refresh()}).fail(g.handleAjaxError)}};var i=new j();return i}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.BreadcrumbsDirective=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.BreadcrumbsDirective=b())}else{nf.ng.BreadcrumbsDirective=b()}}}(this,function(){return function(a){return{restrict:"E",templateUrl:"views/nf-ng-breadcrumbs-directive-view.html",scope:{breadcrumbs:"=",clickFunc:"=",highlightCrumbId:"=",separatorFunc:"=",isTracking:"=",getVersionControlClass:"=",getVersionControlTooltip:"="},link:function(d,c,b){a.registerMouseWheelEvent(c)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.DraggableDirective=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.DraggableDirective=b())}else{nf.ng.DraggableDirective=b()}}}(this,function(){return function(){return{restrict:"AE",link:function(c,b,a){b.draggable(c.$eval(a.nfDraggable))}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.ng.Bridge","nf.Common","nf.CanvasUtils","nf.ClusterSummary","nf.Actions"],function(e,f,g,c,d){return(nf.ng.AppCtrl=b(e,f,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppCtrl=b(require("nf.ng.Bridge"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.ClusterSummary"),require("nf.Actions")))}else{nf.ng.AppCtrl=b(a.nf.ng.Bridge,a.nf.CanvasUtils,a.nf.Common,a.nf.ClusterSummary,a.nf.Actions)}}}(this,function(c,d,e,a,b){return function(g,i){function f(j){this.nf={Common:e,ClusterSummary:a,Actions:b,CanvasUtils:d,};this.serviceProvider=j}f.prototype={constructor:f};var h=new f(i);g.appCtrl=h;c.rootScope=g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.AppConfig=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppConfig=b())}else{nf.ng.AppConfig=b()}}}(this,function(){return function(a,b){b.debugInfoEnabled(false);a.definePalette("basePalette",{"50":"728E9B","100":"728E9B","200":"004849","300":"775351","400":"728E9B","500":"728E9B","600":"728E9B","700":"728E9B","800":"728E9B","900":"rgba(249,250,251,0.97)",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("tintPalette",{"50":"728E9B","100":"728E9B","200":"CCDADB","300":"728E9B","400":"AABBC3","500":"728E9B","600":"C7D2D7","700":"728E9B","800":"E3E8EB","900":"728E9B",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("warnPalette",{"50":"BA554A","100":"BA554A","200":"BA554A","300":"BA554A","400":"BA554A","500":"BA554A","600":"BA554A","700":"BA554A","800":"BA554A","900":"BA554A",A100:"BA554A",A200:"BA554A",A400:"BA554A",A700:"BA554A",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.theme("default").primaryPalette("basePalette",{"default":"500","hue-1":"200","hue-2":"300","hue-3":"900"}).accentPalette("tintPalette",{"default":"200","hue-1":"400","hue-2":"600","hue-3":"800"}).warnPalette("warnPalette",{"default":"500"})}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","angular","nf.Common","nf.CanvasUtils","nf.ErrorHandler","nf.Client","nf.Dialog","nf.Storage","nf.Canvas","nf.Graph","nf.ContextMenu","nf.QuickSelect","nf.Shell","nf.ParameterContexts","nf.Settings","nf.Snippet","nf.Actions","nf.QueueListing","nf.Verify","nf.ComponentState","nf.FlowVersion","nf.ComponentVersion","nf.Draggable","nf.Connectable","nf.StatusHistory","nf.Birdseye","nf.ConnectionConfiguration","nf.ControllerService","nf.ReportingTask","nf.FlowAnalysisRule","nf.ParameterProvider","nf.PolicyManagement","nf.ProcessorConfiguration","nf.ProcessGroupConfiguration","nf.ControllerServices","nf.RemoteProcessGroupConfiguration","nf.RemoteProcessGroupPorts","nf.PortConfiguration","nf.LabelConfiguration","nf.ProcessorDetails","nf.PortDetails","nf.ConnectionDetails","nf.RemoteProcessGroupDetails","nf.GoTo","nf.ng.Bridge","nf.ng.AppCtrl","nf.ng.AppConfig","nf.ng.ServiceProvider","nf.ng.BreadcrumbsCtrl","nf.ng.Canvas.HeaderCtrl","nf.ng.Canvas.FlowStatusCtrl","nf.ng.Canvas.GlobalMenuCtrl","nf.ng.Canvas.ToolboxCtrl","nf.ng.ProcessorComponent","nf.ng.InputPortComponent","nf.ng.OutputPortComponent","nf.ng.GroupComponent","nf.ng.RemoteProcessGroupComponent","nf.ng.FunnelComponent","nf.ng.TemplateComponent","nf.ng.RegistryImportComponent","nf.ng.LabelComponent","nf.ng.Canvas.GraphControlsCtrl","nf.ng.Canvas.NavigateCtrl","nf.ng.Canvas.OperateCtrl","nf.ng.BreadcrumbsDirective","nf.ng.DraggableDirective"],function(P,D,ac,an,f,m,p,z,G,x,H,Y,ab,ap,V,E,ao,N,S,h,B,A,C,O,ah,l,v,ae,Q,Z,ad,I,am,T,W,M,c,R,J,d,y,w,ag,k,t,j,L,af,o,g,e,r,aj,aa,F,K,aq,ai,al,X,s,u,U,i,ak,n,q){return b(P,D,ac,an,f,m,p,z,G,x,H,Y,ab,ap,V,E,ao,N,S,h,B,A,C,O,ah,l,v,ae,Q,Z,ad,I,am,T,W,M,c,R,J,d,y,w,ag,k,t,j,L,af,o,g,e,r,aj,aa,F,K,aq,ai,al,X,s,u,U,i,ak,n,q)})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=b(require("jquery"),require("angular"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Client"),require("nf.Dialog"),require("f.Storage"),require("nf.Canvas"),require("nf.Graph"),require("nf.ContextMenu"),require("nf.QuickSelect"),require("nf.Shell"),require("nf.ParameterContexts"),require("nf.Settings"),require("nf.Actions"),require("nf.Snippet"),require("nf.QueueListing"),require("nf.Verify"),require("nf.ComponentState"),require("nf.FlowVersion"),require("nf.ComponentVersion"),require("nf.Draggable"),require("nf.Connectable"),require("nf.StatusHistory"),require("nf.Birdseye"),require("nf.ConnectionConfiguration"),require("nf.ControllerService"),require("nf.ReportingTask"),require("nf.FlowAnalysisRule"),require("nf.ParameterProvider"),require("nf.PolicyManagement"),require("nf.ProcessorConfiguration"),require("nf.ProcessGroupConfiguration"),require("nf.ControllerServices"),require("nf.RemoteProcessGroupConfiguration"),require("nf.RemoteProcessGroupPorts"),require("nf.PortConfiguration"),require("nf.LabelConfiguration"),require("nf.ProcessorDetails"),require("nf.PortDetails"),require("nf.ConnectionDetails"),require("nf.RemoteProcessGroupDetails"),require("nf.GoTo"),require("nf.ng.Bridge"),require("nf.ng.AppCtrl"),require("nf.ng.AppConfig"),require("nf.ng.ServiceProvider"),require("nf.ng.BreadcrumbsCtrl"),require("nf.ng.Canvas.HeaderCtrl"),require("nf.ng.Canvas.FlowStatusCtrl"),require("nf.ng.Canvas.GlobalMenuCtrl"),require("nf.ng.Canvas.ToolboxCtrl"),require("nf.ng.ProcessorComponent"),require("nf.ng.InputPortComponent"),require("nf.ng.OutputPortComponent"),require("nf.ng.GroupComponent"),require("nf.ng.RemoteProcessGroupComponent"),require("nf.ng.FunnelComponent"),require("nf.ng.TemplateComponent"),require("nf.ng.RegistryImportComponent"),require("nf.ng.LabelComponent"),require("nf.ng.Canvas.GraphControlsCtrl"),require("nf.ng.Canvas.NavigateCtrl"),require("nf.ng.Canvas.OperateCtrl"),require("nf.ng.BreadcrumbsDirective"),require("nf.ng.DraggableDirective"))}else{b(a.$,a.angular,a.nf.Common,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Client,a.nf.Dialog,a.nf.Storage,a.nf.Canvas,a.nf.Graph,a.nf.ContextMenu,a.nf.QuickSelect,a.nf.Shell,a.nf.ParameterContexts,a.nf.Settings,a.nf.Actions,a.nf.Snippet,a.nf.QueueListing,a.nf.Verify,a.nf.ComponentState,a.nf.FlowVersion,a.nf.ComponentVersion,a.nf.Draggable,a.nf.Connectable,a.nf.StatusHistory,a.nf.Birdseye,a.nf.ConnectionConfiguration,a.nf.ControllerService,a.nf.ReportingTask,a.nf.FlowAnalysisRule,a.nf.ParameterProvider,a.nf.PolicyManagement,a.nf.ProcessorConfiguration,a.nf.ProcessGroupConfiguration,a.nf.ControllerServices,a.nf.RemoteProcessGroupConfiguration,a.nf.RemoteProcessGroupPorts,a.nf.PortConfiguration,a.nf.LabelConfiguration,a.nf.ProcessorDetails,a.nf.PortDetails,a.nf.ConnectionDetails,a.nf.RemoteProcessGroupDetails,a.nf.GoTo,a.nf.ng.Bridge,a.nf.ng.AppCtrl,a.nf.ng.AppConfig,a.nf.ng.ServiceProvider,a.nf.ng.BreadcrumbsCtrl,a.nf.ng.Canvas.HeaderCtrl,a.nf.ng.Canvas.FlowStatusCtrl,a.nf.ng.Canvas.GlobalMenuCtrl,a.nf.ng.Canvas.ToolboxCtrl,a.nf.ng.ProcessorComponent,a.nf.ng.InputPortComponent,a.nf.ng.OutputPortComponent,a.nf.ng.GroupComponent,a.nf.ng.RemoteProcessGroupComponent,a.nf.ng.FunnelComponent,a.nf.ng.TemplateComponent,a.nf.ng.RegistryImportComponent,a.nf.ng.LabelComponent,a.nf.ng.Canvas.GraphControlsCtrl,a.nf.ng.Canvas.NavigateCtrl,a.nf.ng.Canvas.OperateCtrl,a.nf.ng.BreadcrumbsDirective,a.nf.ng.DraggableDirective)}}}(this,function(N,B,ab,am,d,k,n,x,E,v,F,X,aa,ao,T,C,an,L,Q,f,z,y,A,M,ag,j,t,ad,O,Y,ac,G,al,R,V,K,a,P,H,b,w,u,af,i,r,h,J,ae,m,e,c,p,ai,Z,D,I,ap,ah,ak,W,q,s,S,g,aj,l,o){var U={urls:{flowConfig:"../nifi-api/flow/config"}};N(document).ready(function(){if(E.SUPPORTS_SVG){var ar=B.module("ngCanvasApp",["ngResource","ngRoute","ngMaterial","ngMessages"]);J.$inject=["$mdThemingProvider","$compileProvider"];h.$inject=["$scope","serviceProvider","$compile","headerCtrl","graphControlsCtrl"];ae.$inject=[];m.$inject=["serviceProvider"];e.$inject=["serviceProvider","toolboxCtrl","globalMenuCtrl","flowStatusCtrl"];c.$inject=["serviceProvider"];p.$inject=["serviceProvider"];ai.$inject=["processorComponent","inputPortComponent","outputPortComponent","groupComponent","remoteGroupComponent","funnelComponent","templateComponent","registryImportComponent","labelComponent"];Z.$inject=["serviceProvider"];D.$inject=["serviceProvider"];I.$inject=["serviceProvider"];ap.$inject=["serviceProvider"];ah.$inject=["serviceProvider"];ak.$inject=["serviceProvider"];W.$inject=["serviceProvider"];q.$inject=["serviceProvider"];s.$inject=["serviceProvider"];S.$inject=["serviceProvider","navigateCtrl","operateCtrl"];g.$inject=["$timeout"];aj.$inject=[];l.$inject=["breadcrumbsCtrl"];o.$inject=[];ar.config(J);ar.controller("ngCanvasAppCtrl",h);ar.service("serviceProvider",ae);ar.service("breadcrumbsCtrl",m);ar.service("headerCtrl",e);ar.service("flowStatusCtrl",c);ar.service("globalMenuCtrl",p);ar.service("toolboxCtrl",ai);ar.service("processorComponent",Z);ar.service("inputPortComponent",D);ar.service("outputPortComponent",I);ar.service("groupComponent",ap);ar.service("remoteGroupComponent",ah);ar.service("funnelComponent",ak);ar.service("templateComponent",W);ar.service("registryImportComponent",q);ar.service("labelComponent",s);ar.service("graphControlsCtrl",S);ar.service("navigateCtrl",g);ar.service("operateCtrl",aj);ar.directive("nfBreadcrumbs",l);ar.directive("nfDraggable",o);am.init(E,C,an,j,v);r.injector=B.bootstrap(N("body"),["ngCanvasApp"],{strictDi:true});var aq=E.init();aq.done(function(){var at=k.init();var au=N.ajax({type:"GET",url:U.urls.flowConfig,dataType:"json"});N.when(au,aq,at).done(function(ax){var ay=ax[0];var az=N("#canvas-container");E.CANVAS_OFFSET=az.offset().top;var aw=ay.flowConfiguration;var av=parseInt(aw.autoRefreshIntervalSeconds,10);E.setManagedAuthorizer(aw.supportsManagedAuthorizer);E.setConfigurableAuthorizer(aw.supportsConfigurableAuthorizer);E.setConfigurableUsersAndGroups(aw.supportsConfigurableUsersAndGroups);x.init();E.initCanvas();E.View.init();F.init(C);X.init(C);aa.init(F);r.injector.get("headerCtrl").init();T.init();ao.init(ac);C.init();L.init();Q.init();f.init();z.init(aw.timeOffset);y.init(T);A.init();M.init();ag.init(aw.timeOffset);j.init(v);t.init(j,v,aw.defaultBackPressureObjectThreshold,aw.defaultBackPressureDataSizeThreshold);ad.init(V,O,Y,ac,T);O.init(T);Y.init(T);ac.init({nfSettings:T,statusBarOptions:{supportsStatusBar:true}});G.init();al.init({supportsStatusBar:true,nfActions:C});R.init(V,ao);K.init();a.init();P.init();H.init();b.init({supportsGoTo:true,supportsStatusBar:true,nfCanvasUtils:am,nfActions:C});w.init();u.init();af.init();i.init();v.init().done(function(){r.injector.get("graphControlsCtrl").init();var aA=av/2;setTimeout(function(){E.startPolling(av)},aA*1000);E.hideSplash()}).fail(d.handleAjaxError)}).fail(d.handleAjaxError)}).fail(d.handleAjaxError);N(".component-button").qtip(N.extend({},ab.config.tooltipConfig,{position:{at:"bottom center",my:"top center",adjust:{y:5}}}))}else{N("#message-title").text("Unsupported Browser");N("#message-content").text("Flow graphs are shown using SVG. Please use a browser that supports rendering SVG.");N("#message-pane").show();E.hideSplash()}})}));
