(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.Dialog=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Dialog=b(require("jquery")))}else{nf.Dialog=b(a.$)}}}(this,function(b){b(document).ready(function(){b("#nf-ok-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-ok-dialog-content").empty()}}});b("#nf-yes-no-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-yes-no-dialog-content").empty();b("#nf-yes-no-dialog").modal("setButtonModel",[])}}})});var a={showOkDialog:function(c){c=b.extend({headerText:"",dialogContent:""},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-ok-dialog-content").append(d).append("</br>");b("#nf-ok-dialog").modal("setButtonModel",[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-ok-dialog").modal("hide");if(typeof c.okHandler==="function"){c.okHandler.call(this)}}}}]);b("#nf-ok-dialog").modal("setHeaderText",c.headerText).modal("show")},showYesNoDialog:function(c){c=b.extend({headerText:"",dialogContent:"",yesText:"Yes",noText:"No"},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-yes-no-dialog-content").append(d);b("#nf-yes-no-dialog").modal("setButtonModel",[{buttonText:c.yesText,color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.yesHandler==="function"){c.yesHandler.call(this)}}}},{buttonText:c.noText,color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.noHandler==="function"){c.noHandler.call(this)}}}}]);b("#nf-yes-no-dialog").modal("setHeaderText",c.headerText).modal("show")},showDisconnectedFromClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node is currently not connected to the cluster. Any modifications to the data flow made here will not replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})},showConnectedToClusterMessage:function(c){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node just joined the cluster. Any modifications to the data flow made here will replicate across the cluster.",okHandler:function(){if(typeof c==="function"){c.call(this)}}})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.AuthorizationStorage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AuthorizationStorage=b())}else{nf.AuthorizationStorage=b()}}}(this,function(){var b="Access-Token-Expiration";var a=new RegExp("Request-Token=([^;]+)");return{getRequestToken:function(){var c=null;var d=a.exec(document.cookie);if(d){c=d[1]}return c},getToken:function(){return sessionStorage.getItem(b)},hasToken:function(){var c=this.getToken();return typeof c==="string"},removeToken:function(){sessionStorage.removeItem(b)},setToken:function(c){sessionStorage.setItem(b,c)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.Storage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Storage=b())}else{nf.Storage=b()}}}(this,function(){var h=false;var g=86400000;var f=g*2;var b=function(i){return typeof i==="undefined"};var e=function(i){return i===null};var d=function(i){return !b(i)&&!e(i)};var c=function(k){if(d(k.expires)){var i=new Date(k.expires);var j=new Date();return i.valueOf()<j.valueOf()}else{return false}};var a=function(i){try{var j=JSON.parse(localStorage.getItem(i));if(d(j)){return j}else{return null}}catch(k){return null}};return{init:function(){for(var k=0;k<localStorage.length;k++){try{var j=localStorage.key(k);this.getItem(j)}catch(l){}}},acknowledgeDisconnection:function(){h=true},resetDisconnectionAcknowledgement:function(){h=false},isDisconnectionAcknowledged:function(){return h},setItem:function(j,l,i){i=d(i)?i:new Date().valueOf()+f;var k={expires:i,item:l};localStorage.setItem(j,JSON.stringify(k))},hasItem:function(i){return a(i)!==null},getItem:function(i){var j=a(i);if(j===null){return null}if(c(j)){this.removeItem(i);return null}if(d(j.item)){return j.item}else{return null}},getItemExpiration:function(i){var j=a(i);if(j===null){return null}if(d(j.expires)){return j.expires}else{return null}},removeItem:function(i){localStorage.removeItem(i)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.AuthorizationStorage","lodash","moment"],function(f,e,c,d,g){return(nf.Common=b(f,e,c,d,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Common=b(require("jquery"),require("d3"),require("nf.AuthorizationStorage"),require("lodash"),require("moment")))}else{nf.Common=b(a.$,a.d3,a.nf.AuthorizationStorage,a._,a.moment)}}}(this,function(f,e,b,c,h){f(document).ready(function(){var i="images/bg-error.png";f("<img/>").attr("src",i).on("load",function(){f("div.message-pane").css("background-image",i)});f(document).on("mouseenter","span.link",function(){f(this).addClass("link-over")}).on("mouseleave","span.link",function(){f(this).removeClass("link-over")});f(document).on("click","div.nf-checkbox",function(){var l=f(this);var k=l.hasClass("checkbox-unchecked");var j=l.hasClass("disabled");if(j){return}if(k){l.removeClass("checkbox-unchecked").addClass("checkbox-checked")}else{l.removeClass("checkbox-checked").addClass("checkbox-unchecked")}l.trigger("change",{isChecked:k})});f(document).on("click",".nf-checkbox-label",function(j){f(j.target).parent().find(".nf-checkbox").click()});f(document).ajaxStart(function(){f("div.loading-container").addClass("ajax-loading")}).ajaxStop(function(){f("div.loading-container").removeClass("ajax-loading")});if(b.hasToken()){f("#user-logout-container").css("display","block");g.scheduleTokenRefresh()}f("#user-logout").on("click",function(){f.ajax({type:"DELETE",url:"../nifi-api/access/logout",}).done(function(){b.removeToken();window.location="../nifi/logout"}).fail(nfErrorHandler.handleAjaxError)});f("#user-home").on("click",function(){if(top!==window){parent.window.location="../nifi/"}else{window.location="../nifi/"}})});var d=null;var a=[{text:"view the user interface",value:"flow",description:"Allows users to view the user interface"},{text:"access the controller",value:"controller",description:"Allows users to view/modify the controller including Management Controller Services, Reporting Tasks, Registry Clients, Parameter Providers and nodes in the cluster"},{text:"access parameter contexts",value:"parameter-contexts",description:"Allows users to view/modify Parameter Contexts"},{text:"query provenance",value:"provenance",description:"Allows users to submit a Provenance Search and request Event Lineage"},{text:"access restricted components",value:"restricted-components",description:"Allows users to create/modify restricted components assuming other permissions are sufficient"},{text:"access all policies",value:"policies",description:"Allows users to view/modify the policies for all components"},{text:"access users/user groups",value:"tenants",description:"Allows users to view/modify the users and user groups"},{text:"retrieve site-to-site details",value:"site-to-site",description:"Allows other NiFi instances to retrieve Site-To-Site details of this NiFi"},{text:"view system diagnostics",value:"system",description:"Allows users to view System Diagnostics"},{text:"proxy user requests",value:"proxy",description:"Allows proxy machines to send requests on the behalf of others"},{text:"access counters",value:"counters",description:"Allows users to view/modify Counters"}];var g={ANONYMOUS_USER_TEXT:"Anonymous user",config:{sensitiveText:"Sensitive value set",tooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:function(i){f(this).slideDown(100)}},hide:{effect:function(i){f(this).slideUp(100)}},position:{at:"top center",my:"bottom center"}}},SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,currentUser:undefined,sortVersion:function(j,t){if(j===t){return 0}var p=j.split(/-/);var u=t.split(/-/);if(p.length>=1&&u.length>=1){var r=p[0].split(/\./);var o=u[0].split(/\./);if(r.length>=1&&o.length>=1){var m=Math.min(r.length,o.length);for(var n=0;n<m;n++){var s=parseInt(r[n],10);var l=parseInt(o[n],10);if(isNaN(s)&&isNaN(l)){continue}else{if(isNaN(s)){return -1}else{if(isNaN(l)){return 1}}}if(s!==l){return s-l}}if(r.length===o.length){if(p.length===u.length){var q=g.substringAfterFirst(j,p[0]);var k=g.substringAfterFirst(t,u[0]);return q===k?0:q>k?1:-1}else{return u.length-p.length}}else{return r.length-o.length}}else{if(r.length>=1){return 1}else{if(o.length>=1){return -1}else{return 0}}}}else{if(p.length>=1){return 1}else{if(u.length>=1){return -1}else{return 0}}}},sortType:function(i,l){var j=function(o,m){var p=g.formatBundle(o.bundle);var n=g.formatBundle(m.bundle);return p===n?0:p>n?1:-1};var k=function(t,s){if(i.columnId==="version"){var r=g.isDefinedAndNotNull(t.bundle[i.columnId])?t.bundle[i.columnId]:"";var p=g.isDefinedAndNotNull(s.bundle[i.columnId])?s.bundle[i.columnId]:"";var n=g.sortVersion(r,p);return n===0?j(t,s):n}else{if(i.columnId==="type"){var q=g.substringAfterLast(t[i.columnId],".");var o=g.substringAfterLast(s[i.columnId],".");return q===o?0:q>o?1:-1}else{var m=g.isDefinedAndNotNull(t[i.columnId])?t[i.columnId]:"";var u=g.isDefinedAndNotNull(s[i.columnId])?s[i.columnId]:"";return m===u?j(t,s):m>u?1:-1}}};l.sort(k,i.sortAsc)},typeFormatter:function(n,j,m,l,i){var k="";if(i.restricted===true){k+='<div class="view-usage-restriction fa fa-shield"></div><span class="hidden row-id">'+g.escapeHtml(i.id)+"</span>"}else{k+='<div class="fa"></div>'}k+=g.escapeHtml(m);return k},genericValueFormatter:function(m,j,l,k,i){return g.escapeHtml(l)},typeBundleFormatter:function(m,j,l,k,i){return g.escapeHtml(g.formatBundle(i.bundle))},typeVersionFormatter:function(n,j,m,l,i){var k="";if(g.isDefinedAndNotNull(i.bundle)){k+=('<div style="float: left;">'+g.escapeHtml(i.bundle.version)+"</div>")}else{k+='<div style="float: left;">unversioned</div>'}if(!g.isEmpty(i.controllerServiceApis)){k+='<div class="controller-service-apis fa fa-list" title="Compatible Controller Service" style="margin-left: 4px;"></div><span class="hidden row-id">'+g.escapeHtml(i.id)+"</span>"}k+='<div class="clear"></div>';return k},instanceTypeFormatter:function(m,j,l,k,i){if(!i.permissions.canRead){return""}return g.escapeHtml(g.formatType(i.component))},instanceBundleFormatter:function(m,j,l,k,i){if(!i.permissions.canRead){return""}return g.typeBundleFormatter(m,j,l,k,i.component)},getVersionControlTooltip:function(i){return i.stateExplanation},formatClassName:function(i){return g.substringAfterLast(i.type,".")},formatType:function(i){var j=g.formatClassName(i);if(i.bundle.version!=="unversioned"){j+=(" "+i.bundle.version)}return j},formatBundle:function(i){var j="";if(i.group!=="default"){j=i.group+" - "}return j+i.artifact},setCurrentUser:function(i){g.currentUser=i},scheduleTokenRefresh:function(){if(d!==null){clearInterval(d)}var i=g.MILLIS_PER_MINUTE;var j=function(){var o=b.getToken();if(o!==null){var l=parseInt(o,10)*g.MILLIS_PER_SECOND;var n=new Date(l);var m=new Date();var k=n.valueOf()-m.valueOf()-(30*g.MILLIS_PER_SECOND);if(k<i){if(f("#current-user").text()!==g.ANONYMOUS_USER_TEXT&&!f("#anonymous-user-alert").is(":visible")){f("#anonymous-user-alert").show().qtip(f.extend({},g.config.tooltipConfig,{content:"Your session will expire soon. Please log in again to avoid being automatically logged out.",position:{my:"top right",at:"bottom left"}}))}}}};j();d=setInterval(j,i)},setAnonymousUserLabel:function(){var i=f("#anonymous-user-alert");if(i.data("qtip")){i.qtip("api").destroy(true)}i.show().qtip(f.extend({},g.config.tooltipConfig,{content:"You are accessing with limited authority. Log in or request an account to access with additional authority granted to you by an administrator.",position:{my:"top right",at:"bottom left"}}));f("#current-user").text(g.ANONYMOUS_USER_TEXT).show()},getSessionExpiration:function(j){var k=null;var i=g.getJwtPayload(j);if(i){k=i.exp}return k},getDefaultExpiration:function(){var j=new Date();var i=j.getTime()+43200000;var k=Math.round(i/1000);return k.toString()},getJwtPayload:function(j){if(g.isDefinedAndNotNull(j)){var i=j.split(/\./);if(i.length!==3){return""}var l=f.base64.atob(i[1]);var k=JSON.parse(l);if(g.isDefinedAndNotNull(k)){return k}else{return null}}return null},canVersionFlows:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.canVersionFlows===true}else{return false}},canAccessProvenance:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.provenancePermissions.canRead===true}else{return false}},canAccessRestrictedComponents:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.restrictedComponentsPermissions.canWrite===true}else{return false}},canAccessComponentRestrictions:function(j){if(g.isDefinedAndNotNull(g.currentUser)){if(g.currentUser.restrictedComponentsPermissions.canWrite===true){return true}var i=function(m){if(g.isEmpty(g.currentUser.componentRestrictionPermissions)){return false}var l=false;f.each(g.currentUser.componentRestrictionPermissions,function(n,o){if(o.requiredPermission.id===m.id){if(o.permissions.canWrite===true){l=true;return false}}});return l};var k=true;if(g.isEmpty(j)){k=false}else{f.each(j,function(l,m){if(!i(m.requiredPermission)){k=false;return false}})}return k}else{return false}},canAccessCounters:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.countersPermissions.canRead===true}else{return false}},canModifyCounters:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.countersPermissions.canRead===true&&g.currentUser.countersPermissions.canWrite===true}else{return false}},canAccessTenants:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.tenantsPermissions.canRead===true}else{return false}},canModifyTenants:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.tenantsPermissions.canRead===true&&g.currentUser.tenantsPermissions.canWrite===true}else{return false}},canModifyParameterContexts:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.parameterContextPermissions.canRead===true&&g.currentUser.parameterContextPermissions.canWrite===true}else{return false}},canAccessPolicies:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.policiesPermissions.canRead===true}else{return false}},canModifyPolicies:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.policiesPermissions.canRead===true&&g.currentUser.policiesPermissions.canWrite===true}else{return false}},canAccessController:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.controllerPermissions.canRead===true}else{return false}},canModifyController:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.controllerPermissions.canRead===true&&g.currentUser.controllerPermissions.canWrite===true}else{return false}},canAccessSystem:function(){if(g.isDefinedAndNotNull(g.currentUser)){return g.currentUser.systemPermissions.canRead===true}else{return false}},addHoverEffect:function(i,k,j){f(document).on("mouseenter",i,function(){f(this).removeClass(k).addClass(j)}).on("mouseleave",i,function(){f(this).removeClass(j).addClass(k)});return f(i).addClass(k)},toggleScrollable:function(i){if(f(i).is(":visible")){if(i.offsetHeight<i.scrollHeight||i.offsetWidth<i.scrollWidth){f(i).addClass("scrollable")}else{f(i).removeClass("scrollable")}}},determineContrastColor:function(i){if(parseInt(i,16)>16777215/1.5){return"#000000"}return"#ffffff"},updateLogoutLink:function(){if(b.hasToken()){f("#user-logout-container").css("display","block")}else{f("#user-logout-container").css("display","none")}},isContentViewConfigured:function(){var i=f("#nifi-content-viewer-url").text();return !g.isBlank(i)},populateField:function(j,i){if(g.isUndefined(i)||g.isNull(i)){return f("#"+j).addClass("unset").text("No value set")}else{if(i===""){return f("#"+j).addClass("blank").text("Empty string set")}else{return f("#"+j).text(i)}}},clearField:function(i){return f("#"+i).removeClass("unset blank").text("")},cleanUpTooltips:function(i,j){i.find(j).each(function(){var l=f(this);if(l.data("qtip")){var k=l.qtip("api");k.destroy(true)}})},formatPropertyTooltip:function(j,l){var m=[];if(g.isDefinedAndNotNull(j)){if(!g.isBlank(j.description)){m.push(g.escapeHtml(j.description))}if(!g.isBlank(j.defaultValue)){m.push("<b>Default value:</b> "+g.escapeHtml(j.defaultValue))}if(!g.isBlank(j.supportsEl)){m.push("<b>Expression language scope:</b> "+g.escapeHtml(j.expressionLanguageScope))}if(!g.isBlank(j.sensitive)){m.push("<b>Sensitive property:</b> "+g.escapeHtml(j.sensitive))}if(!g.isBlank(j.identifiesControllerService)){var i=g.formatType({type:j.identifiesControllerService,bundle:j.identifiesControllerServiceBundle});var k=g.formatBundle(j.identifiesControllerServiceBundle);m.push("<b>Requires Controller Service:</b> "+g.escapeHtml(i+" from "+k))}}if(g.isDefinedAndNotNull(l)){if(!g.isEmpty(l.previousValues)){var n=[];f.each(l.previousValues,function(p,o){n.push("<li>"+g.escapeHtml(o.previousValue)+" - "+g.escapeHtml(o.timestamp)+" ("+g.escapeHtml(o.userIdentity)+")</li>")});m.push('<b>History:</b><ul class="property-info">'+n.join("")+"</ul>")}}if(m.length>0){return m.join("<br/><br/>")}else{return null}},formatWhitespaceTooltip:function(){return g.escapeHtml("The specified value contains leading and/or trailing whitespace character(s). This could produce unexpected results if it was not intentional.")},LEAD_TRAIL_WHITE_SPACE_REGEX:/^[ \s]+|[ \s]+$/,hasLeadTrailWhitespace:function(i){if(g.isBlank(i)){return false}return g.LEAD_TRAIL_WHITE_SPACE_REGEX.test(i)},formatProperty:function(i,j){return'<div><span class="label">'+g.formatValue(i)+": </span>"+g.formatValue(j)+"</div>"},formatValue:function(i){if(g.isDefinedAndNotNull(i)){if(i===""){return'<span class="blank" style="font-size: 13px; padding-top: 2px;">Empty string set</span>'}else{return g.escapeHtml(i)}}else{return'<span class="unset" style="font-size: 13px; padding-top: 2px;">No value set</span>'}},escapeHtml:(function(){var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2f;"};return function(j){if(g.isDefinedAndNotNull(j)){return String(j).replace(/[&<>"'\/]/g,function(k){return i[k]})}else{return""}}}()),formatNewLines:function(i){if(g.isDefinedAndNotNull(i)){return i.replaceAll(/[\n]/g,"<br>")}else{return""}},isSensitiveProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.sensitive===true}else{return false}},isRequiredProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.required===true}else{return false}},isDynamicProperty:function(i){if(g.isDefinedAndNotNull(i)){return i.dynamic===true}else{return false}},getAllowableValues:function(i){if(g.isDefinedAndNotNull(i)){return i.allowableValues}else{return null}},supportsEl:function(i){if(g.isDefinedAndNotNull(i)){return i.supportsEl===true}else{return false}},formatUnorderedList:function(j){if(f.isArray(j)){var i=f('<ul class="result"></ul>');f.each(j,function(l,m){var k=f("<li></li>").appendTo(i);if(m instanceof jQuery){k.append(m)}else{k.text(m)}});return i}else{return null}},substringAfterLast:function(m,l){var j="";var k=m.lastIndexOf(l);if(k>=0){var i=k+l.length;if(i<m.length){j=m.substr(i)}}return j},substringAfterFirst:function(m,l){var j="";var k=m.indexOf(l);if(k>=0){var i=k+l.length;if(i<m.length){j=m.substr(i)}}return j},substringBeforeLast:function(l,k){var i="";var j=l.lastIndexOf(k);if(j>=0){i=l.substr(0,j)}return i},substringBeforeFirst:function(l,k){var i="";var j=l.indexOf(k);if(j>=0){i=l.substr(0,j)}return i},setCursor:function(j,i){if(i){f("#"+j).addClass("pointer")}else{f("#"+j).removeClass("pointer")}},MILLIS_PER_DAY:86400000,MILLIS_PER_HOUR:3600000,MILLIS_PER_MINUTE:60000,MILLIS_PER_SECOND:1000,loadBalanceStrategyOptions:[{text:"Do not load balance",value:"DO_NOT_LOAD_BALANCE",description:"Do not load balance FlowFiles between nodes in the cluster."},{text:"Partition by attribute",value:"PARTITION_BY_ATTRIBUTE",description:"Determine which node to send a given FlowFile to based on the value of a user-specified FlowFile Attribute. All FlowFiles that have the same value for said Attribute will be sent to the same node in the cluster."},{text:"Round robin",value:"ROUND_ROBIN",description:"FlowFiles will be distributed to nodes in the cluster in a Round-Robin fashion. However, if a node in the cluster is not able to receive data as fast as other nodes, that node may be skipped in one or more iterations in order to maximize throughput of data distribution across the cluster."},{text:"Single node",value:"SINGLE_NODE",description:"All FlowFiles will be sent to the same node. Which node they are sent to is not defined."}],loadBalanceCompressionOptions:[{text:"Do not compress",value:"DO_NOT_COMPRESS",description:"FlowFiles will not be compressed"},{text:"Compress attributes only",value:"COMPRESS_ATTRIBUTES_ONLY",description:"FlowFiles' attributes will be compressed, but the FlowFiles' contents will not be"},{text:"Compress attributes and content",value:"COMPRESS_ATTRIBUTES_AND_CONTENT",description:"FlowFiles' attributes and content will be compressed"}],formatDuration:function(l){l=l<1?0:l;var n=l/g.MILLIS_PER_DAY;n=n>=1?parseInt(n,10):0;l%=g.MILLIS_PER_DAY;var i=l/g.MILLIS_PER_HOUR;i=i>=1?parseInt(i,10):0;l%=g.MILLIS_PER_HOUR;var j=l/g.MILLIS_PER_MINUTE;j=j>=1?parseInt(j,10):0;l%=g.MILLIS_PER_MINUTE;var m=l/g.MILLIS_PER_SECOND;m=m>=1?parseInt(m,10):0;l=Math.floor(l%g.MILLIS_PER_SECOND);var k=g.pad(i,2,"0")+":"+g.pad(j,2,"0")+":"+g.pad(m,2,"0")+"."+g.pad(l,3,"0");if(n>0){return n+" days and "+k}else{return k}},formatPredictedDuration:function(i){if(i===0){return"now"}return h.duration(i,"ms").humanize()},BYTES_IN_KILOBYTE:1024,BYTES_IN_MEGABYTE:1048576,BYTES_IN_GIGABYTE:1073741824,BYTES_IN_TERABYTE:1099511627776,formatDataSize:function(j){var i=parseFloat(j/g.BYTES_IN_TERABYTE);if(i>1){return i.toFixed(2)+" TB"}i=parseFloat(j/g.BYTES_IN_GIGABYTE);if(i>1){return i.toFixed(2)+" GB"}i=parseFloat(j/g.BYTES_IN_MEGABYTE);if(i>1){return i.toFixed(2)+" MB"}i=parseFloat(j/g.BYTES_IN_KILOBYTE);if(i>1){return i.toFixed(2)+" KB"}return parseFloat(j).toFixed(2)+" bytes"},formatInteger:function(j){var i=j+"";var k=/(\d+)(\d{3})/;while(k.test(i)){i=i.replace(k,"$1,$2")}return g.escapeHtml(i)},formatFloat:function(i){if(g.isUndefinedOrNull(i)){return 0+""}return i.toFixed(2)+""},pad:function(l,j,k){var i=l+"";while(i.length<j){i=k+i}return i},formatDateTime:function(i){return g.pad(i.getMonth()+1,2,"0")+"/"+g.pad(i.getDate(),2,"0")+"/"+g.pad(i.getFullYear(),2,"0")+" "+g.pad(i.getHours(),2,"0")+":"+g.pad(i.getMinutes(),2,"0")+":"+g.pad(i.getSeconds(),2,"0")+"."+g.pad(i.getMilliseconds(),3,"0")},parseDateTime:function(m){if(!g.isDefinedAndNotNull(m)){return new Date()}if(m==="No value set"){return new Date()}if(m==="Empty string set"){return new Date()}var t=m.split(/ /);if(t.length!==3){return new Date()}var j=t[0].split(/\//);var i=t[1].split(/:/);if(j.length!==3||i.length!==3){return new Date()}var o=parseInt(j[2],10);var n=parseInt(j[0],10)-1;var p=parseInt(j[1],10);var q=parseInt(i[0],10);var l=parseInt(i[1],10);var s=i[2].split(/\./);var r=parseInt(s[0],10);var k=0;if(s.length===2){k=parseInt(s[1],10)}return new Date(o,n,p,q,l,r,k)},parseDuration:function(i){var j=i.split(/:/);if(j.length!==3){return 0}var k=j[2].split(/\./);if(k.length===2){return new Date(1970,0,1,parseInt(j[0],10),parseInt(j[1],10),parseInt(k[0],10),parseInt(k[1],10)).getTime()}else{return new Date(1970,0,1,parseInt(j[0],10),parseInt(j[1],10),parseInt(j[2],10),0).getTime()}},parseSize:function(k){var l=k.split(/ /);var j=parseFloat(l[0].replace(/,/g,""));var i=l[1];if(i==="KB"){return j*1024}else{if(i==="MB"){return j*1024*1024}else{if(i==="GB"){return j*1024*1024*1024}else{if(i==="TB"){return j*1024*1024*1024*1024}else{return j}}}}},parseCount:function(k){var j=k.split(/ /,1);if(j.length!==1){return 0}var i=parseInt(j[0].replace(/,/g,""),10);if(isNaN(i)){return 0}return i},isDefinedAndNotNull:function(i){return !g.isUndefined(i)&&!g.isNull(i)},isUndefinedOrNull:function(i){return g.isUndefined(i)||g.isNull(i)},isUndefined:function(i){return typeof i==="undefined"},isBlank:function(i){return g.isUndefined(i)||g.isNull(i)||f.trim(i)===""},isNull:function(i){return i===null},isEmpty:function(i){return f.isArray(i)?i.length===0:true},doBulletinsDiffer:function(k,l){if(f.isArray(k)&&f.isArray(l)){if(k.length===l.length){for(var j=0;j<k.length;j++){if(k[j].id!==l[j].id||k[j].canRead!==l[j].canRead){return true}}}else{return true}}else{if(f.isArray(k)||f.isArray(l)){return true}}return false},getFormattedBulletins:function(j){var i=[];f.each(j,function(l,m){if(m.canRead===true){var k=m.bulletin;var p="";if(g.isDefinedAndNotNull(k.nodeAddress)){p="-&nbsp;"+g.escapeHtml(k.nodeAddress)+"&nbsp;-&nbsp;"}var o=f("<pre></pre>").css({"white-space":"pre-wrap"}).text(k.message);var n=f("<div>"+g.escapeHtml(k.timestamp)+"&nbsp;"+p+"&nbsp;<b>"+g.escapeHtml(k.level)+"</b>&nbsp;</div>").append(o);i.push(n)}});return i},getFormattedServiceApis:function(j){var i=[];f.each(j,function(m,n){var k=g.formatType({type:n.type,bundle:n.bundle});var l=g.formatBundle(n.bundle);i.push(f("<div></div>").text(k+" from "+l))});return i},getFormattedGarbageCollections:function(j){j.sort(function(l,k){return k.collectionCount-l.collectionCount});var i=[];f.each(j,function(m,k){var l=f('<span style="font-weight: bold;"></span>').text(k.name);var n=f("<span></span>").text(" - "+k.collectionCount+" times ("+k.collectionTime+")");var o=f("<div></div>").append(l).append(n);i.push(o)});return i},isGlobalPolicy:function(i){return g.getPolicyTypeListing(i)!==null},getPolicyTypeListing:function(i){return a.find(function(j){return i===j.value})},getComponentName:function(i){return i.permissions.canRead===true?i.component.name:i.id},getComboOptionText:function(i,k){var j=i.find(function(l){return l.value===k});return g.isDefinedAndNotNull(j)?j.text:undefined},throttle:function(i,j){return c.throttle(i,j)},getKeyValue:function(j,i){return i.split(".").reduce(function(l,k){return(typeof l===undefined||l===null)?l:(typeof l[k]=="function")?l[k]():l[k]},j)},isMultiLine:function(i){const j=/\n/.exec(i);if(j){return true}return false},sortParameterContextsAlphabeticallyBasedOnAuthorization:function(m){var j=m.filter(function(n){return n.permissions.canRead});var k=m.filter(function(n){return !n.permissions.canRead});var i=j.sort(function(o,n){if(o.component.name<n.component.name){return -1}if(o.component.name>n.component.name){return 1}return 0});var l=k.sort(function(o,n){if(o.id<n.id){return -1}if(o.id>n.id){return 1}return 0});return i.concat(l)}};return g}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Dialog","nf.Common","nf.AuthorizationStorage"],function(e,d,f,c){return(nf.ErrorHandler=b(e,d,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("jquery"),require("nf.Dialog"),require("nf.Common"),require("nf.AuthorizationStorage")))}else{nf.ErrorHandler=b(a.$,a.nf.Dialog,a.nf.Common,a.nf.AuthorizationStorage)}}}(this,function(d,c,e,b){var a={handleAjaxError:function(k,f,g){if(f==="canceled"){b.removeToken();if(d("#splash").is(":visible")){d("#message-title").text("Session Expired");d("#message-content").text("Your session has expired. Please reload to log in again.");d("#message-pane").show()}else{c.showOkDialog({headerText:"Session Expired",dialogContent:"Your session has expired. Please press Ok to log in again.",okHandler:function(){window.location="../nifi/"}})}return}var i=k.getResponseHeader("WWW-Authenticate");var j=new RegExp("^Bearer.*$");if(j.test(i)){b.removeToken()}if(d("#splash").is(":visible")){if(k.status===401){d("#message-title").text("Unauthorized")}else{if(k.status===403){d("#message-title").text("Insufficient Permissions")}else{if(k.status===409){d("#message-title").text("Invalid State")}else{if(k.status===413){d("#message-title").text("Payload Too Large")}else{d("#message-title").text("An unexpected error has occurred")}}}}if(d.trim(k.responseText)===""){d("#message-content").text("Please check the logs.")}else{d("#message-content").text(k.responseText)}d("#message-pane").show();return}if(k.status===400||k.status===404||k.status===409||k.status==413||k.status===503){c.showOkDialog({headerText:"Error",dialogContent:e.escapeHtml(k.responseText)})}else{if(k.status===403){c.showOkDialog({headerText:"Insufficient Permissions",dialogContent:e.escapeHtml(k.responseText)})}else{if(k.status<99||k.status===12007||k.status===12029){var h="Please ensure the application is running and check the logs for any errors.";if(e.isDefinedAndNotNull(f)){if(f==="timeout"){h="Request has timed out. Please ensure the application is running and check the logs for any errors."}else{if(f==="abort"){h="Request has been aborted."}else{if(f==="No Transport"){h="Request transport mechanism failed. Please ensure the host where the application is running is accessible."}}}}d("#message-title").text("Unable to communicate with NiFi");d("#message-content").text(h)}else{if(k.status===401){d("#message-title").text("Unauthorized");if(d.trim(k.responseText)===""){d("#message-content").text("Authentication is required to use this NiFi.")}else{d("#message-content").text(k.responseText)}}else{if(k.status===500){d("#message-title").text("An unexpected error has occurred");if(d.trim(k.responseText)===""){d("#message-content").text("An error occurred communicating with the application core. Please check the logs and fix any configuration issues before restarting.")}else{d("#message-content").text(k.responseText)}}else{if(k.status===200||k.status===201){d("#message-title").text("Parse Error");if(d.trim(k.responseText)===""){d("#message-content").text("Unable to interpret response from NiFi.")}else{d("#message-content").text(k.responseText)}}else{d("#message-title").text(k.status+": Unexpected Response");d("#message-content").text("An unexpected error has occurred. Please check the logs.")}}}}d("#message-pane").show()}}},handleConfigurationUpdateAjaxError:function(i,f,g){if(i.status===400){var j=i.responseText.split("\n");var h;if(j.length===1){h=d("<span></span>").text(j[0])}else{h=e.formatUnorderedList(j)}c.showOkDialog({dialogContent:h,headerText:"Configuration Error"})}else{a.handleAjaxError(i,f,g)}}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.UniversalCapture=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.UniversalCapture=b(require("jquery")))}else{nf.UniversalCapture=b(a.$)}}}(this,function(b){b(document).ready(function(c){c(window).on("keydown",function(d){var i=d.ctrlKey||d.metaKey;if(!i&&d.keyCode===27){var g=c("div.value-combo");if(g.is(":visible")&&g.parent().hasClass("combo-editor")){return}if(c("div.property-detail").is(":visible")){a.removeAllPropertyDetailDialogs();d.stopImmediatePropagation();d.preventDefault()}else{var h=c(d.target);if(h.length){var j=c(".cancellable");if(j.length){var e=null;var f=null;c.each(j,function(k,m){var l=c(m);var n=l.css("zIndex");if(l.is(":visible")&&(n!==null&&typeof n!=="undefined")){n=parseInt(n,10);if(e===null||n>e){e=n;f=l}}});if(f!==null){if(f.hasClass("modal")){f.modal("hide")}else{f.hide()}d.stopImmediatePropagation();d.preventDefault();return}}if(top!==window){if(typeof parent.nf!=="undefined"&&typeof parent.nf.Shell!=="undefined"){parent.$("#shell-close-button").click();d.stopImmediatePropagation();d.preventDefault();return}}}}}else{if(i){if(d.keyCode===82){d.preventDefault()}}else{if(!c("input, textarea").is(":focus")&&(d.keyCode==8||d.keyCode===46)){d.preventDefault()}}}})});var a={removeAllPropertyDetailDialogs:function(){var c=b("body").find("div.property-detail");c.find("div.nf-editor").nfeditor("destroy");c.find("div.value-combo").combo("destroy");c.hide().remove()}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.AuthorizationStorage"],function(d,c){return(nf.AjaxSetup=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AjaxSetup=b(require("jquery"),require("nf.AuthorizationStorage")))}else{nf.AjaxSetup=b(a.$,a.nf.AuthorizationStorage)}}}(this,function(b,a){b(document).ready(function(c){c.ajaxSetup({beforeSend:function(e){var d=a.getRequestToken();if(d!==null){e.setRequestHeader("Request-Token",d)}}})})}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.Dialog","nf.ErrorHandler"],function(d,g,e,c,f){return(nf.ClusterTable=b(d,g,e,c,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterTable=b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.Dialog"),require("nf.ErrorHandler")))}else{nf.ClusterTable=b(a.$,a.Slick,a.nf.Common,a.nf.Dialog,a.nf.ErrorHandler)}}}(this,function(I,c,W,q,g){var Q={primaryNode:"Primary Node",clusterCoordinator:"Cluster Coordinator",urls:{cluster:"../nifi-api/controller/cluster",nodes:"../nifi-api/controller/cluster/nodes",systemDiagnostics:"../nifi-api/system-diagnostics"},data:[{name:"cluster",update:k,isAuthorized:W.canAccessController},{name:"systemDiagnostics",update:F,isAuthorized:W.canAccessSystem}]};var H={autosizeColsMode:c.GridAutosizeColsMode.LegacyForceFit,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var L={name:"Nodes",data:{dataSet:"cluster",update:o},tabContentId:"cluster-nodes-tab-content",tableId:"cluster-nodes-table",tableColumnModel:a,tableIdColumn:"nodeId",tableOptions:H,tableOnClick:e,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"address"},{text:"by status",value:"status"}]};var S={name:"JVM",data:{dataSet:"systemDiagnostics",update:Z},tabContentId:"cluster-jvm-tab-content",tableId:"cluster-jvm-table",tableColumnModel:z,tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:j,cleanUpTable:t,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"node"}]};var u={name:"System",data:{dataSet:"systemDiagnostics",update:b},tabContentId:"cluster-system-tab-content",tableId:"cluster-system-table",tableColumnModel:[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"processors",field:"processors",name:"Cores",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"processorLoadAverage",field:"processorLoadAverage",name:"Core Load Average",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"totalThreads",field:"totalThreads",name:"Total Threads",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"daemonThreads",field:"daemonThreads",name:"Daemon Threads",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter}],tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"node"}]};var y={name:"FlowFile Storage",data:{dataSet:"systemDiagnostics",update:E},tabContentId:"cluster-flowfile-tab-content",tableId:"cluster-flowfile-table",tableColumnModel:[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"ffRepoTotal",field:"ffRepoTotal",name:"Total Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"ffRepoUsed",field:"ffRepoUsed",name:"Used Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"ffRepoFree",field:"ffRepoFree",name:"Free Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"ffStoreUtil",field:"ffRepoUtil",name:"Utilization",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter}],tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"node"}]};var ab={name:"Content Storage",data:{dataSet:"systemDiagnostics",update:w},tabContentId:"cluster-content-tab-content",tableId:"cluster-content-table",tableColumnModel:[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"contentRepoId",field:"contentRepoId",name:"Content Repository",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"contentRepoTotal",field:"contentRepoTotal",name:"Total Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"contentRepoUsed",field:"contentRepoUsed",name:"Used Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"contentRepoFree",field:"contentRepoFree",name:"Free Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"contentRepoUtil",field:"contentRepoUtil",name:"Utilization",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter}],tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"node"},{text:"by repository",value:"contentRepoId"}]};var C={name:"Provenance Storage",data:{dataSet:"systemDiagnostics",update:p},tabContentId:"cluster-provenance-tab-content",tableId:"cluster-provenance-table",tableColumnModel:[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"provenanceRepoId",field:"provenanceRepoId",name:"Provenance Repository",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"provenanceRepoTotal",field:"provenanceRepoTotal",name:"Total Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"provenanceRepoUsed",field:"provenanceRepoUsed",name:"Used Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"provenanceRepoFree",field:"provenanceRepoFree",name:"Free Space",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"provenanceRepoUtil",field:"provenanceRepoUtil",name:"Utilization",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter}],tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"node"},{text:"by repository",value:"contentRepoId"}]};var s={name:"Versions",data:{dataSet:"systemDiagnostics",update:f},tabContentId:"cluster-version-tab-content",tableId:"cluster-version-table",tableColumnModel:[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"version",field:"version",name:"NiFi Version",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"javavendor",field:"javaVendor",name:"Java Vendor",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"javaversion",field:"javaVersion",name:"Java Version",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"osname",field:"osName",name:"OS Name",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"osversion",field:"osVersion",name:"OS Version",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"osarch",field:"osArchitecture",name:"OS Architecture",sortable:true,resizable:true,formatter:W.genericValueFormatter}],tableIdColumn:"id",tableOptions:H,tableOnClick:null,createTableOnEnter:null,cleanUpTable:null,init:x,onSort:aa,onTabSelected:i,filterOptions:[{text:"by address",value:"address"}]};var T=[L,u,S,y,ab,C,s];var A={};var M={};function e(af,ac,ae,ad){if(L.grid.getColumns()[ac.cell].id==="actions"){if(ae.hasClass("prompt-for-connect")){R(ad)}else{if(ae.hasClass("prompt-for-removal")){h(ad)}else{if(ae.hasClass("prompt-for-offload")){l(ad)}else{if(ae.hasClass("prompt-for-disconnect")){V(ad)}}}}}else{if(L.grid.getColumns()[ac.cell].id==="moreDetails"){if(ae.hasClass("show-node-details")){B(ad)}}}}function a(){var ad=function(am,aj,al,ak,ai){return'<div title="View Details" class="pointer show-node-details fa fa-info-circle"></div>'};var ac=function(am,aj,al,ak,ai){return m(ai)};var ae=function(am,aj,al,ak,ai){return W.formatValue(al)};var ah=function(am,aj,al,ak,ai){return d(ai)};var af=[{id:"moreDetails",name:"&nbsp;",sortable:false,resizable:false,formatter:ad,width:50,maxWidth:50},{id:"formattedNodeAddress",field:"formattedNodeAddress",name:"Node Address",formatter:ac,resizable:true,sortable:true},{id:"activeThreadCount",field:"activeThreadCount",name:"Active Thread Count",resizable:true,sortable:true,defaultSortAsc:false,formatter:W.genericValueFormatter},{id:"queued",field:"queued",name:'<span class="queued-title">Queue</span>&nbsp;/&nbsp;<span class="queued-size-title">Size</span>',resizable:true,sortable:true,defaultSortAsc:false,formatter:W.genericValueFormatter},{id:"status",field:"status",name:"Status",formatter:ah,resizable:true,sortable:true},{id:"uptime",field:"nodeStartTime",name:"Started At",formatter:ae,resizable:true,sortable:true,defaultSortAsc:false},{id:"heartbeat",field:"heartbeat",name:"Last Heartbeat",formatter:ae,resizable:true,sortable:true,defaultSortAsc:false}];if(W.canModifyController()){var ag=function(ar,ap,ao,am,aj){var an='<div title="Connect" class="pointer prompt-for-connect fa fa-plug"></div>';var ak='<div title="Delete" class="pointer prompt-for-removal fa fa-trash"></div>';var ai='<div title="Disconnect" class="pointer prompt-for-disconnect fa fa-power-off"></div>';var al='<div title="Offload" class="pointer prompt-for-offload fa fa-rotate-90 fa-upload" style="margin-top: 5px;margin-left: 5px;margin-right: -2px;"></div>';var aq="";if(aj.status==="CONNECTED"||aj.status==="CONNECTING"){aq+=ai}else{if(aj.status==="DISCONNECTED"){aq+=an+al+ak}else{if(aj.status==="OFFLOADED"){aq+=an+ak}else{aq+='<div style="width: 16px; height: 16px;">&nbsp;</div>'}}}return aq};af.push({id:"actions",label:"&nbsp;",formatter:ag,resizable:false,sortable:false,width:80,maxWidth:80})}return af}function j(ac){var ad=ac.getData();return function(ah){var ai=I(this).find("div.show-jvm-gc");if(ai.length&&!ai.data("qtip")){var ag=I(this).find("span.row-id").text();var ae=ad.getItemById(ag);var aj=W.getFormattedGarbageCollections(ae.garbageCollection);var af=W.formatUnorderedList(aj);if(W.isDefinedAndNotNull(af)){ai.qtip(I.extend({},W.config.tooltipConfig,{content:af,position:{container:I("#cluster"),at:"bottom left",my:"top right",adjust:{x:4,y:4}}}))}}}}function t(ac){W.cleanUpTooltips(ac,"div.show-jvm-gc")}function z(){var ac=function(ah,ae,ag,af,ad){return'<div class="pointer show-jvm-gc fa fa-question-circle"></div><span class="hidden row-id">'+W.escapeHtml(ad.id)+"</span>"};return[{id:"node",field:"node",name:"Node Address",sortable:true,resizable:true,formatter:W.genericValueFormatter},{id:"heapMax",field:"maxHeap",name:"Heap Max",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"heapTotal",field:"totalHeap",name:"Heap Total",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"heapUsed",field:"usedHeap",name:"Heap Used",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"heapUtilPct",field:"heapUtilization",name:"Heap Utilization",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"nonHeapTotal",field:"totalNonHeap",name:"Non-Heap Total",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"nonHeapUsed",field:"usedNonHeap",name:"Non-Heap Used",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter},{id:"gc",name:"GC",sortable:false,resizable:true,formatter:ac,width:50,maxWidth:50},{id:"uptime",field:"uptime",name:"Uptime",sortable:true,resizable:true,cssClass:"cell-right",headerCssClass:"header-right",formatter:W.genericValueFormatter}]}var r,X;function aa(ac,af,ae){var ad=function(au,at){if(ac.columnId==="heartbeat"||ac.columnId==="uptime"){var ak=W.parseDateTime(au[ac.columnId]);var ah=W.parseDateTime(at[ac.columnId]);return ak.getTime()-ah.getTime()}else{if(ac.columnId==="queued"){var am=au[ac.columnId].split(/ \/ /);var ap=at[ac.columnId].split(/ \/ /);var ar=X%4;if(ar<2){I("#cluster-nodes-table span.queued-title").addClass("sorted");var ai=W.parseCount(am[0]);var ao=W.parseCount(ap[0]);return ai-ao}else{I("#cluster-nodes-table span.queued-size-title").addClass("sorted");var ax=W.parseSize(am[1]);var aw=W.parseSize(ap[1]);return ax-aw}}else{if(ac.columnId==="maxHeap"||ac.columnId==="totalHeap"||ac.columnId==="usedHeap"||ac.columnId==="totalNonHeap"||ac.columnId==="usedNonHeap"||ac.columnId==="ffRepoTotal"||ac.columnId==="ffRepoUsed"||ac.columnId==="ffRepoFree"||ac.columnId==="contentRepoTotal"||ac.columnId==="contentRepoUsed"||ac.columnId==="contentRepoFree"){var ax=W.parseSize(au[ac.columnId]);var aw=W.parseSize(at[ac.columnId]);return ax-aw}else{if(ac.columnId==="totalThreads"||ac.columnId==="daemonThreads"||ac.columnId==="processors"){var ai=W.parseCount(au[ac.columnId]);var ao=W.parseCount(at[ac.columnId]);return ai-ao}else{if(ac.columnId==="status"){var al=d(au);var aq=d(at);return al===aq?0:al>aq?1:-1}else{if(ac.columnId==="formattedNodeAddress"){var aj=m(au);var ag=m(at);return aj===ag?0:aj>ag?1:-1}else{var an=W.isDefinedAndNotNull(au[ac.columnId])?au[ac.columnId]:"";var av=W.isDefinedAndNotNull(at[ac.columnId])?at[ac.columnId]:"";return an===av?0:an>av?1:-1}}}}}}};I("#cluster-nodes-table span.queued-title").removeClass("sorted");I("#cluster-nodes-table span.queued-size-title").removeClass("sorted");if(r!==ac.columnId){X=0}else{X++}af.sort(ad,ac.sortAsc);r=ac.columnId}var m=function(ac){return W.escapeHtml(ac.address)+":"+W.escapeHtml(ac.apiPort)};var d=function(ad){var ac=ad.status;if(ad.roles.includes(Q.primaryNode)){ac+=", PRIMARY"}if(ad.roles.includes(Q.clusterCoordinator)){ac+=", COORDINATOR"}return W.escapeHtml(ac)};var R=function(ac){q.showYesNoDialog({headerText:"Connect Node",dialogContent:"Connect '"+m(ac)+"' to this cluster?",yesHandler:function(){v(ac.nodeId)}})};var v=function(ad){var ac={node:{nodeId:ad,status:"CONNECTING"}};I.ajax({type:"PUT",url:Q.urls.nodes+"/"+encodeURIComponent(ad),data:JSON.stringify(ac),dataType:"json",contentType:"application/json"}).done(function(af){var ag=af.node;var ah=I("#cluster-nodes-table").data("gridInstance");var ae=ah.getData();ae.updateItem(ag.nodeId,ag)}).fail(g.handleAjaxError)};var l=function(ac){q.showYesNoDialog({headerText:"Offload Node",dialogContent:"Offload '"+m(ac)+"'?",yesHandler:function(){U(ac.nodeId)}})};var U=function(ad){var ac={node:{nodeId:ad,status:"OFFLOADING"}};I.ajax({type:"PUT",url:Q.urls.nodes+"/"+encodeURIComponent(ad),data:JSON.stringify(ac),dataType:"json",contentType:"application/json"}).done(function(af){var ag=af.node;var ah=I("#cluster-nodes-table").data("gridInstance");var ae=ah.getData();ae.updateItem(ag.nodeId,ag)}).fail(g.handleAjaxError)};var V=function(ac){q.showYesNoDialog({headerText:"Disconnect Node",dialogContent:"Disconnect '"+m(ac)+"' from the cluster?",yesHandler:function(){Y(ac.nodeId)}})};var Y=function(ad){var ac={node:{nodeId:ad,status:"DISCONNECTING"}};I.ajax({type:"PUT",url:Q.urls.nodes+"/"+encodeURIComponent(ad),data:JSON.stringify(ac),dataType:"json",contentType:"application/json"}).done(function(af){var ag=af.node;var ah=I("#cluster-nodes-table").data("gridInstance");var ae=ah.getData();ae.updateItem(ag.nodeId,ag)}).fail(g.handleAjaxError)};var h=function(ac){q.showYesNoDialog({headerText:"Remove Node",dialogContent:"Remove '"+m(ac)+"' from the cluster?",yesHandler:function(){D(ac.nodeId)}})};var D=function(ac){I.ajax({type:"DELETE",url:Q.urls.nodes+"/"+encodeURIComponent(ac),dataType:"json"}).done(function(){var ae=I("#cluster-nodes-table").data("gridInstance");var ad=ae.getData();ad.deleteItem(ac)}).fail(g.handleAjaxError)};var J=function(){return I("#cluster-filter").val()};var n=function(){var ae=N();if(!ae){return}var ad=ae.grid;if(W.isDefinedAndNotNull(ad)){var ac=ad.getData();ac.setFilterArgs({searchString:J(),property:I("#cluster-filter-type").combo("getSelectedOption").value});ac.refresh()}};var N=function(){var ac=null;T.forEach(function(ad){if(I("#"+ad.tableId).is(":visible")){ac=ad}});return ac};var K=function(ad,ac){if(ac.searchString===""){return true}try{var ag=new RegExp(ac.searchString,"i")}catch(af){return false}var ae=ad[ac.property];if(ac.property==="address"){ae=m(ad)}else{if(ac.property==="status"){ae=d(ad)}}return ae.search(ag)>=0};function O(ac){if(!ac){ac=N()}if(ac.dataView){var ae=ac.dataView.getLength();var ad=ac.rowCount;I("#displayed-rows").text(ae);I("#total-rows").text(ad)}}var P=function(){I("#cluster-filter").val("");n()};var B=function(ac){I.ajax({type:"GET",url:Q.urls.nodes+"/"+encodeURIComponent(ac.nodeId),dataType:"json"}).done(function(ae){var ag=ae.node;I("#node-id").text(ag.nodeId);I("#node-address").text(m(ag));var af=I("#node-events");if(I.isArray(ag.events)&&ag.events.length>0){var ad=[];I.each(ag.events,function(ah,ai){ad.push(ai.timestamp+": "+ai.message)});I("<div></div>").append(W.formatUnorderedList(ad)).appendTo(af)}else{af.append('<div><span class="unset">None</span></div>')}I("#node-details-dialog").modal("show")}).fail(g.handleAjaxError)};function Z(ac){if(W.isDefinedAndNotNull(ac.systemDiagnostics)&&W.isDefinedAndNotNull(ac.systemDiagnostics.nodeSnapshots)){var ad=[];ac.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;ad.push({id:ae.nodeId,node:ae.address+":"+ae.apiPort,address:ae.address,maxHeap:af.maxHeap,totalHeap:af.totalHeap,usedHeap:af.usedHeap,heapUtilization:af.heapUtilization,maxNonHeap:af.maxNonHeap,totalNonHeap:af.totalNonHeap,usedNonHeap:af.usedNonHeap,garbageCollection:af.garbageCollection,uptime:af.uptime})});S.rowCount=ad.length;S.dataView.setItems(ad);S.dataView.reSort();S.grid.invalidate()}else{S.rowCount=0}}function b(ad){if(W.isDefinedAndNotNull(ad.systemDiagnostics)&&W.isDefinedAndNotNull(ad.systemDiagnostics.nodeSnapshots)){var ac=[];ad.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;ac.push({id:ae.nodeId,node:ae.address+":"+ae.apiPort,address:ae.address,processors:af.availableProcessors,processorLoadAverage:af.processorLoadAverage,totalThreads:af.totalThreads,daemonThreads:af.daemonThreads})});u.rowCount=ac.length;u.dataView.setItems(ac);u.dataView.reSort();u.grid.invalidate()}else{u.rowCount=0}}function E(ac){if(W.isDefinedAndNotNull(ac.systemDiagnostics)&&W.isDefinedAndNotNull(ac.systemDiagnostics.nodeSnapshots)){var ad=[];ac.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;ad.push({id:ae.nodeId,node:ae.address+":"+ae.apiPort,address:ae.address,ffRepoTotal:af.flowFileRepositoryStorageUsage.totalSpace,ffRepoUsed:af.flowFileRepositoryStorageUsage.usedSpace,ffRepoFree:af.flowFileRepositoryStorageUsage.freeSpace,ffRepoUtil:af.flowFileRepositoryStorageUsage.utilization})});y.rowCount=ad.length;y.dataView.setItems(ad);y.dataView.reSort();y.grid.invalidate()}else{y.rowCount=0}}function w(ad){if(W.isDefinedAndNotNull(ad.systemDiagnostics)&&W.isDefinedAndNotNull(ad.systemDiagnostics.nodeSnapshots)){var ac=[];ad.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;af.contentRepositoryStorageUsage.forEach(function(ag){ac.push({id:ae.nodeId+":"+ag.identifier,address:ae.address,node:ae.address+":"+ae.apiPort,contentRepoId:ag.identifier,contentRepoTotal:ag.totalSpace,contentRepoUsed:ag.usedSpace,contentRepoFree:ag.freeSpace,contentRepoUtil:ag.utilization})})});ab.rowCount=ac.length;ab.dataView.setItems(ac);ab.dataView.reSort();ab.grid.invalidate()}else{ab.rowCount=0}}function p(ad){if(W.isDefinedAndNotNull(ad.systemDiagnostics)&&W.isDefinedAndNotNull(ad.systemDiagnostics.nodeSnapshots)){var ac=[];ad.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;af.provenanceRepositoryStorageUsage.forEach(function(ag){ac.push({id:ae.nodeId+":"+ag.identifier,address:ae.address,node:ae.address+":"+ae.apiPort,provenanceRepoId:ag.identifier,provenanceRepoTotal:ag.totalSpace,provenanceRepoUsed:ag.usedSpace,provenanceRepoFree:ag.freeSpace,provenanceRepoUtil:ag.utilization})})});C.rowCount=ac.length;C.dataView.setItems(ac);C.dataView.reSort();C.grid.invalidate()}else{C.rowCount=0}}function f(ad){if(W.isDefinedAndNotNull(ad.systemDiagnostics)&&W.isDefinedAndNotNull(ad.systemDiagnostics.nodeSnapshots)){var ac=[];ad.systemDiagnostics.nodeSnapshots.forEach(function(ae){var af=ae.snapshot;ac.push({id:ae.nodeId,address:ae.address,node:ae.address+":"+ae.apiPort,version:af.versionInfo.niFiVersion,javaVendor:af.versionInfo.javaVendor,javaVersion:af.versionInfo.javaVersion,osName:af.versionInfo.osName,osVersion:af.versionInfo.osVersion,osArchitecture:af.versionInfo.osArchitecture})});s.dataView.setItems(ac);s.dataView.reSort();s.grid.invalidate()}}function F(){var ad=Q.urls.systemDiagnostics;var ac=I.ajax({type:"GET",url:ad,data:{nodewise:true},dataType:"json"}).done(function(af){var ae=M.systemDiagnostics;ae.forEach(function(ag){ag(af)})}).fail(g.handleAjaxError);return ac}function x(ae){var ag=new c.Data.DataView({inlineFilters:false});ag.setItems([],ae.tableIdColumn);ag.setFilterArgs({searchString:J(),property:I("#cluster-filter-type").combo("getSelectedOption").value});ag.setFilter(K);ae.onSort({columnId:ae.tableIdColumn,sortAsc:true},ag);var ad=ae.tableColumnModel;if(typeof ad==="function"){ad=ad()}var ac=new c.Grid("#"+ae.tableId,ag,ad,ae.tableOptions);ac.setSelectionModel(new c.RowSelectionModel());ac.setSortColumn(ae.tableIdColumn,true);ac.onSort.subscribe(function(ai,ah){ae.onSort({columnId:ah.sortCol.field,sortAsc:ah.sortAsc},ag,ae)});ag.onRowCountChanged.subscribe(function(ai,ah){ac.updateRowCount();ac.render();O(ae)});ag.onRowsChanged.subscribe(function(ai,ah){ac.invalidateRows(ah.rows);ac.render()});if(ae.tableOnClick){ac.onClick.subscribe(function(ak,ah){var aj=I(ak.target);var ai=ag.getItem(ah.row);ae.tableOnClick(ak,ah,aj,ai)})}var af=I("#"+ae.tableId).data("gridInstance",ac);if(typeof ae.createTableOnEnter==="function"){af.on("mouseenter","div.slick-cell",ae.createTableOnEnter(ac))}if(typeof ae.cleanUpTable==="function"){ac.onViewportChanged.subscribe(function(ai,ah){ae.cleanUpTable(af)})}ae.dataView=ag;ae.grid=ac}function o(ae){var ac=ae.cluster;if(W.isDefinedAndNotNull(ac.nodes)){var af=L.grid;var ad=af.getData();L.rowCount=ac.nodes.length;ad.setItems(ac.nodes);ad.reSort();af.invalidate();I("#cluster-last-refreshed").text(ac.generated)}else{I("#total-nodes").text("0")}}function k(){var ac=I.ajax({type:"GET",url:Q.urls.cluster,dataType:"json"}).done(function(ae){var ad=M.cluster;ad.forEach(function(af){af(ae)})}).fail(g.handleAjaxError);return ac}function i(ac){var ad=ac.grid;if(W.isDefinedAndNotNull(ad)){ad.resizeCanvas()}P();I("#cluster-filter-type").combo({options:ac.filterOptions,select:function(ae){n()}});O(ac)}var G={init:function(){I("#node-details-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Node Details",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){I("#node-details-dialog").modal("hide")}}}],handler:{close:function(){I("#node-address").text("");I("#node-id").text("");I("#node-events").empty()}}});I("#cluster-filter").keyup(function(){n()});var ac={};Q.data=Q.data.filter(function(ad){ad.authorized=ad.isAuthorized();ac[ad.name]=ad.authorized;if(ad.authorized){return true}else{return false}});T=T.filter(function(ae){var ad=ae.data.dataSet;if(ac[ad]){return true}else{return false}});T.forEach(function(ad){A[ad.name]=ad;var ae=M[ad.data.dataSet];if(ae){M[ad.data.dataSet]=ae.concat([ad.data.update])}else{M[ad.data.dataSet]=[ad.data.update]}});I("#cluster-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:T,select:function(){var ae=I(this).text();var ad=A[ae];if(ad){ad.onTabSelected(ad)}else{console.error("Failed to match tab: ",ae,A)}}});I(window).resize(function(){G.resetTableSize()});T.forEach(function(ae){try{ae.init(ae)}catch(ad){console.error("Failed to initialize tab",ae,ad)}})},resetTableSize:function(){T.forEach(function(ac){if(ac&&ac.grid){ac.grid.resizeCanvas()}})},loadClusterTable:function(){var ad=Q.data.map(function(af){var ae=af.update();return ae});var ac=I.when.apply(I,ad);ac=ac.done(function(ae){O(L)});return ac}};return G}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.ClusterTable","nf.ErrorHandler","nf.Storage"],function(d,e,g,f,c){return(nf.Cluster=b(d,e,g,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Cluster=b(require("jquery"),require("nf.Common"),require("nf.ClusterTable"),require("nf.ErrorHandler"),require("nf.Storage")))}else{nf.Cluster=b(a.$,a.nf.Common,a.nf.ClusterTable,a.nf.ErrorHandler,a.nf.Storage)}}}(this,function(c,b,h,e,d){c(document).ready(function(){g.init()});var a={urls:{banners:"../nifi-api/flow/banners",about:"../nifi-api/flow/about",currentUser:"../nifi-api/flow/current-user"}};var f=function(){return c.ajax({type:"GET",url:a.urls.currentUser,dataType:"json"}).done(function(j){b.setCurrentUser(j)}).fail(e.handleAjaxError)};var i=function(){c("#refresh-button").click(function(){h.loadClusterTable()});return c.Deferred(function(j){if(top===window){c.ajax({type:"GET",url:a.urls.banners,dataType:"json"}).done(function(o){if(b.isDefinedAndNotNull(o.banners)){if(b.isDefinedAndNotNull(o.banners.headerText)&&o.banners.headerText!==""){var l=c("#banner-header").text(o.banners.headerText).show();var n=function(p){var q=c("#"+p);q.css("top",(parseInt(l.css("height"),10)+parseInt(q.css("top"),10))+"px")};n("counters")}if(b.isDefinedAndNotNull(o.banners.footerText)&&o.banners.footerText!==""){var k=c("#banner-footer").text(o.banners.footerText).show();var m=function(p){var q=c("#"+p);q.css("bottom",parseInt(k.css("height"),10)+"px")};m("counters")}}j.resolve()}).fail(function(m,k,l){e.handleAjaxError(m,k,l);j.reject()})}else{j.resolve()}}).promise()};var g={init:function(){d.init();f().done(function(){var j=function(){if(top===window){c("body").css({height:c(window).height()+"px",width:c(window).width()+"px"});c("#cluster").css("margin",40);c("#cluster-table").css("bottom",127);c("#cluster-refresh-container").css("margin",40)}};j();h.init();h.resetTableSize();h.loadClusterTable().done(function(){i().done(function(){c.ajax({type:"GET",url:a.urls.about,dataType:"json"}).done(function(l){var k=l.about;var m=k.title+" Cluster";document.title=m;c("#counters-header-text").text(m)}).fail(e.handleAjaxError);c(window).on("resize",function(s){j();var l=c(".dialog");for(var q=0,r=l.length;q<r;q++){if(c(l[q]).is(":visible")){setTimeout(function(k){k.modal("resize")},50,c(l[q]))}}var t=c('*[class*="slickgrid_"]');for(var p=0,r=t.length;p<r;p++){if(c(t[p]).is(":visible")){setTimeout(function(k){k.data("gridInstance").resizeCanvas()},50,c(t[p]))}}var n=c(".tab-container");var m=[];for(var o=0,r=n.length;o<r;o++){if(c(n[o]).is(":visible")){m.push(c("#"+c(n[o]).attr("id")+"-content"))}}c.each(m,function(k,u){b.toggleScrollable(u.get(0))})})})})})}};return g}));
